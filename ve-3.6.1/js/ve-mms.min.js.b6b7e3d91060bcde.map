{"version":3,"sources":["../../src/mms.js","../../src/services/ApplicationService.js","../../src/services/ArtifactService.js","../../src/services/AuthorizationService.js","../../src/services/CacheService.js","../../src/services/ElementService.js","../../src/services/FullDocumentService.js","../../src/services/HttpService.js","../../src/services/JobService.js","../../src/services/MentionService.js","../../src/services/ProjectService.js","../../src/services/ShortenUrlService.js","../../src/services/StompService.js","../../src/services/TableService.js","../../src/services/URLService.js","../../src/services/UtilsService.js","../../src/services/UxService.js","../../src/services/ViewService.js","../../src/services/VizService.js","../../src/filters/underlineMatch.js","../../src/directives/charts/mmsC3Plot.js","../../src/directives/charts/mmsD3GroupedHorizontalBarPlot.js","../../src/directives/charts/mmsD3NormalizedStackedBarPlot.js","../../src/directives/charts/mmsD3ParallelAxisPlot.js","../../src/directives/charts/mmsD3RadarPlot.js","../../src/directives/mmsAnnotation.js","../../src/directives/mmsButtonBar.js","../../src/directives/mmsCf.js","../../src/directives/mmsCkEditor.js","../../src/directives/mmsDiagramBlock.js","../../src/directives/mmsDiffAttr.js","../../src/directives/mmsGroupDocs.js","../../src/directives/mmsHistory.js","../../src/directives/mmsHtmlDiff.js","../../src/directives/mmsJobs.js","../../src/directives/mmsMaturityBar.js","../../src/directives/mmsMention.js","../../src/directives/mmsRefList.js","../../src/directives/mmsSearch.js","../../src/directives/mmsSpec.js","../../src/directives/mmsToolbar.js","../../src/directives/mmsTranscludeArt.js","../../src/directives/mmsTranscludeCom.js","../../src/directives/mmsTranscludeDoc.js","../../src/directives/mmsTranscludeImg.js","../../src/directives/mmsTranscludeName.js","../../src/directives/mmsTranscludeVal.js","../../src/directives/mmsTree.js","../../src/directives/mmsTsDiagram.js","../../src/directives/mmsValueLink.js","../../src/directives/mmsView.js","../../src/directives/mmsViewEquation.js","../../src/directives/mmsViewFigure.js","../../src/directives/mmsViewImg.js","../../src/directives/mmsViewLink.js","../../src/directives/mmsViewList.js","../../src/directives/mmsViewListT.js","../../src/directives/mmsViewPara.js","../../src/directives/mmsViewPlot.js","../../src/directives/mmsViewPresentationElem.js","../../src/directives/mmsViewReorder.js","../../src/directives/mmsViewSection.js","../../src/directives/mmsViewTable.js","../../src/directives/mmsViewTableT.js","../jsTemp/mms.directives.tpls.js","../../src/mms.directives.js","../../src/directives/ngDropdownMultiselect.js","../../src/directives/Utils.js","../../app/js/mms/controllers/controller.utils.js","../../app/js/mms/directives/currentTag.js","../../app/js/mms/directives/runXlr.js","../../app/js/mms/directives/veFooter.js","../../app/js/mms/directives/veMenu.js","../../app/js/mms/directives/veNav.js","../jsTemp/app.tpls.js","../../app/js/mms/app.js","../../app/js/mms/controllers/fulldoc.controller.js","../../app/js/mms/controllers/main.controller.js","../../app/js/mms/controllers/redirect.controller.js","../../app/js/mms/controllers/refs.controller.js","../../app/js/mms/controllers/reorder.controller.js","../../app/js/mms/controllers/reorderGroup.controller.js","../../app/js/mms/controllers/tool.controller.js","../../app/js/mms/controllers/toolbar.controller.js","../../app/js/mms/controllers/tree.controller.js","../../app/js/mms/controllers/view.controller.js"],"names":["ApplicationService","$q","$http","URLService","username","source","createUniqueId","state","s","hexDigits","i","substr","Math","floor","random","join","getSource","getMmsVersion","deferred","defer","get","getMmsVersionURL","then","response","resolve","data","mmsVersion","handleHttpStatus","status","headers","config","promise","setUserName","user","getUserName","getState","ArtifactService","UtilsService","CacheService","HttpService","inProgress","cacheArtifact","reqOb","artifactOb","edit","requestCacheKey","getArtifactCacheKey","id","origResultCommit","_commitId","commmitId","resultCommitCopy","JSON","parse","stringify","commitCacheKey","makeArtifactKey","put","realCacheKey","angular","equals","refId","commitId","artifactId","key","projectId","push","getArtifact","weight","update","normalize","getArtifactURL","hasOwnProperty","ping","cached","isArray","artifacts","length","reject","message","getArtifacts","request","existing","artifactIds","exist","getPutArtifactsURL","getArtifactHistory","getArtifactHistoryURL","exists","commits","reset","AuthService","ElementService","ViewService","ProjectService","$window","$analytics","ticket","localStorage","getItem","removeTicket","removeItem","undefined","setTicket","dropAll","checkLogin","getCheckTicketURL","success","setUsername","fail","getAuthorized","credentials","post","setItem","header","getTicket","logout","_","cache","realkey","makeKey","realval","isString","remove","result","val","isObject","keys","getLatestElements","latestElements","indexOf","value","merge","m","a","b","type","Array","prototype","apply","getCache","Object","getElement","getElementKey","url","getElementURL","extended","_qualifiedId","deletedRequestCacheKey","deleted","recentVersionOfElement","elements","cacheElement","elementId","cacheDeletedElement","elementOb","cleanElement","makeElementKey","deletedOb","getGenericElements","jsonKey","results","element","fillInElement","ob","editOb","_displayedElementIds","_allowedElementIds","_childViews","updateElement","returnChildViews","postElem","getPostElementsURL","_projectId","_refId","timeout","rejected","code","e","metaOb","resp","editCopy","history","unshift","_creator","_modifier","_created","_modified","handleSuccess","serverOb","origCommit","origOb","hasConflict","_read","good","reason","getElements","elementIds","getPutElementsURL","getElementForEdit","copy","finally","getOwnedElements","depth","getOwnedElementURL","updateElements","elementObs","every","postElements","map","groupOfElements","groupBy","promises","forEach","serverResponse","_bulkUpdateSuccessHandler","allSettled","responses","successfulRequests","filter","successValues","flatten","rejectionReasons","failedRequests","createElement","createElements","getElementHistory","getElementHistoryURL","isCacheOutdated","search","query","getElementSearchURL","FullDocumentService","$timeout","$interval","growl","views","self","this","_pushNewViewsToBuffer","startIndex","endIndex","isLoadedBefore","_views","viewsBuffer","slice","_waitTillAfterDigestCycle","_isFullDocFullyLoaded","_deleteViewsFrom","viewListToDeleteFrom","viewIdsToDelete","view","_findViewFromLoadedViews","viewId","findIndex","_findViewFromOriginalViews","callback","pendingRequests","handleClickOnBranch","branch","isViewLoadedBefore","index","_loadViewsUntilViewWith","info","ttl","destroy","loadRemainingViews","handler","_loadingRemainingViewsMessage","onclose","_isLoadingRemaingViews","nextIndex","cancel","handleDocumentScrolling","addInitialViews","isScrollbarVisible","_incrementallyAddViewTillScroll","isNoMoreToLoad","isScrollBarVisible","handleViewAdd","prevSiblingViewId","siblingIndex","splice","siblingIndexFromLoadedViews","handleViewDelete","deletedBranch","_getAllViewsStartingAt","children","childBranch","queue","0","1","GET_OUTBOUND_LIMIT","successCallback","errorCallback","next","shift","setOutboundLimit","limit","getOutboundLimit","getQueue","transformQueue","JobService","$location","serverSentPMA","host","segments","split","setJobsUrl","env","createJob","jobOb","jobName","jobType","jobSchedule","schedule","associatedElementID","mmsServer","alfrescoToken","link","getCreateJobURL","jobs","error","getJobs","docId","getJobsURL","docJobs","getJobInstances","jobId","getJobInstancesURL","jobInstances","runJob","jobRunOb","getRunJobURL","MentionService","$rootScope","$compile","moment","mentions","mentionPlacerHolderPrefix","getFastCfListing","createMention","handleInput","event","editor","currentEditingElement","elementsPath","list","$","currentEditingElementId","getAttribute","mentionId","_getMentionIdFromMentionPlaceHolder","mentionState","_retrieveMentionState","mentionPlaceHolderId","mentionScope","$apply","text","innerText","substring","mmsMentionValue","mentionElement","dropdownResultElement","find","isOnScreen","ckeditorBox","_getCkeditorFrame","getBoundingClientRect","css","top","left","evt","which","_handleArrowKey","editorId","matchDom","attr","mentionItem","cf","mentionController","selectMentionItem","_handleEnterKey","_cleanup","_handleSpecialKeys","handleMentionSelection","removeAllMentionForEditor","splits","hasMentionResults","reduce","elementType","getElementType","iconClass","getElementTypeClass","name","documentation","editTime","fromNow","defaultValue","String","existingMentionPlaceHolder","mentionPlaceHolder","newScope","mention","ckeditorFrame","mentionPlaceHolderBox","chr4","toString","_getNewMentionId","insertHtml","assign","$new","mmsEditor","mmsMentionId","mmsProjectId","mmsRefId","scope","controller","_getMentionStateId","contentDocument","getElementById","position","append","container","getElementsByTagName","unwrapOnly","mentionPlaceHolderDom","document","getById","range","createRange","moveToClosestEditablePosition","contents","unwrap","select","$destroy","isDownArrow","allOptions","len","activeIndex","each","hasClass","target","addClass","removeClass","parentNode","scrollTop","offsetTop","getRefs","cacheKey","getRefsURL","refs","ref","getGroups","getGroupsURL","groups","group","metatypeFilterMustNotList","terms","_appliedStereotypeIds","getMetatypeFilter","size","aggs","stereotypedElements","bool","must","term","_inRefIds","field","must_not","stereotypeIds","types","getProjects","orgId","getProjectsURL","projects","project","getProject","getProjectURL","getProjectMounts","getProjectMountsURL","getOrgs","getOrgsURL","orgs","org","getOrg","urlkey","getOrgURL","getRef","getRefHistory","timestamp","getRefHistoryURL","getGroup","createRef","refOb","createdRef","updateRef","deleteRef","getRefURL","delete","getMetatypes","getSearchURL","aggregations","isDefined","metatypeList","typeIds","buckets","typeKeyList","obj","pluck","steroObjList","concat","ShortenUrlService","dynamicPopover","templateUrl","title","copyToClipboard","$event","getShortUrl","currentUrl","Authorization","shortUrl","StompService","stompClient","getJMSHostname","connections","removeProtocol","uri","replace","stompConnect","console","log","failed","stompSuccessCallback","updateWebpage","fromJson","body","updatedElements","eltId","$broadcast","updatedJobs","updateJob","$on","unsubscribe","stompFailureCallback","Stomp","client","debug","connect","subscribe","TableService","asyncReadTableHeader","aMmsEid","readRowValues","tableheader","values","asyncReadTableBody","tablebody","c3_data","valuesO","row","yyvalue","getValue","datavalue","isNaN","Number","readParagraphValue","content","sourceType","tv","trim","valueO","sourceProperty","refe","nameModified","docModified","r","toValidId","original","plotConfig","clientConfig","defaultPlotConfig","width","height","padding","marginTop","right","marginRight","marginLeft","bottom","marginBottom","readvalues","plot","isHeader","table","readvalues2","mtableheader","valuesx","urlService","baseUrl","mmsUrl","root","jobsRoot","addTicket","isTimestamp","version","test","addServer","server","addVersion","addExtended","addChildViews","add","getRoot","t","getMmsServer","getSiteDashboardURL","site","getViewElementIdsURL","recurseString","checkType","urlParams","getProjectDocumentsURL","getDocumentViewsURL","getImageURL","getExportHtmlUrl","jobUrl","machine","getJobURL","getCheckLoginURL","getLogoutURL","VIEW_SID","OTHER_VIEW_SID","DOCUMENT_SID","REQUIREMENT_SID","editKeys","CLASS_ELEMENT_TEMPLATE","appliedStereotypeInstanceId","classifierBehaviorId","clientDependencyIds","collaborationUseIds","elementImportIds","generalizationIds","interfaceRealizationIds","isAbstract","isActive","isFinalSpecialization","isLeaf","mdExtensionsIds","nameExpression","ownedAttributeIds","ownedOperationIds","ownerId","packageImportIds","powertypeExtentIds","redefinedClassifierIds","representationId","substitutionIds","supplierDependencyIds","syncElementId","templateBindingIds","templateParameterId","useCaseIds","visibility","INSTANCE_ELEMENT_TEMPLATE","classifierIds","deploymentIds","slotIds","specification","stereotypedElementId","VALUESPEC_ELEMENT_TEMPLATE","typeId","PACKAGE_ELEMENT_TEMPLATE","URI","packageMergeIds","profileApplicationIds","GENERALIZATION_ELEMENT_TEMPLATE","generalizationSetIds","isSubstitutable","DEPENDENCY_ELEMENT_TEMPLATE","cleanValueSpec","vs","valueExpression","operand","makeHtmlTable","isFilterable","isSortable","pe","style","colwidths","makeTableBody","inDoc","excludeFromList","tableConfig","sortByColumnFn","showBindingForSortIcon","filterDebounceRate","filterTermColumnPrefixBinding","_generateRowColNumber","rowIndex","startCol","colCounter","cell","cellIndex","rowspan","colspan","colSpan","startRow","endRow","endCol","j","k","thing","dtag","para","makeHtmlPara","makeHtmlList","item","ordered","nonEditable","makeHtmlTOCChild","skip","child","_veNumber","ulAdded","makeTablesAndFiguresTOCChild","printElement","live","showRefName","sysmlId","veNumber","prefix","el","cap","capTbl","tables","html","prepend","capFig","figures","wrap","after","equations","equationCap","capEq","last","generateAnchorId","generateTOCHtmlOption","tree","tblCap","tbl","fig","anchorId","thisCap","tableCount","figureCount","figcap","BLOCK_SID","createClassElement","o","createInstanceElement","createValueSpecElement","createGeneralizationElement","createDependencyElement","createPackageElement","hasCircularReference","curId","curType","curscope","$parent","parent","mmsElementId","cfType","elem","forEdit","_contents","contains","specialization","buildTreeHierarchy","array","level2_Func","rootNodes","data2Node","label","sortFunction","sort","toLowerCase","filterProperties","res","mergeElement","updateEdit","orig","isRestrictedValue","makeHtmlTOC","root_branch","makeTablesAndFiguresTOC","equationCount","addLiveNumbering","convertViewLinks","$this","createMmsId","d","Date","now","uuid","c","getPrintCss","htmlFlag","landscape","meta","ret","isView","isDocument","isRequirement","exportHtmlAs","exportType","accept","Content-Type","Accepts","htmlString","PROJECT_URL_PREFIX","stopPropagation","window","selectNodeContents","childNodes","getSelection","removeAllRanges","addRange","execCommand","err","UxService","getToolbarButton","button","icon","selected","active","permission","tooltip","spinner","onClick","dynamic_buttons","dynamic","diffPerspective","getButtonBarButton","togglable","placement","action","dropdown_buttons","toggle_icon","toggle_tooltip","button_content","save","saveC","preview","MetaTypes","getTypeIcon","getChangeTypeName","getTreeTypes","treeTypes","TYPE_TO_CLASSIFIER_ID","Image","List","Paragraph","Table","Section","ListT","TableT","ImageT","Equation","ParagraphT","SectionT","TomSawyerDiagram","Figure","FigureT","GROUP_ST_ID","TYPE_TO_CLASSIFIER_TYPE","Comment","opaqueClassifiers","collectTableSources","sources","createView","ownerOb","viewOb","peDoc","newViewId","newInstanceId","untitledName","isDoc","_allowedElements","instanceId","viewName","viewDoc","parentView","aggregation","peSpec","toCreate","getPresentationElementSpec","instanceSpec","instanceSpecSpec","isSection","jsonString","getElementReferenceTree","getElementReference","all","instanceVal","elementObject","sectionElements","req","instanceSpecification","isOpaque","presentationElement","sectionElementReferenceTree","isTable","isFigure","isEquation","processSlotStrings","processSlotIntegers","isInteger","parseInt","getPresentationElementType","getViewElements","toGet","displayed","specContents","tableJson","toGetSet","Set","from","createDocument","docOb","data2","_groupId","createGroup","PACKAGE_ID","PACKAGE_ASI_ID","_isGroup","groupObj","_parentId","_link","removeGroup","updatedElement","toUpdate","downgradeDocument","clone","asi","projectDocs","addViewToParentView","parentViewId","aggr","getDocumentViews","getProjectDocuments","getTreeType","addElementToViewOrSection","addPeIndex","removeElementFromViewOrSection","operands","removeViewFromParentView","createInstanceSpecification","viewOrSectionOb","realType","jsonType","getTypeFromClassifierId","some","getDocMetadata","metadata","numberingDepth","numberingSeparator","prop","feature","definingFeatureId","topl","topr","bottoml","bottomr","AnnotationType","mmsTranscludeName","mmsTranscludeDoc","mmsTranscludeCom","mmsTranscludeVal","mmsViewLink","mmsPresentationElement","VizService","makeImageUrl","newroot","parts","createImageCacheKey","Accept","partialMatch","$filter","uibTypeaheadHighlightFn","match","mmsC3Plot","mmsChartLink","attrs","mmsViewCtrl","c3","d3","divchart","viewVersion","getElementOrigin","simplifyFunctions","object","forOwn","isPlainObject","eval","vf_pplot","c3json","c3jfunc","generate","render","c3options","options","x","axis","tick","centered","xs","columns","functions","selectAll","$id","bindto","$watch","newVals","oldVals","restrict","require","mmsD3GroupedHorizontalBarPlot","achartdata","click","d3colorR","scaleOrdinal","schemeCategory10","getColor","colors","opacitydefault","opacityselected","opacitynotselected","mouseout","transition","mouseover","mouseoverClassId","createGroupedHorizontalBarChart","svg","filteredDataValues","filteredDataSysmlids","filteredDataColors","filteredDataLegends","filteredDataLabels","datalegendsfilter","legendsFilter","datalabelsfilter","labelsFilter","counter","labels","legends","valueIds","filteredLegendsLength","chartWidth","groupHeight","spaceForLabels","chartHeight","scaleLinear","domain","max","y","yAxis","axisLeft","tickFormat","tickSize","chart","bar","enter","numRows","barHeight","on","transcludeClicked","call","legend","legendRectSize","udcolors","rowvalue","cellId","rowvalues","cellIds","cid","createFilters","graphFilter","color","checked","newValue","oldValue","eid","mmsD3NormalizedStackedBarPlot","plotId","margin","g","scaleBand","rangeRound","align","z","stack","offset","stackOffsetExpand","total","tablecolumnheader","rowheader","serie","bandwidth","axisBottom","ticks","mmsD3ParallelAxisPlot","rowHeaders","getTickColor","rowHeaderName","kk","tickColor","dataseries","_out","outputs","maxSize","variables","w","h","colorscale","scalePoint","line","minMax","minTest","maxTest","min","minimum","maximum","abs","axisData","tickData","p","mouse","design","td","mmsD3RadarPlot","RadarChart","draw","LegendOptions","cfg","opacityArea","radius","factor","factorLegend","levels","maxValue","radians","PI","ToRight","TranslateX","TranslateY","ExtraWidthX","ExtraWidthY","allAxis","levelFactor2","sin","cos","format","getPosition","func","getHorizontalPosition","getVerticalPosition","levelFactors","level","levelGroups","exit","levelLine","levelFactor","series","dataValues","parseFloat","str","pti","newX","newY","mmsAnnotation","$templateCache","template","mmsReqOb","mmsRecentElement","mmsType","mmsCfLabel","$scope","displayContent","toolTipTitle","toolTipContent","AT","inlineContent","classifierType","_getValueForTranscludeVal","_getContentIfElementFound","cfLabel","_getContentIfElementNotFound","mmsButtonBar","mmsBbApi","api","parentButton","childButton","dropdownButton","setPermission","buttons","setTooltip","setIcon","setToggleState","toggle_state","toggleButtonState","getToggleState","buttonTemp","addButton","count","tooltip_orginal","icon_original","toggleButtonSpinner","init","direction","mmsCf","mmsCommitId","mmsCfType","mmsWatchId","mmsGenerateForDiff","domElement","controllers","mmsCfCtrl","changeElement","newVal","oldVal","idwatch","commitwatch","cfVersion","templateElementHtml","innerHTML","mmsCkeditor","$uibModal","CKEDITOR","Utils","generatedIds","priority","autosaveKey","mmsEditorType","mmsEditorApi","ngModelCtrl","$set","instance","transcludeModalTemplate","commentModalTemplate","transcludeCtrl","$uibModalInstance","description","searchExisting","newE","requestName","requestDocumentation","showProposeLink","nonEditableCheckbox","showEditableOp","choose","property","tag","close","dismiss","searchOptions","getProperties","emptyDocTxt","makeNewAndChoose","proposeClass","toggleRadio","transcludeCallback","ed","open","_addWidgetTag","focusManager","focus","transcludeViewLinkCtrl","suppressNumbering","linkType","linkText","createViewLink","did","vid","peid","currentDoc","_relatedDocuments","cur","_parentViews","chooseDoc","doc","relatedCallback","filterQueryList","stereoQuery","classifierList","allClassifierIds","classifierIdQuery","should","itemsPerPage","viewLinkCallback","commentCtrl","comment","toISOString","oking","ok","commentCallback","resetCrossRef","typeString","transclusionObject","transclusionId","transclusionKey","inCache","mmsResetCallback","getBody","$setViewValue","getData","stylesToolbar","items","basicStylesToolbar","clipboardToolbar","justifyToolbar","editingToolbar","linksToolbar","listToolbar","equationToolbar","sourceToolbar","thisToolbar","command","deb","debounce","focusOnEditorAfterAddingWidgetTag","_keyHandler","_isMentionKey","domEvent","ignoreDefaultBehaviour","_isTabKey","stop","_isShiftKeyOn","keyboardEvent","shiftKey","keyupHandler","$modelValue","mmscf","callbackModalFnc","mmscomment","mmsvlink","mmsreset","contentsCss","basePath","toolbar","autosave","SaveKey","delay","NotOlderThen","enableAutosave","activeEditorClass","dataProcessor","htmlFilter","addRules","startsWith","replaceWithChildren","attributesToDelete","attributes","attrKey","attrToDelete","addCommand","exec","selected_text","getSelectedText","newElement","dom","setText","insertElement","addMenuGroup","addMenuItem","contextMenu","addListener","formatAsCode","TRISTATE_OFF","setKeystroke","CTRL","closest","args","$setPristine","blur","instances","removeListener","fileLoader","formData","FormData","xhr","file","fileName","send","artifactLocation","$render","mmsDiagramBlock","go","mmsDid","ownedElementsMap","nodesMap","node","iskey","figure","nodes","elem_id","elem_node","edges","edge","_sourceIds","to","_targetIds","graph","components","diagramNode","isGroup","GraphObject","make","myDiagram","Diagram","allowDrop","mouseDrop","commandHandler","addTopLevelParts","selection","currentTool","doCancel","layout","GridLayout","wrappingWidth","Infinity","alignment","Position","cellSize","Size","initialContentAlignment","Spot","Center","groupSelectionAdornmentTemplate","Adornment","Panel","Auto","Shape","fill","stroke","strokeWidth","Placeholder","commandHandler.archetypeGroupData","category","undoManager.isEnabled","highlightGroup","grp","show","handled","tool","diagram","toolManager","draggingTool","draggedParts","copiedParts","canAddMembers","toKeySet","isHighlighted","addDiagramListener","selnode","first","model","selectedNodeData","Node","groupTemplate","Group","TreeLayout","angle","arrangement","ArrangementHorizontal","isRealtime","isSubGraphExpanded","subGraphExpandedChanged","memberParts","defaultAlignment","Left","Top","TextBlock","font","Binding","Margin","itemTempl","desiredSize","nodeTemplate","selectionAdorned","resizable","layoutConditions","Part","LayoutStandard","LayoutNodeSized","fromSpot","Right","toSpot","isShadowed","mouseDragEnter","nod","prev","containingGroup","mouseDragLeave","addMembers","isPanelMain","NaN","RowColumnDefinition","column","stretch","Horizontal","TopLeft","itemTemplate","linkTemplate","Link","routing","AvoidsNodes","corner","curve","JumpGap","toArrow","GraphLinksModel","mmsDiffAttr","mmsAttr","mmsBaseProjectId","mmsCompareProjectId","mmsBaseRefId","mmsCompareRefId","mmsBaseCommitId","mmsCompareCommitId","mmsBaseElementId","mmsCompareElementId","viewOrigin","diffFinish","diffLoading","_commitIdChangeHandler","baseNotFound","compNotFound","baseDeleted","compDeleted","_setupDiff","baseProjectId","compareProjectId","baseRefId","compareRefId","baseCommitId","compareCommitId","baseElementId","compareElementId","isSame","_checkSameElement","baseElementPromise","_getElementData","comparedElementPromise","respForBaseElement","_fullyRender","baseElementHtml","includes","respForComparedElement","comparedElementHtml","_checkElementExistence","finishRenderCb","_createElement","baseHtml","mmsGroupDocs","mmsGroupId","documents","docs","groupId","$watchCollection","mmsHistory","$animate","ran","lastid","historyVer","compareCommit","compareHistory","commitSelected","isopen","refList","baseCommit","refSelected","baseHistory","refisopen","gettingHistory","commitClicked","getElementHistoryByRef","disableRevert","baseCommitClicked","revert","revertAction","mmsHtmlDiff","MathJax","HtmlRenderedDiff","mmsBaseHtml","mmsComparedHtml","mmsDiffFinish","_performDiff","htmlDiffId","newBaseHtml","oldBaseHtml","newComparedHtml","oldComparedHtml","comparedHtml","diffResult","generateDiff","_preformatHtml","diffContainer","img$","imgPatcherClass","tr$","trPatcherClass","mmsJobs","mmsDocId","loadingJobs","createJobCleared","runCleared","jobInput","hasRefArr","docEditable","docgenExists","getRefsInProgress","loading","jobStatus","mmsRefType","docName","_editable","createJobandRun","job","defaultName","disableJob","changePane","pane","mmsMaturityBar","colorRect","svgContainer","mmsMention","$item","fastCfListing","ctrls","mmsMentionIntercept","mmsMentionInterceptValue","ctls","newV","oldV","mmsRefList","mmsBranches","mmsTags","showMerge","currentRefOb","fromRef","fromRefId","docmergeJobId","jobExists","docMergeAction","srcRef","srcRefOb","mergeDocCtrl","commitMessage","createForm","associatedElementId","mmsSearch","$anchorScroll","baseSearchResults","showFilterOptions","mmsOptions","hideFilterOptions","searchLoading","mainSearch","searchText","searchType","selectedSearchMetatypes","docsviews","qualifiedNameFormatter","qualifiedName","expandQualifiedName","currentTarget","showMoreRelatedViews","remainingRelatedDocuments","allRelatedDocuments","activeFilter","totalResults","paginationCache","currentPage","advanceSearch","advanceSearchRows","stringQuery","showSearchResultProps","switchText","limitForProps","closeSearch","back","getMetatypeSelection","mainElement","metatypeSearch","getTypeClass","fieldTypeList","operatorList","metatypeSettings","scrollableHeight","scrollable","enableSearch","displayProp","showCheckAll","smartButtonMaxItems","buttonClasses","multiselectEvent","onItemSelect","stringQueryUpdate","onItemDeselect","onDeselectAll","getActiveFilterClass","filterSearchResults","pull","_applyFilters","searchResults","filterOptions","display","_properties","properties","elt","rowLength","operator","toUpperCase","addAdvanceSearchRow","removeRowAdvanceSearch","without","modifyAdvanceSearch","advancedSearchResults","nextPage","prevPage","page","numItems","queryOb","buildQuery","filterCallback","combineRelatedViews","maxPages","ceil","newSearch","getAllMountsAsArray","projectsList","mounts","_mounts","buildSearchClause","clause","q","valueSearchFields","idQuery","boost","allQuery","fields","fuzziness","multi_match","metatypeFilterList","appliedStereotypeFilter","typeFilter","minimum_should_match","projectTermsOb","projList","mountCacheKey","cachedProj","getProjectMountsQuery","filterList","filterOb","viewsAndDocs","mainBoolQuery","jsonQueryOb","clause2","clause1","order","indices_boost","getAggs","relatedDoc","relatedDocument","relatedView","someRelatedDocuments","searchResult","data1","searchInput","userResultClick","userRelatedClick","preventDefault","mmsSpec","mmsElement","mmsSpecApi","noEdit","mmsDisplayOldContent","keepMode","editing","editable","gettingSpec","isEnumeration","propertyTypeClicked","elmentOb","$emit","setupValCf","addHtml","editorApi","relatedDocuments","isSlot","searchResultOb","editValues","getPropertySpec","elementTypeClass","elementDataLink","selector","cleanupVal","revertEdits","hasHtml","hasEdits","setupValEditFunctions","toggleEditing","setEditing","mode","getEditing","getEdits","setEdit","editorSave","mmsToolbar","mmsTbApi","deactivate","setSelected","firstButton","pullDown","setOptions","clicked","toggleDecativeFlag","$root","ve_togglePane","mms_pane_toggleable","closed","toggle","ve_tbApi","mmsTranscludeArt","processed","artifact","contentType","image","bbApi","buttonsInit","isDirectChildOfPresentationElement","mmsViewPresentationElemCtrl","recompileScope","startEdit","isEditable","warning","recompile","isEditing","empty","Hub","Queue","elementTranscluded","includeRecentVersionElement","panelType","continueEdit","recentElement","elementSaving","getView","isDirectChildOfPresentationElementFunc","saveAction","cancelAction","previewAction","deleteAction","getParentSection","getInstanceSpec","getInstanceVal","presentationElem","getPresentationElement","panelTitle","fixPreSpanRegex","fixPostSpanRegex","emptyRegex","fixImgSrc","reopenUnsavedElts","stompUpdate","charAt","editorType","mmsTranscludeImg","_artifactIds","svgImgUrl","pngImgUrl","noClick","clickHandler","valTemplate","frameTemplate","editTemplate","toCompileList","areStrings","toCompile","mmsTree","$log","treeData","initialSelection","treeControl","getHref","fullDoc","expandLevel","iconExpand","iconCollapse","iconDefault","expand_level","for_each_branch","excludeBranch","run","remove_branch_impl","singleBranch","parent_branch","get_parent","uid","parent_uid","for_all_ancestors","fn","expand_all_parents","expandable","expandCallback","expanded","selected_branch","select_branch","onSelect","scrollIntoView","on_initialSelection_change","on_treeData_change","tree_rows","add_branch_to_list","section","visible","peNums","expand_icon","type_icon","haveVisibleChild","hide","number","sectionCopy","sectionNumbering","startChapter","child_visible","nextSection","equaton","equation","treeFilter","user_clicks_branch","user_dblclicks_branch","onDblclick","expand_all","collapse_all","get_first_branch","select_first_branch","get_selected_branch","clear_selected_branch","get_parent_branch","get_children","select_parent_branch","add_branch","new_branch","remove_branch","remove_single_branch","add_root_branch","expand_branch","expandPathToSelectedBranch","collapse_branch","get_siblings","get_next_sibling","siblings","get_prev_sibling","select_next_sibling","get_next_silbing","select_prev_sibling","get_first_child","get_closest_ancestor_next_sibling","get_next_branch","select_next_branch","last_descendant","get_prev_branch","prev_sibling","select_prev_branch","refresh","initialSelect","sort_branch","get_branch","get_rows","warn","mmsTsDiagram","importedTsJs","mapping","projectId2PeId","peId2projectId","projectIdLoaded","viewNameMapping","IBD","BDD","STM","ACT","SD","PKG","PAR","REQ","UC","controlMapping","elementTableMapping","relTableMapping","onPerspectivesCommandSuccess","successfulCommand","hidePerspectivesProgressIndicator","onPerspectivesCommandFailure","failedCommand","callstack","commmand","onPerspectivesProjectLoad","projectID","onPerspectivesProjectReady","showPerspectivesProgressIndicator","invokePerspectivesCommand","onPerspectivesViewLoaded","moduleName","modelID","viewID","onPerspectivesViewUpdated","viewNamem","viewData","onPerspectivesViewCanvasRendered","onPerspectivesMouseClickOnObject","objectID","onPerspectivesMouseDoubleClickOnObject","PerspectivesErrorDialogHandler","callStackString","mmsTspSpec","mmsPeId","containerId","tableId","edgeTableId","inspectorId","controlsId","initElements","params","diagramType","viewType","tableName","edgeTableName","inspectorName","controlsName","context","webProjectCommand","onload","onready","onfailure","onsuccess","filename","module","integratorName","integratorID","integratorFileLocation","viewClass","onupdate","oncanvasrendered","widgetIDs","updateCommand","serverClassName","attributeName","attributeValue","initialIntegratorIds","integratorIDs","_createUpdateCommand","tryInvokeCommand","mmsValueLink","mmsErrorText","mmsLinkText","mmsView","mmsLink","mmsViewApi","presentationElemCleanUpFncs","isTranscludedElement","elementName","isViewElement","isPresentationElement","showEdits","elementClicked","modified","modifier","hoverIn","isHover","hoverOut","setPeLineVisibility","setTimeout","peContainer","checkForDuplicateInstances","showElements","showComments","addEltAction","addPresentationElement","toggleShowElements","toggleClass","toggleShowComments","toggleShowEdits","setShowElements","setShowComments","changeView","mmsViewEquation","mmsViewFigure","mmsViewImg","mmsPe","linkClass","linkIconClass","linkTarget","mmsExternalLink","docid","suffix","hash","reqPEOb","href","change","mmsViewList","mmsViewListT","mmsViewPara","mmsViewPlot","ptype","mmsViewPresentationElem","mmsInstanceVal","mmsParentSection","presentationElemLoading","mmsViewReorder","mmsViewReorderApi","treeOptions","sourceNodeScope","destNodeScope","destIndex","$element","elementReferenceTree","originalElementReferenceTree","cloneDeep","elementObsToUpdate","updateSectionElementOrder","elementReference","sectionEdit","origOperand","viewEdit","origContents","view2view","mmsViewSection","defaultTemplate","sectionInstanceVals","inPreviewMode","recompileEdit","cleanUp","mmsViewTable","$document","vm","_generalComparator","columnIndex","rowA","rowB","cellValueA","_getCellValueForSorting","cellValueB","isAscending","_areAllCellValidNumber","rows","eq","containerDivContent","contentTag","contentTagAttr","addFullTableFilter","trs","_fullTableFilterWatcherUnregisterFn","_addWatcherToFullTableFilterInput","_fullTableFilter","performFilter","newInputVal","oldInputVal","_displaySomeRows","increaseNumOfRowToShow","searchTerm","regExp","RegExp","string","_resetColumnWiseFilterInputs","numFiltered","addColumnsWiseFilter","_columnsInputWatchers","_addWatchersForAllHeaderColumnsInput","_filterTermForColumns","filterByColumn","filterTerm","startColNum","endColNum","filterInputBinding","_resetFullTableFilterInput","_storeColumnWiseFilterTerm","_displayRowsMatchingAllColumnsFilterTerms","columnsInputWatchers","headerRow","_addWatcherToColumnInput","deRegistration","filterTermForColumns","toArray","shouldKeepRow","colNum","_getCellValueForFiltering","_updateExistingColumnWiseFilterTerm","_addNewColumnWiseFilterTerm","listOfFilterInputBindings","addSorting","tbody","_addDefaultSortOrder","_addSortingBinding","_addSortResetBinding","rowNumber","tr","_rowSortOrderAttrName","sortColumnNum","sortedRows","reverse","_displaySortedRows","showSortReset","resetSort","_comparatorForSortReset","_comparator","detach","appendTo","rowARowNumber","rowBRowNumber","__areAllCellValidNumber","ctrl","showIfEmpty","showFilter","getSortIconClass","cellColumn","makeCsv","csvString","table2CSV","delivery","blob","Blob","navigator","msSaveOrOpenBlob","msSaveBlob","downloadContainer","downloadLink","URL","createObjectURL","fixedHeaders","fixedColumns","numFixedColumns","scroll","scrollLeft","makeFixedHeader","innerHeight","makeFixedColumn","innerWidth","findColumnCells","updateFixedColumns","bodyTag","cellTag","n","spanData","curRow","curCol","thead","searchbar","lastIndex","numTotal","compile","columnFix","mmsViewTableT","$sceProvider","enabled","constant","flatpickr","factory","provider","setBaseUrl","base","setMmsUrl","mms","$get","growlProvider","uiTreeFilterSettingsProvider","onlyUniqueMessages","globalTimeToLive","globalPosition","addresses","descendantCollection","directive","directiveModule","clearAutosaveContent","conflictCtrl","force","latest","choice","resolved","cachedKey","handleError","newArray","localeCompare","scrollToElement","addPeCtrl","newPe","elemType","presentationElemType","successUpdates","classIdOb","veCommentsOn","doNotScroll","skipBroadcast","cancelCleanUp","viewOrSec","parentElement","nodeName","isEnum","enumValue","addValueTypes","boolean","integer","real","addValue","newValueSpec","addValueType","addEnumerationValue","removeVal","windowClass","revertEltInfo","transcludeType","unsavedEdits","ve_edits","thisEdits","valList1","valList2","curr","seen","dups","imgDom","src","widgets","focused","getParent","toggleLeftPane","ve_tree_pane","MmsAppUtils","$state","printOrGenerate","viewOrDocOb","genTotf","htmlTotf","printElementCopy","canvas","imgElement","toDataURL","replaceWith","hostname","port","protocol","absurl","absUrl","mmsIndex","toc","ve_treeApi","tableAndFigTOC","tof","tot","toe","old","not","removeAttr","removeProperty","cover","outerHTML","handleChildViews","v","propId","curItemFunc","childrenFunc","seenViews","curItem","childIds","childAggrs","childPropIds","propertyId","childViews","childPromises","processedChildViews","printModal","customizeDoc","useCustomStyle","hasError","_printCss","customCSS","top-left","top-right","bottom-left","bottom-right","displayTime","_timestamp","unsaved","isEmpty","docOption","saveStyleUpdate","previewResult","htmlArr","popupWin","write","print","customization","fulldoc","backdrop","keyboard","ve_fullDocMode","ve_bbApi","tableToCsv","modalInstance","export","tableCSV","tableObj","caption","genTextArea","num","generator","refreshNumbering","centerElement","mmsCurrentTag","mms_tag","runXlr","templateId","xlrTaskName","xlrReleaseName","runXLR","password","spin","login","tok","baseAuth","btoa","email","postBody","releaseTitle","releaseVariables","contentEditor","editorEmail","autoStart","method","cache-control","withCredentials","async","crossDomain","processData","veFooter","transclude","veMenu","$sce","branches","tags","getHrefForProject","getHrefForBranch","getHrefForTag","htmlTooltip","trustAsHtml","currentProject","currentRef","currentBranch","currentTag","updateProject","reload","updateBranch","current","updateTag","refsView","isRefsView","refObs","parentId","bcrumbs","groupsMap","alfLink","breadcrumbs","eltChildren","liWidth","scrollWidth","truncateStyle","max-width","white-space","overflow","text-overflow","veNav","hotkeys","isNavCollapsed","updateOrg","selectedOrg","selectedProject","selectOrg","selectProject","continue","toggleHelp","toggleCheatSheet","toggleAbout","veV","mmsV","searchClass","stagingView","hostName","address","$parse","selectedModel","extraSettings","events","searchFilter","translationTexts","checkboxes","$attrs","$dropdownTrigger","getFindObj","findObj","settings","externalIdProp","idProp","clearObject","toggleDropdown","checkboxClick","setSelectedItem","stopImmediatePropagation","externalEvents","noop","onSelectAll","onInitDone","onMaxSelectionReached","dynamicTitle","closeOnBlur","selectionLimit","showUncheckAll","closeOnSelect","closeOnDeselect","groupByTextProvider","smartButtonTextConverter","texts","checkAll","uncheckAll","selectionCount","selectionOf","searchPlaceholder","buttonDefaultText","dynamicButtonTextSuffix","orderedItems","extend","singleSelection","parentFound","className","getGroupTitle","groupValue","getButtonText","itemsText","optionItem","isChecked","getPropertyForObject","displayText","converterResponse","totalSelected","deselectAll","sendEvent","dontRemove","finalObj","$stateProvider","$urlRouterProvider","$httpProvider","$provide","URLServiceProvider","$locationProvider","decorator","$delegate","originalLinkFn","tElem","tAttr","arguments","selectActive","matchIdx","hashPrefix","rule","$injector","locationPath","endsWith","mmsHost","location","defaults","otherwise","redirect_from_old_site","crush_url","path","login@","ve_title","pageTitle","credentialsJSON","ve_redirect","toState","toParams","fromLogin","$cookies","rejection","orgObs","$stateParams","$localStorage","$default","orgName","checkForProject","projectArray","projectOb","projectObs","orgOb","tagObs","branchObs","tagOb","branchOb","documentOb","nav@","menu@","manageRefs@","groupObs","groupOb","reason2","docMeta","pane-left@","pane-center@","pane-right@","toolbar-right@","documentObs","documentId","coverIndex","groupElement","reason3","interceptors","responseError","useApplyAsync","veElementsOn","ve_editmode","latestElement","docLibLink","bindTo","combo","exportButtons","closeable","scrollApi","notifyOnScroll","fullDocumentService","isScrollVisible","throttleRate","threshold","frequency","view2children","seenViewIds","_elementTranscluded","_elementClicked","_buildViewElement","vId","curSec","dis","topLevel","_constructViews","curSection","_handleSingleView","_handleChildren","loadingViewsFromServer","_createViews","prevSibId","handleShareURL","bind","growlMessages","ve_viewContentLoading","ve_treeInitial","ve_footer","modalOpen","ve_fn","addEventListener","returnValue","destroyAllMessages","fromState","fromParams","ve_stateChanging","notify","$current","edits","hidePanes","showManageRefs","showLogin","workingModalOpen","mmsWorkingTime","editKey","veEditsKey","redirect_noResults","redirect_element","resetSelectPage","errorHandler","projectList","searchTermList","successRedirectFnc","noResultFnc","redirectFnc","redirect_relatedDocs","idList","oldUrlTest","mms_refOb","refManageView","refData","activeTab","selectMasterDefault","masterIndex","addBranch","addItem","addTag","deleteItem","refClickHandler","itemType","templateUrlStr","createParentRefId","addItemCtrl","displayName","lastCommit","updateTimeOpt","enableTime","enableSeconds","defaultDate","dateFormat","time_24hr","maxDate","onClose","selectedDates","handlePromise","ts","branchObj","parentRefId","parentCommitId","tagObj","deleteBranch","deleteCtrl","viewIds2node","origViews","updateNumber","dropped","new","curNode","newChildNodes","docNode","saveClass","saving","navigate","curBranch","goToId","toSave","errorMessage","isSaving","targetId","sortRecursively","$nodeScope","dragStart","dest","nodesScope","saveReorder","newOwnerId","helper","childNode","elementsToUpdate","listOfDocInCache","listOfGroupInCache","cacheGroupOb","cacheDocument","navigateAway","catch","cancelReorder","createNode","groupNode","foundParent","isChild","comparator","specInfo","specApi","viewContentsOrderApi","$pane","reorder","tracker","veEditsLength","etrackerChange","etrackerSelected","showPane","cleanUpSaveAll","cleanUpEdit","cleanAll","elementSelected","displayOldContent","$digest","viewCommitId","savingAll","ve_edit","elementToSelect","viewSaving","tbApi","filterInputPlaceholder","treeApi","veTreeShowPe","treeButtons","viewModeButton","setPeVisibility","viewId2node","tableList","figureList","equationList","treeViewModes","branchList","activeMenu","getPeTreeList","resetPeTreeList","fullDocMode","handleSingleView","handleChildren","processDeletedViewBranch","addSectionElements","viewNode","initial","bulkGet","ignore","sectionTreeNode","otherTreeNode","addContentsSectionTreeNode","_startChapter","newViewAggr","newBranchType","parentBranchData","newbranch","addToFullDocView","prevSysml","lastChild","cNode","curNum","prevBranch","addViewSectionsRecursivelyForNode","newDoc","newView","newGroup","realView","cb","parentBranch","lastSection","childViewFound","elementData","newChildren","searchInputChangeHandler","isPageLoading","vidLink","viewApi","comments","lastCommented","lastCommentedBy"],"mappings":"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","file":"ve-mms.min.js","sourcesContent":["'use strict';\n\n/**\n * @ngdoc overview\n * @name mms\n *\n * @description\n * # mms module\n * This module provides angular services that abstract the mms rest api. The only \n * dependency it has is the LoDash js library. Most service functions return\n * a Promise that allows you to pass it success and failure handlers via the\n * then() method. The format of the objects that are resolved when successful \n * are defined by json schemas that're linked to below.\n * \n * ## Links\n * * [angular.js](http://angularjs.org)\n * * [mms](https://github.com/Open-MBEE/mms)\n * * {@link mms.URLService#methods_handleHttpStatus Promise rejected object}\n * * [lodash](http://lodash.com)\n *\n * ## Example app that uses this module\n * The following example is an app that uses the ElementService from mms to\n * display the name of a particular element.\n *\n * ### HTML (index.html)\n *  <pre>\n    <!doctype html>\n    <html ng-app=\"exampleApp\">\n        <head>\n            <title>Example app</title>\n        </head>\n        <body ng-controller=\"exampleCtrl\">\n            <div>{{element.name}}</div> <!-- data binds to the name property\n                                            of the element object in $scope -->\n        <script src=\"lodash.js\"></script>\n        <script src=\"angular.js\"></script>\n        <script src=\"mms.js\"></script>\n        <script src=\"app.js\"></script>\n        </body>\n    </html>\n    </pre>\n * ### JS (app.js)\n *  <pre>\n    angular.module('exampleApp', ['mms'])\n    .controller('exampleCtrl', ['$scope', 'ElementService',\n        function($scope, ElementService) { //dependency injections\n            ElementService.getElement('_element_id').then(\n                function(element) { //success handler\n                    $scope.element = element;\n                }, \n                function(reason) { //failed handler\n                    alert('get element failed: ' + reason.message);\n                }\n            );\n        }\n    ]);\n    </pre>\n */\nangular.module('mms', [])\n.config(['$sceProvider', function($sceProvider) {\n    $sceProvider.enabled(false);\n}])\n.constant('_', window._)\n.constant('HtmlRenderedDiff', window.HtmlRenderedDiff)\n.constant('moment', window.moment)\n.constant('flatpickr', window.flatpickr);\n","'use strict';\n\nangular.module('mms')\n.factory('ApplicationService', ['$q', '$http', 'URLService', ApplicationService]);\n\n/**\n * @ngdoc service\n * @name mms.ApplicationService\n * @requires $q\n * @requires $http\n * @requires URLService\n *\n * @description\n * Provide general applications functions such as getting MMS Version, getting username,\n * creating unique IDs, etc...\n */\nfunction ApplicationService($q, $http, URLService) {\n    var source = createUniqueId();\n    var username;\n    var state = {};\n\n    function createUniqueId() {\n        var s = [];\n        var hexDigits = \"0123456789abcdef\";\n        for (var i = 0; i < 36; i++) {\n            s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);\n        }\n\n        s[14] = \"4\";\n        s[19] = hexDigits.substr((s[19] & 0x3) | 0x8, 1);\n        //s[8] = s[13] = s[18] = s[23] = \"-\";\n        return s.join(\"\");\n    }\n\n    var getSource = function () {\n        return source;\n    };\n\n    var getMmsVersion = function () {\n        var deferred = $q.defer();\n        $http.get(URLService.getMmsVersionURL())\n            .then(function (response) {\n                deferred.resolve(response.data.mmsVersion);\n            }, function (response) {\n                URLService.handleHttpStatus(response.data, response.status, response.headers, response.config, deferred);\n            });\n        return deferred.promise;\n    };\n\n    var setUserName = function (user) {\n        username = user;\n    };\n\n    var getUserName = function () {\n        return username;\n    };\n\n    var getState = function() {\n        return state;\n    };\n\n    return {\n        getSource: getSource,\n        createUniqueId: createUniqueId,\n        getMmsVersion: getMmsVersion,\n        setUserName: setUserName,\n        getUserName: getUserName,\n        getState: getState\n    };\n\n}","'use strict';\n\nangular.module('mms')\n.factory('ArtifactService', ['$q', '$http', 'URLService', 'UtilsService', 'CacheService', 'HttpService', 'ApplicationService', ArtifactService]);\n\n/**\n * @ngdoc service\n * @name mms.ArtifactService\n * @requires $q\n * @requires $http\n * @requires mms.URLService\n * @requires mms.UtilsService\n * @requires mms.CacheService\n * @requires mms.HttpService\n * \n * @description\n * A service to add, get, bulk get and update/create artifacts, with caching\n */\nfunction ArtifactService($q, $http, URLService, UtilsService, CacheService, HttpService, ApplicationService) {\n\n    var inProgress = {};\n\n    /**\n     * @ngdoc method\n     * @name mms.ArtifactService#cacheArtifact\n     * @methodOf mms.ArtifactService\n     * \n     * @description\n     * handles caching of artifact objects - in case the metadata of reqOb is different\n     * from the artifact's canonical projectId/refId/commitId (due to being requested\n     * from a different project context), it'll become an alias\n     * \n     * @param {object} reqOb request keys - {projectId, refId, artifactId, commitId, extended}\n     * @param {object} artifactOb object to cache\n     * @param {boolean} [edit=false] whether object to cache is for editing\n     * @returns {object} cached object\n     */\n    var cacheArtifact = function(reqOb, artifactOb, edit) {\n        var requestCacheKey = getArtifactCacheKey(reqOb, artifactOb.id);\n        var origResultCommit = artifactOb._commitId;\n        if (reqOb.commmitId === 'latest') {\n            var resultCommitCopy = JSON.parse(JSON.stringify(artifactOb));\n            artifactOb._commitId = 'latest'; //so realCacheKey is right later\n            var commitCacheKey = UtilsService.makeArtifactKey(resultCommitCopy); //save historic artifact\n            if (!edit) {\n                CacheService.put(commitCacheKey, resultCommitCopy, true);\n            }\n        }\n        var realCacheKey = UtilsService.makeArtifactKey(artifactOb, edit);\n        artifactOb._commitId = origResultCommit; //restore actual commitId\n        if (angular.equals(realCacheKey, requestCacheKey)) {\n            artifactOb = CacheService.put(requestCacheKey, artifactOb, true);\n        } else {\n            CacheService.put(requestCacheKey, realCacheKey.join('|'));\n            artifactOb = CacheService.put(realCacheKey, artifactOb, true);\n        }\n        return artifactOb;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ArtifactService#getArtifact\n     * @methodOf mms.ArtifactService\n     * \n     * @description\n     * Gets an artifact object by projectId and artifactId. If the artifact object is already in the cache,\n     * resolve the existing reference, if not or update is true, request it from server, \n     * add/merge into the cache. \n     * \n     * Most of these methods return promises that will reject with a reason object\n     * when a server call fails, see\n     * {@link mms.URLService#methods_handleHttpStatus the return object}\n     *\n     * ## Example Usage\n     *  <pre>\n        ArtifactService.getArtifact({\n            projectId: 'projectId'\n            artifactId: 'artifactId',\n            refId: 'refId',         //default 'master'\n        }).then(\n            function(artifact) { //artifact is an artifact object (see json schema)\n                alert('got ' + artifact.name);\n            }, \n            function(reason) {\n                alert('get artifact failed: ' + reason.message);\n                //see mms.URLService#handleHttpStatus for the reason object\n            }\n        );\n        </pre>\n     * ## Example with commitId\n     *  <pre>\n        ArtifactService.getArtifact({\n            projectId: 'projectId'\n            artifactId: 'artifactId',\n            refId: 'refId',         //default 'master'\n            commitId: 'commitId',   //default 'latest'\n        }).then(\n            function(artifact) { //artifact is an artifact object (see json schema)\n                alert('got ' + artifact.name);\n            }, \n            function(reason) {\n                alert('get artifact failed: ' + reason.message);\n                //see mms.URLService#handleHttpStatus for the reason object\n            }\n        );\n        </pre>\n     * \n     * @param {object} reqOb object with keys as described in function description.\n     * @param {integer} [weight=1] priority of request (2 is immediate, 1 is normal, 0 is low)\n     * @param {boolean} [update=false] (optional) whether to always get the latest \n     *      from server, even if it's already in cache (this will update the cache if exists)\n     * @returns {Promise} The promise will be resolved with the artifact object, \n     *      multiple calls to this method with the same parameters would give the\n     *      same object\n     */\n    var getArtifact = function(reqOb, weight, update) {\n        UtilsService.normalize(reqOb);\n        var requestCacheKey = getArtifactCacheKey(reqOb);\n        var key = URLService.getArtifactURL(reqOb);\n\n        // if it's in the inProgress queue get it immediately\n        if (inProgress.hasOwnProperty(key)) { //change to change proirity if it's already in the queue\n            HttpService.ping(key, weight);\n            return inProgress[key];\n        }\n        var deferred = $q.defer();\n        var cached = CacheService.get(requestCacheKey);\n        if (cached && !update) {\n            deferred.resolve(cached);\n            return deferred.promise;\n        }\n        inProgress[key] = deferred.promise;\n        HttpService.get(key,\n            function(data, status, headers, config) {\n                if (angular.isArray(data.artifacts) && data.artifacts.length > 0) {\n                    deferred.resolve(cacheArtifact(reqOb, data.artifacts[0]));\n                } else {\n                    deferred.reject({status: 500, data: '', message: \"Server Error: empty response\"});\n                }\n                delete inProgress[key];\n            },\n            function(data, status, headers, config) {\n                URLService.handleHttpStatus(data, status, headers, config, deferred);\n                delete inProgress[key];\n            },\n            weight\n        );\n        return deferred.promise;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ArtifactService#getArtifacts\n     * @methodOf mms.ArtifactService\n     * \n     * @description\n     * Same as getArtifact, but for multiple ids.\n     * \n     * @param {object} reqOb keys - {projectId, refId, artifactIds (array of ids), commitId, extended}\n     * @param {integer} [weight=1] priority of request (2 is immediate, 1 is normal, 0 is low)\n     * @param {boolean} [update=false] (optional) whether to always get the latest \n     *      from server, even if it's already in cache (this will update the cache if exists)\n     * @returns {Promise} The promise will be resolved with an array of artifact objects, \n     *      multiple calls to this method with the same parameters would give the\n     *      same objects\n     */\n    var getArtifacts = function(reqOb, weight, update) {\n        var deferred = $q.defer();\n        var request = {artifacts: []};\n        var existing = [];\n        UtilsService.normalize(reqOb);\n        for (var i = 0; i < reqOb.artifactIds.length; i++) {\n            var id = reqOb.artifactIds[i];\n            var requestCacheKey = getArtifactCacheKey(reqOb, id);\n            var exist = CacheService.get(requestCacheKey);\n            if (exist && !update) {\n                existing.push(exist);\n                continue;\n            }\n            request.artifacts.push({id: id});\n        }\n        if (request.artifacts.length === 0) {\n            deferred.resolve(existing);\n            return deferred.promise;\n        }\n        $http.put(URLService.getPutArtifactsURL(reqOb), request)\n        .then(function(response) {\n            var data = response.data.artifacts;\n            for (var i = 0; i < data.length; i++) {\n                existing.push(cacheArtifact(reqOb, data[i]));\n            }\n            deferred.resolve(existing);\n        }, function(response) {\n            URLService.handleHttpStatus(response.data, response.status, response.headers, response.config, deferred);\n        });\n        return deferred.promise;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ArtifactService#getArtifactHistory\n     * @methodOf mms.ArtifactService\n     * \n     * @description\n     * Queries for an artifact's entire version history\n     *\n     * @param {object} reqOb see getArtifact\n     * @param {integer} [weight=1] priority\n     * @param {boolean} [update=false] update from server\n     * @returns {Promise} The promise will be resolved with an array of commit objects.\n     */\n    var getArtifactHistory = function(reqOb, weight, update) {\n        UtilsService.normalize(reqOb);\n        var key = URLService.getArtifactHistoryURL(reqOb);\n        if (inProgress.hasOwnProperty(key)) {\n            return inProgress[key];\n        }\n        var requestCacheKey = ['artifactHistory', reqOb.projectId, reqOb.refId, reqOb.artifactId];\n        var deferred = $q.defer();\n        if (CacheService.exists(requestCacheKey) && !update) {\n            deferred.resolve(CacheService.get(requestCacheKey));\n            return deferred.promise;\n        }\n        inProgress[key] = deferred.promise;\n        $http.get(URLService.getArtifactHistoryURL(reqOb))\n        .then(function(response) {\n            deferred.resolve(CacheService.put(requestCacheKey, response.data.commits, true));\n            delete inProgress[key];\n        }, function(response) {\n            URLService.handleHttpStatus(response.data, response.status, response.headers, response.config, deferred);\n            delete inProgress[key];\n        });\n        return deferred.promise;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ArtifactService#updateArtifact\n     * @methodOf mms.ArtifactService\n     * \n     * @description\n     * Save artifact to mms and update the cache if successful, the artifact object\n     * must have an id, and whatever property that needs to be updated.\n     * \n     * {@link mms.ArtifactService#methods_getElementForEdit see also getElementForEdit}\n     *\n     * @param {object} artifactOb An object that contains _projectId, _refId, sysmlId and any property changes to be saved.\n     * @returns {Promise} The promise will be resolved with the updated cache element reference if \n     *      update is successful. If a conflict occurs, the promise will be rejected with status of 409\n     */\n    // var updateArtifact = function(artifactOb, returnChildViews) { //artifactOb should have the keys needed to make url\n    //     var deferred = $q.defer();\n    //     return deferred.promise;\n    // };\n\n    /**\n     * @ngdoc method\n     * @name mms.ArtifactService#createArtifact\n     * @methodOf mms.ArtifactService\n     * \n     * @description\n     * Create artifact on mms.\n     * \n     * @param {object} reqOb see description of getArtifact, instead of artifactId,\n     *                       'artifact' key should be the artifact object to create\n     * @returns {Promise} The promise will be resolved with the created artifact\n     *                    references if create is successful.\n     */\n    // var createArtifact = function(reqOb) {\n    //     return deferred.promise;\n    // };\n\n    var getArtifactCacheKey = function(reqOb, id, edit) {\n        var refId = !reqOb.refId ? 'master' : reqOb.refId;\n        var commitId = !reqOb.commitId ? 'latest' : reqOb.commitId;\n        var artifactId = id ? id : reqOb.artifactId;\n        var key = ['artifact', reqOb.projectId, refId, artifactId, commitId];\n        if (edit) {\n            key.push('edit');\n        }\n        return key;\n    };\n\n    var reset = function() {\n        inProgress = {};\n    };\n\n\n    return {\n        cacheArtifact: cacheArtifact,\n        getArtifact: getArtifact,\n        getArtifacts: getArtifacts,\n        getArtifactHistory: getArtifactHistory,\n        // createArtifact: createArtifact,\n        // updateArtifact: updateArtifact,\n        reset: reset\n    };\n}","'use strict';\n\nangular.module('mms')\n.factory('AuthService', ['$q', '$http', 'CacheService', 'URLService', 'HttpService', 'ElementService', 'ViewService', 'ProjectService', '$window', '$analytics', AuthService]);\n\n/**\n * @ngdoc service\n * @name mms.ApplicationService\n * @requires $q\n * @requires $http\n * @requires URLService\n * @requires HttpService\n * @requires ElementService\n * @requires ViewService\n * @requires ProjectService\n *\n * @description\n * Provide general authorization functions. I.e. login, logout, etc...\n */\nfunction AuthService($q, $http, CacheService, URLService, HttpService, ElementService, ViewService, ProjectService, $window, $analytics) {\n    \n    var ticket = $window.localStorage.getItem('ticket');\n    var getAuthorized = function (credentials) {\n        var deferred = $q.defer();\n        var loginURL = '/alfresco/service/api/login';\n        $http.post(loginURL, credentials).then(function (success) {\n            URLService.setTicket(success.data.data.ticket);\n            ticket = success.data.data.ticket;\n            $window.localStorage.setItem('ticket', ticket);\n            deferred.resolve(ticket);\n        }, function(fail){\n            URLService.handleHttpStatus(fail.data, fail.status, fail.header, fail.config, deferred);\n            deferred.reject(fail);\n        });\n        return deferred.promise;\n    };\n    \n    var removeTicket = function(){\n        $window.localStorage.removeItem('ticket');\n        ticket = undefined;\n        URLService.setTicket(null);\n        HttpService.dropAll();\n        ElementService.reset();\n        ProjectService.reset();\n        ViewService.reset();\n        CacheService.reset();\n    };\n\n    var getTicket = function(){\n        return ticket;\n    };\n\n    var checkLogin = function(){\n        var deferred = $q.defer();\n        if (!ticket) {\n            deferred.reject(false);\n            return deferred.promise;\n        }\n\n        $http.get(URLService.getCheckTicketURL(ticket)).then(function (success) {\n            deferred.resolve(success.data.username);\n            $analytics.setUsername(success.data.username);\n        }, function(fail){\n            deferred.reject(fail);\n            removeTicket();\n        });\n        return deferred.promise;\n    };\n\n    var logout = function() {\n        var deferred = $q.defer();\n        checkLogin().then(function() {\n            removeTicket();\n            //$cookies.remove('com.tomsawyer.web.license.user');\n        }, function() {\n            removeTicket();\n            deferred.resolve(true);\n        });\n        return deferred.promise;\n    };\n\n    return {\n        getAuthorized: getAuthorized,\n        getTicket: getTicket,\n        removeTicket: removeTicket,\n        checkLogin: checkLogin,\n        logout: logout\n    };\n\n}\n","'use strict';\n\nangular.module('mms')\n.factory('CacheService', ['_', CacheService]);\n\n/**\n * @ngdoc service\n * @name mms.CacheService\n * @requires _\n * \n * @description\n * Provides cache of key value pairs. Key can be a string or an array of strings.\n */\nfunction CacheService(_) {\n    var cache = {};\n\n    /**\n     * @ngdoc method\n     * @name mms.CacheService#get\n     * @methodOf mms.CacheService\n     * \n     * @description\n     * Get value from cache\n     * \n     * @param {Array.<string>|string} key String key or Array of hierarchical keys\n     * @returns {Object} Value if found, null if not found\n     */\n    var get = function(key) {\n        var realkey = key;\n        if (angular.isArray(key)) {\n            realkey = makeKey(key);\n        }\n        if (cache.hasOwnProperty(realkey)) {\n            var realval = cache[realkey];\n            if (angular.isString(realval)) {\n                return get(realval);\n            }\n            return realval;\n        }\n        return null;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.CacheService#getElements\n     * @methodOf mms.CacheService\n     * \n     * @description\n     * Get the latest elements in the cache with the parameter workspace ID\n     * \n     * @param {string} projectId The mms project id\n     * @param {string} refId The branch/tag id\n     * @returns {Object} Value if found, null if not found\n     */\n    var getLatestElements = function(projectId, refId) {\n        var latestElements = [];\n        for (var key in cache) {\n            if (!cache.hasOwnProperty(key)) {\n                continue;\n            }\n            if (key.indexOf('|latest') >= 0 && key.indexOf('element|') >= 0 && key.indexOf('|edit') < 0 && \n                    key.indexOf('deleted') < 0 && key.indexOf(refId) >= 0 && key.indexOf(projectId) >= 0) {\n                var val = get(key);\n                if (val) {\n                    latestElements.push(val);\n                }\n            }\n        }\n        return latestElements;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.CacheService#put\n     * @methodOf mms.CacheService\n     * \n     * @description\n     * Put value into cache\n     * \n     * @param {Array.<string>|string} key String key or Array of hierarchical keys\n     * @param {Object} value The value to save\n     * @param {boolean} [merge=false] Whether to replace the value or do a merge if value already exists\n     * @returns {Object} the original value\n     */\n    var put = function(key, value, merge) {\n        var m = !merge ? false : merge;\n        var realkey = key;\n        if (angular.isArray(key)) {\n            realkey = makeKey(key);\n        }\n        var val = get(realkey);\n        if (val && m && angular.isObject(value)) {\n            _.merge(val, value, function(a,b,id) {\n                if ((id === '_contents' || id === 'specification') && b && b.type === 'Expression') {\n                    return b;\n                }\n                if (angular.isArray(a) && angular.isArray(b) && b.length < a.length) {\n                    a.length = 0;\n                    Array.prototype.push.apply(a, b);\n                    return a; \n                }\n                if (id === '_displayedElementIds' && b) {\n                    return b;\n                }\n                return undefined;\n            });\n        } else {\n            if (!angular.isString(val) || angular.isString(value)) {\n                cache[realkey] = value;\n            } else {\n                realkey = val;\n                while (angular.isString(cache[realkey])) {\n                    realkey = cache[realkey];\n                }\n                cache[realkey] = value;\n            }\n            val = value;\n        }\n        return val;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.CacheService#remove\n     * @methodOf mms.CacheService\n     * \n     * @description\n     * Remove value from cache and return it\n     * \n     * @param {Array.<string>|string} key String key or Array of hierarchical keys\n     * @returns {Object} value that was removed or undefined\n     */\n    var remove = function(key) {\n        var realkey = key;\n        if (angular.isArray(key)) {\n            realkey = makeKey(key);\n        }\n        if (!cache.hasOwnProperty(realkey)) {\n            return null;\n        }\n        var result = cache[realkey];\n        delete cache[realkey];\n        if (angular.isString(result)) {\n            return remove(result);\n        }\n        return result;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.CacheService#exists\n     * @methodOf mms.CacheService\n     * \n     * @description\n     * Check if value exists with a specific key\n     * \n     * @param {Array.<string>|string} key String key or Array of hierarchical keys\n     * @returns {boolean} whether value exists for key\n     */\n    var exists = function(key) {\n        var realkey = key;\n        if (angular.isArray(key)) {\n            realkey = makeKey(key);\n        }\n        if (!cache.hasOwnProperty(realkey)) {\n            return false;\n        }\n        var val = cache[realkey];\n        if (angular.isObject(val)) {\n            return true;\n        }\n        if (angular.isString(val)) {\n            return exists(val);\n        }\n        return false;\n    };\n\n    var makeKey = function(keys) {\n        return keys.join('|');\n    };\n\n    var getCache = function() {\n        return cache;\n    };\n\n    var reset = function() {\n        var keys = Object.keys(cache);\n        for (var i = 0; i < keys.length; i++) {\n            delete cache[keys[i]];\n        }\n    };\n\n    return {\n        get: get,\n        getLatestElements: getLatestElements,\n        put: put,\n        exists: exists,\n        remove: remove,\n        getCache: getCache,\n        reset: reset\n    };\n}","'use strict';\n\nangular.module('mms')\n.factory('ElementService', ['$q', '$http', 'URLService', 'UtilsService', 'CacheService', 'HttpService', 'ApplicationService', '_', ElementService]);\n\n/**\n * @ngdoc service\n * @name mms.ElementService\n * @requires $q\n * @requires $http\n * @requires mms.URLService\n * @requires mms.UtilsService\n * @requires mms.CacheService\n * @requires mms.HttpService\n * \n * @description\n * An element CRUD service with additional convenience methods for managing edits.\n */\nfunction ElementService($q, $http, URLService, UtilsService, CacheService, HttpService, ApplicationService, _) {\n\n    var inProgress = {};// leave for now\n    /**\n     * @ngdoc method\n     * @name mms.ElementService#getElement\n     * @methodOf mms.ElementService\n     * \n     * @description\n     * Gets an element object by projectId and elementId. If the element object is already in the cache,\n     * resolve the existing reference, if not or update is true, request it from server, \n     * add/merge into the cache. \n     * \n     * Most of these methods return promises that will reject with a reason object\n     * when a server call fails, see\n     * {@link mms.URLService#methods_handleHttpStatus the return object}\n     *\n     * ## Example Usage\n     *  <pre>\n        ElementService.getElement({projectId: 'projectId', elementId: 'element_id'}).then(\n            function(element) { //element is an element object (see json schema)\n                alert('got ' + element.name);\n            }, \n            function(reason) {\n                alert('get element failed: ' + reason.message); \n                //see mms.URLService#handleHttpStatus for the reason object\n            }\n        );\n        </pre>\n     * ## Example with commitId\n     *  <pre>\n        ElementService.getElement({\n            projectId: 'projectId', \n            elementId: 'elementId', \n            refId: 'refId',         //default 'master'\n            commitId: 'commitId',   //default 'latest'\n            extended: true          //default false (extended includes _qualifiedName, _qualifiedId, _childViews)\n        }).then(\n            function(element) { //element is an element object (see json schema)\n                alert('got ' + element.name);\n            }, \n            function(reason) {\n                alert('get element failed: ' + reason.message); \n                //see mms.URLService#handleHttpStatus for the reason object\n            }\n        );\n        </pre>\n     * \n     * @param {object} reqOb object with keys as described in function description.\n     * @param {integer} [weight=1] priority of request (2 is immediate, 1 is normal, 0 is low)\n     * @param {boolean} [update=false] (optional) whether to always get the latest \n     *      from server, even if it's already in cache (this will update the cache if exists)\n     * @returns {Promise} The promise will be resolved with the element object, \n     *      multiple calls to this method with the same parameters would give the\n     *      same object\n     */\n    var getElement = function(reqOb, weight, update) {\n        UtilsService.normalize(reqOb);\n        var requestCacheKey = getElementKey(reqOb);\n        var url = URLService.getElementURL(reqOb);\n        var key = url;\n        // if it's in the inProgress queue get it immediately\n        if (inProgress.hasOwnProperty(key)) { //change to change proirity if it's already in the queue\n            HttpService.ping(key, weight);\n            return inProgress[key];\n        }\n        var deferred = $q.defer();\n        var cached = CacheService.get(requestCacheKey);\n        if (cached && !update && (!reqOb.extended || (reqOb.extended && cached._qualifiedId))) {\n            deferred.resolve(cached);\n            return deferred.promise;\n        }\n        var deletedRequestCacheKey = getElementKey(reqOb);\n        deletedRequestCacheKey.push('deleted');\n        var deleted = CacheService.get(deletedRequestCacheKey);\n        if (deleted) {\n            deferred.reject({status: 410, data: {recentVersionOfElement: deleted}, message: 'Deleted'});\n            return deferred.promise;\n        }\n        inProgress[key] = deferred.promise;\n\n        HttpService.get(url,\n            function(data, status, headers, config) {\n                if (angular.isArray(data.elements) && data.elements.length > 0) {\n                    deferred.resolve(cacheElement(reqOb, data.elements[0]));\n                } else {\n                    deferred.reject({status: 500, data: '', message: \"Server Error: empty response\"}); //TODO \n                }\n                delete inProgress[key];\n            },\n            function(data, status, headers, config) {\n                if (data.deleted && data.deleted.length > 0 && data.deleted[0].id === reqOb.elementId) {\n                    data.recentVersionOfElement = data.deleted[0];\n                    cacheDeletedElement(reqOb, data.deleted[0]);\n                }\n                URLService.handleHttpStatus(data, status, headers, config, deferred);\n                delete inProgress[key];\n            },\n            weight\n        );\n        return deferred.promise;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ElementService#getElements\n     * @methodOf mms.ElementService\n     * \n     * @description\n     * Same as getElement, but for multiple ids.\n     * \n     * @param {object} reqOb keys - {projectId, refId, elementIds (array of ids), commitId, extended}\n     * @param {integer} [weight=1] priority of request (2 is immediate, 1 is normal, 0 is low)\n     * @param {boolean} [update=false] (optional) whether to always get the latest \n     *      from server, even if it's already in cache (this will update the cache if exists)\n     * @returns {Promise} The promise will be resolved with an array of element objects, \n     *      multiple calls to this method with the same parameters would give the\n     *      same objects\n     */\n    var getElements = function(reqOb, weight, update) {\n        var deferred = $q.defer();\n        var request = {elements: []};\n        var existing = [];\n        UtilsService.normalize(reqOb);\n        for (var i = 0; i < reqOb.elementIds.length; i++) {\n            var id = reqOb.elementIds[i];\n            var requestCacheKey = getElementKey(reqOb, id);\n            var exist = CacheService.get(requestCacheKey);\n            if (exist && !update && (!reqOb.extended || (reqOb.extended && exist._qualifiedId))) {\n                existing.push(exist);\n                continue;\n            }\n            request.elements.push({id: id});\n        }\n        if (request.elements.length === 0) {\n            deferred.resolve(existing);\n            return deferred.promise;\n        }\n        $http.put(URLService.getPutElementsURL(reqOb), request)\n        .then(function(response) {\n            var data = response.data.elements;\n            var i;\n            if (data && data.length > 0) {\n                for (i = 0; i < data.length; i++) {\n                    existing.push(cacheElement(reqOb, data[i]));\n                }\n            }\n            var deleted = response.data.deleted;\n            if (deleted && deleted.length > 0) {\n                for (i = 0; i < deleted.length; i++) {\n                    cacheDeletedElement(reqOb, deleted[i]);\n                }\n            }\n            deferred.resolve(existing);\n        }, function(response) {\n            URLService.handleHttpStatus(response.data, response.status, response.headers, response.config, deferred);\n        });\n        return deferred.promise;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ElementService#cacheElement\n     * @methodOf mms.ElementService\n     * \n     * @description\n     * handles caching of element objects - in case the metadata of reqOb is different\n     * from the element's canonical projectId/refId/commitId (due to being requested \n     * from a different project context), it'll become an alias\n     * \n     * @param {object} reqOb request keys - {projectId, refId, elementId, commitId, extended}\n     * @param {object} elementOb object to cache\n     * @param {boolean} [edit=false] whether object to cache is for editing\n     * @returns {object} cached object\n     */\n    var cacheElement = function(reqOb, elementOb, edit) {\n        var result = UtilsService.cleanElement(elementOb, edit);\n        var requestCacheKey = getElementKey(reqOb, result.id, edit);\n        var origResultCommit = result._commitId;\n        if (reqOb.commitId === 'latest') {\n            var resultCommitCopy = JSON.parse(JSON.stringify(result));\n            result._commitId = 'latest'; //so realCacheKey is right later\n            var commitCacheKey = UtilsService.makeElementKey(resultCommitCopy); //save historic element\n            if (!edit) {\n                CacheService.put(commitCacheKey, resultCommitCopy, true);\n            }\n        }\n        var realCacheKey = UtilsService.makeElementKey(result, edit);\n        result._commitId = origResultCommit; //restore actual commitId\n        if (angular.equals(realCacheKey, requestCacheKey)) {\n            result = CacheService.put(requestCacheKey, result, true);\n        } else {\n            CacheService.put(requestCacheKey, realCacheKey.join('|'));\n            result = CacheService.put(realCacheKey, result, true);\n        }\n        return result;\n    };\n\n    var cacheDeletedElement = function(reqOb, deletedOb) {\n        var requestCacheKey = getElementKey(reqOb, deletedOb.id);\n        requestCacheKey.push('deleted');\n        var commitCacheKey = UtilsService.makeElementKey(deletedOb);\n        CacheService.put(requestCacheKey, commitCacheKey.join('|'));\n        CacheService.put(commitCacheKey, deletedOb, true);\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ElementService#getElementForEdit\n     * @methodOf mms.ElementService\n     * \n     * @description\n     * Gets an element object to edit by id. (this is different from getElement in \n     * that the element is a clone and not the same reference. The rationale is to\n     * consider angular data bindings so editing an element does not cause unintentional\n     * updates to other parts of the view, separating reads and edits)\n     * \n     * ## Example\n     *  <pre>\n        ElementService.getElementForEdit(reqOb).then(\n            function(editableElement) {\n                editableElement.name = 'changed name'; //immediately change a name and save\n                ElementService.updateElement(editableElement).then(\n                    function(updatedElement) { //at this point the regular getElement would show the update\n                        alert('updated');\n                    },\n                    function(reason) {\n                        alert('update failed');\n                    }\n                );\n            },\n            function(reason) {\n                alert('get element failed: ' + reason.message);\n            }\n        );\n        </pre>\n     * \n     * @param {object} reqOb see description of getElement.\n     * @param {integer} [weight=1] priority\n     * @param {boolean} [update=false] update from server\n     * @returns {Promise} The promise will be resolved with the element object, \n     *      multiple calls to this method with the same id would result in \n     *      references to the same object. This object can be edited without\n     *      affecting the same element object that's used for displays\n     */\n    var getElementForEdit = function(reqOb, weight, update) {\n        UtilsService.normalize(reqOb);\n        var requestCacheKey = getElementKey(reqOb, reqOb.elementId, true);\n        var key = URLService.getElementURL(reqOb) + 'edit';\n        if (inProgress.hasOwnProperty(key)) {\n            return inProgress[key];\n        }\n        var deferred = $q.defer();\n        var cached = CacheService.get(requestCacheKey);\n        if (cached && !update) {\n            deferred.resolve(cached);\n            return deferred.promise;\n        }\n        inProgress[key] = deferred.promise;\n        getElement(reqOb, weight, update)\n        .then(function(result) {\n            var copy = JSON.parse(JSON.stringify(result));\n            deferred.resolve(cacheElement(reqOb, copy, true));\n        }, function(reason) {\n            deferred.reject(reason);\n        }).finally(function() {\n            delete inProgress[key];\n        });\n        return deferred.promise;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ElementService#getOwnedElements\n     * @methodOf mms.ElementService\n     * \n     * @description\n     * Gets element's owned element objects. TBD (stub)\n     * \n     * @param {object} reqOb see description of getElement, add 'depth' key.\n     * @param {integer} [weight=1] priority\n     * @param {boolean} [update=false] update from server\n     * @returns {Promise} The promise will be resolved with an array of \n     * element objects \n     */\n    var getOwnedElements = function(reqOb, weight, update) {\n        UtilsService.normalize(reqOb);\n        if (!reqOb.depth) {\n            reqOb.depth = -1;\n        }\n        return getGenericElements(URLService.getOwnedElementURL(reqOb), reqOb, 'elements', weight, update);\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ElementService#getGenericElements\n     * @methodOf mms.ElementService\n     *\n     * @description\n     * This is a method to call a predefined url that returns elements json.\n     * A key provides the key of the json that has the elements array. \n     *\n     * @param {string} url the url to get\n     * @param {object} reqOb see description of getElement.\n     * @param {string} jsonKey json key that has the element array value\n     * @param {integer} [weight=1] priority\n     * @param {boolean} [update=false] update from server\n     */\n    var getGenericElements = function(url, reqOb, jsonKey, weight, update) {\n        UtilsService.normalize(reqOb);\n        if (inProgress.hasOwnProperty(url)) {\n            HttpService.ping(url, weight);\n            return inProgress[url];\n        }\n        var deferred = $q.defer();\n        inProgress[url] = deferred.promise;\n        \n        HttpService.get(url,\n            function(data, status, headers, config) {\n                var results = [];\n                var elements = data[jsonKey];\n                for (var i = 0; i < elements.length; i++) {\n                    var element = elements[i];\n                    if (!element) {//check for possible null\n                        continue;\n                    }\n                    results.push(cacheElement(reqOb, element));\n                }\n                delete inProgress[url];\n                deferred.resolve(results);\n            },\n            function(data, status, headers, config) {\n                URLService.handleHttpStatus(data, status, headers, config, deferred);\n                delete inProgress[url];\n            },\n            weight\n        );\n        return deferred.promise;\n    };\n\n    //called by updateElement, fills in all keys for element to be updated\n    //will also send any cached edited field for the element to be updated\n    var fillInElement = function(elementOb) {\n        /*\n        var deferred = $q.defer();\n        getElement({\n            projectId: elementOb._projectId,\n            elementId: elementOb.id,\n            commitId: 'latest',\n            refId: elementOb._refId\n        }, 2)\n        .then(function(data) {\n        */\n            var ob = JSON.parse(JSON.stringify(elementOb)); //make a copy\n            ob._commitId = 'latest';\n            var editOb = CacheService.get(UtilsService.makeElementKey(ob, true));\n            //for (var key in elementOb) {\n            //    ob[key] = elementOb[key];\n            //}\n            if (editOb) {\n                for (var key in editOb) {\n                    if (!elementOb.hasOwnProperty(key)) {\n                        ob[key] = editOb[key];\n                    }\n                }\n            }\n            if (ob._displayedElementIds) {\n                delete ob._displayedElementIds;\n            }\n            if (ob._allowedElementIds) {\n                delete ob._allowedElementIds;\n            }\n            if (ob._childViews && !elementOb._childViews) {\n                delete ob._childViews;\n            }\n            delete ob._commitId;\n            return ob;\n        /*\n            deferred.resolve(ob);\n        }, function() {\n            deferred.resolve(elementOb);\n        });\n        return deferred.promise;\n        */\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ElementService#updateElement\n     * @methodOf mms.ElementService\n     * \n     * @description\n     * Save element to mms and update the cache if successful, the element object\n     * must have an id, and whatever property that needs to be updated.\n     * \n     * {@link mms.ElementService#methods_getElementForEdit see also getElementForEdit}\n     *\n     * @param {object} elementOb An object that contains _projectId, _refId, sysmlId and any property changes to be saved.\n     * @returns {Promise} The promise will be resolved with the updated cache element reference if \n     *      update is successful. If a conflict occurs, the promise will be rejected with status of 409\n     */\n    var updateElement = function(elementOb, returnChildViews) { //elementOb should have the keys needed to make url\n\n        var deferred = $q.defer();\n        var handleSuccess = function(data) {\n            var e = null;\n            if (data.elements.length > 1 && elementOb.id) {\n                for (var i = 0; i < data.elements.length; i++) {\n                    if (data.elements[i].id === elementOb.id) {\n                        e = data.elements[i];\n                    }\n                }\n                if (!e) {//TODO shouldn't happen\n                    e = data.elements[0];\n                }\n            } else {\n                e = data.elements[0];\n            }\n            var metaOb = {\n                projectId: e._projectId,\n                refId: e._refId,\n                commitId: 'latest',\n                elementId: e.id\n            };\n            var resp = cacheElement(metaOb, e);\n            var editCopy = JSON.parse(JSON.stringify(e));\n            cacheElement(metaOb, editCopy, true);\n            var history = CacheService.get(['history', metaOb.projectId, metaOb.refId, metaOb.elementId]);\n            if (history) {\n                history.unshift({_creator: e._modifier, _created: e._modified, id: e._commitId});\n            }\n            deferred.resolve(resp);\n        };\n\n        if (!elementOb.hasOwnProperty('id')) {\n            deferred.reject({status: 400, data: '', message: 'Element id not found, create element first!'});\n            return deferred.promise;\n        }\n        var postElem = fillInElement(elementOb);\n        //.then(function(postElem) {\n            $http.post(URLService.getPostElementsURL({\n                    projectId: postElem._projectId,\n                    refId: postElem._refId,\n                    returnChildViews: returnChildViews\n                }), {\n                    elements: [postElem],\n                    source: ApplicationService.getSource()\n                }, {timeout: 60000})\n            .then(function(response) {\n                var rejected = response.data.rejected;\n                if (rejected && rejected.length > 0 && rejected[0].code === 304 && rejected[0].element) { //elem will be rejected if server detects no changes\n                    deferred.resolve(rejected[0].element);\n                    return;\n                }\n                if (!angular.isArray(response.data.elements) || response.data.elements.length === 0) {\n                    deferred.reject({status: 500, data: '', message: \"Server Error: empty response\"});\n                    return;\n                }\n                handleSuccess(response.data);\n            }, function(response) {\n                if (response.status === 409) {\n                    var serverOb = response.data.elements[0];\n                    UtilsService.cleanElement(serverOb);\n                    var origCommit = elementOb._commitId;\n                    elementOb._commitId = 'latest';\n                    var origOb = CacheService.get(UtilsService.makeElementKey(elementOb));\n                    elementOb._commitId = origCommit;\n                    if (!origOb) {\n                        URLService.handleHttpStatus(response.data, response.status, response.headers, response.config, deferred);\n                        return;\n                    } \n                    if (!UtilsService.hasConflict(postElem, origOb, serverOb)) {\n                        elementOb._read = serverOb._read;\n                        elementOb._modified = serverOb._modified;\n                        updateElement(elementOb, returnChildViews)\n                        .then(function(good){\n                            deferred.resolve(good);\n                        }, function(reason) {\n                            deferred.reject(reason);\n                        });\n                    } else {\n                        URLService.handleHttpStatus(response.data, response.status, response.headers, response.config, deferred);\n                    }\n                } else\n                    URLService.handleHttpStatus(response.data, response.status, response.headers, response.config, deferred);\n            });\n        //}); \n        return deferred.promise;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ElementService#updateElements\n     * @methodOf mms.ElementService\n     *\n     * @description\n     * Save elements to alfresco and update the cache if successful.\n     *\n     * @param {Array.<Object>} elementObs, array of element objects that contains element id and any property changes to be saved.\n     * @param {boolean} returnChildViews, whether to include childViews\n     * @returns {Promise} The promise will be resolved with an array of updated element references if\n     *      update is successful and will be rejected with an object with the following format:\n     *      {failedRequests: list of rejection reasons, successfulRequests: array of updated elements }\n     */\n    var updateElements = function(elementObs, returnChildViews) {\n        var deferred = $q.defer();\n        if ( _validate(elementObs) ) {\n            var postElements = elementObs.map(function(elementOb) {\n                return fillInElement(elementOb);\n            });\n\n            var groupOfElements = _groupElementsByProjectIdAndRefId(postElements);\n            var promises = [];\n\n            Object.keys(groupOfElements).forEach(function (key) {\n                promises.push(_bulkUpdate(groupOfElements[key], returnChildViews));\n            });\n\n             // responses is an array of response corresponding to both successful and failed requests with the following format\n             // [ { state: 'fulfilled', value: the value returned by the server },\n             //   { state: 'rejected', reason: {status, data, message} -- Specified by handleHttpStatus method }\n             // ]\n            $q.allSettled(promises).then(function(responses) {\n                // get all the successful requests\n                var successfulRequests = responses.filter(function(response) {\n                    return response.state === 'fulfilled';\n                });\n\n                var successValues = _.flatten( successfulRequests.map(function(response){\n                    return response.value;\n                }));\n\n                if ( successfulRequests.length === promises.length ) {\n                    // All requests succeeded\n                    deferred.resolve(successValues);\n                } else {\n                    // some requests failed\n                    var rejectionReasons = responses.filter(function(response) {\n                        return response.state === 'rejected';\n                    }).map(function(response) {\n                        return response.reason;\n                    });\n\n                    // since we could have multiple failed requests when having some successful requests,\n                    // reject with the following format so that the client can deal with them at a granular level if\n                    // desired\n                    deferred.reject({\n                        failedRequests: rejectionReasons,\n                        successfulRequests: successValues\n                    });\n                }\n            });\n        } else {\n            deferred.reject( {\n                failedRequests: [ { status: 400, data: elementObs, message: 'Some of the elements do not have id, _projectId, _refId' } ],\n                successfulRequests: []\n            });\n        }\n        return deferred.promise;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ElementService#createElement\n     * @methodOf mms.ElementService\n     * \n     * @description\n     * Create element on mms.\n     * \n     * @param {object} reqOb see description of getElement, instead of elementId, 'element' key should be \n     *                  the element object to create\n     * @returns {Promise} The promise will be resolved with the created element references if \n     *      create is successful.\n     */\n    var createElement = function(reqOb) {\n        UtilsService.normalize(reqOb);\n        var deferred = $q.defer();\n\n        var url = URLService.getPostElementsURL(reqOb);\n        $http.post(url, {'elements': [reqOb.element], 'source': ApplicationService.getSource()})\n        .then(function(response) {\n            if (!angular.isArray(response.data.elements) || response.data.elements.length === 0) {\n                deferred.reject({status: 500, data: '', message: \"Server Error: empty response\"});\n                return;\n            }\n            var resp = null;\n            if (response.data.elements.length > 1 && reqOb.element.id) {\n                for (var i = 0; i < response.data.elements.length; i++) {\n                    if (response.data.elements[i].id === reqOb.element.id) {\n                        resp = response.data.elements[i];\n                    }\n                }\n                if (!resp) {//shouldn't happen!\n                    resp = response.data.elements[0];\n                }\n            } else {\n                resp = response.data.elements[0];\n            }\n            deferred.resolve(cacheElement(reqOb, resp));\n        }, function(response) {\n            URLService.handleHttpStatus(response.data, response.status, response.headers, response.config, deferred);\n        });\n        return deferred.promise;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ElementService#createElements\n     * @methodOf mms.ElementService\n     * \n     * @description\n     * Create elements to alfresco and update the cache if successful.\n     * \n     * @param {object} reqOb see description of getElement, instead of elementId, 'elements' key should be \n     *                  the array of element object to create\n     * @returns {Promise} The promise will be resolved with an array of created element references if \n     *      create is successful.\n     */\n    var createElements = function(reqOb) {\n        UtilsService.normalize(reqOb);\n        var deferred = $q.defer();\n        var url = URLService.getPostElementsURL(reqOb);\n        $http.post(url, {'elements': reqOb.elements, 'source': ApplicationService.getSource()})\n        .then(function(response) {\n            if (!angular.isArray(response.data.elements) || response.data.elements.length === 0) {\n                deferred.reject({status: 500, data: '', message: \"Server Error: empty response\"});\n                return;\n            }\n            var results = [];\n            for (var i = 0; i < response.data.elements.length; i++) {\n                results.push(cacheElement(reqOb, response.data.elements[i]));\n                var editCopy = JSON.parse(JSON.stringify(response.data.elements[i]));\n                cacheElement(reqOb, editCopy, true);\n            }\n            deferred.resolve(results);\n        }, function(response) {\n            URLService.handleHttpStatus(response.data, response.status, response.headers, response.config, deferred);\n        });\n        return deferred.promise;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ElementService#isCacheOutdated\n     * @methodOf mms.ElementService\n     *\n     * @description\n     * Checks if the current cached element has been updated on the server, does not update the cache. \n     * If the element doesn't exist in the cache, it's considered not outdated\n     *\n     * @param {object} reqOb see description of getElement\n     * @returns {Promise} Resolved with {status: false} if cache is up to date, \n     *      Resolved with {status: true, server: server element, cache: cache element} if cache is outdated\n     */\n    var isCacheOutdated = function(reqOb) {//TODO\n        var deferred = $q.defer();\n        deferred.resolve({status: false});\n        /*var ws = !workspace ? 'master' : workspace;\n        var orig = CacheService.get(UtilsService.makeElementKey(id, ws, null, false));\n        if (!orig) {\n            deferred.resolve({status: false});\n            return deferred.promise;\n        }\n        $http.get(URLService.getElementURL(id, ws, 'latest'))\n        .success(function(data, status, headers, config) {\n            var server = _.cloneDeep(data.elements[0]);\n            delete server._modified;\n            delete server._read;\n            delete server._creator;\n            UtilsService.cleanElement(server);\n            var current = _.cloneDeep(orig);\n            delete current._modified;\n            delete current._read;\n            delete current._creator;\n            UtilsService.cleanElement(current);\n            if (angular.equals(server, current)) {\n                deferred.resolve({status: false});\n            } else {\n                deferred.resolve({status: true, server: data.elements[0], cache: orig});\n            }\n        }).error(function(data, status, headers, config) {\n            URLService.handleHttpStatus(data, status, headers, config, deferred);\n        });*/\n        return deferred.promise;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ElementService#search\n     * @methodOf mms.ElementService\n     * \n     * @description\n     * Search for elements based on some query\n     * \n     * @param {object} reqOb see description of getElement\n     * @param {object} query JSON object with Elastic query format\n     * @param {integer} [weight=1] priority\n     * @returns {Promise} The promise will be resolved with an array of element objects.\n     *                  The element results returned will be a clone of the original server response and not cache references\n     */\n    var search = function(reqOb, query, weight) {\n        UtilsService.normalize(reqOb);\n        var url = URLService.getElementSearchURL(reqOb);\n        var deferred = $q.defer();\n        $http.put(url, query)\n            .then(function(data) {\n                //var result = [];\n                //for (var i = 0; i < data.data.elements.length; i++) {\n                //    var element = data.data.elements[i];\n                //    var cacheE = cacheElement(reqOb, element);\n                //    var toAdd = JSON.parse(JSON.stringify(element)); //make clone\n                //    toAdd._relatedDocuments = cacheE._relatedDocuments;\n                //    result.push(toAdd);\n                //}\n                //deferred.resolve(result);\n                deferred.resolve(data.data);\n            }, function(data) {\n                URLService.handleHttpStatus(data.data, data.status, data.headers, data.config, deferred);\n            });\n        return deferred.promise;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ElementService#getElementVersions\n     * @methodOf mms.ElementService\n     * \n     * @description\n     * Queries for an element's entire version history\n     *\n     * @param {object} reqOb see getElement\n     * @param {integer} [weight=1] priority\n     * @param {boolean} [update=false] update from server\n     * @returns {Promise} The promise will be resolved with an array of commit objects.\n     */\n    var getElementHistory = function(reqOb, weight, update) {\n        UtilsService.normalize(reqOb);\n\n        var key = URLService.getElementHistoryURL(reqOb);\n        if (inProgress.hasOwnProperty(key)) {\n            return inProgress[key];\n        }\n        var requestCacheKey = ['history', reqOb.projectId, reqOb.refId, reqOb.elementId];\n        var deferred = $q.defer();\n        if (CacheService.exists(requestCacheKey) && !update) {\n            deferred.resolve(CacheService.get(requestCacheKey));\n            return deferred.promise;\n        }\n        inProgress[key] = deferred.promise;\n        $http.get(URLService.getElementHistoryURL(reqOb))\n        .then(function(response){\n            deferred.resolve(CacheService.put(requestCacheKey, response.data.commits, true));\n            delete inProgress[key];\n        }, function(response) {\n            URLService.handleHttpStatus(response.data, response.status, response.headers, response.config, deferred);\n            delete inProgress[key];\n        });\n        return deferred.promise;\n    };\n\n    var getElementKey = function(reqOb, id, edit) {\n        var cacheKey = UtilsService.makeElementKey({\n            _projectId: reqOb.projectId,\n            id: id ? id : reqOb.elementId,\n            _commitId: reqOb.commitId,\n            _refId: reqOb.refId\n        }, edit);\n        return cacheKey;\n    };\n\n    var reset = function() {\n        inProgress = {};\n    };\n\n    function _groupElementsByProjectIdAndRefId(elementObs) {\n        return _.groupBy(elementObs, function(element) {\n            return element._projectId + '|' + element._refId;\n        });\n    }\n\n    function _createMetaOb(element) {\n        return {\n            projectId: element._projectId,\n            refId: element._refId,\n            commitId: 'latest',\n            elementId: element.id\n        };\n    }\n\n    function _validate(elementObs) {\n        return _.every( elementObs, function( elementOb ) {\n            return elementOb.hasOwnProperty('id') && elementOb.hasOwnProperty('_projectId') && elementOb.hasOwnProperty('_refId');\n        });\n    }\n\n    function _bulkUpdate(elements, returnChildViews) {\n        var deferred = $q.defer();\n        $http.post(URLService.getPostElementsURL({\n            projectId: elements[0]._projectId,\n            refId: elements[0]._refId,\n            returnChildViews: returnChildViews\n        }), {\n            elements: elements,\n            source: ApplicationService.getSource()\n        }, {timeout: 60000})\n            .then(function (response) {\n                _bulkUpdateSuccessHandler(response, deferred);\n            }, function (response) {\n                _bulkUpdateFailHandler(response, deferred, elements);\n            });\n        return deferred.promise;\n    }\n\n    function _bulkUpdateSuccessHandler(serverResponse, deferred) {\n        var results = [];\n        var elements = serverResponse.data.elements;\n        elements.forEach(function (e) {\n            var metaOb = _createMetaOb(e);\n            var editCopy = JSON.parse(JSON.stringify(e));\n            results.push(cacheElement(metaOb, e));\n\n            cacheElement(metaOb, editCopy, true);\n\n            var history = CacheService.get(['history', metaOb.projectId, metaOb.refId, metaOb.elementId]);\n            if (history) {\n                history.unshift({_creator: e._modifier, _created: e._modified, id: e._commitId});\n            }\n        });\n        var rejected = serverResponse.data.rejected;\n        if (rejected && rejected.length > 0) {\n            rejected.forEach(function(e) {\n                if (e.code === 304 && e.element) {\n                    results.push(e.element); //add any server rejected elements because they haven't changed\n                }\n            });\n        }\n        deferred.resolve(results);\n    }\n\n    /** For now, not doing anything special when there is a \"conflict\" error **/\n    function _bulkUpdateFailHandler(response, deferred, elementObs) {\n        // for now the server doesn't return anything for the data properties, so override with the input\n        response.data = elementObs;\n        URLService.handleHttpStatus(response.data, response.status, response.headers, response.config, deferred);\n    }\n/*\n    function _getLatestVersionOfElement(reqOb) {\n        var deferred = $q.defer();\n        getElementHistory(reqOb).then(function(elementHistory) {\n            if (elementHistory.length > 1) {\n                // Index 0 is the deletion commit, 0 index is the the commit before deletion\n                var commitBeforeDelete = elementHistory[1];\n                reqOb.commitId = commitBeforeDelete.id;\n                reqOb.includeRecentVersionElement = false;\n                getElement(reqOb).then(function(element) {\n                    deferred.resolve(element);\n                }, deferred.reject);\n            } else {\n                // this case is not possible coz this method should only be called if the element is already deleted\n                // ( and with that there will be at least two commits, one for the add at the very beginning and one for the deletion )\n                deferred.reject();\n            }\n        }, deferred.reject);\n        return deferred.promise;\n    }\n*/\n    return {\n        getElement: getElement,\n        getElements: getElements,\n        getElementForEdit: getElementForEdit,\n        getOwnedElements: getOwnedElements,\n        updateElement: updateElement,\n        updateElements: updateElements,\n        createElement: createElement,\n        createElements: createElements,\n        fillInElement: fillInElement,\n        getGenericElements: getGenericElements,\n        getElementHistory: getElementHistory,\n        isCacheOutdated: isCacheOutdated,\n        cacheElement: cacheElement,\n        search: search,\n        reset: reset\n    };\n}","'use strict';\n\nangular.module('mms')\n    .factory('FullDocumentService', ['$timeout', \"$interval\", '$http', '_', 'growl', FullDocumentService]);\n\nfunction FullDocumentService($timeout, $interval, $http, _, growl) {\n    return function (views) {\n        var self = this;\n        // public api\n        this.viewsBuffer = [];\n        this.handleClickOnBranch = handleClickOnBranch;\n        this.loadRemainingViews = loadRemainingViews;\n        this.handleDocumentScrolling = handleDocumentScrolling;\n        this.addInitialViews = addInitialViews;\n        this.handleViewAdd = handleViewAdd;\n        this.handleViewDelete = handleViewDelete;\n\n        // internal states\n        this._views = views;\n        this._isLoadingRemaingViews = false;\n        this._isFullDocFullyLoaded = false;\n\n        function handleClickOnBranch(branch, callback) {\n            var viewId = branch.type === 'view' ? branch.data.id : branch.viewId;\n            var isViewLoadedBefore =_loadViewsUntilViewWith(viewId); // load some views if necessary\n            if (isViewLoadedBefore) {\n                callback();\n            } else {\n                var message = growl.info('Loading more views!', {ttl: -1});\n                _waitTillAfterDigestCycle(function() { // wait for digest to finish and for content to finish rendering\n                    message.destroy();\n                    callback();\n                });\n            }\n            return isViewLoadedBefore;\n        }\n\n        function loadRemainingViews(callback) {\n            if (self._isFullDocFullyLoaded) {\n                callback();\n            } else {\n                var handler;\n                if (!self._loadingRemainingViewsMessage) {\n                    self._loadingRemainingViewsMessage = growl.info('Loading more views!', { ttl: -1, onclose: function() { delete self._loadingRemainingViewsMessage; } } );\n                }\n                if (!self._isLoadingRemaingViews) {\n                    self._isLoadingRemaingViews = true;\n                    handler = $interval(function() {\n                        var nextIndex = self.viewsBuffer.length + 9;\n                        if (nextIndex >= self._views.length) {\n                            nextIndex = self._views.length - 1;\n                        }\n                        _pushNewViewsToBuffer(self.viewsBuffer.length, nextIndex);\n                        if (nextIndex === self._views.length - 1) {\n                            $interval.cancel(handler);\n                            _waitTillAfterDigestCycle(function() {\n                                callback();\n                                self._isLoadingRemaingViews = false;\n                                if (self._loadingRemainingViewsMessage) {\n                                    self._loadingRemainingViewsMessage.destroy();\n                                    delete self._loadingRemainingViewsMessage;\n                                }\n                            });\n                        }\n                    }, 1000);\n                }\n            }\n        }\n\n        function handleDocumentScrolling() {\n            return _pushNewViewsToBuffer(self.viewsBuffer.length, self.viewsBuffer.length);\n        }\n\n        function addInitialViews(isScrollbarVisible) {\n            var message = growl.info('Loading initial view!', {ttl: -1});\n            _incrementallyAddViewTillScroll(message.destroy, isScrollbarVisible);\n        }\n\n        function handleViewAdd(view, prevSiblingViewId) {\n            // load the new view into the original views right after its sibling\n            var siblingIndex = _findViewFromOriginalViews(prevSiblingViewId);\n            self._views.splice(siblingIndex + 1, 0, view);\n\n            // load the new view into the viewsBuffer\n            var siblingIndexFromLoadedViews = _findViewFromLoadedViews(prevSiblingViewId);\n            if (siblingIndexFromLoadedViews === -1) {\n                // load all views up until the sibling view plus the new view\n                _pushNewViewsToBuffer(self.viewsBuffer.length, siblingIndex + 1);\n            } else {\n                // load the new view right after its sibling\n                _addNewViewToBufferAt(siblingIndexFromLoadedViews + 1);\n            }\n        }\n\n        function handleViewDelete(deletedBranch) {\n            var viewIdsToDelete = [];\n            _getAllViewsStartingAt(deletedBranch, viewIdsToDelete);\n            _deleteViewsFrom(self._views, viewIdsToDelete);\n            _deleteViewsFrom(self.viewsBuffer, viewIdsToDelete);\n        }\n\n        function _addNewViewToBufferAt(index) {\n            self.viewsBuffer.splice(index, 0, self._views[index]);\n        }\n\n        function _pushNewViewsToBuffer(startIndex, endIndex) {\n            var isLoadedBefore = true;\n            if (startIndex < self._views.length && endIndex < self._views.length) {\n                Array.prototype.push.apply(self.viewsBuffer, self._views.slice(startIndex, endIndex + 1));\n                isLoadedBefore = false;\n                if (endIndex === self._views.length - 1) {\n                    _waitTillAfterDigestCycle(function() {\n                        self._isFullDocFullyLoaded = true;\n                    });\n                }\n            }\n            return isLoadedBefore;\n        }\n\n        function _loadViewsUntilViewWith(viewId) {\n            var isViewLoadedBefore = true;\n            // if not, find the index of that view and load starting from lastLoadedViewIndex till that view + 1\n            if (_findViewFromLoadedViews(viewId) === -1) {\n                var index = _findViewFromOriginalViews(viewId);\n                if (index !== -1) {\n                    _pushNewViewsToBuffer(self.viewsBuffer.length, index);\n                }\n                isViewLoadedBefore = false;\n            }\n            return isViewLoadedBefore;\n        }\n\n        function _incrementallyAddViewTillScroll(callback, isScrollbarVisible) {\n            var isNoMoreToLoad = _pushNewViewsToBuffer(self.viewsBuffer.length, self.viewsBuffer.length);\n            _waitTillAfterDigestCycle(function() {\n                var isScrollBarVisible = isScrollbarVisible();\n                if (isScrollBarVisible || isNoMoreToLoad) {\n                    callback();\n                } else {\n                    _incrementallyAddViewTillScroll(callback, isScrollbarVisible);\n                }\n            });\n        }\n\n        function _getAllViewsStartingAt(branch, results) {\n            if (branch.type === 'view') {\n                results.push(branch.data.id);\n                branch.children.forEach(function(childBranch) {\n                    _getAllViewsStartingAt(childBranch, results);\n                });\n            }\n        }\n\n        function _deleteViewsFrom(viewListToDeleteFrom, viewIdsToDelete) {\n            _.remove(viewListToDeleteFrom, function(view) {\n                return viewIdsToDelete.indexOf(view.id) !== -1;\n            });\n        }\n\n        function _findViewFromLoadedViews(viewId) {\n            return _.findIndex(self.viewsBuffer, {id: viewId});\n        }\n\n        function _findViewFromOriginalViews(viewId) {\n            return _.findIndex(self._views, {id: viewId});\n        }\n\n        function _waitTillAfterDigestCycle(callback) {\n            $timeout(function() {\n                if (_isViewsFullyLoaded()) {\n                    callback();\n                } else {\n                    _waitTillAfterDigestCycle(callback);\n                }\n            }, 500);\n        }\n\n        function _isViewsFullyLoaded() {\n            return $http.pendingRequests.length === 0;\n        }\n    };\n}","'use strict';\n\nangular.module('mms')\n.factory('HttpService', ['$http', HttpService]);\n\n/**\n * @ngdoc service\n * @name mms.HttpService\n * \n * @description\n * Provides prioritization and caching for $http service calls\n */\nfunction HttpService($http) {\n    \n    var queue = {};\n    queue[0]= [];//high proirity\n    queue[1]=[];//low prority\n    var cache = {}; // cache url -> this is a easy key look up\n    var inProgress = 0;\n    var GET_OUTBOUND_LIMIT = 20; //max number of get requests active\n    \n    var setOutboundLimit = function(limit){\n        GET_OUTBOUND_LIMIT = limit;\n    };\n    var getOutboundLimit = function() {\n        return GET_OUTBOUND_LIMIT;\n    };\n    var getQueue = function(){\n        return queue;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.HttpService#get\n     * @methodOf mms.HttpService\n     * \n     * @description\n     * Put a new get request in the queue, the queue is FIFO\n     *\n     * @param {string} url url to get\n     * @param {function} success success function\n     * @param {function} error function\n     * @param {string} proirity by weight\n     */\n    var get = function(url, successCallback, errorCallback, weight) {\n        if(weight === undefined){\n            weight = 1;\n        }\n        var request = { url : url, successCallback: successCallback, errorCallback: errorCallback , weight: weight };\n        if (inProgress >= GET_OUTBOUND_LIMIT) {\n            if(request.weight === 2){\n                $http.get(url).then(\n                    function(response){successCallback(response.data, response.status, response.headers, response.config);},\n                    function(response){errorCallback(response.data, response.status, response.headers, response.config);})\n                    .finally(function(){\n                        if (cache.hasOwnProperty(url)) {\n                            delete cache[url];\n                        }\n                    });\n            }    \n            else if(request.weight === 0){\n                queue[0].push(request);\n            }    \n            else{\n                queue[1].push(request);\n            } \n            if(cache.hasOwnProperty(url)){\n                 if(cache[url].weight < request.weight)\n                    cache[url].weight = request.weight;\n            }\n            else {\n                cache[url] = request;\n            } \n        } \n        else {\n            inProgress++;\n            cache[url] = request;\n            $http.get(url).then(\n                function(response){successCallback(response.data, response.status, response.headers, response.config);},\n                function(response){errorCallback(response.data, response.status, response.headers, response.config);})\n                .finally( function() {\n                    inProgress--;\n                    var next; \n                    if (cache.hasOwnProperty(url)) {\n                        delete cache[url];\n                    }\n                    if (queue[1].length > 0) {\n                        next = queue[1].shift();\n                        get(next.url, next.successCallback, next.errorCallback, next.weight);\n                    }\n                    else if(queue[0].length > 0){\n                        next = queue[0].shift();\n                        get(next.url, next.successCallback, next.errorCallback, next.weight);\n                    }\n                });\n        }\n    };\n    \n    /**\n     * @ngdoc method\n     * @name mms.HttpService#ping\n     * @methodOf mms.HttpService\n     * \n     * @description\n     * If the current queue has an ongoing request, put it in front\n     *\n     * @param {string} url url to get\n     */\n    var ping = function(url, weight) { // ping should simply change the weight\n        if(weight === undefined){\n            weight = 1;\n        }\n        if (cache.hasOwnProperty(url)) {\n            if(weight > cache[url].weight){\n                var request = cache[url];\n                var index;\n                if(request.weight === 0)\n                    index= queue[0].indexOf(request);\n                else\n                    index= queue[1].indexOf(request);\n                if(weight === 1 && index !== -1){\n                    request.weight = 1;\n                    queue[1].push(request);\n                    queue[0].splice(index, 1);\n                }\n                else if(weight === 2 && index !== -1){\n                    if(request.weight === 0 ){\n                        queue[0].splice(index, 1);\n                    }\n                    else{\n                        queue[1].splice(index, 1);\n                    }\n                    get(request.url, request.successCallback, request.errorCallback, weight);\n                }\n            }\n        }\n    };\n    \n    /**\n     * @ngdoc method\n     * @name mms.HttpService#ping\n     * @methodOf mms.HttpService\n     * \n     * @description Changes all requests in the Queue 1 to Queue 0\n     */\n    var transformQueue = function(){\n        if(queue[1].length > 0) {//will the queue ever be defined?\n            for(var i = 0; i < queue[1].length; i++){\n                queue[1][i].weight = 0;\n                // if(cache.hasOwnProperty(queue[1][i].request.url))\n                //     cache[queue[1][i].request.url].weight = 0;\n                queue[0].push(queue[1][i]);\n                //queue[1][i].shift();\n            }\n            //queue[0] = queue[0].concat(queue[1]);\n            queue[1] = [];\n        }\n    };\n\n    var dropAll = function() {\n        queue[1].length = 0;\n        queue[0].length = 0;\n        cache = {};\n        inProgress = 0;\n    };\n\n    return {\n        get: get,\n        ping: ping,\n        setOutboundLimit: setOutboundLimit,\n        getOutboundLimit: getOutboundLimit,\n        getQueue: getQueue,\n        transformQueue: transformQueue,\n        dropAll: dropAll\n    };\n\n}","'use strict';\n\nangular.module('mms')\n.factory('JobService', ['$q', '$http', '$location', 'URLService', 'CacheService', 'AuthService', '_', JobService]);\n\n/**\n * @ngdoc service\n * @name mms.JobService\n * @requires $q\n * @requires $http\n * @requires $location\n * @requires mms.URLService\n * @requries mms.CacheService\n * \n * @description\n * This service handles VE jobs- creation, running, ...\n */\nfunction JobService($q, $http, $location, URLService, CacheService, AuthService, _) {\n\n    var serverSentPMA = '';\n    var host = $location.host();\n    if (host != 'localhost' && host != '0.0.0.0') {\n        var segments = host.split('-');\n        if (segments.length === 1) {\n            URLService.setJobsUrl('https://cae-pma.jpl.nasa.gov');\n        } else {\n            var env = segments[segments.length-1];\n            URLService.setJobsUrl('https://cae-pma-' + env);\n        }\n        serverSentPMA = host;\n    } else {\n        //use default pma //TODO need to define env var when running dev// TODO create porxy in gruntfile for PMA\n        URLService.setJobsUrl('https://cae-pma-test.jpl.nasa.gov');\n        serverSentPMA = 'opencae-test.jpl.nasa.gov';\n    }\n\n    /**\n     * @ngdoc method\n     * @name mms.JobService#runJob\n     * @methodOf mms.JobService\n     * \n     * @description\n     * Run job\n     * \n     * @param {object} jobRunOb {id: jobId, post: {all params needed for running job}}\n     * @param {string} projectId Project Id\n     * @param {string} refId Ref Id\n     * @returns {Promise} The promise will be resolved with the job instance\n     */\n    var runJob = function (jobRunOb, projectId, refId) {\n        var deferred = $q.defer();\n        var link = URLService.getRunJobURL(projectId, refId, jobRunOb.id);\n        var post = {\n            \"mmsServer\" : serverSentPMA,\n            \"alfrescoToken\" : AuthService.getTicket()\n        };\n        if (jobRunOb.post) {\n            _.merge(post, jobRunOb.post);\n        }\n        $http.post(link, post).then(function(data) {\n            deferred.resolve(data.data.jobInstances);\n        }, function(error) {\n            deferred.reject(error);\n        });\n        return deferred.promise;\n    };\n\n\n    /**\n     * @ngdoc method\n     * @name mms.JobService#getJobs\n     * @methodOf mms.JobService\n     * \n     * @description\n     * Get all the jobs for current document\n     * \n     * @param {string} docId Document Id\n     * @param {string} projectId Project Id\n     * @param {string} refId Ref Id\n     * @returns {Promise} The promise will be resolved with list of jobs\n     */\n    var getJobs = function (docId, projectId, refId) {\n        var deferred = $q.defer();\n        var link = URLService.getJobsURL(projectId, refId, serverSentPMA);\n        var docJobs = [];\n        $http.get(link).then(function(data) {\n            var jobs;\n            if (data.data.jobs) {\n                jobs = data.data.jobs;\n                for (var i = 0; i < jobs.length; i++) {\n                    if (jobs[i].associatedElementID === docId) {\n                        docJobs.push(jobs[i]);\n                    }\n                }\n            }\n            deferred.resolve(docJobs);\n        }, function(error) {\n            deferred.reject(error);\n        });\n        return deferred.promise;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.JobService#getJobInstances\n     * @methodOf mms.JobService\n     * \n     * @description\n     * Get latest instances of job. Need to use history to get past instances/builds.\n     * \n     * @param {string} jobId Job Id\n     * @param {string} projectId Project Id\n     * @param {string} refId Ref Id\n     * @returns {Promise} The promise will be resolved with a job instance\n     */\n    var getJobInstances = function (jobId, projectId, refId) {\n        var deferred = $q.defer();\n        var link = URLService.getJobInstancesURL(projectId, refId, jobId, serverSentPMA);\n        $http.get(link).then(function(data) {\n            deferred.resolve(data.data.jobInstances);\n        }, function(error) {\n            deferred.reject(error);\n        });\n        return deferred.promise;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.JobService#createJob\n     * @methodOf mms.JobService\n     * \n     * @description\n     * Create new job for doc\n     *  <pre>\n        JobService.createJob({\n            id: 'docId', \n            jobName: 'docName_docmerge', //default ''\n            jobType: 'docmerge',         //default 'docgen'\n            jobSchedule: '* * * *',      //default ''\n        }).then(\n            function(job) { \n                alert('created ' + job.name);\n            }, \n            function(reason) {\n                alert('creation failed: ' + reason.message);\n                //see mms.URLService#handleHttpStatus for the reason object\n            }\n        );\n        </pre>\n     * \n     * @param {object} jobOb {id: docId, jobName: 'jobName', jobType: 'docmerge/docgen'}\n     * @param {string} projectId Project Id\n     * @param {string} refId Ref Id\n     * @returns {Promise} The promise will be resolved with new job\n     */\n    var createJob = function(jobOb, projectId, refId) {\n        var deferred = $q.defer();\n        var id = jobOb.id;\n        var jobName = jobOb.jobName;\n        var jobType = 'docgen';\n        var jobSchedule = '';\n        \n        if (jobOb.jobType) {\n            jobType = jobOb.jobType;\n        }\n        if (jobOb.jobSchedule) {\n            jobSchedule = jobOb.jobSchedule;\n        }\n\n        var post = {\n            \"jobName\" : jobName,\n            \"type\" : jobType,\n            // \"arguments\" : [\"arg1\",\"arg2\"],\n            \"schedule\" : jobSchedule,\n            \"associatedElementID\" : id,\n            \"mmsServer\" : serverSentPMA,\n            \"alfrescoToken\" : AuthService.getTicket()\n        };\n\n        var link = URLService.getCreateJobURL(projectId, refId);\n        $http.post(link, post).then(function(data) {\n            deferred.resolve(data.data.jobs[0]);\n        }, function(error) {\n            deferred.reject(error);\n        });\n        return deferred.promise;\n    };\n\n    // var createJobCacheKey = function(reqOb) {\n    //     var refId = !reqOb.refId ? 'master' : reqOb.refId;\n    //     return ['job', reqOb.projectId, refId, reqOb.elementId];\n    // };\n\n    return {\n        createJob: createJob,\n        getJobs: getJobs,\n        getJobInstances: getJobInstances,\n        runJob: runJob\n    };\n\n}","'use strict';\n\nangular.module('mms')\n    .factory('MentionService', ['$rootScope', '$compile', '$timeout', 'moment', 'CacheService', 'ViewService', 'UtilsService' , MentionService]);\n\nfunction MentionService($rootScope, $compile, $timeout, moment, CacheService, ViewService, UtilsService) {\n    /** Used to maintain all mention in all ckeditors **/\n    var mentions = {};\n    var mentionPlacerHolderPrefix = 'mentionPlaceHolder';\n\n    return {\n        getFastCfListing: getFastCfListing,\n        createMention: createMention,\n        handleInput: handleInput,\n        handleMentionSelection: handleMentionSelection,\n        removeAllMentionForEditor: removeAllMentionForEditor,\n        hasMentionResults: hasMentionResults\n    };\n\n    function getFastCfListing(projectId, refId) {\n        return CacheService.getLatestElements(projectId, refId).reduce(function(result, cacheElement) {\n            var elementType = ViewService.getElementType(cacheElement);\n            var iconClass = UtilsService.getElementTypeClass(cacheElement, elementType);\n            result.push({id: cacheElement.id, name: cacheElement.name, type: 'name',\n                iconClass: iconClass, documentation: cacheElement.documentation || 'no text',\n                editor: cacheElement._modifier, editTime: moment(cacheElement._modified).fromNow(),\n                elementType: elementType || cacheElement.type\n            });\n            if (cacheElement.documentation != undefined) {\n                result.push({id: cacheElement.id, name: cacheElement.name, type: 'doc',\n                    iconClass: iconClass, documentation: cacheElement.documentation || 'no text',\n                    editor: cacheElement._modifier, editTime: moment(cacheElement._modified).fromNow(),\n                    elementType: elementType || cacheElement.type\n                });\n            }\n\n            if (cacheElement.type === 'Property' && cacheElement.defaultValue) {\n                var value = String(cacheElement.defaultValue.value);\n                if (!value || value === 'undefined') {\n                    value = 'this field is empty';\n                }\n                result.push({id: cacheElement.id, name: cacheElement.name, type: 'val',\n                    iconClass: iconClass, value: value,\n                    editor: cacheElement._modifier, editTime: moment(cacheElement._modified).fromNow(),\n                    elementType: cacheElement.type\n                });\n            }\n            return result;\n        }, []);\n    }\n\n    function createMention(editor, projectId, refId, existingMentionPlaceHolder) {\n        var mentionId = existingMentionPlaceHolder ? existingMentionPlaceHolder.mentionId : _getNewMentionId();\n        var mentionPlaceHolderId = existingMentionPlaceHolder ? existingMentionPlaceHolder.mentionPlaceHolderId : _createMentionPlaceHolder(editor, mentionId);\n        var mention = _createMentionDirective(editor, mentionId, projectId, refId);\n        _createNewMentionState(editor, mention, mentionPlaceHolderId, mentionId);\n        _positionMentionElement(editor, mention.element, mentionPlaceHolderId);\n    }\n\n    function handleInput(event, editor, projectId, refId) {\n        var currentEditingElement = editor._.elementsPath.list[0].$;\n        var currentEditingElementId = currentEditingElement.getAttribute('id');\n        var mentionId = _getMentionIdFromMentionPlaceHolder(currentEditingElementId);\n        if (mentionId) {\n            var mentionState = _retrieveMentionState(editor.id, mentionId);\n            // logic to reactivate existing \"@\" when reloading ckeditor\n            if (!mentionState) {\n                createMention(editor, projectId, refId, { mentionId: mentionId, mentionPlaceHolderId: currentEditingElementId} );\n                mentionState = _retrieveMentionState(editor.id, mentionId);\n            }\n\n            var mentionScope = mentionState.mentionScope;\n            mentionScope.$apply(function() {\n                var text = currentEditingElement.innerText;\n                text = text.substring(1); // ignore @\n                mentionScope.mmsMentionValue = text;\n                _repositionDropdownIfOffScreen(editor, mentionState);\n            });\n\n            _handleSpecialKeys(event, mentionId, editor, projectId, refId);\n        }\n    }\n\n    function handleMentionSelection(editor, mentionId) {\n        _cleanup(editor, mentionId);\n    }\n\n    function removeAllMentionForEditor(editor) {\n        Object.keys(mentions).filter(function(key) {\n            var splits = key.split('-');\n            return splits[0] === editor.id;\n        }).forEach(function(key) {\n            _cleanup(editor, key.split('-')[1]);\n        });\n    }\n\n    function hasMentionResults(editor) {\n        var currentEditingElement = editor._.elementsPath.list[0].$;\n        var currentEditingElementId = currentEditingElement.getAttribute('id');\n        var mentionId = _getMentionIdFromMentionPlaceHolder(currentEditingElementId);\n        if (mentionId) {\n            return _hasMentionResults(mentionId);\n        }\n        return false;\n    }\n\n    function _hasMentionResults(mentionId) {\n        return $('#' + mentionId).find('ul').children().length > 0;\n    }\n\n    function _createMentionDirective(editor, mentionId, projectId, refId) {\n        var newScope = Object.assign($rootScope.$new(),\n            {\n                mmsEditor: editor,\n                mmsMentionValue: '',\n                mmsMentionId: mentionId,\n                mmsProjectId: projectId,\n                mmsRefId: refId\n            });\n        var element = $compile('<span mms-mention mms-editor=\"mmsEditor\" mms-mention-value=\"mmsMentionValue\" mms-mention-id=\"mmsMentionId\" mms-project-id=\"mmsProjectId\" mms-ref-id=\"mmsRefId\"></span>')(newScope);\n        return {\n            scope: newScope,\n            controller: element.controller('mms-mention'),\n            element: element\n        };\n    }\n\n    function _getCkeditorFrame(editor) {\n        return editor.container.$.getElementsByTagName('iframe')[0];\n    }\n    \n    function _positionMentionElement(editor, mentionElement, mentionPlaceHolderId) {\n        var ckeditorFrame = _getCkeditorFrame(editor);\n        var ckeditorBox = ckeditorFrame.getBoundingClientRect();\n        var mentionPlaceHolder = ckeditorFrame.contentDocument.getElementById(mentionPlaceHolderId);\n        var mentionPlaceHolderBox = $(mentionPlaceHolder)[0].getBoundingClientRect();\n        mentionElement.css({\n            position: 'absolute',\n            top: ckeditorBox.top + mentionPlaceHolderBox.top + 30,\n            left: ckeditorBox.left + mentionPlaceHolderBox.left\n        });\n        $('body').append(mentionElement);\n    }\n\n    function _createNewMentionState(editor, mention, mentionPlaceHolderId, mentionId) {\n        var key = _getMentionStateId(editor.id, mentionId);\n        var value = {\n            mentionScope: mention.scope,\n            mentionController: mention.controller,\n            mentionElement: mention.element,\n            mentionId: mentionId,\n            mentionPlaceHolderId: mentionPlaceHolderId\n        };\n        mentions[key] = value;\n        return value;\n    }\n\n    function _retrieveMentionState(editorId, mentionId) {\n        return mentions[_getMentionStateId(editorId, mentionId)];\n    }\n\n    function _getMentionStateId(editorId, mentionId) {\n        return editorId + '-' + mentionId;\n    }\n\n    function _createMentionPlaceHolder(editor, mentionId) {\n        var id = mentionPlacerHolderPrefix + '-' + editor.id + '-' + mentionId;\n        var mentionPlaceHolder = '<span id=\"' + id + '\">@</span>';\n        editor.insertHtml(mentionPlaceHolder);\n        return id;\n    }\n\n    // Generate unique id\n    function _getNewMentionId() {\n        function chr4(){\n            return Math.random().toString(16).slice(-4);\n        }\n        return chr4() + chr4() + chr4() + chr4() + chr4() + chr4() + chr4() + chr4();\n    }\n\n    function _getMentionIdFromMentionPlaceHolder(currentEditingElementId) {\n        if (currentEditingElementId && currentEditingElementId.indexOf(mentionPlacerHolderPrefix) > -1) {\n            var splits = currentEditingElementId.split('-');\n            var mentionId = splits[2];\n            return mentionId;\n        }\n        return null;\n    }\n\n    function _cleanup(editor, mentionId, unwrapOnly) {\n        var mentionState = _retrieveMentionState(editor.id, mentionId);\n        var mentionPlaceHolderId = mentionState.mentionPlaceHolderId;\n        var mentionPlaceHolderDom = editor.document.getById(mentionPlaceHolderId); \n        if (unwrapOnly) {\n            var range = editor.createRange();\n            if (range && mentionPlaceHolderDom) {\n                range.moveToClosestEditablePosition(mentionPlaceHolderDom, true);\n                $(mentionPlaceHolderDom.$).contents().unwrap();\n                range.select();\n            }\n        } else {\n            // remove the mentionPlaceHolder\n            mentionPlaceHolderDom.remove();\n        }\n        // cleanup the mention directive\n        var mentionScope = mentionState.mentionScope;\n        mentionScope.$destroy();\n        // remove the mention dom\n        var mentionElement = mentionState.mentionElement;\n        mentionElement.remove();\n        // remove the mention state\n        delete mentions[_getMentionStateId(editor.id, mentionId)];\n    }\n\n    function _handleSpecialKeys(evt, mentionId, editor, projectId, refId) {\n        switch (evt.data.$.which) {\n            case 38: // up arrow\n                _handleArrowKey(mentionId, false);\n                break;\n            case 40: // down arrow\n                _handleArrowKey(mentionId, true);\n                break;\n            case 13: // enter\n                _handleEnterKey(editor.id, mentionId, projectId, refId);\n                break;\n            case 27: // esc\n                _handleEscKey(editor, mentionId);\n        }\n    }\n\n    function _getMentionItem(key, projectId, refId) {\n        var cfListing = getFastCfListing(projectId, refId);\n        return cfListing.find(function(cf) {\n            return (cf.id + cf.type) === key;\n        });\n    }\n\n    function _handleEnterKey(editorId, mentionId, projectId, refId) {\n        var matchDom = $('#' + mentionId + ' .active .mentionMatch');\n        if (matchDom.length > 0) {\n            var key = matchDom.attr('id');\n            var mentionItem = _getMentionItem(key, projectId, refId);\n            var mentionState = _retrieveMentionState(editorId, mentionId);\n            mentionState.mentionController.selectMentionItem(mentionItem);\n        }\n    }\n    \n    function _handleEscKey(editor, mentionId) {\n        _cleanup(editor, mentionId, true);\n    }\n\n    function _handleArrowKey(mentionId, isDownArrow) {\n        var popUpEl = $('#' + mentionId);\n        var allOptions = popUpEl.find('li');\n        var len = allOptions.length;\n        var activeIndex = -1;\n        allOptions.each(function(index) {\n            if ($(this).hasClass('active')) {\n                activeIndex = index;\n            }\n        });\n        if (activeIndex !== -1) {\n            var nextIndex;\n            if (isDownArrow) {\n                nextIndex = (activeIndex + 1) % len;\n            } else {\n                if (activeIndex === 0 ) {\n                    nextIndex = len - 1;\n                } else {\n                    nextIndex = (activeIndex - 1) % len;\n                }\n            }\n            var target = $(allOptions[nextIndex]);\n            target.addClass('active');\n            $(allOptions[activeIndex]).removeClass('active');\n            // scroll if necessary\n            target[0].parentNode.scrollTop = target[0].offsetTop;\n        }\n    }\n\n    function _repositionDropdownIfOffScreen(editor, mentionState) {\n        // wait for dropdown result to render so that we can determine whether it is on/off-screen\n        $timeout(function() {\n            var mentionElement = mentionState.mentionElement;\n            var dropdownResultElement = mentionElement.find('ul.dropdown-menu');\n            if (dropdownResultElement.children().length > 0 && !dropdownResultElement.isOnScreen()) {\n                var ckeditorBox = _getCkeditorFrame(editor).getBoundingClientRect();\n                mentionElement.css({\n                    top: ckeditorBox.top,\n                    left: ckeditorBox.left\n                });\n            }\n        }, 0, false);\n\n    }\n}\n","'use strict';\n\nangular.module('mms')\n.factory('ProjectService', ['$q','$http','ApplicationService','CacheService','ElementService','URLService','_', ProjectService]);\n\n/**\n * @ngdoc service\n * @name mms.ProjectService\n * @requires $q\n * @requires $http\n * @requires mms.ApplicationService\n * @requires mms.CacheService\n * @requires mms.ElementService\n * @requires mms.URLService\n * @requires _\n *\n * @description\n * This is a utility service for getting project, ref, commit information\n */\nfunction ProjectService($q, $http,ApplicationService,CacheService,ElementService,URLService,_) {\n    var inProgress = {};\n\n    /**\n     * @ngdoc method\n     * @name mms.ProjectService#getOrg\n     * @methodOf mms.ProjectService\n     *\n     * @description\n     * Gets org information from mms\n     *\n     * @param {string} orgId id of org\n     * @returns {Promise} Resolves to the org object.\n     */\n    var getOrg = function(orgId) {\n        var deferred = $q.defer();\n        var key = ['org', orgId];\n        var urlkey = URLService.getOrgURL(orgId);\n        if (inProgress.hasOwnProperty(urlkey)) {\n            return inProgress[urlkey];\n        }\n        if (CacheService.exists(key)) {\n            deferred.resolve(CacheService.get(key));\n        } else {\n            inProgress[urlkey] = deferred.promise;\n            $http.get(urlkey)\n            .then(function(response) {\n                if (!response.data.orgs || response.data.orgs.length < 1) {\n                    deferred.reject({status: 404, data: '', message: 'Org not found'});\n                } else {\n                    CacheService.put(key, response.data.orgs[0], true);\n                    deferred.resolve(CacheService.get(key));\n                }\n            }, function(response) {\n                URLService.handleHttpStatus(response.data, response.status, response.headers, response.config, deferred);\n            }).finally(function() {\n                delete inProgress[urlkey];\n            });\n        }\n        return deferred.promise;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ProjectService#getOrgs\n     * @methodOf mms.ProjectService\n     * \n     * @description\n     * Gets orgs information\n     *\n     * @returns {Promise} Resolves into array of org objects.\n     */\n    var getOrgs = function() {\n        var key = 'orgs';\n        if (inProgress.hasOwnProperty(key)) {\n            return inProgress[key];\n        }\n        var deferred = $q.defer();\n        if (CacheService.exists(key)) {\n            deferred.resolve(CacheService.get(key));\n        } else {\n            inProgress[key] = deferred.promise;\n            $http.get(URLService.getOrgsURL())\n            .then(function(response) {\n                var orgs = [];\n                for (var i = 0; i < response.data.orgs.length; i++) {\n                    var org = response.data.orgs[i];\n                    CacheService.put(['org', org.id], org, true);\n                    orgs.push(CacheService.get(['org', org.id]));\n                }\n                CacheService.put(key, orgs, false);\n                deferred.resolve(CacheService.get(key));\n            }, function(response) {\n                URLService.handleHttpStatus(response.data, response.status, response.headers, response.config, deferred);\n            }).finally(function() {\n                delete inProgress[key];\n            });\n        }\n        return deferred.promise;\n    };\n\n    var getProjects = function(orgId) {\n        var deferred = $q.defer();\n        var url = URLService.getProjectsURL(orgId);\n        if (inProgress.hasOwnProperty(url)) {\n            return inProgress[url];\n        }\n        var cacheKey = !orgId ? 'projects' : ['projects', orgId];\n        if (CacheService.exists(cacheKey)) {\n            deferred.resolve(CacheService.get(cacheKey));\n        } else {\n            inProgress[url] = deferred.promise;\n            $http.get(url).then(function(response) {\n                if (!angular.isArray(response.data.projects)) {\n                    deferred.reject({status: 500, data: '', message: \"Server Error: empty response\"});\n                    return;\n                }\n                var projects = [];\n                for (var i = 0; i < response.data.projects.length; i++) {\n                    var project = response.data.projects[i];\n                    if (orgId) {\n                        project.orgId = orgId;\n                    }\n                    CacheService.put(['project', project.id], project, true);\n                    projects.push(CacheService.get(['project', project.id]));\n                }\n                CacheService.put(cacheKey, projects, false);\n                deferred.resolve(CacheService.get(cacheKey));\n            }, function(response) {\n                URLService.handleHttpStatus(response.data, response.status, response.headers, response.config, deferred);\n            }).finally(function() {\n                delete inProgress[url];\n            });\n        }\n        return deferred.promise;\n    };\n\n    var getProject = function(projectId) {\n        var deferred = $q.defer();\n        var url = URLService.getProjectURL(projectId);\n        if (inProgress.hasOwnProperty(url)) {\n            return inProgress[url];\n        }\n        var cacheKey = ['project', projectId];\n        if (CacheService.exists(cacheKey))\n            deferred.resolve(CacheService.get(cacheKey));\n        else {\n            inProgress[url] = deferred.promise;\n            $http.get(url).then(function(response) {\n                if (!angular.isArray(response.data.projects) || response.data.projects.length === 0) {\n                    deferred.reject({status: 500, data: '', message: \"Server Error: empty response\"});\n                    return;\n                }\n                CacheService.put(cacheKey, response.data.projects[0], true);\n                deferred.resolve(CacheService.get(cacheKey));\n            }, function(response) {\n                URLService.handleHttpStatus(response.data, response.status, response.headers, response.config, deferred);\n            }).finally(function() {\n                delete inProgress[url];\n            });\n        }\n        return deferred.promise;\n    };\n\n    var getProjectMounts = function(projectId, refId) {\n        var deferred = $q.defer();\n        var url = URLService.getProjectMountsURL(projectId, refId);\n        if (inProgress.hasOwnProperty(url)) {\n            return inProgress[url];\n        }\n        var cacheKey = ['project', projectId, refId];\n        if (CacheService.exists(cacheKey)) {\n            deferred.resolve(CacheService.get(cacheKey));\n        } else {\n            inProgress[url] = deferred.promise;\n            $http.get(url).then(function(response) {\n                if (!angular.isArray(response.data.projects) || response.data.projects.length === 0) {\n                    deferred.reject({status: 500, data: '', message: \"Server Error: empty response\"});\n                    return;\n                }\n                CacheService.put(cacheKey, response.data.projects[0], true);\n                deferred.resolve(CacheService.get(cacheKey));\n            }, function(response) {\n                URLService.handleHttpStatus(response.data, response.status, response.headers, response.config, deferred);\n            }).finally(function() {\n                delete inProgress[url];\n            });\n        }\n        return deferred.promise;\n    };\n\n    var getRefs = function(projectId) {\n        var cacheKey = ['refs', projectId];\n        var url = URLService.getRefsURL(projectId);\n        if (inProgress.hasOwnProperty(url)) {\n            return inProgress[url];\n        }\n        var deferred = $q.defer();\n        if (CacheService.exists(cacheKey)) {\n            deferred.resolve(CacheService.get(cacheKey));\n        } else {\n            inProgress[url] = deferred.promise;\n            $http.get(url).then(function(response) {\n                if (!angular.isArray(response.data.refs)) {\n                    deferred.reject({status: 500, data: '', message: \"Server Error: empty response\"});\n                    return;\n                }\n                var refs = [];\n                for (var index = 0; index < response.data.refs.length; index++) {\n                    var ref = response.data.refs[index];\n                    if (ref.id === 'master') {\n                        ref.type = 'Branch';\n                    }\n                    CacheService.put(['ref', projectId, ref.id], ref, true);\n                    refs.push(CacheService.get(['ref', projectId, ref.id]));\n                }\n                CacheService.put(cacheKey, refs, false);\n                deferred.resolve(CacheService.get(cacheKey));\n            }, function(response) {\n                URLService.handleHttpStatus(response.data, response.status, response.headers, response.config, deferred);\n            }).finally(function() {\n                delete inProgress[url];\n            });\n        }\n        return deferred.promise;\n    };\n\n    var getRef = function(refId, projectId) {\n        var deferred = $q.defer();\n        getRefs(projectId).then(function(data) {\n            var result = CacheService.get(['ref', projectId, refId]);\n            if (result) {\n                deferred.resolve(result);\n            } else {\n                deferred.reject({status: 404, data: '', message: \"Ref not found\"});\n            }\n        }, function(reason) {\n            deferred.reject(reason);\n        });\n        return deferred.promise;\n    };\n\n    var getRefHistory = function(refId, projectId, timestamp) {\n        var deferred = $q.defer();\n        var url;\n        if (timestamp !== null) {\n            url = URLService.getRefHistoryURL(projectId, refId, timestamp);\n        } else {\n            url = URLService.getRefHistoryURL(projectId, refId);\n        }\n        inProgress[url] = deferred.promise;\n        $http.get(url).then(function(response) {\n            if (!angular.isArray(response.data.commits) || response.data.commits.length === 0) {\n                deferred.reject({status: 500, data: '', message: \"Error: Project does not exist at specified time.\"});\n                return;\n            }\n            deferred.resolve(response.data.commits);\n        }, function(response) {\n            URLService.handleHttpStatus(response.data, response.status, response.headers, response.config, deferred);\n        }).finally(function() {\n            delete inProgress[url];\n        });\n        return deferred.promise;\n    };\n\n    var createRef = function(refOb, projectId) {\n        var deferred = $q.defer();\n        var url = URLService.getRefsURL(projectId);\n        $http.post(url, {'refs': [refOb], 'source': ApplicationService.getSource()})\n        .then(function(response) {\n            if (!angular.isArray(response.data.refs) || response.data.refs.length === 0) {\n                deferred.reject({status: 500, data: '', message: \"Server Error: empty response\"});\n                return;\n            }\n            var createdRef = response.data.refs[0];\n            var list = CacheService.get(['refs', projectId]);\n            if (list) {\n                list.push(createdRef);\n            }\n            deferred.resolve(CacheService.put(['ref', projectId, createdRef.id], createdRef));\n        }, function(response) {\n            URLService.handleHttpStatus(response.data, response.status, response.headers, response.config, deferred);\n        });\n        return deferred.promise;\n    };\n\n    var updateRef = function(refOb, projectId) {\n        var deferred = $q.defer();\n        var url = URLService.getRefsURL(projectId);\n        $http.post(url, {'refs': [refOb], 'source': ApplicationService.getSource()})\n        .then(function(response) {\n            if (!angular.isArray(response.data.refs) || response.data.refs.length === 0) {\n                deferred.reject({status: 500, data: '', message: \"Server Error: empty response\"});\n                return;\n            }\n            var resp = response.data.refs[0];\n            deferred.resolve(CacheService.put(['ref', projectId, resp.id], resp, true));\n        }, function(response) {\n            URLService.handleHttpStatus(response.data, response.status, response.headers, response.config, deferred);\n        });\n        return deferred.promise;\n    };\n\n    var deleteRef = function(refId, projectId) {\n        var deferred = $q.defer();\n        var url = URLService.getRefURL(projectId, refId);\n        $http.delete(url).then(function(response) {\n            var key = ['ref', projectId, refId];\n            var refOb = CacheService.get(key);\n            if (refOb) {\n                CacheService.remove(key);\n                var list = CacheService.get(['refs', projectId]);\n                if (list) {\n                    for (var i = 0; i < list.length; i++) {\n                        if (list[i].id === refOb.id) {\n                            list.splice(i, 1);\n                            break;\n                        }\n                    }\n                }\n            }\n            deferred.resolve('');\n        }, function(response) {\n            URLService.handleHttpStatus(response.data, response.status, response.headers, response.config, deferred);\n        });\n        return deferred.promise;\n    };\n\n    var getGroups = function(projectId, refId) {\n        refId = refId ? refId : 'master';\n        var cacheKey = ['groups', projectId, refId];\n        var url = URLService.getGroupsURL(projectId, refId);\n        if (inProgress.hasOwnProperty(url)) {\n            return inProgress[url];\n        }\n        var deferred = $q.defer();\n        if (CacheService.exists(cacheKey)) {\n            deferred.resolve(CacheService.get(cacheKey));\n        } else {\n            inProgress[url] = deferred.promise;\n            $http.get(url).then(function(response) {\n                if (!angular.isArray(response.data.groups)) {\n                    deferred.reject({status: 500, data: '', message: \"Server Error: empty response\"});\n                    return;\n                }\n                var groups = [];\n                var reqOb = {projectId: projectId, refId: refId, commitId: 'latest'};\n                for (var i = 0; i < response.data.groups.length; i++) {\n                    var group = response.data.groups[i];\n                    reqOb.elementId = group.id;\n                    group = ElementService.cacheElement(reqOb, group, false);\n                    CacheService.put(['group', projectId, refId, group.id], group, true);\n                    groups.push(CacheService.get(['group', projectId, refId, group.id]));\n                }\n                CacheService.put(cacheKey, groups, false);\n                deferred.resolve(CacheService.get(cacheKey));\n            }, function(response) {\n                URLService.handleHttpStatus(response.data, response.status, response.headers, response.config, deferred);\n            }).finally(function() {\n                delete inProgress[url];\n            });\n        }\n        return deferred.promise;\n    };\n\n    var getGroup = function(id, projectId, refId) {\n        var deferred = $q.defer();\n        getGroups(projectId, refId).then(function(data) {\n            var result = CacheService.get(['group', projectId, refId, id]);\n            if (result) {\n                deferred.resolve(result);\n            } else {\n                deferred.reject({status: 404, data: '', message: \"Group not found\"});\n            }\n        }, function(reason) {\n            deferred.reject(reason);\n        });\n        return deferred.promise;\n    };\n\n    var getMetatypes = function(projectId, refId) {\n        refId = refId ? refId : 'master';\n        var cacheKey = ['metatypes', projectId, refId];\n        var url = URLService.getSearchURL(projectId, refId);\n        if (inProgress.hasOwnProperty(url)) {\n            return inProgress[url];\n        }\n        var deferred = $q.defer();\n        if (CacheService.exists(cacheKey)) {\n            deferred.resolve(CacheService.get(cacheKey));\n        } else {\n            inProgress[url] = deferred.promise;\n            var query = getMetatypeFilter(projectId, refId);\n            $http.put(url, query).then(function(response) {\n                var aggregations = response.data.aggregations;\n                if (!angular.isDefined(aggregations)) {\n                    deferred.reject({status: 500, data: '', message: \"Could not find metatypes\"});\n                    return;\n                }\n                var metatypeList = [];\n                // Get metatype buckets for `types` and add to metatype list\n                var typeIds = aggregations.elements.types.buckets;\n                var typeKeyList = _.map(typeIds, function(obj){ return {id: obj.key, name: obj.key}; });\n                metatypeList = typeKeyList;\n                // Get metatype buckets for `stereotypedElements` and get elements\n                // before adding to metatype list (need name for dropdown)\n                var stereotypeIds = aggregations.stereotypedElements.stereotypeIds.buckets;\n                var stereotypeKeyList = _.pluck(stereotypeIds, 'key');\n                var reqOb = {elementIds: stereotypeKeyList, projectId: projectId, refId: refId};\n                ElementService.getElements(reqOb,2).then(function(data) {\n                    var steroObjList = _.map(data, function(obj){ return {id: obj.id, name: obj.name}; });\n                    metatypeList = metatypeList.concat(steroObjList);\n                    CacheService.put(cacheKey, metatypeList, false);\n                    deferred.resolve(CacheService.get(cacheKey));\n                });\n            }, function(response) {\n                URLService.handleHttpStatus(response.data, response.status, response.headers, response.config, deferred);\n            }).finally(function() {\n                delete inProgress[url];\n            });\n        }\n        return deferred.promise;\n    };\n\n    /**\n     * List of appliedSterotypes and types to not include in metatype search dropdown\n     */\n    var metatypeFilterMustNotList = [\n        {\n            \"terms\": {\n                \"_appliedStereotypeIds\": [\"_17_0_5_407019f_1336584858932_290814_11897\", \"_17_0_2_407019f_1354126823633_971278_12922\", \"_17_0_2_3_407019f_1390932205525_919663_29081\", \"_17_0_1_407019f_1328144768208_151103_11611\", \"_18_5_8bf0285_1486490948776_422870_16475\", \"_17_0_2_3_407019f_1380044908011_537162_29414\", \"_18_0_6_8bf0285_1480702282066_678566_13974\", \"_18_0_5_407019f_1470005595314_374414_14088\", \"_17_0_1_407019f_1320688868391_878682_2122\", \"_17_0_5_407019f_1334873987130_64195_11860\", \"_17_0_1_244d03ea_1319490838789_76536_23321\", \"_17_0_1_244d03ea_1319490696098_585884_23244\", \"_17_0_1_244d03ea_1319490675924_494597_23220\", \"_17_0_2_3_e81034b_1378849795852_475880_29502\", \"_17_0_1_244d03ea_1319490856319_735016_23345\", \"_17_0_5_407019f_1346952773459_128964_11915\", \"_17_0_1_244d03ea_1319492675769_542703_24690\", \"_17_0_1_244d03ea_1319490805237_397889_23292\", \"_17_0_1_244d03ea_1319491813759_405316_23859\", \"_17_0_1_22b603cd_1319577320837_597116_24044\", \"_17_0_1_244d03ea_1319490870282_714178_23369\", \"_17_0_1_244d03ea_1319490921274_829705_23417\", \"_17_0_2_3_e81034b_1378849355455_639118_29417\", \"_17_0_1_244d03ea_1319490658057_783239_23196\", \"_17_0_1_244d03ea_1319490607459_890787_23148\", \"_17_0_1_244d03ea_1319490639053_446661_23172\", \"_17_0_1_24c603f9_1318965749289_636288_15241\", \"_17_0_1_244d03ea_1319490721410_468874_23268\", \"_17_0_1_244d03ea_1319490880431_889010_23393\", \"_17_0_2_3_407019f_1377878750778_198079_29401\", \"_17_0_2_3_407019f_1377881591361_754431_29966\", \"_17_0_5_407019f_1337970852079_693660_12393\", \"_17_0_2_3_407019f_1377878719961_37575_29374\", \"_17_0_1_24c603f9_1318965764947_847626_15265\", \"_17_0_2_1_407019f_1358445062164_196970_12977\", \"_17_0_1_244d03ea_1319496225382_275996_25443\", \"_17_0_1_244d03ea_1319498258297_961829_27083\", \"_17_0_1_244d03ea_1319496302084_771803_25570\", \"_17_0_1_244d03ea_1319496280368_246829_25514\", \"_18_5_2_8bf0285_1506039168690_925234_16001\", \"_17_0_1_407019f_1326235066484_404532_2489\", \"_17_0_1_244d03ea_1319512564304_251824_28229\", \"_18_0_5_ef50357_1480453603002_831462_13966\", \"_17_0_2_3_407019f_1383246724224_41450_29079\", \"_17_0_2_3_407019f_1375477696989_696093_29350\", \"_17_0_2_3_407019f_1375478079564_152907_29404\", \"_17_0_2_3_407019f_1392933505529_270043_29089\", \"_17_0_2_3_e9f034d_1375474838719_217024_29345\", \"_17_0_2_3_eac0346_1374702066208_763130_29330\", \"_17_0_2_3_eac0346_1374701945748_238477_29309\", \"_17_0_2_3_407019f_1383165357327_898985_29071\", \"_9_0_be00301_1108044380615_150487_0\", \"_10_0_622020d_1127207234373_259585_1\", \"_12_1_8f90291_1173963323875_662612_98\", \"_16_0_62a020a_1227788740027_441955_240\", \"_17_0_2_3_ff3038a_1383749269646_31940_44489\", \"_16_5beta1_8ba0276_1232443673758_573873_267\", \"_9_0_be00301_1108044563999_784946_1\", \"_11_5EAPbeta_be00301_1151484491369_618395_1\", \"_15_5EAPbeta1_8f90291_1207743469046_796042_162\", \"_18_0beta_8e8028e_1384177586203_506524_3245\", \"_9_0_be00301_1108044721245_236588_411\", \"_17_0_2beta_903028d_1330931963982_116619_1920\", \"_18_5beta_8ba0279_1468931052415_679497_4210\", \"_17_0_2beta_903028d_1330931963978_770627_1918\", \"_18_1_8760276_1416414449210_764904_3981\", \"_17_0_5beta_f720368_1373961709543_89140_3280\", \"_9_0_be00301_1108044705753_203399_228\"]\n            }\n        },\n        {\n            \"terms\": {\n                \"type\": [\"Dependency\", \"Abstraction\", \"ComponentRealization\", \"InterfaceRealization\", \"Deployment\", \"Manifestation\", \"Realization\", \"Substitution\", \"Usage\", \"ElementImport\", \"Extend\", \"Include\", \"InformationFlow\", \"PackageImport\", \"ProfileApplication\", \"ProtocolConformance\", \"TemplateBinding\", \"Generalization\", \"Association\", \"Connector\", \"ConnectorEnd\", \"ControlFlow\", \"ObjectFlow\", \"Mount\", \"FinalNode\", \"JoinNode\", \"ForkNode\", \"MergeNode\", \"FlowFinalNode\", \"InitialNode\", \"ActivityFinalNode\", \"ActivityPartition\", \"DecisionNode\", \"Transition\"]\n            }\n        }\n    ];\n\n    var getMetatypeFilter = function(projectId, refId) {\n        return {\n        \"size\": 0,\n        \"aggs\": {\n          \"stereotypedElements\": {\n              \"filter\": { \"bool\": {\n                  \"must\": [\n                      {\"term\": {\"_projectId\": projectId}},\n                      {\"term\": {\"_inRefIds\": refId}},\n                      {\"exists\": {\"field\": \"_appliedStereotypeIds\"}}\n                  ],\n                  \"must_not\": metatypeFilterMustNotList\n              }},\n              \"aggs\": {\n                  \"stereotypeIds\": {\n                      \"terms\": {\n                          \"field\": \"_appliedStereotypeIds\",\n                          \"size\": 20\n                      }\n                  }\n              }\n          },\n         \"elements\": {\n              \"filter\": { \"bool\": {\n                  \"must\": [\n                      {\"term\": {\"_projectId\": projectId}},\n                      {\"term\": {\"_inRefIds\": refId}}\n                  ],\n                 \"must_not\" : metatypeFilterMustNotList\n              }},\n              \"aggs\": {\n                  \"types\": {\n                      \"terms\": {\n                          \"field\": \"type\",\n                          \"size\": 20\n                      }\n                  }\n              }\n          }\n        }\n      };\n    };\n\n    var reset = function() {\n        inProgress = {};\n    };\n\n\n    return {\n        getProjects: getProjects,\n        getProject: getProject,\n        getProjectMounts: getProjectMounts,\n        getOrgs: getOrgs,\n        getOrg: getOrg,\n        getRefs: getRefs,\n        getRef: getRef,\n        getRefHistory: getRefHistory,\n        getGroups: getGroups,\n        getGroup: getGroup,\n        createRef: createRef,\n        updateRef: updateRef,\n        deleteRef: deleteRef,\n        getMetatypes: getMetatypes,\n        reset: reset\n    };\n}","'use strict';\n\nangular.module('mms')\n    .factory('ShortenUrlService', ['$http', '$q', 'URLService', 'UtilsService', ShortenUrlService]);\n\nfunction ShortenUrlService($http, $q, URLService, UtilsService) {\n\n    function getShortUrl(currentUrl, scope) {\n        var SHARE_URL = 'https://opencae.jpl.nasa.gov/goto/';\n        return $http.post('https://purl-prod.jpl.nasa.gov/create', {'url': currentUrl}, {headers: {'Authorization': 'Basic Og=='}})\n            .then(function (response) {\n                scope.shortUrl = SHARE_URL + response.data.link;\n            }, function (response) {\n                return URLService.handleHttpStatus(response.data, response.status, response.headers, response.config, $q.defer());\n            });\n    }\n\n    return {\n        dynamicPopover: {\n            templateUrl: 'shareUrlTemplate.html',\n            title: 'Share'\n        },\n        copyToClipboard: function ($event) {\n            UtilsService.copyToClipboard($('#ve-short-url'), $event);\n        },\n        getShortUrl: getShortUrl\n    };\n}\n","'use strict';\n\nangular.module('mms')\n.factory('StompService', ['$rootScope', 'ApplicationService', 'ElementService', 'URLService','$http', 'UtilsService', 'CacheService', '_', StompService]);\n\n/**\n * @ngdoc service\n * @name mms.StompService\n * @requires _\n *\n * @description\n * Provides messages from the activemq JMS bus\n */\nfunction StompService($rootScope, ApplicationService, ElementService, URLService, $http, UtilsService, CacheService, _) {\n     var stompClient = {};\n     var host;\n\n    $http.get(URLService.getJMSHostname()).then(function successCallback(response) {\n        if(response.data.connections[0].hasOwnProperty(\"uri\")){\n            var removeProtocol = response.data.connections[0].uri.replace(/.*?:\\/\\//g, \"\");\n            host = 'wss://' + removeProtocol.substring(0, removeProtocol.length-6) + ':61614';\n            stompConnect();\n        }else{\n            console.log('JSON does not contain the right key.  STOMP failed.');\n        }\n    }, function errorCallback(failed) {\n        console.log(\"failed to connect to the JMS:  \" + failed.status);\n    });\n\n    var stompSuccessCallback = function(message) {\n        var updateWebpage = angular.fromJson(message.body);\n        var projectId = message.headers.projectId;\n        var refId = message.headers.refId;\n        refId = !refId ? 'master' : refId;\n        if (updateWebpage.source !== ApplicationService.getSource()) {\n            if (updateWebpage.refs) {\n                if (updateWebpage.refs.updatedElements && updateWebpage.refs.updatedElements.length > 0) {\n                    angular.forEach(updateWebpage.refs.updatedElements, function (eltId) {\n                        // if (eltId.startsWith(\"PMA\")) {\n                        //     $rootScope.$broadcast(\"stomp.job\", eltId);\n                        // }\n                        var key = UtilsService.makeElementKey({_projectId: projectId, _refId: refId, id: eltId});\n                        if (!CacheService.exists(key)) {\n                            return;\n                        }\n                        ElementService.getElement({\n                            projectId: projectId,\n                            refId: refId,\n                            extended: true,\n                            elementId: eltId\n                        }, 1, true).then(function (data) {\n                            $rootScope.$broadcast(\"element.updated\", data, null, true);\n                        });\n                    });\n                }\n            }\n        }\n        if (updateWebpage.createdRef) {\n            var createdRef = updateWebpage.createdRef;\n            var list = CacheService.get(['refs', projectId]);\n            var index = -1;\n            if (list) {\n                index = _.findIndex(list, {id: createdRef.id});\n                if ( index > -1 ) {\n                    Object.assign(list[index], createdRef);\n                } else {\n                    list.push(createdRef);\n                }\n            }\n            CacheService.put(['ref', projectId, createdRef.id], createdRef);\n            $rootScope.$broadcast(\"stomp.branchCreated\", createdRef, projectId);\n        }\n        if (updateWebpage.updatedJobs) {\n            var updateJob = updateWebpage.updatedJobs;\n            $rootScope.$broadcast(\"stomp.updateJob\", updateJob);\n        }\n\n        // this should happen in where...\n        $rootScope.$on('$destroy', function() {\n            stompClient.unsubscribe('/topic/master'/*, whatToDoWhenUnsubscribe*/);\n        });\n    };\n\n    var stompFailureCallback = function(error) {\n        console.log('STOMP: ' + error);\n        stompConnect();\n        console.log('STOMP: Reconnecting in 10 seconds');\n    };\n\n    var stompConnect = function(){\n        stompClient = Stomp.client(host);\n        stompClient.debug = null;\n        stompClient.connect(\"guest\", \"guest\", function(){ // on success\n            stompClient.subscribe(\"/topic/master\", stompSuccessCallback );\n        }, stompFailureCallback, '/');\n    };\n\n     return {\n\n     };\n }\n","'use strict';\n\nangular.module('mms')\n  .factory('TableService', ['$q', '$http', 'URLService', 'UtilsService', 'CacheService', '_', 'ElementService', TableService]);\n\nfunction TableService($q, $http, URLService, UtilsService, CacheService, _, ElementService) {\n\n  function readvalues2(plot, projectId, refId, commitId){ \n\n    var deferred = $q.defer();\n\n    var aMmsEid = {projectId: projectId, refId: refId, commitId: commitId};\n    var isHeader = (plot.table.header !== undefined && plot.table.header.length > 0 ? true : false);\n\n    if (isHeader) {\n      var aheader = asyncReadTableHeader(aMmsEid, plot.table.header[0]);\n      aheader.then( function(tableheader){\n        var abody = asyncReadTableBody2(aMmsEid, plot.table.body, tableheader);\n        abody.then( function(tablebody){\n          var r = {tableheader: tableheader, tablebody: tablebody, isHeader: isHeader};\n          deferred.resolve(r);\n        });\n      });\n    }\n    else {\n      var abody = asyncReadTableBody(aMmsEid, plot.table.body);\n      abody.then( function(tablebody){\n        var r = {tablebody: tablebody, isHeader:isHeader};\n        deferred.resolve(r);\n      });\n    }\n    return deferred.promise;\n  } //end of readValues\n  \n\n\n  function readvalues(plot, projectId, refId, commitId){ \n\n    var deferred = $q.defer();\n\n    var aMmsEid = {projectId: projectId, refId: refId, commitId: commitId};\n    var isHeader = (plot.table.header !== undefined && plot.table.header.length > 0 ? true : false);\n\n    if (isHeader) {\n      var aheader = asyncReadTableHeader(aMmsEid, plot.table.header[0]);\n      aheader.then( function(tableheader){\n        var abody = asyncReadTableBody(aMmsEid, plot.table.body);\n        abody.then( function(tablebody){\n          var r = {tableheader: tableheader, tablebody: tablebody, isHeader: isHeader};\n          deferred.resolve(r);\n        });\n      });\n    }\n    else {\n      var abody = asyncReadTableBody(aMmsEid, plot.table.body);\n      abody.then( function(tablebody){\n        var r = {tablebody: tablebody, isHeader:isHeader};\n        deferred.resolve(r);\n      });\n    }\n    return deferred.promise;\n  } //end of readValues\n  \n\n\n\n  function asyncReadTableHeader(aMmsEid, header){ \n    return $q( function(resolve){\n      readRowValues(header, aMmsEid)\n        .then(function(tableheader) {\n        tableheader.values.shift(); //remove 1st element\n        resolve(tableheader.values);\n      });\n    });\n  } \n\n  function asyncReadTableBody(aMmsEid, tablebody) {\n    return $q( function (resolve){\n      var c3_data = [];\n      var valuesO = [];\n      \n      tablebody.forEach(function(row){\n        readRowValues(row, aMmsEid)\n          .then(function (yyvalue){\n            c3_data.push(yyvalue.values);\n            valuesO.push(yyvalue.valuesO);\n            if ( c3_data.length === tablebody.length) {\n              var r = {\n                c3_data: c3_data,\n                valuesO: valuesO \n              };\n              resolve(r);\n            }\n          });\n      });\n    });\n  }\n\n  function asyncReadTableBody2(aMmsEid, tablebody, tableheader) {\n    return $q( function (resolve){\n\n      var c3_data = [];\n      var valuesO = [];\n\n      //adding \"rowheader\" so length of header and rowvalues will be the same.\n      var mtableheader = tableheader.slice(0);\n      mtableheader.splice(0, 0, \"rowheader\");\n      tablebody.forEach(function(row){\n        readRowValues2(row, aMmsEid, mtableheader)\n          .then(function (yyvalue){\n            c3_data.push(yyvalue.valuesx);\n            valuesO.push(yyvalue.valuesO);\n            if ( valuesO.length === tablebody.length) {\n              var r = {\n                c3_data: c3_data,\n                valuesO: valuesO \n              };\n              resolve(r);\n            }\n          });\n      });\n    });\n  }\n\n  function getValue(datavalue){\n    if (datavalue && datavalue.type === \"LiteralString\"){\n      if ( isNaN(datavalue.value))\n        return datavalue.value;\n      else\n        return Number(datavalue.value);\n    }\n    else if (datavalue && (datavalue.type === \"LiteralReal\" || datavalue.type === \"LiteralInteger\")){\n      return datavalue.value;\n    }\n  } \n  function readParagraphValue(e,aMmsEid, index){\n\n    return $q( function(resolve){\n        if (e.content[0].sourceType == 'text'){\n          //console.log(\"text\");\n          var tv = e.content[0].text.replace(\"<p>\",\"\").replace(\"</p>\",\"\").trim();\n          if ( !isNaN(tv))\n            tv = Number(tv);\n          resolve( { index: index, value: tv, valueO: e});\n        }\n        else if (e.content[0].sourceType === 'reference'){\n          aMmsEid.elementId =e.content[0].source;\n\n          if ( e.content[0].sourceProperty === 'name'){\n            //console.log(\"name\");\n            ElementService.getElement(aMmsEid, 1, false)\n              .then(function(refe) {\n                //value = refe.name;\n                //valueO= refe;\n                var nameModified = refe.name;\n                if ( !isNaN(nameModified)) //means it is a number\n                    nameModified = Number(nameModified);\n                resolve( { index: index, value: nameModified, valueO: refe});\n              });\n          }\n          else if ( e.content[0].sourceProperty === 'documentation'){\n              //console.log(\"doc\");\n              ElementService.getElement(aMmsEid, 1, false)\n                .then(function(refe) {\n                  var docModified = refe.documentation.replace(\"<p>\",\"\").replace(\"</p>\",\"\").trim();\n                  //seems adding \\n at the end when modified at vieweditor so if number goahead to conver to number\n                  //i.e., \"5\\n\" will be a number.\n                  if ( !isNaN(docModified)) //means it is a number\n                    docModified = Number(docModified);\n                  resolve( { index: index, value: docModified, valueO: refe});\n                }); \n          }\n          else { //sourceProperty === 'value'\n              //console.log('value');\n              ElementService.getElement(aMmsEid, 1, false)\n              .then(function(refe) {\n\n                var valueO= refe;\n                var value = \"\";\n                if (refe.type === 'Property' || refe.type === 'Port') {\n                    if (refe.defaultValue) {\n                        value = getValue(refe.defaultValue); //default value\n                    } else {\n                        value= \"\";\n                    }\n                }\n                if (refe.type === 'Slot') {\n                    value = getValue(refe.value[0]); //scope.element.value\n                }\n                /* not sure what to do\n                if (refe.type === 'Constraint' && refe.specification) {\n                    value = refe.specification;\n                }\n                if (refe.type === 'Expression') {\n                    value = refe.operand;\n                }\n                */\n                resolve( { index: index, value: value, valueO: valueO});\n              });\n            }//end of else\n          } //reference\n    });\n  }\n  function readRowValues ( row, aMmsEid ){\n\n    return $q( function (resolve) {\n      var values = [];\n      var valuesO = [];\n      var index = 0;\n      row.forEach(function(e){\n       if (e.content.length === 0){\n          values[index] = null;\n          valuesO[index] = null;\n          index++;\n       }\n       else {\n         if (e.content[0].type == 'Paragraph'){\n            readParagraphValue(e, aMmsEid, index++)\n            .then( function(r){\n              values[r.index] =r.value;\n              valuesO[r.index] = r.valueO;\n              if ( values.length === row.length){\n                var result = {\n                    values: values,\n                    valuesO: valuesO \n                };\n                resolve(result);\n              }\n            });\n          } // Paragraph\n        } //end of else\n      }); //for each row\n    });\n  } //end of function\n  function readRowValues2 (row, aMmsEid, mtableheader){\n\n    return $q( function (resolve) {\n      var valuesx = []; //named index instead of number index\n      var valuesO = [];\n      var index = 0;\n      row.forEach(function(e){\n       if (e.content.length === 0){\n          valuesx[mtableheader[index]] = null;\n          valuesO[index] = null;\n          index++;\n       }\n       else {\n         if (e.content[0].type == 'Paragraph'){\n            readParagraphValue(e, aMmsEid, index++)\n            .then( function(r){\n              valuesx[mtableheader[r.index]] = r.value;\n              valuesO[r.index] = r.valueO;\n              if ( valuesO.length === row.length){\n                var result = {\n                    valuesx: valuesx,\n                    valuesO: valuesO \n                };\n                resolve(result);\n              }\n            });\n          } // Paragraph\n        } //end of else\n      }); //for each row\n    });\n  } //end of function\n //make only a-zA-Z0-9_ because id or class does not support special characters(ie., ())\n    var toValidId = function(original) {\n        return original.replace(/[^a-zA-Z0-9_]/gi, '');\n    };\n\n    /**\n    * @param {Object} clientConfig The size width, height and margin info from magicDraw\n    * @param {Object} defaultPlotConfig The size width, height and margin from the plot directive\n    */\n    var plotConfig = function(clientConfig, defaultPlotConfig){\n      var plotConfig = defaultPlotConfig;\n      if (clientConfig !== undefined){\n        if (clientConfig.size !== undefined) {\n          if( clientConfig.size.width != undefined && !isNaN(clientConfig.size.width))\n              plotConfig.width = Number(clientConfig.size.width);\n          if( clientConfig.size.height != undefined && !isNaN(clientConfig.size.height))\n              plotConfig.height = Number(clientConfig.size.height);\n        }\n        if (clientConfig.padding !== undefined) {\n          if (clientConfig.padding.top != undefined && !isNaN(clientConfig.padding.top))\n            plotConfig.marginTop = Number(clientConfig.padding.top);\n          if (clientConfig.padding.right != undefined && !isNaN(clientConfig.padding.right))\n            plotConfig.marginRight = Number(clientConfig.padding.right);\n          if (clientConfig.padding.left != undefined && !isNaN(clientConfig.padding.left))\n            plotConfig.marginLeft = Number(clientConfig.padding.left);\n          if (clientConfig.padding.bottom != undefined && !isNaN(clientConfig.padding.bottom))\n            plotConfig.marginBottom = Number(clientConfig.padding.bottom);  \n        }\n      }\n      return plotConfig;\n    };\n\n    return {\n        toValidId : toValidId,\n        plotConfig: plotConfig,\n        readvalues: readvalues,  //for row values in number index\n        readvalues2: readvalues2 //for row values with named(header) index\n    };\n\n}\n","'use strict';\n\nangular.module('mms')\n.provider('URLService', function URLServiceProvider() {\n    var baseUrl = '/alfresco/service';\n    var mmsUrl = '';\n    this.setBaseUrl = function(base) {\n        baseUrl = base;\n    };\n    this.setMmsUrl = function(mms) {\n        mmsUrl = mms;\n    };\n    this.$get = [function URLServiceFactory() {\n        return urlService(baseUrl, mmsUrl);\n    }];\n});\n\n/**\n * @ngdoc service\n * @name mms.URLService\n *\n * @description\n * This utility service gives back url paths for use in other services in communicating\n * with the server, arguments like projectId, refId, commitId are expected to be strings and\n * not null or undefined. This service is usually called by higher level services and\n * should rarely be used directly by applications.\n *\n * To configure the base url of the mms server, you can use the URLServiceProvider\n * in your application module's config. By default, the baseUrl is '/alfresco/service'\n * which assumes your application is hosted on the same machine as the mms and ve.\n *  <pre>\n        angular.module('myApp', ['mms'])\n        .config(function(URLServiceProvider) {\n            URLServiceProvider.setBaseUrl('https://url/alfresco/service');\n        });\n    </pre>\n * (You may run into problems like cross origin security policy that prevents it from\n *  actually getting the resources from a different server, solution TBD)\n */\nfunction urlService(baseUrl, mmsUrl) {\n    var root = baseUrl;\n    var mmsServer = mmsUrl;\n    var jobsRoot = 'https://cae-pma-int:8443/';\n    var ticket;\n\n    var getRoot = function() {\n        return root;\n    };\n\n    var setTicket = function(t) {\n        ticket = t;\n    };\n    \n    var getJMSHostname = function(){\n        return root + '/connection/jms';\n    };\n\n    var getMmsServer = function() {\n        return mmsServer;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.URLService#addTicket\n     * @methodOf mms.URLService\n     *\n     * @description\n     * Adds alf_ticket parameter to URL string\n     *\n     * @param {String} url The url string for which to add alf_ticket parameter argument.\n     * @returns {string} The url with alf_ticket parameter added.\n     */\n    var addTicket = function(url) {\n        var r = url;\n        if (!ticket)\n            return r;\n        // if (r.indexOf('commitId') > 0) //TODO check mms cache rules\n        //     return r;\n        if (r.indexOf('?') > 0)\n            r += '&alf_ticket=' + ticket;\n        else\n            r += '?alf_ticket=' + ticket;\n        return r;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.URLService#isTimestamp\n     * @methodOf mms.URLService\n     * \n     * @description\n     * self explanatory\n     *\n     * @param {string} version A version string or timestamp\n     * @returns {boolean} Returns true if the string has '-' in it\n     */\n    var isTimestamp = function(version) {\n        if (!version)\n            return false;\n        if(/^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}.\\d{3}[+]?-\\d{4}$/.test(version.trim()))\n            return true;\n        return false;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.URLService#getMmsVersionURL\n     * @methodOf mms.URLService\n     * \n     * @description\n     * self explanatory\n     *\n     * @returns {object} Returns object with mmsversion\n     */\n    var getMmsVersionURL = function() {\n        return addTicket(root + \"/mmsversion\");\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.URLService#getSiteDashboardURL\n     * @methodOf mms.URLService\n     * \n     * @description\n     * Gets the path for a site dashboard.\n     * \n     * @param {string} site Site name (not title!).\n     * @returns {string} The path for site dashboard.\n     */\n    var getSiteDashboardURL = function(site) {\n        return addTicket(\"/share/page/site/\" + site + \"/dashboard\");\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.URLService#getExportHtmlUrl\n     * @methodOf mms.URLService\n     *\n     * @description\n     * Gets url that to convert HTML to PDF or Word\n     * @param {string} projectId id of the project\n     * @param {string} refId id of the ref\n     * @returns {string} The url\n     */\n    var getExportHtmlUrl = function(projectId, refId) {\n        return addTicket(root + \"/projects/\" + projectId +\n          \"/refs/\" + refId + '/convert');\n      };\n\n    /**\n     * @ngdoc method\n     * @name mms.URLService#getCheckLoginURL\n     * @methodOf mms.URLService\n     *\n     * @description\n     * Gets url that checks the login\n     *\n     * @returns {string} The url\n     */\n    var getCheckLoginURL = function() {\n        return root + \"/checklogin\";\n    };\n\n    var getOrgURL = function(orgId) {\n        return addTicket(root + '/orgs/' + orgId);\n    };\n    \n    var getOrgsURL = function() {\n        return addTicket(root + \"/orgs\");\n    };\n\n    var getProjectsURL = function(orgId) {\n        if (orgId)\n            return addTicket(root + \"/orgs/\" + orgId + '/projects');\n        return addTicket(root + '/projects');\n    };\n\n    var getProjectURL = function(projectId) {\n        return addTicket(root + \"/projects/\" + projectId);\n    };\n\n    var getProjectMountsURL = function(projectId, refId) {\n        return addTicket(root + '/projects/' + projectId + '/refs/' + refId + '/mounts');\n    };\n\n    var getRefsURL = function(projectId) {\n        return addTicket(root + '/projects/' + projectId + '/refs');\n    };\n\n    var getRefURL = function(projectId, refId) {\n        return addTicket(root + '/projects/' + projectId + '/refs/' + refId);\n    };\n\n    var getRefHistoryURL = function(projectId, refId, timestamp) {\n        if (timestamp !== '' && isTimestamp(timestamp)) {\n            return addTicket(root + '/projects/' + projectId + '/refs/' + refId + '/commits') + '&maxTimestamp=' + timestamp + '&limit=1';\n        }\n        return addTicket(root + '/projects/' + projectId + '/refs/' + refId + '/commits');\n    };\n\n    var getGroupsURL = function(projectId, refId) {\n        return addTicket(root + '/projects/' + projectId + '/refs/' + refId + '/groups');\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.URLService#getSiteProductsURL\n     * @methodOf mms.URLService\n     *\n     * @description\n     * Gets the url for all documents in a ref\n     *\n     * @param {object} reqOb object with keys as described in ElementService.\n     * @returns {string} The url\n     */\n    var getProjectDocumentsURL = function(reqOb) {\n        var r = root + \"/projects/\" + reqOb.projectId + \n                      \"/refs/\" + reqOb.refId + \n                      \"/documents\";\n        return addExtended(addTicket(addVersion(r, reqOb.commitId)), reqOb.extended);\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.URLService#getImageURL\n     * @methodOf mms.URLService\n     * \n     * @description\n     * Gets the url for querying an image url\n     * (this is not the actual image path)\n     * \n     * @returns {string} The path for image url queries.\n     */\n    var getImageURL = function(reqOb) {\n        var r = root + '/projects/' + reqOb.projectId + '/refs/' + reqOb.refId + '/elements/' +\n                       reqOb.elementId;\n        return addTicket(addVersion(r, reqOb.commitId));\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.URLService#getElementURL\n     * @methodOf mms.URLService\n     * \n     * @description\n     * Gets the path for an element\n     *\n     * @param {object} reqOb object with keys as described in ElementService.\n     * @returns {string} The url.\n     */\n    var getElementURL = function(reqOb) {\n        var r = root + '/projects/' + reqOb.projectId + '/refs/' + reqOb.refId + '/elements/' + reqOb.elementId;\n        return addExtended(addTicket(addVersion(r, reqOb.commitId)), reqOb.extended);\n    };\n\n    var getViewElementIdsURL = function(reqOb) {\n        var r = root + '/projects/' + reqOb.projectId + '/refs/' + reqOb.refId + '/elements/' + reqOb.elementId + '/cfids';\n        return addTicket(r);\n    };\n\n    var getOwnedElementURL = function(reqOb) {\n        var recurseString = 'recurse=true';\n        if (reqOb.depth)\n            recurseString = 'depth=' + reqOb.depth;\n        var r = root + '/projects/' + reqOb.projectId + '/refs/' + reqOb.refId + '/elements/' + reqOb.elementId;\n        r = addVersion(r, reqOb.commitId);\n        if (r.indexOf('?') > 0) {\n            r += '&' + recurseString;\n        } else {\n            r += '?' + recurseString;\n        }\n        return addTicket(addExtended(r, reqOb.extended));\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.URLService#getDocumentViewsURL\n     * @methodOf mms.URLService\n     * \n     * @description\n     * Gets the url to get all views in a document\n     *\n     * @param {object} reqOb object with keys as described in ElementService.\n     * @returns {string} The url.\n     */\n    var getDocumentViewsURL = function(reqOb) {\n        var r = root + \"/projects/\" + reqOb.projectId + \"/refs/\" + reqOb.refId + \n            '/documents/' + reqOb.elementId + \"/views\";\n        r = addVersion(r, reqOb.commitId);\n        return addExtended(addTicket(r), reqOb.extended);\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.URLService#getElementVersionsURL\n     * @methodOf mms.URLService\n     * \n     * @description\n     * Gets the url to query for element history\n     *\n     * @param {object} reqOb object with keys as described in ElementService.\n     * @returns {string} The url.\n     */\n    var getElementHistoryURL = function(reqOb) {\n        return addTicket(root + '/projects/' + reqOb.projectId + '/refs/' + reqOb.refId + '/elements/' + reqOb.elementId + '/commits');\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.URLService#getPostElementsURL\n     * @methodOf mms.URLService\n     * \n     * @description\n     * Gets the path for posting element changes.\n     *\n     * @param {object} reqOb object with keys as described in ElementService.\n     * @returns {string} The post elements url.\n     */\n    var getPostElementsURL = function(reqOb) {\n        return addExtended(addChildViews(addTicket(root + '/projects/' + reqOb.projectId + '/refs/' + reqOb.refId + '/elements'), reqOb.returnChildViews), reqOb.extended);\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.URLService#getPutElementsURL\n     * @methodOf mms.URLService\n     * \n     * @description\n     * Gets the path for getting multiple elements (using put with body).\n     *\n     * @param {object} reqOb object with keys as described in ElementService.\n     * @returns {string} The post elements url.\n     */\n    var getPutElementsURL = function(reqOb) {\n        var r = root + '/projects/' + reqOb.projectId + '/refs/' + reqOb.refId + '/elements';\n        return addExtended(addTicket(addVersion(r, reqOb.commitId)), reqOb.extended);\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.URLService#getElementSearchURL\n     * @methodOf mms.URLService\n     * \n     * @description\n     * Gets the url for element keyword search.\n     *\n     * @param {object} reqOb object with keys as described in ElementService.\n     * @returns {string} The post elements url.\n     */\n    var getElementSearchURL = function(reqOb) {\n        var r = root + '/projects/' + reqOb.projectId + '/refs/' + reqOb.refId + '/search' + (reqOb.checkType ? '?checkType=true' : '');\n        return addExtended(addTicket(r), true);\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.URLService#getSearchURL\n     * @methodOf mms.URLService\n     * \n     * @description\n     * Gets the url for default search. Can optionally provide query parameters\n     * i.e. `checkType=true&literal=true`\n     *\n     * @param {string} projectId Project Id\n     * @param {string} refId Ref Id\n     * @param {string} urlParams provide optional query parameters\n     * @returns {string} The url with ticket\n     */\n    var getSearchURL = function(projectId, refId, urlParams) {\n        var r;\n        if (urlParams !== null || urlParams !== ''){\n            // ie '/search?checkType=true&literal=true';\n            r = root + '/projects/' + projectId + '/refs/' + refId + '/search?' + urlParams;\n        } else {\n            r = root + '/projects/' + projectId + '/refs/' + refId + '/search';\n        }\n        return addTicket(r);\n    };\n\n    /**\n     * @ngdocs method\n     * @name mms.URLService#getArtifactURL\n     * @methodOf mms.URLService\n     * \n     * @description\n     * Gets the url for an artifact\n     * \n     * @param {object} reqOb object with keys\n     * @returns {string} url\n     */\n    var getArtifactURL = function(reqOb) {\n        var r = root + '/projects/' + reqOb.projectId + '/refs/' + reqOb.refId + '/artifacts/' + reqOb.artifactId;\n        return addTicket(addVersion(r, reqOb.commitId));\n    };\n\n    /**\n     * @ngdocs method\n     * @name mms.URLService#getPutArtifactsURL\n     * @methodOf mms.URLService\n     * \n     * @description\n     * Gets the url for an artifact\n     * \n     * @param {object} reqOb object with keys\n     * @returns {string} url\n     */\n    var getPutArtifactsURL = function(reqOb) {\n        var r = root + '/projects/' + reqOb.projectId + '/refs/' + reqOb.refId + '/artifacts';\n        return addTicket(addVersion(r, reqOb.commitId));\n    };\n\n    /**\n     * @ngdocs method\n     * @name mms.URLService#getArtifactHistoryURL\n     * @methodOf mms.URLService\n     * \n     * @description\n     * Gets the url for an artifact commit history\n     * \n     * @param {object} reqOb object with keys\n     * @returns {string} url\n     */\n    var getArtifactHistoryURL = function(reqOb) {\n        var r = root + '/projects/' + reqOb.projectId + '/refs/' + reqOb.refId + '/artifacts/' + reqOb.artifactId + '/commits';\n        return addTicket(r);\n    };\n\n    var setJobsUrl = function(jobUrl) {\n        jobsRoot = jobUrl + ':8443/';\n    };\n\n    var getJobsURL = function(projectId, refId, machine) {\n        return addTicket( addServer(jobsRoot + 'projects/'+ projectId + '/refs/' + refId + '/jobs', machine) );\n    };\n\n    var getJobURL = function(projectId, refId, jobId, machine){\n        return addTicket( addServer(jobsRoot + 'projects/'+ projectId + '/refs/' + refId + '/jobs/' + jobId , machine) );\n    };\n\n    var getRunJobURL = function(projectId, refId, jobId) {\n        return jobsRoot + 'projects/'+ projectId + '/refs/' + refId + '/jobs/' + jobId + '/instances';\n    };\n    \n    var getCreateJobURL = function(projectId, refId) {\n        return jobsRoot + 'projects/'+ projectId + '/refs/' + refId + '/jobs';\n    };\n\n    var getJobInstancesURL = function(projectId, refId, jobId, machine) {\n        return addTicket( addServer(jobsRoot + 'projects/'+ projectId + '/refs/' + refId + '/jobs/' + jobId + '/instances', machine) );\n    };\n\n    var getLogoutURL = function() {\n        return addTicket(root + '/api/login/ticket/' + ticket);\n    };\n\n    var getCheckTicketURL = function(t) {\n        return root + '/mms/login/ticket/' + t; //TODO remove when server returns 404\n    };\n\n        /**\n     * @ngdoc method\n     * @name mms.URLService#handleHttpStatus\n     * @methodOf mms.URLService\n     * \n     * @description\n     * Utility for setting the state of a deferred object based on the status\n     * of http error. The arguments are the same as angular's $http error \n     * callback\n     * \n     * @param {Object} data The http response\n     * @param {number} status Http return status\n     * @param {Object} header Http return header\n     * @param {Object} config Http config\n     * @param {Object} deferred A deferred object that would be rejected \n     *      with this object based on the http status: \n     *      ```\n     *          {\n     *              status: status,\n     *              message: http status message,\n     *              data: data\n     *          }\n     *      ```\n     */\n    var handleHttpStatus = function(data, status, header, config, deferred) {\n        var result = {status: status, data: data};\n        if (status === 404)\n            result.message = \"Not Found\";\n        else if (status === 500) {\n            if (angular.isString(data) && data.indexOf(\"ENOTFOUND\") >= 0)\n                result.message = \"Network Error (Please check network)\";\n            else\n                result.message = \"Server Error\";\n        } else if (status === 401 || status === 403)\n            result.message = \"Permission Error\";\n        else if (status === 409)\n            result.message = \"Conflict\";\n        else if (status === 400)\n            result.message = \"Bad Request\";\n        else if (status === 410)\n            result.message = \"Deleted\";\n        else if (status === 408)\n            result.message = \"Timed Out\";\n        else if (status === 501) {\n            result.message = \"Cacheing\";\n        } else\n            result.message = \"Timed Out (Please check network)\";\n        deferred.reject(result);\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.URLService#addServer\n     * @methodOf mms.URLService\n     *\n     * @description\n     * Adds mmsServer parameter to URL string, mainly used for PMA jobs\n     *\n     * @param {String} url The url string for which to add mmsServer parameter argument.\n     * @param {String} server The mms server url for where elements are stored\n     * @returns {string} The url with server parameter added.\n     */\n    var addServer = function(url, server) {\n        if (url.indexOf('?') > 0)\n            return url + '&mmsServer=' + server;\n        else\n            return url + '?mmsServer=' + server;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.URLService#addVersion\n     * @methodOf mms.URLService\n     *\n     * @description\n     * Adds commitId parameter to URL string\n     *\n     * @param {String} url The url string for which to add version parameter argument.\n     * @param {String} version The commit id\n     * @returns {string} The url with commitId parameter added.\n     */\n    var addVersion = function(url, version) {\n        if (version === 'latest')\n            return url;\n        else if (version) {\n            if (url.indexOf('?') > 0)\n                return url + '&commitId=' + version;\n            else\n                return url + '?commitId=' + version;\n        } \n        return url;\n    };\n\n    var addExtended = function(url, extended) {\n        var r = url;\n        if (!extended)\n            return r;\n        if (r.indexOf('?') > 0)\n            r += '&extended=true';\n        else\n            r += '?extended=true';\n        return r;\n    };\n\n    var addChildViews = function(url, add) {\n        var r = url;\n        if (!add)\n            return r;\n        if (r.indexOf('?') > 0)\n            r += '&childviews=true';\n        else\n            r += '?childviews=true';\n        return r;\n    };\n\n\n    return {\n        getRoot: getRoot,\n        setTicket: setTicket,\n        getJMSHostname: getJMSHostname,\n        getMmsServer: getMmsServer,\n        isTimestamp: isTimestamp,\n        getMmsVersionURL: getMmsVersionURL,\n        getSiteDashboardURL: getSiteDashboardURL,\n        getOrgURL: getOrgURL,\n        getOrgsURL: getOrgsURL,\n        getProjectsURL: getProjectsURL,\n        getProjectURL: getProjectURL,\n        getProjectMountsURL: getProjectMountsURL,\n        getRefsURL: getRefsURL,\n        getRefURL: getRefURL,\n        getRefHistoryURL: getRefHistoryURL,\n        getGroupsURL: getGroupsURL,\n        getElementURL: getElementURL,\n        getViewElementIdsURL: getViewElementIdsURL,\n        getPutElementsURL: getPutElementsURL,\n        getPostElementsURL: getPostElementsURL,\n        getOwnedElementURL: getOwnedElementURL,\n        getElementHistoryURL: getElementHistoryURL,\n        getElementSearchURL: getElementSearchURL,\n        getSearchURL: getSearchURL,\n        getProjectDocumentsURL: getProjectDocumentsURL,\n        getDocumentViewsURL: getDocumentViewsURL,\n        getImageURL: getImageURL,\n        getExportHtmlUrl: getExportHtmlUrl,\n        getArtifactURL: getArtifactURL,\n        getPutArtifactsURL: getPutArtifactsURL,\n        getArtifactHistoryURL: getArtifactHistoryURL,\n        setJobsUrl: setJobsUrl,\n        getJobsURL: getJobsURL,\n        getJobURL: getJobURL,\n        getRunJobURL: getRunJobURL,\n        getCreateJobURL: getCreateJobURL,\n        getJobInstancesURL: getJobInstancesURL,\n        getCheckLoginURL: getCheckLoginURL,\n        getCheckTicketURL: getCheckTicketURL,\n        getLogoutURL: getLogoutURL,\n        handleHttpStatus: handleHttpStatus,\n    };\n\n}","'use strict';\n\nangular.module('mms')\n.factory('UtilsService', ['$q', '$http', 'CacheService', 'URLService', 'ApplicationService', '_', UtilsService]);\n\n/**\n * @ngdoc service\n * @name mms.UtilsService\n * @requires $q\n * @requires $http\n * @requires CacheService\n * @requires URLService\n * @requires ApplicationService\n * @requires _\n * \n * @description\n * Utilities\n */\nfunction UtilsService($q, $http, CacheService, URLService, ApplicationService, _) {\n    var PROJECT_URL_PREFIX = 'mms.html#/projects/';\n    var VIEW_SID = '_11_5EAPbeta_be00301_1147420760998_43940_227';\n    var OTHER_VIEW_SID = ['_17_0_1_407019f_1332453225141_893756_11936',\n        '_17_0_1_232f03dc_1325612611695_581988_21583', '_18_0beta_9150291_1392290067481_33752_4359'];\n    var DOCUMENT_SID = '_17_0_2_3_87b0275_1371477871400_792964_43374';\n    var BLOCK_SID = '_11_5EAPbeta_be00301_1147424179914_458922_958';\n    var REQUIREMENT_SID = ['_project-bundle_mission_PackageableElement-mission_u003aRequirement_PackageableElement',\n        '_18_0_5_f560360_1476403587924_687681_736366','_18_0_5_f560360_1476403587924_687681_736366',\n        '_11_5EAPbeta_be00301_1147873190330_159934_2220'];\n    var editKeys = ['name', 'documentation', 'defaultValue', 'value', 'specification', 'id', '_projectId', '_refId', 'type'];\n    var CLASS_ELEMENT_TEMPLATE = {\n        _appliedStereotypeIds: [],\n        appliedStereotypeInstanceId: null,\n        classifierBehaviorId: null,\n        clientDependencyIds: [],\n        collaborationUseIds: [],\n        documentation: \"\",\n        elementImportIds: [],\n        generalizationIds: [],\n        interfaceRealizationIds: [],\n        isAbstract: false,\n        isActive: false,\n        isFinalSpecialization: false,\n        isLeaf: false,\n        mdExtensionsIds: [],\n        name: \"\",\n        nameExpression: null,\n        ownedAttributeIds: [],\n        ownedOperationIds: [],\n        ownerId: null,\n        packageImportIds: [],\n        powertypeExtentIds: [],\n        redefinedClassifierIds: [],\n        representationId: null,\n        substitutionIds: [],\n        supplierDependencyIds: [],\n        syncElementId: null,\n        templateBindingIds: [],\n        templateParameterId: null,\n        type: \"Class\",\n        useCaseIds: [],\n        visibility: 'public'\n    };\n    var INSTANCE_ELEMENT_TEMPLATE = {\n        appliedStereotypeInstanceId: null,\n        classifierIds: [],\n        clientDependencyIds: [],\n        deploymentIds: [],\n        documentation: '',\n        mdExtensionsIds: [],\n        name: '',\n        nameExpression: null,\n        ownerId: null,\n        slotIds: [],\n        specification: null,\n        stereotypedElementId: null,\n        supplierDependencyIds: [],\n        syncElementId: null,\n        templateParameterId: null,\n        type: \"InstanceSpecification\",\n        visibility: \"public\",\n        _appliedStereotypeIds: [],\n    };\n    var VALUESPEC_ELEMENT_TEMPLATE = {\n        appliedStereotypeInstanceId: null,\n        clientDependencyIds: [ ],\n        documentation: \"\",\n        mdExtensionsIds: [ ],\n        name: \"\",\n        nameExpression: null,\n        supplierDependencyIds: [ ],\n        syncElementId: null,\n        templateParameterId: null,\n        typeId: null,\n        visibility: \"public\",\n        _appliedStereotypeIds: [ ],\n    };\n    var PACKAGE_ELEMENT_TEMPLATE = {\n        _appliedStereotypeIds : [ ],\n        documentation : \"\",\n        type : \"Package\",\n        mdExtensionsIds : [ ],\n        syncElementId : null,\n        appliedStereotypeInstanceId : null,\n        clientDependencyIds : [ ],\n        supplierDependencyIds : [ ],\n        name : \"\",\n        nameExpression : null,\n        visibility : null,\n        templateParameterId : null,\n        elementImportIds : [ ],\n        packageImportIds : [ ],\n        templateBindingIds : [ ],\n        URI : \"\",\n        packageMergeIds : [ ],\n        profileApplicationIds : [ ]\n    };\n    var GENERALIZATION_ELEMENT_TEMPLATE = {\n        appliedStereotypeInstanceId : null,\n        documentation : \"\",\n        generalizationSetIds : [ ],\n        isSubstitutable : true,\n        mdExtensionsIds : [ ],\n        syncElementId : null,\n        type : \"Generalization\",\n        _appliedStereotypeIds : [ ],\n    };\n    var DEPENDENCY_ELEMENT_TEMPLATE = {\n        _appliedStereotypeIds : [ ],\n        appliedStereotypeInstanceId : null,\n        clientDependencyIds : [ ],\n        documentation : \"\",\n        mdExtensionsIds : [ ],\n        name : \"\",\n        nameExpression : null,\n        supplierDependencyIds : [ ],\n        syncElementId : null,\n        templateParameterId : null,\n        type : \"Dependency\",\n        visibility : null,\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#hasCircularReference\n     * @methodOf mms.UtilsService\n     *\n     * @description\n     * Tells whether or not there exists a circular reference\n     *\n     * @param {Object} scope scope\n     * @param {string} curId current id\n     * @param {string} curType current type\n     * @returns {boolean} true or false\n     */\n    var hasCircularReference = function(scope, curId, curType) {\n        var curscope = scope;\n        while (curscope.$parent) {\n            var parent = curscope.$parent;\n            if (parent.mmsElementId === curId && parent.cfType === curType)\n                return true;\n            curscope = parent;\n        }\n        return false;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#cleanValueSpec\n     * @methodOf mms.UtilsService\n     *\n     * @description\n     * Cleans value specification\n     *\n     * @param {Object} vs value spec object\n     * @returns {void} nothing\n     */\n    var cleanValueSpec = function(vs) {\n        if (vs.hasOwnProperty('valueExpression'))\n            delete vs.valueExpression;\n        if (vs.operand) {\n            for (var i = 0; i < vs.operand.length; i++) {\n                cleanValueSpec(vs.operand[i]);\n            }\n        }\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#cleanElement\n     * @methodOf mms.UtilsService\n     * \n     * @description\n     * Cleans \n     *\n     * @param {Object} elem the element object to be cleaned \n     * @param {boolean} [forEdit=false] (optional) forEdit.\n     * @returns {Object} clean elem\n     */\n    var cleanElement = function(elem, forEdit) {\n        var i = 0;\n        if (elem.type === 'Property' || elem.type === 'Port') {\n            if (!elem.defaultValue) {\n                elem.defaultValue = null;\n            }\n        }\n        if (elem.type === 'Slot') {\n            if (!_.isArray(elem.value))\n                elem.value = [];\n        }\n        if (elem.value) {\n            for (i = 0; i < elem.value.length; i++) {\n                cleanValueSpec(elem.value[i]);\n            }\n        }\n        if (elem._contents) {\n            cleanValueSpec(elem._contents);\n        }\n        if (elem.specification) {\n            cleanValueSpec(elem.specification);\n        }\n        if (elem.type === 'Class') {\n            if (elem._contents && elem.contains) {\n                delete elem.contains;\n            }\n            if (Array.isArray(elem._displayedElementIds)) {\n                elem._displayedElementIds = JSON.stringify(elem._displayedElementIds);\n            }\n            if (elem._allowedElementIds) {\n                delete elem._allowedElementIds;\n            }\n        }\n        if (elem.hasOwnProperty('specialization')) {\n            delete elem.specialization;\n        }\n        if (forEdit) { //only keep editable or needed keys in edit object instead of everything\n            var keys = Object.keys(elem);\n            for (i in keys) {\n                if (editKeys.indexOf(keys[i]) >= 0) {\n                    continue;\n                }\n                delete elem[keys[i]];\n            }\n        }\n        return elem;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#buildTreeHierarchy\n     * @methodOf mms.UtilsService\n     *\n     * @description\n     * builds hierarchy of tree branch objects\n     *\n     * @param {array} array array of objects\n     * @param {string} id key of id field\n     * @param {string} type type of object\n     * @param {object} parent key of parent field\n     * @param {callback} level2_Func function to get childen objects\n     * @returns {void} root node\n     */\n    var buildTreeHierarchy = function (array, id, type, parent, level2_Func) {\n        var rootNodes = [];\n        var data2Node = {};\n        var i = 0;\n        var data = null;\n        // make first pass to create all nodes\n        for (i = 0; i < array.length; i++) {\n            data = array[i];\n            data2Node[data[id]] = { \n                label : data.name, \n                type : type,\n                data : data, \n                children : [] \n            };\n        }\n        // make second pass to associate data to parent nodes\n        for (i = 0; i < array.length; i++) {\n            data = array[i];\n            // If theres an element in data2Node whose key matches the 'parent' value in the array element\n            // add the array element to the children array of the matched data2Node element\n            if (data[parent] && data2Node[data[parent]]) {//bad data!\n                data2Node[data[parent]].children.push(data2Node[data[id]]);\n            } else {\n            // If theres not an element in data2Node whose key matches the 'parent' value in the array element\n            // it's a \"root node\" and so it should be pushed to the root nodes array along with its children\n                rootNodes.push(data2Node[data[id]]);\n            }\n        }\n\n        //apply level2 function if available\n        if (level2_Func) {\n            for (i = 0; i < array.length; i++) {\n                data = array[i];\n                var level1_parentNode = data2Node[data[id]];\n                level2_Func(data, level1_parentNode);\n            }\n        }\n\n        var sortFunction = function(a, b) {\n            if (a.children.length > 1) {\n                a.children.sort(sortFunction);\n            }\n            if (b.children.length > 1) {\n                b.children.sort(sortFunction);\n            }\n            if (a.label.toLowerCase() < b.label.toLowerCase()) {\n                return -1;\n            }\n            if (a.label.toLowerCase() > b.label.toLowerCase()) {\n                return 1;\n            }\n            return 0;\n        };\n        rootNodes.sort(sortFunction);\n        return rootNodes;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#normalize\n     * @methodOf mms.UtilsService\n     * \n     * @description\n     * Normalize common arguments\n     *\n     * @param {Object} ob Object with update, workspace, version keys\n     * @returns {Object} object with update, ws, ver keys based on the input.\n     *      default values: {update: false, ws: 'master', ver: 'latest'}\n     */\n    var normalize = function(reqOb) {\n        reqOb.extended = !reqOb.extended ? false : true;\n        reqOb.refId = !reqOb.refId ? 'master' : reqOb.refId;\n        reqOb.commitId = !reqOb.commitId ? 'latest' : reqOb.commitId;\n        return reqOb;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#makeElementKey\n     * @methodOf mms.UtilsService\n     * \n     * @description\n     * Make key for element for use in CacheService\n     *\n     * @param {string} elementOb element object\n     * @param {boolean} [edited=false] element is to be edited\n     * @returns {Array} key to be used in CacheService\n     */\n    var makeElementKey = function(elementOb, edit) {\n        var refId = !elementOb._refId ? 'master' : elementOb._refId;\n        var commitId = !elementOb._commitId ? 'latest' : elementOb._commitId;\n        var key = ['element', elementOb._projectId, refId, elementOb.id, commitId];\n        if (edit)\n            key.push('edit');\n        return key;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#makeArtifactKey\n     * @methodOf mms.UtilsService\n     * \n     * @description\n     * Make key for element for use in CacheService\n     *\n     * @param {string} elementOb element object\n     * @param {boolean} [edited=false] element is to be edited\n     * @returns {Array} key to be used in CacheService\n     */\n    var makeArtifactKey = function(elementOb, edit) {\n        var refId = !elementOb._refId ? 'master' : elementOb._refId;\n        var commitId = !elementOb._commitId ? 'latest' : elementOb._commitId;\n        var key = ['artifact', elementOb._projectId, refId, elementOb.id, commitId];\n        if (edit)\n            key.push('edit');\n        return key;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#mergeElement\n     * @methodOf mms.UtilsService\n     * \n     * @description\n     * Make key for element for use in CacheService\n     *\n     * @param {object} source the element object to merge in \n     * @param {boolean} [updateEdit=false] updateEdit\n     * @returns {void} nothing \n     */\n    var mergeElement = function(source, updateEdit) {\n        //TODO remove calls to this, shoudl use ElementService.cacheElement\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#filterProperties\n     * @methodOf mms.UtilsService\n     * \n     * @description\n     * given element object a and element object b,\n     * returns new object with b data minus keys not in a \n     * (set notation A intersect B)\n     *\n     * @param {Object} a Element Object\n     * @param {Object} b Element Object\n     * @returns {Object} new object\n     */\n    var filterProperties = function(a, b) {\n        var res = {};\n        for (var key in a) {\n            if (a.hasOwnProperty(key) && b.hasOwnProperty(key)) {\n                res[key] = b[key];\n            }\n        }\n        return res;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#hasConflict\n     * @methodOf mms.UtilsService\n     * \n     * @description\t\t\n     *  Checks if sever and cache version of the element are\n     *  the same so that the user is aware that they are overriding \n     *  changes to the element that they have not seen in the cache element.\n     *  Given edit object with only keys that were edited,\n     * 'orig' object and 'server' object, should only return true \n     *\tif key is in edit object and value in orig object is different \n     *  from value in server object. \n     *\n     * @param {Object} edit An object that contains element id and any property changes to be saved.\n     * @param {Object} orig version of elem object in cache.\n     * @param {Object} server version of elem object from server.\n     * @returns {Boolean} true if conflict, false if not\n     */\n    var hasConflict = function(edit, orig, server) {\n        for (var i in edit) {\n            if (i === '_read' || i === '_modified' || i === '_modifier' || \n                    i === '_creator' || i === '_created' || i === '_commitId') {\n                continue;\n            }\n            if (edit.hasOwnProperty(i) && orig.hasOwnProperty(i) && server.hasOwnProperty(i)) {\n                if (!angular.equals(orig[i], server[i])) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#isRestrictedValue\n     * @methodOf mms.UtilsService\n     *\n     * @description\n     * deprecated\n     *\n     * @param {string} table table content\n     * @returns {boolean} boolean\n     */\n    function isRestrictedValue(values) {\n        if (values.length > 0 && values[0].type === 'Expression' &&\n                values[0].operand.length === 3 && values[0].operand[0].value === 'RestrictedValue' &&\n                values[0].operand[2].type === 'Expression' && values[0].operand[2].operand.length > 0 &&\n                values[0].operand[1].type === 'ElementValue') {\n            return true;\n        }\n        return false;\n    }\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#makeHtmlTable\n     * @methodOf mms.UtilsService\n     *\n     * @description\n     * make html table based on table spec object\n     *\n     * @param {object} table table content\n     * @param {boolean} isFilterable table content\n     * @param {boolean} isSortable table content\n     * @returns {string} generated html string\n     */\n    var makeHtmlTable = function(table, isFilterable, isSortable, pe) {\n        var result = ['<table class=\"table-bordered table-condensed ' + (table.style ? table.style : '') + '\">'];\n        if (table.colwidths && table.colwidths.length > 0) {\n            result.push('<colgroup>');\n            for (var i = 0; i < table.colwidths.length; i++) {\n                if (table.colwidths[i]) {\n                    result.push('<col style=\"width: ' + table.colwidths[i] + '\">');\n                } else {\n                    result.push('<col>');\n                }\n            }\n            result.push('</colgroup>');\n        }\n        result.push('<tbody>'); //put tbody before thead to control stacking context so if freeze header/columns are both used headers cover cells (?)\n        //https://stackoverflow.com/questions/45676848/stacking-context-on-table-elementhead-and-body\n        result.push(makeTableBody(table.body, false));\n        result.push('</tbody>');\n        if (table.header && table.header.length) {\n            // only add styling to the filterable or sortable header\n            if ( isFilterable || isSortable ) {\n                result.push('<thead class=\"doc-table-header\" >');\n            } else {\n                result.push('<thead>');\n            }\n\n            result.push(makeTableBody(table.header, true, isFilterable, isSortable));\n            result.push('</thead>');\n        }\n        if (ApplicationService.getState().inDoc && !table.excludeFromList) {\n            result.push('<caption>Table {{mmsPe._veNumber}}. {{table.title || mmsPe.name}}</caption>');\n        } else if (table.title) {\n            result.push('<caption>' + table.title + '</caption>');\n        } //same for caption to control stacking context\n        result.push('</table>');\n        return result.join('');\n    };\n\n    var tableConfig = {\n        sortByColumnFn: 'sortByColumnFn',\n        showBindingForSortIcon: 'sortColumnNum',\n        filterDebounceRate: 200,\n        filterTermColumnPrefixBinding: 'filterTermForColumn'\n    };\n\n    /** Include row and column number for table's header data object **/\n    var _generateRowColNumber = function(header) {\n      header.forEach(function (row, rowIndex) {\n          var startCol = 0;\n          var colCounter = 0;\n          row.forEach(function (cell, cellIndex) {\n              // startCol is always 0 except when row > 0th and on cell === 0th && rowSpan of the previous row's first element is larger than 1\n              // This is the only time when we need to offset the starting colNumber for cells under merged column(s)\n              if ( rowIndex !== 0 && cellIndex === 0 && Number(header[rowIndex - 1][0].rowspan) > 1 ) {\n                  startCol = Number(header[rowIndex - 1][0].colspan);\n              }\n              var colSpan = Number(cell.colspan);\n              cell.startRow = rowIndex;\n              cell.endRow = cell.startRow + Number(cell.rowspan) - 1;\n              cell.startCol = startCol + colCounter;\n              cell.endCol = cell.startCol +  colSpan - 1;\n              colCounter += colSpan;\n          });\n          startCol = 0;\n          colCounter = 0;\n      });\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#makeTableBody\n     * @methodOf mms.UtilsService\n     *\n     * @description\n     * make html table body based on body spec object\n     *\n     * @param {object} body body content\n     * @param {boolean} isHeader is header\n     * @param {boolean} isFilterable is filterable\n     * @param {boolean} isSortable is sortable\n     * @returns {string} generated html string\n     */\n    var makeTableBody = function(body, isHeader, isFilterable, isSortable) {\n        if ( isHeader && (isFilterable || isSortable ) ) {\n            _generateRowColNumber(body);\n        }\n        var result = [], i, j, k, row, cell, thing;\n        var dtag = (isHeader ? 'th' : 'td');\n        for (i = 0; i < body.length; i++) {\n            result.push('<tr>');\n            row = body[i];\n            for (j = 0; j < row.length; j++) {\n                cell = row[j];\n                result.push('<' + dtag + ' colspan=\"' + cell.colspan + '\" rowspan=\"' + cell.rowspan + '\">');\n                for (k = 0; k < cell.content.length; k++) {\n                    thing = cell.content[k];\n                    if ( isFilterable || isSortable ) {\n                        result.push('<div ng-style=\"{display: \\'inline\\'}\">');\n                    } else {\n                        result.push('<div>');\n                    }\n\n                    if (thing.type === 'Paragraph') {\n                        var para = makeHtmlPara(thing);\n                        // add special styling for header's title\n                        if ( ( isFilterable || isSortable ) && thing.sourceType === 'text' ) {\n                            para = para.replace('<p>', '<p ng-style=\"{display: \\'inline\\'}\">' );\n                        }\n                        result.push(para);\n                    } else if (thing.type === 'Table') {\n                        result.push(makeHtmlTable(thing));\n                    } else if (thing.type === 'List') {\n                        result.push(makeHtmlList(thing));\n                    } else if (thing.type === 'Image') {\n                        //todo use mmsCf\n                        result.push('<mms-cf mms-cf-type=\"img\" mms-element-id=\"' + thing.id + '\"></mms-cf>');\n                    }\n                    result.push('</div>');\n                    if ( isHeader ) {\n                        if ( isSortable && Number(cell.colspan) === 1 ) {\n                            result.push('<span' + ' ng-click=\\\"'+ tableConfig.sortByColumnFn + \"(\" + cell.startCol + \")\" + '\\\"' + ' ng-class=\\\"'+ 'getSortIconClass('+ cell.startCol + ')' + '\\\"></span>');\n                        }\n                        if ( isFilterable ) {\n                            result.push('<input class=\"no-print ve-plain-input filter-input\" type=\"text\" placeholder=\"Filter column\"' + ' ng-show=\"showFilter\" ng-model-options=\\\"{debounce: '+ tableConfig.filterDebounceRate  + '}\\\"' + ' ng-model=\\\"' + tableConfig.filterTermColumnPrefixBinding + cell.startCol + cell.endCol + '\\\">');\n                        }\n                    }\n                }\n                result.push('</' + dtag + '>');\n            }\n            result.push('</tr>');\n        }\n        return result.join('');\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#makeHtmlList\n     * @methodOf mms.UtilsService\n     *\n     * @description\n     * make html list string based on list spec object\n     *\n     * @param {object} list list specification object\n     * @returns {string} generated html string\n     */\n    var makeHtmlList = function(list) {\n        var result = [], i, j, item, thing;\n        if (list.ordered)\n            result.push('<ol>');\n        else\n            result.push('<ul>');\n        for (i = 0; i < list.list.length; i++) {\n            item = list.list[i];\n            result.push('<li>');\n            for (j = 0; j < item.length; j++) {\n                thing = item[j];\n                result.push('<div>');\n                if (thing.type === 'Paragraph') {\n                    result.push(makeHtmlPara(thing));\n                } else if (thing.type === 'Table') {\n                    result.push(makeHtmlTable(thing));\n                } else if (thing.type === 'List') {\n                    result.push(makeHtmlList(thing));\n                } else if (thing.type === 'Image') {\n                    result.push('<mms-cf mms-cf-type=\"img\" mms-element-id=\"' + thing.id + '\"></mms-cf>');\n                }\n                result.push('</div>');\n            }\n            result.push('</li>');\n        }\n        if (list.ordered)\n            result.push('</ol>');\n        else\n            result.push('</ul>');\n        return result.join('');\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#makeHtmlPara\n     * @methodOf mms.UtilsService\n     *\n     * @description\n     * make html para string based on para spec object\n     *\n     * @param {object} para paragraph spec object\n     * @returns {string} generated html string\n     */\n    var makeHtmlPara = function(para) {\n        if (para.sourceType === 'text')\n            return para.text;\n        var t = 'doc';\n        var attr = '';\n        if (para.sourceProperty === 'name') {\n            t = 'name';\n        }\n        if (para.sourceProperty === 'value') {\n            t = 'val';\n        }\n        if (para.nonEditable) {\n            attr = ' non-editable=\"' + para.nonEditable + '\"';\n        }\n        //TODO update these to match mmsCF\n        return '<mms-cf mms-cf-type=\"' + t + '\" mms-element-id=\"' + para.source + '\"' + attr + '></mms-cf>';\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#makeHtmlTOCChild\n     * @methodOf mms.UtilsService\n     *\n     * @description\n     * Generates table of contents for the document/views.\n     *\n     * @param {string} tree the root element (document or view)\n     * @returns {string} toc string\n     */\n    var makeHtmlTOC = function (tree) {\n        var result = '<div class=\"toc\"><h1 class=\"header\">Table of Contents</h1>';\n        var root_branch = tree[0].branch;\n        result += makeHtmlTOCChild(root_branch, true);\n        result += '</div>';\n        return result;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#makeHtmlTOCChild\n     * @methodOf mms.UtilsService\n     *\n     * @description\n     * Generates table of contents for the document/views.\n     *\n     * @param {string} child the view to be referenced in the table of content\n     * @param {boolean} skip skip adding li for this branch\n     * @returns {string} toc string\n     */\n    var makeHtmlTOCChild = function(branch, skip) {\n        var result = '';\n        var child;\n        if (!skip) {\n            var anchor = '<a href=#' + branch.data.id + '>';\n            result += '  <li>' + anchor + branch.data._veNumber + ' ' + branch.data.name + '</a>';\n        }\n        var ulAdded = false;\n        for (var i = 0; i < branch.children.length; i++) {\n            child = branch.children[i];\n            if (child.type !== 'view' && child.type !== 'section') {\n                continue;\n            }\n            if (!ulAdded) {\n                result += '<ul>';\n                ulAdded = true;\n            }\n            result += makeHtmlTOCChild(child);\n        }\n        if (ulAdded) {\n            result += '</ul>';\n        }\n        if (!skip) {\n            result += '</li>';\n        }\n        return result;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#makeTablesAndFiguresTOC\n     * @methodOf mms.UtilsService\n     *\n     * @description\n     * Generates a list of tables, figures, and equations. Default uses presentation elements.\n     * `html` param provides option to use html content to generate list. It also appends the\n     * captions to the figures and tables.\n     *\n     * @param {string} tree the document/view to be printed (what is on the left pane)\n     * @param {string} printElement contents to be printed (what is displayed in the center pane)\n     * @param {boolean} live true only if a specific sorting is required\n     * @param {boolean} html whether to generated list of tables and figures using html content, outside of the corresponding PE or not\n     * @returns {object} results\n     */\n    var makeTablesAndFiguresTOC = function(tree, printElement, live, html) {\n        var ob = {\n            tables: '',\n            figures: '',\n            equations: '',\n            tableCount: 0,\n            figureCount: 0,\n            equationCount: 0\n        };\n        var root_branch = tree[0].branch;\n\n        // If both \"Generate List of Tables and Figures\" && \"Use HTML for List of Tables and Figures \" options are checked...\n        if (html) {\n            ob = generateTOCHtmlOption(ob, tree, printElement);\n            // return obHTML;\n        } else {\n            for (var i = 0; i < root_branch.children.length; i++) {\n                makeTablesAndFiguresTOCChild(root_branch.children[i], printElement, ob, live, false);\n            }\n        }\n        ob.tables    = ob.tables.length    ? '<div class=\"tot\"><h1 class=\"header\">List of Tables</h1><ul>'    + ob.tables    + '</ul></div>' : '';\n        ob.figures   = ob.figures.length   ? '<div class=\"tof\"><h1 class=\"header\">List of Figures</h1><ul>'   + ob.figures   + '</ul></div>' : '';\n        ob.equations = ob.equations.length ? '<div class=\"tof\"><h1 class=\"header\">List of Equations</h1><ul>' + ob.equations + '</ul></div>' : '';\n        return ob;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#makeTablesAndFiguresTOCChild\n     * @methodOf mms.UtilsService\n     *\n     * @description\n     * Generates a list of tables, figures, and equations of the none root node of he tree (containment tree on the left pane). It also appends the captions to the figures and tables.\n     *\n     * @param {string} child presentation element\n     * @param {string} printElement contents to be printed (what is displayed in the center pane)\n     * @param {string} ob an object that stores the html list of tables, figures, and equations as well as the counts of those\n     * @param {boolean} live true when user would like to preview numbering in the app\n     * @param {boolean} showRefName the tree hierarchy of the document or view (what is displayed in the left pane)\n     * @returns {void} nothing\n     */\n    var makeTablesAndFiguresTOCChild = function(child, printElement, ob, live, showRefName) {\n        var pe = child.data;\n        var sysmlId = pe.id;\n        var veNumber = pe._veNumber;\n        var prefix = '';\n        var el = printElement.find('#' + sysmlId);\n        var refs = printElement.find('mms-view-link[mms-pe-id=\"' + sysmlId + '\"], mms-view-link[data-mms-pe-id=\"' + sysmlId + '\"]');\n        var cap = '';\n        var name = '';\n        if (child.type === 'table') {\n            //ob.tableCount++;\n            prefix = 'Table ' + veNumber + '. ';\n            var capTbl = el.find('table > caption');\n            name = capTbl.text();\n            if (name !== \"\" && name.indexOf('Table') === 0 && name.split('. ').length > 0) {\n                name = name.substring(name.indexOf(prefix) + prefix.length);\n            } else if (name === \"\") {\n                name = pe.name;\n            }\n            cap = veNumber + '. ' + name;\n            ob.tables += '<li><a href=\"#' + sysmlId + '\">' + cap + '</a></li>';\n            capTbl.html('Table ' + cap);\n            // If caption does not exist, add to html\n            if (capTbl.length === 0) {\n                el.find('table').prepend('<caption>Table ' + cap + '</caption>');\n            }\n            // Change cap value based on showRefName true/false\n            if (!showRefName) {\n                cap = veNumber;\n            }\n            if (!live) {\n                refs.find('a').attr('href', '#' + sysmlId);\n            }\n            refs.filter('[suppress-numbering!=\"true\"]').filter(':not([link-text])').find('a').html('Table ' + cap);\n        }\n        if (child.type === 'figure') {\n            //ob.figureCount++;\n            prefix = 'Figure ' + veNumber + '. ';\n            var capFig = el.find('figure > figcaption');\n            name = capFig.text();\n            if (name !== \"\" && name.indexOf('Figure') === 0 && name.split('. ').length > 0) {\n                name = name.substring(name.indexOf(prefix) + prefix.length);\n            } else if (name === \"\") {\n                name = pe.name;\n            }\n            cap = veNumber + '. ' + name;\n            ob.figures += '<li><a href=\"#' + sysmlId + '\">' + cap + '</a></li>';\n            capFig.html('Figure ' + cap);\n            // If caption does not exist, add to html\n            if (capFig.length === 0) {\n                el.find('img').wrap('<figure></figure>').after('<figcaption>Figure ' + cap + '</figcaption>');\n            }\n            // Change cap value based on showRefName true/false\n            if (!showRefName) {\n                cap = veNumber;\n            }\n            if (!live) {\n                refs.find('a').attr('href', '#' + sysmlId);\n            }\n            refs.filter('[suppress-numbering!=\"true\"]').filter(':not([link-text])').find('a').html('Fig. ' + cap);\n        }\n        if (child.type === 'equation') {\n            //ob.equationCount++;\n            cap = veNumber + '. ' + pe.name;\n            ob.equations += '<li><a href=\"#' + sysmlId + '\">' + cap + '</a></li>';\n            var equationCap = '(' + veNumber + ')';\n            var capEq = el.find('.mms-equation-caption');\n            capEq.html(equationCap);\n            // If caption does not exist, add to html\n            if (capEq.length === 0) {\n                el.find('mms-view-equation > mms-cf > mms-transclude-doc > p').last().append('<span class=\"mms-equation-caption pull-right\">' + equationCap + '</span>');\n            }\n            if (!live) {\n                refs.find('a').attr('href', '#' + sysmlId);\n            }\n            refs.filter('[suppress-numbering!=\"true\"]').filter(':not([link-text])').find('a').html('Eq. ' + equationCap);\n        }\n        for (var i = 0; i < child.children.length; i++) {\n            makeTablesAndFiguresTOCChild(child.children[i], printElement, ob, live, showRefName);\n        }\n    };\n\n    var addLiveNumbering = function(pe, el, type) {\n        var veNumber = pe._veNumber;\n        if (!veNumber) {\n            return;\n        }\n        var prefix = '';\n        var name = '';\n        var cap = '';\n        if (type === 'table') {\n            prefix = 'Table ' + veNumber + '. ';\n            var capTbl = el.find('table > caption');\n            name = capTbl.text();\n            if (name !== \"\" && name.indexOf('Table') === 0 && name.split('. ').length > 0) {\n                name = name.substring(name.indexOf(prefix) + prefix.length);\n            } else if (name === \"\") {\n                name = pe.name;\n            }\n            cap = veNumber + '. ' + name;\n            capTbl.html('Table ' + cap);\n            // If caption does not exist, add to html\n            if (capTbl.length === 0) {\n                el.find('table').prepend('<caption>Table ' + cap + '</caption>');\n            }\n        }\n        if (type === 'figure') {\n            prefix = 'Figure ' + veNumber + '. ';\n            var capFig = el.find('figure > figcaption');\n            name = capFig.text();\n            if (name !== \"\" && name.indexOf('Figure') === 0 && name.split('. ').length > 0) {\n                name = name.substring(name.indexOf(prefix) + prefix.length);\n            } else if (name === \"\") {\n                name = pe.name;\n            }\n            cap = veNumber + '. ' + name;\n            capFig.html('Figure ' + cap);\n            // If caption does not exist, add to html\n            if (capFig.length === 0) {\n                el.find('img').wrap('<figure></figure>').after('<figcaption>Figure ' + cap + '</figcaption>');\n            }\n        }\n        if (type === 'equation') {\n            var equationCap = '(' + veNumber + ')';\n            var capEq = el.find('.mms-equation-caption');\n            capEq.html(equationCap);\n            // If caption does not exist, add to html\n            if (capEq.length === 0) {\n                el.find('mms-view-equation > mms-cf > mms-transclude-doc > p').last().append('<span class=\"mms-equation-caption pull-right\">' + equationCap + '</span>');\n            }\n        }\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#generateAnchorId\n     * @methodOf mms.UtilsService\n     *\n     * @description\n     * Generates a unique ID to be used in TOC anchor tags (e.g. <a name='tbl_xxxxx...x'>, <a href='#tbl_xxxxx...x'>)\n     *\n     * @param {string} prefix \"tbl_\" when creating an id for a table, \"fig_\" when creating an id for a figuer\n     * @returns {string} unique ID wit prefix, tbl_ or fig_\n     */\n    var generateAnchorId = function(prefix){\n        return prefix + ApplicationService.createUniqueId();\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#generateTOCHtmlOption\n     * @methodOf mms.UtilsService\n     *\n     * @description\n     * Generates a list of tables, figures, and equations. It also appends the captions to the figures and tables.\n     *\n     * @param {string} ob an object that stores the html list of tables, figures, and equations as well as the counts of those\n     * @param {string} tree the tree hierarchy of the document or view (what is displayed in the left pane)\n     * @param {string} printElement contents to be printed (what is displayed in the center pane)\n     * @returns {string} populates the object fed to the function (the first argument) and return\n     */\n    var generateTOCHtmlOption = function(ob, tree, printElement){\n        // Grab all existing tables and figures inside the center pane, and assign them to tables and figures\n        var tables = printElement.find('table'),\n            figures = printElement.find('figure');\n            // equations = printElement.find('.math-tex');\n        var anchorId = '', thisCap='', tblCap, tbl, fig, j;\n\n        ob.tableCount = tables.length;\n        ob.figureCount = figures.length;\n\n        // Tables\n        for ( j = 0; j < tables.length; j++) {\n            tbl = $(tables[j]);\n            tblCap = $('caption', tbl);\n\n            // Set the link from the List of Tables to the actual tables\n            anchorId = generateAnchorId('tbl_');\n            tbl.attr('id', anchorId);\n\n            // Append li to the List of Tables\n            thisCap = (tblCap && tblCap.text() !== '') ? (j+1) + \". \" + tblCap.text() : (j+1) + \". \";\n            ob.tables += '<li><a href=\"#' + anchorId + '\">' + thisCap + '</a></li>';\n\n            // If no caption exists, add empty caption for numbering\n            if (tblCap.length === 0) {\n                tbl.prepend('<caption> </caption>');\n            }\n        }\n\n        // Figures\n        for ( j = 0; j < figures.length; j++) {\n            fig = $(figures[j]);\n            var figcap = $('figcaption',fig);\n\n            // Set the link from the List of Tables to the actual tables\n            anchorId = generateAnchorId('fig_');\n            fig.attr('id', anchorId);\n\n            // Append li to the List of Figures\n            thisCap = (figcap && figcap.text() !== '') ? (j + 1) + \". \" + figcap.text() : (j+1);\n            ob.figures += '<li><a href=\"#' + anchorId + '\">' + thisCap + '</a></li>';\n\n            // If no caption exists, add empty caption for numbering\n            if (figcap.length === 0) {\n                fig.append('<figcaption>&nbsp;</figcaption>');\n            }\n        }\n\n        // We will not add List of Equations for now\n        // for ( j = 0; j < equations.length; j++) {\n        //     // Grab all equations from the center pane\n        //     eq = $(equations[j]);\n        //\n        //     // Set the link from the List of Tables to the actual tables\n        //     anchorId = generateAnchorId('eq_');\n        //     eq.attr('id', anchorId);\n        //\n        //     // Append li to the List of Equations\n        //     ob.equations += '<li><a href=\"#' + anchorId + '\">' + j + '. </a></li>';\n        //     if(noCaption){ // If user did not add the caption, add a mock caption\n        //         eq.append('<caption>&nbsp;</caption>');\n        //     }\n        // }\n        return ob;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#createMmsId\n     * @methodOf mms.UtilsService\n     *\n     * @description\n     * Generate unique SysML element ID\n     *\n     * @returns {string} unique SysML element ID\n     */\n    var createMmsId = function() {\n        var d = Date.now();\n        var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n            var r = (d + Math.random()*16)%16 | 0;\n            d = Math.floor(d/16);\n            return (c=='x' ? r : (r&0x3|0x8)).toString(16);\n        });\n        return 'MMS_' + Date.now() + '_' + uuid;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#convertViewLinks\n     * @methodOf mms.UtilsService\n     *\n     * @description\n     * Link the element to the document/view in VE (add an anchor tag)\n     *\n     * @param {string} printElement the content of the view/document currently selected on the center pane\n     * @returns {void} nothing\n     */\n    var convertViewLinks = function(printElement) {\n        printElement.find('mms-view-link').each(function(index) {\n            var $this = $(this);\n            var elementId = $this.attr('mms-element-id') || $this.attr('data-mms-element-id');\n            if (!elementId) {\n                return;\n            }\n            elementId = elementId.replace(/[^\\w\\-]/gi, '');\n            var isElementInDoc = printElement.find(\"#\" + elementId);\n            if (isElementInDoc.length) {\n                $this.find('a').attr('href','#' + elementId);\n            }\n        });\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#getPrintCss\n     * @methodOf mms.UtilsService\n     *\n     * @description\n     * Typeset HTML to PDF (resource: https://www.princexml.com/)\n     *\n     * @param {string} htmlFlag user input taken from the printConfirm modal: whether to include docGen generated tables and rapid tables, outside of the corresponding PE or not(<-- this comment needs to be approved by Shakeh)\n     * @param {string} landscape user input taken from the printConfirm modal\n     * @param {string} meta metadata about document/view {\n                    'top-left': 'loading...', top: 'loading...', 'top-right': 'loading...',\n                    'bottom-left': 'loading...', bottom: 'loading...', 'bottom-right': 'loading...'\n                };\n     * @returns {string} document/view content string to be passed to the server for conversion\n     */\n    var getPrintCss = function(htmlFlag, landscape, meta) {\n        var ret = \"/*------------------------------------------------------------------\\n\" +\n                \"Custom CSS Table of Contents\\n\" +\n                \"1. Images\\n\" +\n                \"2. Tables\\n\" +\n                \"3. Typography\\n\" +\n                \"   3.1 Diff\\n\" +\n                \"   3.2 Errors\\n\" +\n                \"4. Figure Captions\\n\" +\n                \"5. Table of Contents\\n\" +\n                \"6. Page Layout\\n\" +\n                \"7. Headers and Footers\\n\" +\n                \"8. Signature Box\\n\" +\n                \"9. Bookmark Level\\n\" +\n                \"------------------------------------------------------------------*/\\n\" +\n                \"\\n\" +\n                \"/*------------------------------------------------------------------\\n\" +\n                \"1. Images\\n\" +\n                \"------------------------------------------------------------------*/\\n\" +\n                \"img {max-width: 100%; page-break-inside: avoid; page-break-before: auto; page-break-after: auto; margin-left: auto; margin-right: auto;}\\n\" +\n                \"img.image-center {display: block;}\\n\" +\n                \"figure img {display: block;}\\n\" +\n                \".pull-right {float: right;}\\n\" + \n                \"\\n\" +\n                \"/*------------------------------------------------------------------\\n\" +\n                \"2. Tables\\n\" +\n                \"------------------------------------------------------------------*/\\n\" +\n                \" tr, td, th { page-break-inside: avoid; } thead {display: table-header-group;}\\n\" + \n                \"table {width: 100%; border-collapse: collapse;}\\n\" + \n                \"table, th, td {border: 1px solid black; padding: 4px; font-size: 10pt;}\\n\" +\n                \"table[border='0'], table[border='0'] th, table[border='0'] td {border: 0px;}\\n\" +\n                \"table, th > p, td > p {margin: 0px; padding: 0px;}\\n\" +\n                \"table, th > div > p, td > div > p {margin: 0px; padding: 0px;}\\n\" +\n                \"table mms-transclude-doc p {margin: 0 0 5px;}\\n\" +\n                \"th {background-color: #f2f3f2;}\\n\" + \n                //\"table p {word-break: break-all;}\\n\" + \n                \"\\n\" +\n                \"/*------------------------------------------------------------------\\n\" +\n                \"3. Typography\\n\" +\n                \"------------------------------------------------------------------*/\\n\" +\n                \"h1, h2, h3, h4, h5, h6 {font-family: 'Arial', sans-serif; margin: 10px 0; page-break-inside: avoid; page-break-after: avoid;}\\n\" +\n                \"h1 {font-size: 18pt;} h2 {font-size: 16pt;} h3 {font-size: 14pt;} h4 {font-size: 13pt;} h5 {font-size: 12pt;} h6 {font-size: 11pt;}\\n\" +\n                \".ng-hide {display: none;}\\n\" +\n                \".chapter h1.view-title {font-size: 20pt; }\\n\" + \n                \"body {font-size: 10pt; font-family: 'Times New Roman', Times, serif; }\\n\" + \n                \"\\n\" +\n                \"/*------------------------------------------------------------------\\n\" +\n                \"   3.1 Diff\\n\" +\n                \"------------------------------------------------------------------*/\\n\" +\n                \"ins, .ins {color: black; background: #dafde0;}\\n\" +\n                \"del, .del{color: black;background: #ffe3e3;text-decoration: line-through;}\\n\" +\n                \".match,.textdiff span {color: gray;}\\n\" +\n                \".patcher-replaceIn, .patcher-attribute-replace-in, .patcher-insert, .patcher-text-insertion {background-color: #dafde0;}\\n\" +\n                \".patcher-replaceIn, .patcher-attribute-replace-in, .patcher-insert {border: 2px dashed #abffb9;}\\n\" +\n                \".patcher-replaceOut, .patcher-delete, .patcher-attribute-replace-out, .patcher-text-deletion {background-color: #ffe3e3; text-decoration: line-through;}\\n\" +\n                \".patcher-replaceOut, .patcher-delete, .patcher-attribute-replace-out {border: 2px dashed #ffb6b6;}\\n\" +\n                \".patcher-text-insertion, .patcher-text-deletion {display: inline !important;}\\n\" +\n                \"[class*=\\\"patcher-\\\"]:not(td):not(tr) {display: inline-block;}\\n\" +\n                \"\\n\" +\n                \"/*------------------------------------------------------------------\\n\" +\n                \"   3.2 Errors\\n\" +\n                \"------------------------------------------------------------------*/\\n\" +\n                \".mms-error {background: repeating-linear-gradient(45deg,#fff,#fff 10px,#fff2e4 10px,#fff2e4 20px);}\\n\" +\n                \"\\n\" +\n                \"/*------------------------------------------------------------------\\n\" +\n                \"4. Figure Captions\\n\" +\n                \"------------------------------------------------------------------*/\\n\" +\n                \"caption, figcaption, .mms-equation-caption {text-align: center; font-weight: bold;}\\n\" +\n                \"table, figure {margin-bottom: 10px;}\\n\" +\n                \".mms-equation-caption {float: right;}\\n\" +\n                \"mms-view-equation, mms-view-figure, mms-view-image {page-break-inside: avoid;}\\n\" +\n                \"\\n\" +\n                \"/*------------------------------------------------------------------\\n\" +\n                \"5. Table of Contents\\n\" +\n                \"------------------------------------------------------------------*/\\n\" +\n                \".toc, .tof, .tot {page-break-after:always;}\\n\" +\n                \".toc {page-break-before: always;}\\n\" +\n                \".toc a, .tof a, .tot a { text-decoration:none; color: #000; font-size:9pt; }\\n\" + \n                \".toc .header, .tof .header, .tot .header { margin-bottom: 4px; font-weight: bold; font-size:24px; }\\n\" +\n                \".toc ul, .tof ul, .tot ul {list-style-type:none; margin: 0; }\\n\" +\n                \".tof ul, .tot ul {padding-left:0;}\\n\" +\n                \".toc ul {padding-left:4em;}\\n\" +\n                \".toc > ul {padding-left:0;}\\n\" +\n                \".toc li > a[href]::after {content: leader('.') target-counter(attr(href), page);}\\n\" + \n                \".tot li > a[href]::after {content: leader('.') target-counter(attr(href), page);}\\n\" + \n                \".tof li > a[href]::after {content: leader('.') target-counter(attr(href), page);}\\n\" + \n                \"\\n\" +\n                \"/*------------------------------------------------------------------\\n\" +\n                \"6. Page Layout\\n\" +\n                \"------------------------------------------------------------------*/\\n\" +\n                \"@page {margin: 0.5in;}\\n\" + \n                \"@page landscape {size: 11in 8.5in;}\\n\" +\n                \".landscape {page: landscape;}\\n\" +\n                \".chapter {page-break-before: always}\\n\" + \n                \"p, div {widows: 2; orphans: 2;}\\n\" +\n                \"\\n\" +\n                \"/*------------------------------------------------------------------\\n\" +\n                \"7. Headers and Footers\\n\" +\n                \"------------------------------------------------------------------*/\\n\" +\n                \"@page:first {@top {content: ''} @bottom {content: ''} @top-left {content: ''} @top-right {content: ''} @bottom-left {content: ''} @bottom-right {content: ''}}\\n\" +\n                \"\\n\" +\n                \"/*------------------------------------------------------------------\\n\" +\n                \"8. Signature Box\\n\" +\n                \"------------------------------------------------------------------*/\\n\" +\n                \".signature-box td.signature-name-styling {width: 60%;}\\n\" + \n                \".signature-box td.signature-space-styling {width: 1%;}\\n\" + \n                \".signature-box td.signature-date-styling {width: 39%;}\\n\" + \n                \"\\n\" +\n                \"/*------------------------------------------------------------------\\n\" +\n                \"9. Bookmark Level\\n\" +\n                \"------------------------------------------------------------------*/\\n\" ;\n        for (var i = 1; i < 10; i++) {\n            ret += \".h\" + i + \" {bookmark-level: \" + i + \";}\\n\";\n        }\n        if (htmlFlag) {\n            ret += \".toc { counter-reset: table-counter figure-counter;}\\n\" +\n                \"figure { counter-increment: figure-counter; }\\n\" +\n                \"figcaption::before {content: \\\"Figure \\\" counter(figure-counter) \\\". \\\"; }\\n\" +\n                \"table { counter-increment: table-counter; }\\n\" +\n                \"caption::before {content: \\\"Table \\\" counter(table-counter) \\\". \\\"; }\\n\";\n        }\n        Object.keys(meta).forEach(function(key) {\n            if (meta[key]) {\n                var content;\n                if (meta[key] === 'counter(page)') {\n                    content = meta[key];\n                } else {\n                    content = '\"' + meta[key] + '\"';\n                }\n                ret += '@page {@' + key + ' {font-size: 10px; content: ' + content + ';}}\\n';\n            }\n        });\n        if (landscape) {\n            ret += \"@page {size: 11in 8.5in;}\";\n        }\n        return ret;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#isView\n     * @methodOf mms.UtilsService\n     *\n     * @description\n     * Evaluates if an given element is a view or not\n     *\n     * @param {Object} e element\n     * @returns {boolean} boolean\n     */\n    var isView = function(e) {\n        if (e._appliedStereotypeIds) {\n            if (e._appliedStereotypeIds.indexOf(VIEW_SID) >= 0 || e._appliedStereotypeIds.indexOf(DOCUMENT_SID) >= 0) {\n                return true;\n            }\n            for (var i = 0; i < OTHER_VIEW_SID.length; i++) {\n                if (e._appliedStereotypeIds.indexOf(OTHER_VIEW_SID[i]) >= 0) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#isDocument\n     * @methodOf mms.UtilsService\n     *\n     * @description\n     * Evaluates if an given element is a document or not\n     *\n     * @param {Object} e element\n     * @returns {boolean} boolean\n     */\n    var isDocument = function(e) {\n        if (e._appliedStereotypeIds && e._appliedStereotypeIds.indexOf(DOCUMENT_SID) >= 0) {\n            return true;\n        }\n        return false;\n    };\n\n        /**\n     * @ngdoc method\n     * @name mms.UtilsService#isRequirement\n     * @methodOf mms.UtilsService\n     *\n     * @description\n     * Evaluates if an given element is a requirement from list given above: REQUIREMENT_SID\n     *\n     * @param {Object} e element\n     * @returns {boolean} boolean\n     */\n    var isRequirement = function(e) {\n        if (e._appliedStereotypeIds) {\n            for (var i = 0; i < REQUIREMENT_SID.length; i++) {\n                if (e._appliedStereotypeIds.indexOf(REQUIREMENT_SID[i]) >= 0) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#exportHtmlAs\n     * @methodOf mms.UtilsService\n     *\n     * @description\n     * Converts HTML to PDF\n     *\n     * @param {string} exportType The export type (3 for pdf | 2 for word)\n     * @param {Object} data contains htmlString, name, projectId, refId\n     * @returns {Promise} Promise would be resolved with 'ok', the server will send an email to user when done\n     */\n    var exportHtmlAs = function(exportType, data){\n        var accept;\n        switch (exportType) {\n          case 2:\n              accept = 'application/vnd.openxmlformats-officedocument.wordprocessingml.document';\n              break;\n          case 3:\n              accept = 'application/pdf';\n              break;\n          default:\n              accept = 'application/pdf';\n        }\n        var deferred = $q.defer();\n        $http.post(URLService.getExportHtmlUrl(data.projectId, data.refId), {\n            'Content-Type' : 'text/html',\n            'Accepts' : accept,\n            'body': data.htmlString,\n            'name': data.name,\n            'css': data.css\n        })\n        .then(function() {\n            deferred.resolve('ok');\n        }, function(error) {\n            URLService.handleHttpStatus(error.data, error.status, error.headers, error.config, deferred);\n        });\n        return deferred.promise;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.UtilsService#createClassElement\n     * @methodOf mms.UtilsService\n     *\n     * @description\n     * returns a class json object with all emf fields set to default, with\n     * fields from passed in object substituted\n     * \n     */\n    var createClassElement = function(obj) {\n        var o = JSON.parse(JSON.stringify(CLASS_ELEMENT_TEMPLATE));\n        Object.assign(o, obj);\n        return o;\n    };\n\n    var createInstanceElement = function(obj) {\n        var o = JSON.parse(JSON.stringify(INSTANCE_ELEMENT_TEMPLATE));\n        Object.assign(o, obj);\n        return o;\n    };\n\n    var createValueSpecElement = function(obj) {\n        var o = JSON.parse(JSON.stringify(VALUESPEC_ELEMENT_TEMPLATE));\n        Object.assign(o, obj);\n        return o;\n    };\n\n    var createGeneralizationElement = function(obj) {\n        var o = JSON.parse(JSON.stringify(GENERALIZATION_ELEMENT_TEMPLATE));\n        Object.assign(o, obj);\n        return o;\n    };\n\n    var createPackageElement = function(obj) {\n        var o = JSON.parse(JSON.stringify(PACKAGE_ELEMENT_TEMPLATE));\n        Object.assign(o, obj);\n        return o;\n    };\n\n    var createDependencyElement = function(obj) {\n        var o = JSON.parse(JSON.stringify(DEPENDENCY_ELEMENT_TEMPLATE));\n        Object.assign(o, obj);\n        return o;\n    };\n\n    var copyToClipboard = function(target, $event) {\n        $event.stopPropagation();\n        var range = window.document.createRange();\n        range.selectNodeContents(target[0].childNodes[0]);\n        window.getSelection().removeAllRanges();\n        window.getSelection().addRange(range);\n        try {\n            window.document.execCommand('copy');\n        } catch(err) {}\n        window.getSelection().removeAllRanges();\n    };\n\n    var getElementTypeClass = function(element, elementType) {\n        var elementTypeClass = '';\n        if (element.type === 'InstanceSpecification') {\n            elementTypeClass = 'pe-type-' + elementType;\n        } else {\n            elementTypeClass = 'item-type-' + elementType;\n        }\n        return elementTypeClass;\n    };\n\n    return {\n        VIEW_SID: VIEW_SID,\n        OTHER_VIEW_SID: OTHER_VIEW_SID,\n        DOCUMENT_SID: DOCUMENT_SID,\n        BLOCK_SID: BLOCK_SID,\n        createClassElement: createClassElement,\n        createInstanceElement: createInstanceElement,\n        createValueSpecElement: createValueSpecElement,\n        createGeneralizationElement: createGeneralizationElement,\n        createDependencyElement: createDependencyElement,\n        createPackageElement: createPackageElement,\n        hasCircularReference: hasCircularReference,\n        cleanElement: cleanElement,\n        normalize: normalize,\n        makeElementKey: makeElementKey,\n        makeArtifactKey: makeArtifactKey,\n        buildTreeHierarchy: buildTreeHierarchy,\n        filterProperties: filterProperties,\n        mergeElement: mergeElement,\n        hasConflict: hasConflict,\n        isRestrictedValue: isRestrictedValue,\n        makeHtmlTable : makeHtmlTable,\n        makeHtmlPara: makeHtmlPara,\n        makeHtmlList: makeHtmlList,\n        makeHtmlTOC: makeHtmlTOC,\n        makeTablesAndFiguresTOC: makeTablesAndFiguresTOC,\n        addLiveNumbering: addLiveNumbering,\n        convertViewLinks: convertViewLinks,\n        createMmsId: createMmsId,\n        getPrintCss: getPrintCss,\n        isView: isView,\n        isDocument: isDocument,\n        isRequirement: isRequirement,\n        exportHtmlAs: exportHtmlAs,\n        generateTOCHtmlOption: generateTOCHtmlOption,\n        generateAnchorId: generateAnchorId,\n        tableConfig: tableConfig,\n        _generateRowColNumber: _generateRowColNumber,\n        PROJECT_URL_PREFIX: PROJECT_URL_PREFIX,\n        copyToClipboard: copyToClipboard,\n        getElementTypeClass: getElementTypeClass\n    };\n}\n","'use strict';\n\nangular.module('mms')\n.factory('UxService', ['$rootScope', UxService]);\n\n/**\n * @ngdoc service\n * @name mms.UxService\n * \n * @description\n * Ux Service\n */\nfunction UxService($rootScope) {\n\n    /**\n     * @ngdoc method\n     * @name mms.UxService#getToolbarButton\n     * @methodOf mms.UxService\n     * \n     * @description\n     * Get pre-defined toolbar buttons\n     * \n     * @param {<string>} id of button\n     * @returns {Object} Button object\n     */\n    var getToolbarButton = function(button) {\n    switch (button) {\n      case \"element-viewer\":\n        return {id: button, icon: 'fa-eye', selected: true, active: true, permission:true, tooltip: 'Preview Element', \n                spinner: false, onClick: function() {$rootScope.$broadcast(button);},\n                dynamic_buttons: [getToolbarButton(\"element-editor-saveall\")]};\n      case \"element-history\":\n        return {id: button, icon: 'fa-history', selected: false, active: true, permission:true, tooltip: 'Element History',\n                spinner: false, onClick: function() {$rootScope.$broadcast(button);},\n                dynamic_buttons: [getToolbarButton(\"element-editor-saveall\")]};\n      case \"element-editor\":\n        return {id: button, icon: 'fa-edit', selected: false, active: true, permission:false, tooltip: 'Edit Element',\n                spinner: false, onClick: function() {$rootScope.$broadcast(button);},\n                dynamic_buttons: [\n                    getToolbarButton(\"element-editor-save\"), getToolbarButton('element-editor-saveC'),\n                    getToolbarButton(\"element-editor-saveall\"), getToolbarButton(\"element-editor-cancel\") ]};\n      case \"view-reorder\":\n        return {id: button, icon: 'fa-arrows-v', selected: false, active: true, permission:false, tooltip: 'Reorder Content',\n                spinner: false, onClick: function() {$rootScope.$broadcast(button);},\n                dynamic_buttons: [getToolbarButton(\"view-reorder-save\"), getToolbarButton(\"view-reorder-cancel\")]};\n      case \"document-snapshot\":\n        return  {id: button, icon: 'fa-camera', selected: false, active: true, permission:true, tooltip: 'Snapshots',\n                spinner: false, onClick: function() {$rootScope.$broadcast(button);},\n                dynamic_buttons: [getToolbarButton(\"document-snapshot-create\")]};\n      case \"tags\":\n        return {id: button, icon: 'fa-code-fork', selected: false, active: true, permission: true, tooltip: 'Branches and Tags',\n                spinner: false, onClick: function() {$rootScope.$broadcast(button);}};\n      case \"jobs\":\n        return {id: button, icon: 'fa-sort-amount-desc', selected: false, active: true, permission:true, tooltip: 'Jobs',\n                spinner: false, onClick: function() {$rootScope.$broadcast(button);}};\n      case \"element-editor-save\":\n        return {id: button, icon: 'fa-save', dynamic: true, selected: false, active: false, permission:true, tooltip: 'Save',\n                spinner: false, onClick: function() {$rootScope.$broadcast(button);}};\n      case \"element-editor-saveC\":\n        return {id: button, icon: 'fa-send-o', dynamic: true, selected: false, active: false, permission:true, tooltip: 'Save and Continue',\n                spinner: false, onClick: function() {$rootScope.$broadcast(button);}};\n      case \"element-editor-saveall\":\n        return {id: button, icon: 'fa-save-all', dynamic: true, selected: false, active: false, permission:false, tooltip: 'Save All (alt + a)',\n                spinner: false, onClick: function() {$rootScope.$broadcast(button);}};\n      case \"element-editor-cancel\":\n        return {id: button, icon: 'fa-times', dynamic: true, selected: false, active: false, permission:true, tooltip: 'Cancel',\n                spinner: false, onClick: function() {$rootScope.$broadcast(button);}};\n      case \"view-reorder-save\":\n        return {id: button, icon: 'fa-save', dynamic: true, selected: false, active: false, permission:true, tooltip: 'Save',\n                spinner: false, onClick: function() {$rootScope.$broadcast(button);}};\n      case \"view-reorder-cancel\":\n        return {id: button, icon: 'fa-times', dynamic: true, selected: false, active: false, permission:true, tooltip: 'Cancel',\n                spinner: false, onClick: function() {$rootScope.$broadcast(button);}};\n      case \"document-snapshot-refresh\":\n        return {id: button, icon: 'fa-refresh', dynamic: true, selected: false, active: false, permission:true, tooltip: 'Refresh',\n                spinner: false, onClick: function() {$rootScope.$broadcast(button);}};\n      case \"document-snapshot-create\":\n        return {id: button, icon: 'fa-plus', dynamic: true, selected: false, active: false, permission:false, tooltip: 'Create Tag',\n                spinner: false, onClick: function() {$rootScope.$broadcast(button);}};\n      case \"diff-perspective-detail\":\n        return {id: button, icon: 'fa-info-circle', selected: true, active: true, permission: true, tooltip: 'Detail',\n                spinner: false, onClick: function() {$rootScope.diffPerspective = 'detail'; }};\n      case \"diff-perspective-tree\":\n        return {id: button, icon: 'fa-sitemap', selected: false, active: true, permission: true, tooltip: 'Context',\n                spinner: false, onClick: function() {$rootScope.diffPerspective = 'tree'; }};\n    }    \n  };\n\n  var getButtonBarButton = function(button, scope) {\n    switch (button) {\n      case \"tree-expand\":\n        return {id: button, icon: 'fa-caret-square-o-down', selected: true, active: true, permission: true, tooltip: 'Expand All', \n                spinner: false, togglable: false, placement: 'bottom-left', action: function() {$rootScope.$broadcast(button);}};\n      case \"tree-collapse\":\n        return {id: button, icon: 'fa-caret-square-o-up', selected: true, active: true, permission: true, tooltip: 'Collapse All', \n                spinner: false, togglable: false, action: function() {$rootScope.$broadcast(button);}};\n      case \"tree-filter\":\n        return {id: button, icon: 'fa-filter', selected: true, active: true, permission: true, tooltip: 'Filter', \n                spinner: false, togglable: true, action: function() {$rootScope.$broadcast(button);}};\n      case \"tree-add-document-or-group\":\n        return {id: button, icon: 'fa-plus', selected: true, active: true, permission: false, tooltip: 'Add Group or Document',\n                spinner: false, togglable: false, placement: 'bottom-right', action: function() {$rootScope.$broadcast(button);},\n                dropdown_buttons: [ getButtonBarButton(\"tree-add-group\"), getButtonBarButton(\"tree-add-document\")]};\n      case \"tree-delete-document\":\n        return {id: button, icon: 'fa-trash', selected: true, active: true, permission: false, tooltip: 'Remove', \n                spinner: false, togglable: false, action: function() {$rootScope.$broadcast(button);}};\n      case \"tree-add-view\":\n        return {id: button, icon: 'fa-plus', selected: true, active: true, permission: false, tooltip: 'Add View',\n                spinner: false, togglable: false, action: function() {$rootScope.$broadcast(button);}};\n      case \"tree-add-group\":\n        return {id: button, icon: 'fa-folder', selected: true, active: true, permission: true, tooltip: 'Add Group',\n              spinner: false, togglable: false, action: function() {$rootScope.$broadcast(button);}};\n      case \"tree-add-document\":\n        return {id: button, icon: 'fa-file', selected: true, active: true, permission: true, tooltip: 'Add Document',\n            spinner: false, togglable: false, action: function() {$rootScope.$broadcast(button);}};\n\n\n\n      case \"tree-add-tag\":\n        return {id: button, icon: 'fa-tag', selected: true, active: true, permission: true, tooltip: 'Add Tag', \n                spinner: false, togglable: false, action: function() {$rootScope.$broadcast(button);}};\n      case \"tree-add-branch\":\n        return {id: button, icon: 'fa-plus', selected: true, active: true, permission: true, tooltip: 'Add Branch',\n                spinner: false, togglable: false, action: function() {$rootScope.$broadcast(button);}};\n      case \"tree-delete\":\n        return {id: button, icon: 'fa-trash', selected: true, active: true, permission: true, tooltip: 'Remove', \n                spinner: false, togglable: false, action: function() {$rootScope.$broadcast(button);}};\n      case \"tree-delete-view\":\n        return {id: button, icon: 'fa-trash', selected: true, active: true, permission: false, tooltip: 'Remove View', \n                spinner: false, togglable: false, action: function() {$rootScope.$broadcast(button);}};\n      case \"tree-reorder-view\":\n        return {id: button, icon: 'fa-arrows-v', selected: true, active: true, permission: false, tooltip: 'Reorder Views', \n                spinner: false, togglable: false, action: function() {$rootScope.$broadcast(button);}};\n      case \"tree-reorder-group\":\n        return {id: button, icon: 'fa-arrows-v', selected: true, active: true, permission: false, tooltip: 'Organize Groups/Docs',\n              spinner: false, togglable: false, action: function() {$rootScope.$broadcast(button);}};\n      case \"tree-full-document\":\n        return {id: button, icon: 'fa-file-text-o', selected: true, active: true, permission: true, tooltip: 'Full Document', \n                spinner: false, togglable: true, toggle_icon: 'fa-file-text', toggle_tooltip: 'View Mode', action: function() {$rootScope.$broadcast(button);}};\n      case \"view-mode-dropdown\":\n        return {id: button, icon: 'fa-filter', selected: true, active: true, permission: true, tooltip: 'Filter by type',\n                spinner: false, togglable: false, placement: 'bottom-left', action: function() {$rootScope.$broadcast(button);},\n                dropdown_buttons: [ getButtonBarButton(\"tree-show-pe\"), getButtonBarButton(\"tree-show-views\"),\n                    getButtonBarButton(\"tree-show-tables\"), getButtonBarButton(\"tree-show-figures\"),\n                    getButtonBarButton(\"tree-show-equations\")]};\n      case \"tree-show-views\":\n        return {id: button, selected: true, active: true, permission: true, tooltip: 'Show Only Views and Sections',\n                spinner: false, togglable: false, action: function() {$rootScope.$broadcast(button);}};\n      case \"tree-show-pe\":\n        return {id: button, selected: false, active: true, permission: true, tooltip: 'Show All',\n                spinner: false, togglable: false, action: function() {$rootScope.$broadcast(button);}};\n      case \"tree-show-tables\":\n        return {id: button, selected: false, active: true, permission: true, tooltip: 'Show Only Tables',\n                spinner: false, togglable: false, action: function() {$rootScope.$broadcast(button);}};\n      case \"tree-show-figures\":\n        return {id: button, selected: false, active: true, permission: true, tooltip: 'Show Only Figures',\n                spinner: false, togglable: false, action: function() {$rootScope.$broadcast(button);}};\n      case \"tree-show-equations\":\n        return {id: button, selected: false, active: true, permission: true, tooltip: 'Show Only Equations',\n                spinner: false, togglable: false, action: function() {$rootScope.$broadcast(button);}};\n\n\n      case \"show-edits\":\n        return {id: button, icon: 'fa-pencil-square-o', selected: true, active: true, permission: true, tooltip: 'Enable Edits (alt + d)',\n                spinner: false, togglable: true, toggle_icon: 'fa-pencil-square', toggle_tooltip: 'Disable Edits (alt + d)',\n                action: function() {$rootScope.$broadcast(button);}};\n      case \"show-elements\":\n        return {id: button, icon: 'fa-codepen', selected: true, active: true, permission: true, tooltip: 'Show Elements (alt + e)',\n                spinner: false, togglable: true, toggle_icon: 'fa-cube', toggle_tooltip: 'Hide Elements (alt + e)',\n                action: function() {$rootScope.$broadcast(button);}};\n      case \"show-comments\":\n        return {id: button, icon: 'fa-comment-o', selected: true, active: true, permission: true, tooltip: 'Show Comments (alt + c)',\n                spinner: false, togglable: true, toggle_icon: 'fa-comment', toggle_tooltip: 'Hide Comments (alt + c)',\n                action: function() {$rootScope.$broadcast(button);}};\n      case \"refresh-numbering\":\n        return {id: button, icon: 'fa-sort-numeric-asc', selected: true, active: true, permission: true, tooltip: 'Refresh Figure Numbering',\n                spinner: false, togglable: false, action: function() {$rootScope.$broadcast(button);}};\n      case \"share-url\":\n        return {id: button, icon: 'fa-share-alt', selected: true, active: true, permission: true, tooltip: 'Share Short URL',\n                spinner: false, togglable: false, action: function() {$rootScope.$broadcast(button);}};\n      case \"center-previous\":\n        return {id: button, icon: 'fa-chevron-left', selected: true, active: true, permission: true, tooltip: 'Previous (alt + ,)',\n                spinner: false, togglable: false, action: function() {$rootScope.$broadcast(button);}};\n      case \"center-next\":\n        return {id: button, icon: 'fa-chevron-right', selected: true, active: true, permission: true, tooltip: 'Next (alt + .)',\n                spinner: false, togglable: false, action: function() {$rootScope.$broadcast(button);}};\n      case \"export\":\n        return {id: button, icon: 'fa-download', selected: true, active: true, permission: true, tooltip: 'Export', button_content: 'Export',\n              spinner: false, togglable: false, action: function() {$rootScope.$broadcast(button);},\n              dropdown_buttons: [ getButtonBarButton(\"word\"), getButtonBarButton(\"tabletocsv\")]};\n      case \"print\":\n        return {id: button, icon: 'fa-print', selected: true, active: true, permission: true, tooltip: 'Print',\n                spinner: false, togglable: false, action: function() {$rootScope.$broadcast(button);}};\n      case \"convert-pdf\":\n        return {id: button, icon: 'fa-file-pdf-o', selected: true, active: true, permission: true, tooltip: 'Export to PDF',\n                spinner: false, togglable: false, action: function() {$rootScope.$broadcast(button);}};\n      case \"word\":\n        return {id: button, icon: 'fa-file-word-o', selected: true, active: true, permission: true, tooltip: 'Export to Word',\n                spinner: false, togglable: false, action: function() {$rootScope.$broadcast(button);}};\n      case \"tabletocsv\":\n        return {id: button, icon: 'fa-table', selected: true, active: true, permission: true, tooltip: 'Table to CSV',\n                spinner: false, togglable: false, action: function() {$rootScope.$broadcast(button);}};\n\n      case \"presentation-element-delete\":\n        return {id: button, icon: 'fa-trash', selected: true, active: true, permission: true, tooltip: 'Remove',\n                spinner: false, togglable: false, action: function(e) {e.stopPropagation(); scope.delete();}};\n      case \"presentation-element-save\":\n        return {id: button, icon: 'fa-save', selected: true, active: true, permission: true, tooltip: 'Save',\n                spinner: false, togglable: false, action: function(e) {e.stopPropagation(); scope.save();}};\n      case \"presentation-element-saveC\":\n        return {id: button, icon: 'fa-send-o', selected: true, active: true, permission: true, tooltip: 'Save and Continue',\n                spinner: false, togglable: false, action: function(e) {e.stopPropagation(); scope.saveC();}};\n      case \"presentation-element-cancel\":\n        return {id: button, icon: 'fa-times', selected: true, active: true, permission: true, tooltip: 'Cancel',\n                spinner: false, togglable: false, action: function(e) {e.stopPropagation(); scope.cancel();}};\n      case \"presentation-element-preview\":\n        return {id: button, icon: 'fa-file-powerpoint-o', selected: true, active: true, permission: true, tooltip: 'Preview Changes',\n                spinner: false, togglable: false, action: function(e) {e.stopPropagation(); scope.preview();}};\n    }\n  };\n\n  var MetaTypes = ['tag', 'connector', 'dependency', 'directedrelationship', 'element', 'property', 'generalization', 'package', 'section', 'group', 'snapshot', 'view', 'branch', 'table', 'figure', 'equation', 'view-composite', 'view-shared', 'view-none' ];\n\n  var getTreeTypes = function() {\n    var treeTypes = {};\n\n    MetaTypes.forEach(function (type) {\n      treeTypes[type] = getTypeIcon(type) + \" fa-fw\";\n    });\n\n    return treeTypes;\n  };\n\n  var getTypeIcon = function(type) {\n    var t = type;\n    if (!t)\n      t = \"unknown\";\n    t = t.toLowerCase();\n    switch (t) {\n      case \"tag\":\n        return \"fa fa-tag\";\n      case \"connector\":\n        return \"fa fa-expand\";\n      case \"dependency\":\n        return \"fa fa-long-arrow-right\";\n      case \"directedrelationship\":\n        return \"fa fa-long-arrow-right\";\n      case \"element\":\n        return \"fa fa-square\";\n      case \"property\":\n        return \"fa fa-circle\";\n      case \"generalization\":\n        return \"fa fa-chevron-right\";\n      case \"package\":\n        return \"fa fa-folder\";\n      case \"section\":\n        return \"section-icon\";//\"fa-file-o\";\n      case \"group\":\n        return \"fa fa-folder\";\n      case \"snapshot\":\n        return \"fa fa-camera\";\n      case \"view\":\n        return \"fa fa-file\";\n      case \"view-composite\":\n        return \"fa fa-file\";\n      case \"view-shared\":\n        return \"fa fa-file-o\";\n      case \"view-none\":\n        return \"fa fa-file-o\";\n      case \"branch\":\n        return \"fa fa-tasks\";\n      case \"table\":\n        return \"fa fa-table\";\n      case \"figure\":\n        return \"fa fa-image\";\n      case \"equation\":\n        return \"fa fa-superscript\";\n      default:\n        return \"fa fa-square\";\n        }\n  };\n\n  var getChangeTypeName = function(type) {\n    type = type.toLowerCase();\n    switch (type) {\n      case \"added\":\n        return \"Addition\";\n      case \"updated\":\n        return \"Modification\";\n      case \"removed\":\n        return \"Removal\";\n    }\n  };\n\n    return {\n        getButtonBarButton: getButtonBarButton,\n        getToolbarButton: getToolbarButton,\n        getTypeIcon: getTypeIcon,\n        getChangeTypeName: getChangeTypeName,\n        getTreeTypes: getTreeTypes\n    };\n}\n","'use strict';\n\nangular.module('mms')\n.factory('ViewService', ['$q', '$http', '$rootScope', 'URLService', 'ElementService', 'UtilsService', 'CacheService', '_', ViewService]);\n\n/**\n * @ngdoc service\n * @name mms.ViewService\n * @requires $q\n * @requires $http\n * @requires mms.URLService\n * @requires mms.ElementService\n * @requires mms.UtilsService\n * @requires mms.CacheService\n * @requires _\n * \n * @description\n * Similar to the ElementService and proxies a lot of functions to it, this provides\n * CRUD for views and products/documents/group\n *\n */\nfunction ViewService($q, $http, $rootScope, URLService, ElementService, UtilsService, CacheService, _) {\n    var inProgress = {}; //only used for view elements over limit\n\n    // The type of opaque element to the sysmlId of the classifierIds:\n    var TYPE_TO_CLASSIFIER_ID = {\n        Image: \"_17_0_5_1_407019f_1430628206190_469511_11978\",\n        List: \"_17_0_5_1_407019f_1430628190151_363897_11927\",\n        Paragraph: \"_17_0_5_1_407019f_1430628197332_560980_11953\",\n        Table: \"_17_0_5_1_407019f_1430628178633_708586_11903\",\n        Section: \"_17_0_5_1_407019f_1430628211976_255218_12002\",\n        ListT: \"_17_0_5_1_407019f_1431903739087_549326_12013\",\n        TableT: \"_17_0_5_1_407019f_1431903724067_825986_11992\",\n        ImageT: \"_17_0_5_1_407019f_1431903748021_2367_12034\", //manual images + timely, etc\n        Equation: \"_17_0_5_1_407019f_1431905053808_352752_11992\",\n        ParagraphT: \"_17_0_5_1_407019f_1431903758416_800749_12055\",\n        SectionT: \"_18_0_2_407019f_1435683487667_494971_14412\",\n        TomSawyerDiagram: \"_18_5_2_8bf0285_1506035630029_725905_15942\",\n        Figure: \"_18_5_2_8bf0285_1506035630979_342273_15944\",\n        FigureT: \"_18_5_2_8bf0285_1506035630029_725905_15942\"\n    };\n\n    var AnnotationType = {\n        mmsTranscludeName: 1,\n        mmsTranscludeDoc: 2,\n        mmsTranscludeCom: 3,\n        mmsTranscludeVal: 4,\n        mmsViewLink: 5,\n        mmsPresentationElement: 6\n    };\n\n    var GROUP_ST_ID = '_18_5_3_8bf0285_1520469040211_2821_15754';\n\n    // function getClassifierIds() {\n    //     var re = [];\n    //     Object.keys(TYPE_TO_CLASSIFIER_ID).forEach(function(key) {\n    //         re.push(TYPE_TO_CLASSIFIER_ID[key]);\n    //     });\n    //     return re;\n    // }\n\n    var TYPE_TO_CLASSIFIER_TYPE = {\n        Table: 'TableT',\n        Paragraph: 'ParagraphT',\n        Section: 'SectionT',\n        Comment: 'ParagraphT',\n        List: 'ListT',\n        Image: 'ImageT',\n        Equation: 'Equation',\n        TomSawyerDiagram: 'TomSawyerDiagram'\n    };\n\n    // var classifierIdsIds = getClassifierIds();\n    var opaqueClassifiers = [TYPE_TO_CLASSIFIER_ID.Image, TYPE_TO_CLASSIFIER_ID.List, \n        TYPE_TO_CLASSIFIER_ID.Paragraph, TYPE_TO_CLASSIFIER_ID.Section, TYPE_TO_CLASSIFIER_ID.Table, TYPE_TO_CLASSIFIER_ID.Figure];\n\n    /**\n     * @ngdoc method\n     * @name mms.ViewService#downgradeDocument\n     * @methodOf mms.ViewService\n     * \n     * @description\n     * Demote document to a view and update the applied stereotype instance\n     * \n     * @param {Object} elementOb A document object\n     * @returns {Promise} The promise will be resolved with the downgraded view\n     */\n    var downgradeDocument = function(elementOb) {\n        var clone = JSON.parse(JSON.stringify(elementOb));\n        clone._appliedStereotypeIds = [UtilsService.VIEW_SID];\n        var asi = {\n            id: elementOb.id + \"_asi\",\n            ownerId: elementOb.id,\n            classifierIds: [UtilsService.VIEW_SID],\n            type: \"InstanceSpecification\",\n            _projectId: elementOb._projectId,\n            _refId: elementOb._refId,\n            stereotypedElementId: elementOb.id\n        };\n        return ElementService.updateElements([clone, asi])\n            .then(function(data) {\n                var cacheKey = ['documents', elementOb._projectId, elementOb._refId];\n                var index = -1;\n                var projectDocs = CacheService.get(cacheKey);\n                if (projectDocs) {\n                    for (var i = 0; i < projectDocs.length; i++) {\n                        if (projectDocs[i].id === elementOb.id) {\n                            index = i;\n                            break;\n                        }\n                    }\n                    if (index >= 0) {\n                        projectDocs.splice(index, 1);\n                    }\n                }\n                return data;\n            }, function(reason) {\n                return reason;\n            });\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ViewService#getViewElements\n     * @methodOf mms.ViewService\n     * \n     * @description\n     * Gets the element objects for elements allowed in this view. The references are \n     * the same as ones gotten from ElementService.\n     * \n     * @param {object} reqOb see description at ElementService.getElement, where elementId is id of the view\n     * @param {integer} weight the priority of the request\n     * @param {boolean} [update=false] (optional) whether to always get the latest \n     *      from server, even if it's already in cache (this will update everywhere\n     *      it's displayed, except for the editables)\n     * @returns {Promise} The promise will be resolved with array of element objects. \n     */\n    var getViewElements = function(reqOb, weight, update) {\n        UtilsService.normalize(reqOb);\n        var deferred = $q.defer();\n        var key = 'viewElements' + reqOb.projectId + reqOb.refId + reqOb.elementId + reqOb.commitId;\n        if (inProgress[key]) {\n            return inProgress[key];\n        }\n        var requestCacheKey = ['elements', reqOb.projectId, reqOb.refId, reqOb.elementId, reqOb.commitId];\n        var cached = CacheService.get(requestCacheKey);\n        if (cached && !update) {\n            deferred.resolve(cached);\n            return deferred.promise;\n        }\n        inProgress[key] = deferred.promise;\n        ElementService.getElement(reqOb, weight, update)\n        .then(function(view) {\n            var toGet = [];\n            var results = [];\n            if (view._displayedElementIds) {\n                var displayed = view._displayedElementIds;\n                if (!angular.isArray(displayed)) {\n                    displayed = JSON.parse(displayed);\n                }\n                if (angular.isArray(displayed) && displayed.length > 0) {\n                    toGet = displayed;\n                }\n            }\n            if (view._contents && view._contents.operand) {\n                var contents = view._contents.operand;\n                for (var i = 0; i < contents.length; i++) {\n                    if (contents[i] && contents[i].instanceId) {\n                        toGet.push(contents[i].instanceId);\n                    }\n                }\n            }\n            if (view.specification && view.specification.operand) {\n                var specContents = view.specification.operand;\n                for (var j = 0; j < specContents.length; j++) {\n                    if (specContents[j] && specContents[j].instanceId) {\n                        toGet.push(specContents[j].instanceId);\n                    }\n                }\n            }\n            if (isTable(view) && view.specification && view.specification.value) {\n                try {\n                    var tableJson = JSON.parse(view.specification.value);\n                    if (tableJson.body) {\n                        collectTableSources(toGet, tableJson.body);\n                    }\n                } catch (e) {\n                }\n            }\n            $http.get(URLService.getViewElementIdsURL(reqOb))\n            .then(function(response) {\n                var data = response.data.elementIds;\n                toGet = toGet.concat(data);\n            }).finally(function() {\n                var toGetSet = new Set(toGet);\n                reqOb.elementIds = Array.from(toGetSet);\n                ElementService.getElements(reqOb, weight, update)\n                .then(function(data) {\n                    results = data;\n                }).finally(function() {\n                    CacheService.put(requestCacheKey, results);\n                    deferred.resolve(results);\n                    delete inProgress[key];\n                });\n            });\n        }, function(reason) {\n            deferred.reject(reason);\n            delete inProgress[key];\n        });\n        return deferred.promise;\n    };\n\n    var collectTableSources = function(sources, body) {\n        var i, j, k;\n        for (i = 0; i < body.length; i++) {\n            var row = body[i];\n            for (j = 0; j < row.length; j++) {\n                var cell = row[j];\n                for (k = 0; k < cell.content.length; k++) {\n                    var thing = cell.content[k];\n                    if (thing.type === 'Table' && thing.body) {\n                        collectTableSources(sources, thing.body);\n                    } else if (thing.type === 'Paragraph' && thing.source) {\n                        sources.push(thing.source);\n                    }\n                }\n            }\n        }\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ViewService#getDocumentViews\n     * @methodOf mms.ViewService\n     * \n     * @description\n     * Gets the view objects for a document. The references are \n     * the same as ones gotten from ElementService.\n     * \n     * @param {object} reqOb see ElementService.getElement\n     * @param {integer} [weight=1] the priority of the request\n     * @param {boolean} [update=false] whether to always get the latest \n     *      from server\n     * @returns {Promise} The promise will be resolved with array of view objects. \n     */\n    var getDocumentViews = function(reqOb, weight, update) {\n        UtilsService.normalize(reqOb);\n        var deferred = $q.defer();\n        var url = URLService.getDocumentViewsURL(reqOb);\n        var cacheKey = ['views', reqOb.projectId, reqOb.refId, reqOb.elementId];\n        if (CacheService.exists(cacheKey) && !update) {\n            deferred.resolve(CacheService.get(cacheKey));\n        } else {\n            ElementService.getGenericElements(url, reqOb, 'views', weight, update).\n            then(function(data) {\n                deferred.resolve(CacheService.put(cacheKey, data, false));\n            }, function(reason) {\n                deferred.reject(reason);\n            });\n        }\n        return deferred.promise;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ViewService#addViewToParentView\n     * @methodOf mms.ViewService\n     *\n     * @description\n     * This updates a document to include a new view, the new view must be a child\n     * of an existing view in the document\n     * \n     * @param {object} reqOb see Element.getElement for description, use parentViewId \n     *                  and viewId instead of elementId, add 'aggr' key\n     * @returns {Promise} The promise would be resolved with updated parent view object\n     */\n    var addViewToParentView = function(reqOb) {\n        UtilsService.normalize(reqOb);\n        var deferred = $q.defer();\n        ElementService.getElement({\n            projectId: reqOb.projectId,\n            refId: reqOb.refId,\n            elementId: reqOb.parentViewId\n        }, 2).then(function(data) {\n            var clone = {\n                _projectId: data._projectId,\n                _refId: data._refId,\n                //_modified: data._modified,\n                id: data.id\n            };\n            if (data._childViews) {\n                clone._childViews = JSON.parse(JSON.stringify(data._childViews));\n            } else {\n                clone._childViews = [];\n            }\n            clone._childViews.push({id: reqOb.viewId, aggregation: reqOb.aggr});\n            ElementService.updateElement(clone, true)\n            .then(function(data2) {\n                deferred.resolve(data2);\n            }, function(reason) {\n                deferred.reject(reason);\n            });\n        }, function(reason) {\n            deferred.reject(reason);\n        });\n        return deferred.promise;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ViewService#removeViewFromParentView\n     * @methodOf mms.ViewService\n     *\n     * @description\n     * This removes the specified view from the parent view\n     * \n     * @param {object} reqOb see ElementService.getElement, use viewId and parentViewId\n     * @returns {Promise} The promise would be resolved with updated parent View object\n     */\n    var removeViewFromParentView = function(reqOb) {\n        UtilsService.normalize(reqOb);\n        var deferred = $q.defer();\n        ElementService.getElement({\n            projectId: reqOb.projectId,\n            refId: reqOb.refId,\n            elementId: reqOb.parentViewId\n        }, 2).then(function(data) {\n            if (data._childViews) {\n                var clone = {\n                    _projectId: data._projectId,\n                    _refId: data._refId,\n                    //_modified: data._modified,\n                    //_read: data._read,\n                    id: data.id,\n                    _childViews: JSON.parse(JSON.stringify(data._childViews))\n                };\n                for (var i = 0; i < clone._childViews.length; i++) {\n                    if (clone._childViews[i].id === reqOb.viewId) {\n                        clone._childViews.splice(i,1);\n                        break; \n                    }\n                }\n                ElementService.updateElement(clone, true)\n                .then(function(data2) {\n                    deferred.resolve(data2);\n                }, function(reason) {\n                    deferred.reject(reason);\n                });\n            } else {\n                deferred.resolve(data);\n            }\n        }, function(reason) {\n            deferred.reject(reason);\n        });\n        return deferred.promise;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ViewService#addElementToViewOrSection\n     * @methodOf mms.ViewService\n     *\n     * @description\n     * This updates a view or section to include a new element, the new element must be a child\n     * of an existing element in the view\n     *\n     * @param {object} reqOb see ElementService.getElement for description, elementId is the view\n     *                          or section instance element id\n     * @param {object} elementOb the element object to add (this should be an instanceValue)\n     * @param {number} addPeIndex the index of where to add view or section (instance spec) object\n     * @returns {Promise} The promise would be resolved with updated view or section object\n     */\n    var addElementToViewOrSection = function(reqOb, elementOb, addPeIndex) {\n        UtilsService.normalize(reqOb);\n        var deferred = $q.defer();\n        ElementService.getElement({\n            projectId: reqOb._projectId,\n            refId: reqOb._refId,\n            elementId: reqOb.id\n        }, 2)\n        .then(function(data) {\n            var clone = {\n                _projectId: data._projectId,\n                _refId: data._refId,\n                //_modified: data._modified,\n                id: data.id,\n            };\n            var key = '_contents';\n            if (isSection(data)) {\n                key = \"specification\";\n            }\n            if (data[key]) {\n                clone[key] = JSON.parse(JSON.stringify(data[key]));\n                if (!clone[key].id || !clone[key].ownerId) {\n                    clone[key].id = isSection(data) ? UtilsService.createMmsId() : data.id + \"_vc_expression\";\n                    clone[key].ownerId = isSection(data) ? data.id : data.id + \"_vc\";\n                }\n            } else {\n                clone[key] = UtilsService.createValueSpecElement({\n                    operand: [],\n                    type: \"Expression\",\n                    id: isSection(data) ? UtilsService.createMmsId() : data.id + \"_vc_expression\",\n                    ownerId: isSection(data) ? data.id : data.id + \"_vc\"\n                });\n            }\n            elementOb.ownerId = clone[key].id;\n            if (!elementOb.id) {\n                elementOb.id = UtilsService.createMmsId();\n            }\n            if (addPeIndex >= -1)\n                clone[key].operand.splice(addPeIndex+1, 0, UtilsService.createValueSpecElement(elementOb));\n            else\n                clone[key].operand.push(UtilsService.createValueSpecElement(elementOb));\n            // clone[key].operand.push(UtilsService.createValueSpecElement(elementOb));\n            ElementService.updateElement(clone)\n            .then(function(data2) {\n                deferred.resolve(data2);\n            }, function(reason) {\n                deferred.reject(reason);\n            });\n        }, function(reason) {\n            deferred.reject(reason);\n        });\n        return deferred.promise;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ViewService#removeElementFromViewOrSection\n     * @methodOf mms.ViewService\n     *\n     * @description\n     * This removes the specified instanceVal from the contents of the View or Section\n     * \n     * @param {object} reqOb see ElementService.getElement for description\n     * @param {object} instanceVal to remove from the View or Section\n     * @returns {Promise} The promise would be resolved with updated View or Section object\n     */\n    var removeElementFromViewOrSection = function(reqOb, instanceVal) {\n        UtilsService.normalize(reqOb);\n        var deferred = $q.defer();\n\n        if (instanceVal) {\n            ElementService.getElement(reqOb, 2)\n            .then(function(data) {\n                var clone = {\n                    _projectId: data._projectId,\n                    _refId: data._refId,\n                    //_modified: data._modified,\n                    id: data.id,\n                };\n                var key = '_contents';\n                if (isSection(data)) {\n                    key = \"specification\";\n                }\n                if (data[key]) {\n                    clone[key] = JSON.parse(JSON.stringify(data[key]));\n                    if (!clone[key].id || !clone[key].ownerId) {\n                        clone[key].id = isSection(data) ? UtilsService.createMmsId() : data.id + \"_vc_expression\";\n                        clone[key].ownerId = isSection(data) ? data.id : data.id + \"_vc\";\n                    }\n                } else {\n                    clone[key] = UtilsService.createValueSpecElement({\n                        operand: [],\n                        type: \"Expression\",\n                        id: isSection(data) ? UtilsService.createMmsId() : data.id + \"_vc_expression\",\n                        ownerId: isSection(data) ? data.id : data.id + \"_vc\"\n                    });\n                }\n                if (clone[key] && clone[key].operand) {\n                    var operands = data[key].operand;\n                    for (var i = 0; i < operands.length; i++) {\n                        if (instanceVal.instanceId === operands[i].instanceId) {\n                            clone[key].operand.splice(i,1);\n                            break;\n                        }\n                    }\n                }\n                ElementService.updateElement(clone)\n                .then(function(data2) {\n                    deferred.resolve(data2);\n                }, function(reason) {\n                    deferred.reject(reason);\n                });\n            }, function(reason) {\n                deferred.reject(reason);\n            });\n        }\n        return deferred.promise;\n    };\n\n    /**\n     * Adds a InstanceVal/InstanceSpecification to the contents of the View\n     *\n     * @param {object} viewOrSection The View or Section element object to add to\n     * @param {string} type The type of element that is to be created, ie 'Paragraph'\n     * @param {string} [name=Untitled <elementType>] (optional) InstanceSpecification name to use\n     * @param {number} addPeIndex the index of where to add view or section (instance spec) object\n     * @returns {Promise} The promise would be resolved with updated View object if addToView is true\n     *                    otherwise the created InstanceSpecification\n    */\n    var createInstanceSpecification = function(viewOrSectionOb, type, name, addPeIndex) {\n        var deferred = $q.defer();\n\n        var newInstanceId = UtilsService.createMmsId();\n        newInstanceId = '_hidden_' + newInstanceId + \"_pei\";\n\n        var realType = TYPE_TO_CLASSIFIER_TYPE[type];\n        var jsonType = realType;\n        if (type === 'Comment' || type === 'Paragraph')\n            jsonType = type;\n        /*\n        var newDataId = UtilsService.createMmsId();\n        var newDataSInstanceId = UtilsService.createMmsId();\n        var newData = UtilsService.createClassElement({\n            id: newDataId,\n            name: name + '_' + newDataId,\n            ownerId: 'holding_bin_' + viewOrSectionOb._projectId,\n            documentation: '',\n            _appliedStereotypeIds: [UtilsService.BLOCK_SID],\n            appliedStereotypeInstanceId: newDataSInstanceId\n        });\n        var newDataSInstance = UtilsService.createInstanceElement({\n            id: newDataSInstanceId,\n            stereotypedElementId: newDataId,\n            ownerId: newDataId,\n            classifierIds: [UtilsService.BLOCK_SID]\n        });\n        */\n        var instanceSpecSpec = {\n            'type': jsonType,\n            'sourceType': 'reference',\n            'source': newInstanceId,\n            'sourceProperty': 'documentation'\n        };\n        var instanceSpec = {\n            id: newInstanceId,\n            ownerId: 'view_instances_bin_' + viewOrSectionOb._projectId,\n            name: name ? name : \"Untitled \" + type,\n            documentation: '',\n            type: \"InstanceSpecification\",\n            classifierIds: [TYPE_TO_CLASSIFIER_ID[realType]],\n            specification: UtilsService.createValueSpecElement({\n                value: JSON.stringify(instanceSpecSpec),\n                type: \"LiteralString\",\n                ownerId: newInstanceId,\n                id: UtilsService.createMmsId()\n            }),\n            _appliedStereotypeIds: [],\n        };\n        instanceSpec = UtilsService.createInstanceElement(instanceSpec);\n        if (type === 'Section') {\n            //newData = newDataSInstance = null;\n            instanceSpec.specification = UtilsService.createValueSpecElement({\n                operand: [],  \n                type: \"Expression\",\n                ownerId: newInstanceId,\n                id: UtilsService.createMmsId()\n            });\n        }\n        var clone = {\n            _projectId: viewOrSectionOb._projectId,\n            id: viewOrSectionOb.id,\n            _refId: viewOrSectionOb._refId,\n        };\n        var key = '_contents';\n        if (isSection(viewOrSectionOb)) {\n            key = \"specification\";\n        }\n        if (!viewOrSectionOb[key]) {\n            clone[key] = UtilsService.createValueSpecElement({\n                operand: [],\n                type: \"Expression\",\n                id: isSection(viewOrSectionOb) ? UtilsService.createMmsId() : viewOrSectionOb.id + \"_vc_expression\",\n                ownerId: isSection(viewOrSectionOb) ? viewOrSectionOb.id : viewOrSectionOb.id + \"_vc\"\n            });\n        } else {\n            clone[key] = JSON.parse(JSON.stringify(viewOrSectionOb[key]));\n            if (!clone[key].id || !clone[key].ownerId) {\n                clone[key].id = isSection(viewOrSectionOb) ? UtilsService.createMmsId() : viewOrSectionOb.id + \"_vc_expression\";\n                clone[key].ownerId = isSection(viewOrSectionOb) ? viewOrSectionOb.id : viewOrSectionOb.id + \"_vc\";\n            }\n        }\n        if (addPeIndex >= -1) {\n            clone[key].operand.splice(addPeIndex+1, 0, UtilsService.createValueSpecElement({instanceId: newInstanceId, type: \"InstanceValue\", id: UtilsService.createMmsId(), ownerId: clone[key].id}));\n        } else {\n            clone[key].operand.push(UtilsService.createValueSpecElement({instanceId: newInstanceId, type: \"InstanceValue\", id: UtilsService.createMmsId(), ownerId: clone[key].id}));\n        }\n        clone = ElementService.fillInElement(clone);\n        var toCreate = [instanceSpec, clone];\n        /*\n        if (newData && newDataSInstance) {\n            toCreate.push(newData);\n            toCreate.push(newDataSInstance);\n        }\n        */\n        var reqOb = {\n            projectId: viewOrSectionOb._projectId,\n            refId: viewOrSectionOb._refId,\n            elements: toCreate,\n        };\n        ElementService.createElements(reqOb)\n        .then(function(data) {\n            for (var i = 0; i < data.length; i++) {\n                var elem = data[i];\n                if (elem.id === newInstanceId) {\n                    if (type === \"Section\") {\n                        $rootScope.$broadcast('viewctrl.add.section', elem, viewOrSectionOb);\n                    }\n                    deferred.resolve(elem);\n                    return;\n                }\n            }\n        }, function(reason) {\n            deferred.reject(reason);\n        });\n        return deferred.promise;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ViewService#createView\n     * @methodOf mms.ViewService\n     * \n     * @description\n     * Create a new view, owner must be specified (parent view), id cannot be specified,\n     * if name isn't specified, \"Untitled\" will be used, a default contents with \n     * paragraph of the view documentation will be used. If a document is specified, \n     * will also add the view to the document, in this case the parent view should \n     * already be in the document. The new view will be added as the last child of the \n     * parent view.\n     * \n     * @param {object} ownerOb should contain _project and _ref, can be a parent view with _childViews\n     * @param {object} viewOb can specify optional viewId, viewName, viewDoc to be used when\n     *                          creating the new view, boolean isDoc indicate whether it's a document\n     * @param {string} peDoc optional documentation to set for pe creation\n     * @returns {Promise} The promise will be resolved with the new view.\n     */\n    var createView = function(ownerOb, viewOb, peDoc) {\n        var deferred = $q.defer();\n\n        var newViewId = viewOb.viewId ? viewOb.viewId : UtilsService.createMmsId();\n        var newInstanceId = '_hidden_' + UtilsService.createMmsId() + '_pei';\n\n        var untitledName = viewOb.isDoc ? 'Untitled Document' : 'Untitled View';\n        var view = UtilsService.createClassElement({\n            id: newViewId,\n            type: 'Class',\n            ownerId: ownerOb.id,\n            _allowedElements: [],\n            _displayedElementIds: [newViewId],\n            _childViews: [],\n            _contents: UtilsService.createValueSpecElement({\n                operand: [UtilsService.createValueSpecElement({type: \"InstanceValue\", instanceId: newInstanceId})],\n                type: 'Expression',\n                id: newViewId + \"_vc_expression\",\n                ownerId: newViewId + \"_vc\"\n            }),\n            name: viewOb.viewName ? viewOb.viewName : untitledName,\n            documentation: viewOb.viewDoc ? viewOb.viewDoc : '',\n            _appliedStereotypeIds: [\n                (viewOb.isDoc ? UtilsService.DOCUMENT_SID : UtilsService.VIEW_SID)\n            ],\n            appliedStereotypeInstanceId: newViewId + '_asi'\n        });\n        var parentView = null;\n        if (ownerOb && (ownerOb._childViews || UtilsService.isView(ownerOb))) {\n            parentView = {\n                _projectId: ownerOb._projectId,\n                _refId: ownerOb._refId,\n                id: ownerOb.id\n            };\n            if (!ownerOb._childViews) {\n                parentView._childViews = [];\n            } else {\n                parentView._childViews = JSON.parse(JSON.stringify(ownerOb._childViews));\n            }\n            parentView._childViews.push({id: newViewId, aggregation: \"composite\"});\n        }\n        var peSpec = {\n            'type': 'Paragraph',\n            'sourceType': 'reference',\n            'source': newInstanceId,\n            'sourceProperty': 'documentation'\n        };\n        var pe = UtilsService.createInstanceElement({\n            id: newInstanceId,\n            ownerId: 'view_instances_bin_' + ownerOb._projectId,\n            name: \"View Paragraph\",\n            documentation: peDoc ? peDoc : '',\n            type: \"InstanceSpecification\",\n            classifierIds:[TYPE_TO_CLASSIFIER_ID.ParagraphT],\n            specification: UtilsService.createValueSpecElement({\n                value: JSON.stringify(peSpec),\n                type: \"LiteralString\",\n                id: UtilsService.createMmsId(),\n                ownerId: newInstanceId\n            }),\n            _appliedStereotypeIds: [],\n        });\n        var asi = UtilsService.createInstanceElement({ //create applied stereotype instance\n            id: newViewId + '_asi',\n            ownerId: newViewId,\n            documentation: '',\n            name: '',\n            type: 'InstanceSpecification',\n            classifierIds: [(viewOb.isDoc ? UtilsService.DOCUMENT_SID : UtilsService.VIEW_SID)],\n            _appliedStereotypeIds: [],\n            stereotypedElementId: newViewId\n        });\n        var toCreate = [pe, view, asi];\n        if (parentView) {\n            parentView = ElementService.fillInElement(parentView);\n            toCreate.push(parentView);\n        }\n        var reqOb = {\n            projectId: ownerOb._projectId,\n            refId: ownerOb._refId,\n            elements: toCreate,\n            returnChildViews: true\n        };\n        ElementService.createElements(reqOb)\n        .then(function(data) {\n            data.forEach(function(elem) {\n                if (elem.id === newViewId) {\n                    deferred.resolve(elem);\n                }\n            });\n        }, function(reason) {\n            deferred.reject(reason);\n        });\n        return deferred.promise;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ViewService#createDocument\n     * @methodOf mms.ViewService\n     * \n     * @description\n     * Create a new document,\n     * if name isn't specified, \"Untitled\" will be used, a default contents with \n     * paragraph of the view documentation will be used.\n     * \n     * @param {object} ownerOb see createView\n     * @param {object} docOb see createView\n     * @returns {Promise} The promise will be resolved with the new view.\n     */\n    var createDocument = function(ownerOb, docOb) {\n        var deferred = $q.defer();\n        docOb.isDoc = true;\n        createView(ownerOb, docOb)\n            .then(function(data2) {\n                if (ownerOb && ownerOb.id.indexOf(\"holding_bin\") < 0) {\n                    data2._groupId = ownerOb.id;\n                }\n                var cacheKey = ['documents', ownerOb._projectId, ownerOb._refId];\n                if (CacheService.exists(cacheKey)) {\n                    CacheService.get(cacheKey).push(data2);\n                }\n                deferred.resolve(data2);\n            }, function(reason) {\n                deferred.reject(reason);\n            });\n        return deferred.promise;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ViewService#createGroup\n     * @methodOf mms.ViewService\n     *\n     * @description\n     * create a group depending on what the user has selected:\n     *   - if the user has not selected anything, create a group at the root level of the project\n     *   - if the user has selected a group, create a child group\n     *   - if the user has selected anything else, let the user know that they must select a group\n     * owner must be specified (parent view/document)\n     * id cannot be specified (automatically generated)\n     * if name isn't specified, \"Untitled\" will be used.\n     *\n     * @param {object} name group name new-doc-or-group.html\n     * @param {object} ownerOb parent id, projectId and refId\n     * @param {string} orgId parent orgId\n     * @returns {Promise} The promise will be resolved with the new group object.\n     */\n    var createGroup = function(name, ownerOb, orgId) {\n        var deferred = $q.defer();\n\n        var PACKAGE_ID = UtilsService.createMmsId(), PACKAGE_ASI_ID = PACKAGE_ID + \"_asi\";\n        // Our Group package element\n        var group = UtilsService.createPackageElement(\n            {\n                \"id\" : PACKAGE_ID,\n                \"name\" : (name) ? name : \"Untitled\",\n                \"ownerId\" : ownerOb.id,\n                \"_isGroup\": true,\n                \"_appliedStereotypeIds\": [GROUP_ST_ID],\n                \"appliedStereotypeInstanceId\": PACKAGE_ASI_ID\n            }\n        );\n        var groupAsi = UtilsService.createInstanceElement(\n            {\n                \"classifierIds\" : [GROUP_ST_ID],\n                \"id\" : PACKAGE_ASI_ID,\n                \"ownerId\" : PACKAGE_ID,\n                \"visibility\" : null,\n                \"stereotypedElementId\" : PACKAGE_ID\n            }\n        );\n        var toCreate = [group, groupAsi];\n        var reqOb = {\n            projectId: ownerOb._projectId,\n            refId: ownerOb._refId,\n            elements: toCreate\n        };\n        ElementService.createElements(reqOb)\n            .then(function(data) {\n                var cacheKey = ['groups', ownerOb._projectId, ownerOb._refId];\n                var groupObj = _.find(data, {id: PACKAGE_ID});\n                if (groupObj) {\n                    groupObj._parentId = ownerOb.id.indexOf('holding') != -1 ? null : ownerOb.id;\n                    groupObj._link = '/share/page/repository#filter=path|/Sites/' + orgId + '/documentLibrary/' + groupObj._projectId + '/' + groupObj.id;\n                    if (CacheService.exists(cacheKey)) {\n                        CacheService.get(cacheKey).push(groupObj);\n                    }\n                    CacheService.put(['group', groupObj.projectId, groupObj.refId, groupObj.id], groupObj, true);\n                    deferred.resolve(groupObj);\n                } else {\n                    deferred.reject({status: 500, message: \"Failed to create group\"});\n                }\n            }, function(reason) {\n                console.log('POST failed:', reason);\n                deferred.reject(reason);\n            });\n        return deferred.promise;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ViewService#deleteGroup\n     * @methodOf mms.ViewService\n     *\n     * @description remove a group\n     *\n     * @param {object} elementOb group to remove\n     * @returns {Promise} The promise will be resolved with the updated group object.\n     */\n    var removeGroup = function(elementOb) {\n        elementOb._isGroup = false;\n        _.remove(elementOb._appliedStereotypeIds, function(id) {\n            return id === GROUP_ST_ID;\n        });\n        elementOb.appliedStereotypeInstanceId = elementOb._appliedStereotypeIds.length > 0 ? elementOb.appliedStereotypeInstanceId : null;\n        var updatedElement = {\n            id: elementOb.id,\n            _projectId: elementOb._projectId,\n            _refId: elementOb._refId,\n            _appliedStereotypeIds: elementOb._appliedStereotypeIds,\n            appliedStereotypeInstanceId: elementOb.appliedStereotypeInstanceId,\n            _isGroup: elementOb._isGroup\n        };\n        var toUpdate = [updatedElement];\n        if (updatedElement.appliedStereotypeInstanceId !== null) {\n            toUpdate.push({\n                id: elementOb.id + '_asi', \n                _refId: elementOb._refId, \n                _projectId: elementOb._projectId,\n                classifierIds: updatedElement._appliedStereotypeIds\n            });\n        } else {\n            $http.delete(URLService.getElementURL({\n                elementId: elementOb.id + '_asi', \n                refId: elementOb._refId, \n                projectId: elementOb._projectId\n            }));\n        }\n        return ElementService.updateElements(toUpdate, false)\n            .then(function(data) {\n                // remove this group for cache\n                var cacheKey = ['groups', elementOb._projectId, elementOb._refId];\n                var groups = CacheService.get(cacheKey) || [];\n                _.remove(groups, function(group) {\n                    return group.id === elementOb.id;\n                });\n                return data;\n            }, function(reason) {\n                return reason;\n            });\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ViewService#getProjectDocuments\n     * @methodOf mms.ViewService\n     * \n     * @description\n     * Gets all the documents in a site\n     * \n     * @param {string} site Site name\n     * @param {boolean} [update=false] Update latest\n     * @param {string} [workspace=master] workspace to use \n     * @param {string} [version=latest] timestamp\n     * @param {int} weight the priority of the request\n     * @returns {Promise} The promise will be resolved with array of document objects \n     */\n    var getProjectDocuments = function(reqOb, weight, update) {\n        UtilsService.normalize(reqOb);\n        var deferred = $q.defer();\n        var url = URLService.getProjectDocumentsURL(reqOb);\n        var cacheKey = ['documents', reqOb.projectId, reqOb.refId];\n        if (CacheService.exists(cacheKey) && !update) {\n            deferred.resolve(CacheService.get(cacheKey));\n        } else {\n            ElementService.getGenericElements(url, reqOb, 'documents', weight, update).\n            then(function(data) {\n                deferred.resolve(CacheService.put(cacheKey, data, false));\n            }, function(reason) {\n                deferred.reject(reason);\n            });\n        }\n        return deferred.promise;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ViewService#getPresentationElementSpec\n     * @methodOf mms.ViewService\n     * \n     * @description\n     * Parses an instanceSpec of the expression reference tree in the contents\n     * of a View, and returns the corresponding presentation element json object.\n     * \n     * @param {object} instanceSpec instance specification object\n     * @returns {object} The json object for the corresponding presentation element\n     */\n    var getPresentationElementSpec = function(instanceSpec) {\n        var instanceSpecSpec = instanceSpec.specification;\n        if (!instanceSpecSpec) {\n            return {status: 500, message: 'missing specification'};\n        }\n        var type = instanceSpecSpec.type;\n\n        if (type === 'LiteralString') { // If it is a Opaque List, Paragraph, Table, Image, List:\n            var jsonString = instanceSpecSpec.value;\n            return JSON.parse(jsonString);\n        } else if (type === 'Expression') { // If it is a Opaque Section, or a Expression:\n            // If it is a Opaque Section then we want the instanceSpec:\n            if (isSection(instanceSpec)) {\n                return instanceSpec;\n            } else { //??\n                return instanceSpecSpec;\n            }\n        }\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ViewService#getElementReferenceTree\n     * @methodOf mms.ViewService\n     * \n     * @description\n     * gets the presentation element tree as an array of tree nodes\n     * a tree node is this:\n     * <pre>\n        {\n            instanceId: id of the instance,\n            instanceVal: instanceValue object,\n            sectionElements: array of child tree nodes,\n            instanceSpecification: instance specification object of the instance,\n            presentationElement: json of the presentation element or a section instance spec with type = Section\n        }\n     * </pre>\n     *\n     * @param {object} reqOb see ElementService.getElement\n     * @param {object} contents an expression object from a view or section\n     * @param {int} weight the priority of the request\n     * @returns {Promise} The promise will be resolved with array of tree node objects\n     */\n    var getElementReferenceTree = function(reqOb, contents, weight) {\n        var promises = [];\n        for (var i = 0; i < contents.operand.length; i++) {\n            promises.push(getElementReference(reqOb, contents.operand[i], weight));\n        }\n        return $q.all(promises);\n    };\n\n    var getElementReference = function(reqOb, instanceVal, weight) {\n        var deferred = $q.defer();\n\n        var elementObject = {};\n        elementObject.instanceId = instanceVal.instanceId;\n        elementObject.instanceVal = instanceVal;\n        elementObject.sectionElements = [];\n\n        var req = JSON.parse(JSON.stringify(reqOb));\n        req.elementId = instanceVal.instanceId;\n        ElementService.getElement(req, weight)\n        .then(function(instanceSpecification) {\n            elementObject.instanceSpecification = instanceSpecification;\n            if (instanceSpecification.classifierIds &&\n                    instanceSpecification.classifierIds.length > 0 && \n                    opaqueClassifiers.indexOf(instanceSpecification.classifierIds[0]) >= 0) {\n                elementObject.isOpaque = true;\n            } else {\n                elementObject.isOpaque = false;\n            }\n            var presentationElement = getPresentationElementSpec(instanceSpecification);\n            elementObject.presentationElement = presentationElement;\n            if (isSection(presentationElement)) {\n                getElementReferenceTree(req, presentationElement.specification)\n                .then(function(sectionElementReferenceTree) {\n                    elementObject.sectionElements = sectionElementReferenceTree;\n                    deferred.resolve(elementObject);\n                }, function(reason) {\n                    deferred.reject(reason);\n                });\n            } else\n                deferred.resolve(elementObject);\n        }, function(reason) {\n            deferred.reject(reason);\n        });\n        return deferred.promise;\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.ViewService#isSection\n     * @methodOf mms.ViewService\n     * \n     * @description\n     * Returns true if the passed InstanceSpecification is a Section\n     * \n     * @param {Object} instanceSpec A InstanceSpecification json object\n     * @returns {boolean} whether it's a section\n     */\n    var isSection = function(instanceSpec) {\n        return instanceSpec.classifierIds &&\n               instanceSpec.classifierIds.length > 0 &&\n               (instanceSpec.classifierIds[0] === TYPE_TO_CLASSIFIER_ID.Section ||\n                instanceSpec.classifierIds[0] === TYPE_TO_CLASSIFIER_ID.SectionT);\n    };\n\n    var isTable = function(instanceSpec) {\n        return instanceSpec.classifierIds && \n               instanceSpec.classifierIds.length > 0 &&\n               (instanceSpec.classifierIds[0] === TYPE_TO_CLASSIFIER_ID.Table ||\n                instanceSpec.classifierIds[0] === TYPE_TO_CLASSIFIER_ID.TableT);\n    };\n\n    var isFigure = function(instanceSpec) {\n        return instanceSpec.classifierIds && \n               instanceSpec.classifierIds.length > 0 &&\n               (instanceSpec.classifierIds[0] === TYPE_TO_CLASSIFIER_ID.ImageT ||\n                instanceSpec.classifierIds[0] === TYPE_TO_CLASSIFIER_ID.Image || \n                instanceSpec.classifierIds[0] === TYPE_TO_CLASSIFIER_ID.Figure ||\n                instanceSpec.classifierIds[0] === TYPE_TO_CLASSIFIER_ID.FigureT);\n    };\n\n    var isEquation = function(instanceSpec) {\n        return instanceSpec.classifierIds && \n               instanceSpec.classifierIds.length > 0 &&\n               instanceSpec.classifierIds[0] === TYPE_TO_CLASSIFIER_ID.Equation;\n    };\n\n    var getTreeType = function(instanceSpec) {\n        if (isSection(instanceSpec))\n            return 'section';\n        if (instanceSpec.specification && instanceSpec.specification.value && JSON.parse(instanceSpec.specification.value).excludeFromList) {\n            return null;\n        }\n        if (isTable(instanceSpec))\n            return 'table';\n        if (isFigure(instanceSpec))\n            return 'figure';\n        if (isEquation(instanceSpec))\n            return 'equation';\n        return null;\n    };\n\n    var processSlotStrings = function(values) {\n        var res = [];\n        if (!values || values.length === 0) {\n            return res;\n        }\n        values.forEach(function(value) {\n            if (value.type !== 'LiteralString' || !value.value)\n                return;\n            res.push(value.value);\n        });\n        return res;\n    };\n\n    var processSlotIntegers = function(values) {\n        var res = [];\n        if (!values || values.length === 0) {\n            return res;\n        }\n        values.forEach(function(value) {\n            if (Number.isInteger(value.value)) {\n                res.push(value.value);\n            } else if ((typeof value.value) === 'string') {\n                var val = parseInt(value.value);\n                if (!isNaN(val)) {\n                    res.push(val);\n                }\n            }\n        });\n        return res;\n    };\n    \n    /**\n     * @ngdoc method\n     * @name mms.ViewService#getDocMetadata\n     * @methodOf mms.ViewService\n     * \n     * @description\n     * gets Document properties from docgen's stereotypes\n     *\n     * @param {object} reqOb see ElementService.getElement\n     * @param {integer} weight the priority of the request\n     * @returns {Promise} The promise will be resolved with metadata object\n     *                      with name value pairs corresponding to document stereotype\n     */\n    var getDocMetadata = function(reqOb, weight) {\n        var deferred = $q.defer();\n        var metadata = {numberingDepth: 0, numberingSeparator: '.'};\n        reqOb.elementIds = [\n            reqOb.elementId + '_asi-slot-_17_0_1_407019f_1326234342817_186479_2256', //header\n            reqOb.elementId + '_asi-slot-_17_0_1_407019f_1326234349580_411867_2258', //footer\n            reqOb.elementId + '_asi-slot-_18_5_3_8bf0285_1526605771405_96327_15754', //numbering depth\n            reqOb.elementId + '_asi-slot-_18_5_3_8bf0285_1526605817077_688557_15755' //numbering separator\n        ];\n        ElementService.getElements(reqOb, weight)\n        .then(function(data) {\n            if (data.length === 0) {\n                return;\n            }\n            for (var i = 0; i < data.length; i++) {\n                var prop = data[i];\n                var feature = prop.definingFeatureId ? prop.definingFeatureId : null;\n                var value = prop.value ? prop.value : null;\n                if (!feature || !value || value.length === 0) {\n                    continue;\n                }\n                var result = [];\n                if (feature === '_17_0_1_407019f_1326234342817_186479_2256') { //header\n                    result = processSlotStrings(value);\n                    metadata.top = result.length > 0 ? result[0] : '';\n                    metadata.topl = result.length > 1 ? result[1] : '';\n                    metadata.topr = result.length > 2 ? result[2] : '';\n                } else if (feature == '_17_0_1_407019f_1326234349580_411867_2258') {//footer\n                    result = processSlotStrings(value);\n                    metadata.bottom = result.length > 0 ? result[0] : '';\n                    metadata.bottoml = result.length > 1 ? result[1] : '';\n                    metadata.bottomr = result.length > 2 ? result[2] : '';\n                } else if (feature == '_18_5_3_8bf0285_1526605771405_96327_15754') { //depth\n                    result = processSlotIntegers(value);\n                    metadata.numberingDepth = result.length > 0 ? result[0] : 0;\n                } else if (feature == '_18_5_3_8bf0285_1526605817077_688557_15755') { //separator\n                    result = processSlotStrings(value);\n                    metadata.numberingSeparator = result.length > 0 ? result[0] : '.';\n                }\n            }\n        }, function(reason) {\n        }).finally(function() {\n            deferred.resolve(metadata);\n        });\n        return deferred.promise;\n    };\n\n    var getPresentationElementType = function (instanceSpec) {\n        if (instanceSpec.type === 'InstanceSpecification') {\n            if (isSection(instanceSpec)) {\n                return 'Section';\n            }  else if (isTable(instanceSpec)) {\n                return 'Table';\n            } else if (isFigure(instanceSpec)) {\n                return 'Image';\n            } else if (isEquation(instanceSpec)) {\n                return 'Equation';\n            } else if (instanceSpec.specification && instanceSpec.specification.value) {\n                // var type = JSON.parse(instanceSpec.specification.value).type;\n                // return type.toLowerCase();\n                return JSON.parse(instanceSpec.specification.value).type;\n            }\n        }\n        return false;\n    };\n\n    var isGroup = function(instanceSpec) {\n        return instanceSpec._appliedStereotypeIds.length > 0 && instanceSpec._appliedStereotypeIds[0] === GROUP_ST_ID;\n    };\n\n    var getElementType = function(element) {\n        // Get Type\n        var elementType = '';\n        if (UtilsService.isRequirement(element)) {\n            elementType = 'Requirement';\n        } else if (UtilsService.isDocument(element)) {\n            elementType = 'Document';\n        } else if (UtilsService.isView(element)) {\n            elementType = 'View';\n        } else if (isGroup(element)) {\n            elementType = 'Group';\n        } else {\n            elementType = getPresentationElementType(element);\n        }\n        return elementType;\n    };\n\n    var reset = function() {\n        inProgress = {};\n    };\n\n    var getTypeFromClassifierId = function(classifierIds) {\n        var type = '';\n        if ( classifierIds && classifierIds.length > 0) {\n            Object.keys(TYPE_TO_CLASSIFIER_ID).some(function(key) {\n                if(TYPE_TO_CLASSIFIER_ID[key] === classifierIds[0]) {\n                    type = key;\n                    return true;\n                }\n                return false;\n            });\n        }\n        return type;\n    };\n\n\n    return {\n        TYPE_TO_CLASSIFIER_ID: TYPE_TO_CLASSIFIER_ID,\n        getViewElements: getViewElements,\n        createView: createView,\n        createDocument: createDocument,\n        createGroup: createGroup,\n        removeGroup: removeGroup,\n        downgradeDocument: downgradeDocument,\n        addViewToParentView: addViewToParentView,\n        getDocumentViews: getDocumentViews,\n        getProjectDocuments: getProjectDocuments,\n        getPresentationElementSpec: getPresentationElementSpec,\n        isSection: isSection,\n        isFigure: isFigure,\n        isTable: isTable,\n        isEquation: isEquation,\n        getTreeType: getTreeType,\n        getPresentationElementType: getPresentationElementType,\n        getElementType: getElementType,\n        addElementToViewOrSection: addElementToViewOrSection,\n        removeElementFromViewOrSection: removeElementFromViewOrSection,\n        removeViewFromParentView: removeViewFromParentView,\n        createInstanceSpecification: createInstanceSpecification,\n        getTypeFromClassifierId: getTypeFromClassifierId,\n        getElementReferenceTree : getElementReferenceTree,\n        getDocMetadata: getDocMetadata,\n        reset: reset,\n        AnnotationType: AnnotationType\n    };\n\n}\n","'use strict';\n\nangular.module('mms')\n.factory('VizService', ['$q', '$http', 'URLService', 'CacheService', 'UtilsService', 'AuthService', VizService]);\n\n/**\n * @ngdoc service\n * @name mms.VizService\n * @requires $q\n * @requires $http\n * @requires mms.URLService\n * @requries mms.CacheService\n * @requires mms.UtilsService\n * \n * @description\n * This service handles visualization needs and diagramming (TBD)\n */\nfunction VizService($q, $http, URLService, CacheService, UtilsService, AuthService) {\n\n    /**\n     * @ngdoc method\n     * @name mms.VizService#getImageURL\n     * @methodOf mms.VizService\n     * \n     * @description\n     * Gets the url for an image link based on the Magicdraw diagram id \n     * \n     * @returns {Promise} The promise will be resolved with the latest image url\n     */\n    var getImageURL = function(reqOb) {\n        var deferred = $q.defer();\n        var cacheKey = createImageCacheKey(reqOb);\n        if (CacheService.exists(cacheKey)) {\n            deferred.resolve(makeImageUrl(CacheService.get(cacheKey)));\n            return deferred.promise;\n        }\n        $http.get(URLService.getImageURL(reqOb), {headers: {Accept: reqOb.accept}})\n        .then(function(data) {\n            CacheService.put(cacheKey, data.data.artifacts[0], false);\n            deferred.resolve(makeImageUrl(data.data.artifacts[0]));\n        }, function(data) {\n            URLService.handleHttpStatus(data.data, data.status, data.headers, data.config, deferred);\n        });\n        return deferred.promise;\n    };\n\n    var makeImageUrl = function(data) {\n        var root = URLService.getRoot();\n        var newroot = '';\n        if (root.indexOf('http') > -1) {\n            var parts = root.split('/');\n            if (parts.length >= 3)\n                newroot = parts[0] + '/' + parts[1] + '/' + parts[2];\n        }\n        return newroot + '/alfresco' + data.url + '?alf_ticket=' + AuthService.getTicket();\n    };\n\n    var createImageCacheKey = function(reqOb) {\n        var refId = !reqOb.refId ? 'master' : reqOb.refId;\n        var commitId = !reqOb.commitId ? 'latest' : reqOb.commitId;\n        return ['image', reqOb.projectId, refId, reqOb.elementId, commitId, reqOb.accept];\n    };\n\n    return {\n        getImageURL: getImageURL\n    };\n\n}","'use strict';\n\nangular.module('mms').filter('underlineMatch', ['$filter', partialMatch]);\nfunction partialMatch($filter) {\n    var uibTypeaheadHighlightFn = $filter('uibTypeaheadHighlight');\n    return function(match, query) {\n        var result = uibTypeaheadHighlightFn(match, query);\n        result = result.replace('<strong>', '<u>').replace('</strong>', '</u>');\n        return result;\n    }\n}\n","'use strict';\n angular.module('mms.directives')\n    .directive('mmsC3Plot', ['TableService', '$window', '_', mmsC3Plot]);\nfunction mmsC3Plot(TableService, $window, _) {\n      \n  var mmsChartLink = function(scope, element, attrs, mmsViewCtrl) {\n\n    var c3 = $window.c3;\n    var d3 = $window.d3;\n    var divchart = d3.select(element[0]).append('div');\n\n    var projectId;\n    var refId;\n    var commitId;\n\n    if (mmsViewCtrl) {\n      var viewVersion = mmsViewCtrl.getElementOrigin();\n      projectId = viewVersion.projectId;\n      refId = viewVersion.refId;\n      commitId = viewVersion.commitId;\n    }\n\n    /**\n     * for any value that's not an object, assume it's a function string, \n     * eval it and assign to same key\n     * @param {*} object \n     */\n    function simplifyFunctions(object){\n      _.forOwn(object, function(value, key, ob) {\n        if (_.isPlainObject(value)) {\n          simplifyFunctions(value);\n        } else {\n          ob[key] = eval('(' + value + ')');\n        }\n      });\n    }\n\n    function vf_pplot(c3json, c3jfunc) { \n      if (c3jfunc && _.isPlainObject(c3jfunc)) {\n        simplifyFunctions(c3jfunc);\n        _.merge(c3json, c3jfunc);\n      }\n      c3.generate(c3json);\n    }\n  \n    scope.render = function() {\n      TableService.readvalues(scope.plot, projectId, refId, commitId)\n      .then( function(value) {\n          scope.valuesO = value.tablebody.valuesO; //value objects used in watch\n          var c3options;\n          if (value.tablebody.c3_data.length === 0) { //no data\n            return;\n          }\n          if ( scope.plot.config.options === undefined || scope.plot.config.options.length === 0 ){\n            if (value.isHeader)\n              c3options = {data: {x: \"x\", type: \"line\"}, axis : {x: {type:\"category\", tick:{centered:true}}}};\n            else \n              c3options = {data: {}};\n          }\n          else\n              c3options = scope.plot.config.options;\n          if ( value.tablebody.c3_data.length === scope.plot.table.body.length && \n              c3options.data.xs === undefined && value.isHeader){\n              value.tablebody.c3_data.unshift(['x'].concat(value.tableheader));\n          }\n          c3options.data.columns = value.tablebody.c3_data;\n\n          var c3jfunc;\n          if (scope.plot.config.functions) {\n            c3jfunc = scope.plot.config.functions;\n          }\n          divchart.selectAll('*').remove();\n          divchart.attr(\"id\", 'c3chart' + scope.$id);\n          c3options.bindto = '#c3chart' + scope.$id;\n        \n          vf_pplot(c3options, c3jfunc); \n      });\n    };//end of render\n\n  \n    scope.$watch('valuesO', function(newVals, oldVals) {\n        return scope.render();\n    }, true);\n  }; //end of link\n\n  return {\n    restrict: 'EA',\n    require: '?^mmsView',\n     scope: {\n      plot: '<'\n    },\n    link: mmsChartLink\n  }; //return\n}\n\n\n\n","//d3js grouped horizontal bar chart is created by referencing\n//http://bl.ocks.org/erikvullings/51cc5332439939f1f292\n'use strict';\n angular.module('mms.directives')\n    .directive('mmsD3GroupedHorizontalBarPlot', ['TableService','$window', mmsD3GroupedHorizontalBarPlot]);\nfunction mmsD3GroupedHorizontalBarPlot(TableService, $window) {\n\n    var mmsChartLink = function(scope, element, attrs, mmsViewCtrl) {\n\n      var d3 = $window.d3;  \n      var divchart = d3.select(element[0]).append('div');\n      var defaultPlotConfig = {width : 960,\n        marginTop:20, marginRight:40, marginBottom:30, marginLeft:40};\n     var plotConfig = TableService.plotConfig(scope.plot.config.options, defaultPlotConfig); \n      var achartdata;\n      element.click(function(e) {\n        //stop Propogating event to parent(mms-transclude-doc) element.\n        e.stopPropagation();\n      });\n\n      var d3colorR = d3.scaleOrdinal(d3.schemeCategory10).range();\n      function getColor(data, i){\n        return data.colors !== undefined ? d3colorR[data.colors[i]] : d3colorR[i];\n      }\n      var projectId;\n      var refId;\n      var commitId;\n\n      if (mmsViewCtrl) {\n        var viewVersion = mmsViewCtrl.getElementOrigin();\n        projectId = viewVersion.projectId;\n        refId = viewVersion.refId;\n        commitId = viewVersion.commitId;\n      }\n      var opacitydefault = 1,//0.7,\n          opacityselected = 1.0,\n          opacitynotselected = 0.3;\n\n      function mouseout(){\n        d3.selectAll(\".ghbbar\")\n          .transition(200)\n          .style(\"fill-opacity\", opacitydefault); \n\n        d3.selectAll(\".legendRect\")\n          .transition(200)\n          .style(\"fill-opacity\", opacitydefault); \n\n        d3.selectAll(\".legentFilter\")\n          .transition(200)\n          .style(\"opacity\", opacitydefault);\n      }//end of function mouseout\n\n      function mouseover(mouseoverClassId){\n            d3.selectAll(\".ghbbar\")\n            .transition(200)\n            .style(\"fill-opacity\", opacitynotselected); \n\n             d3.selectAll(\".legendRect\")\n            .transition(200)\n            .style(\"fill-opacity\", opacitynotselected); \n\n            d3.selectAll(\".legentFilter\")\n            .transition(200)\n            .style(\"opacity\", opacitynotselected);\n            \n            d3.selectAll(mouseoverClassId)\n            .transition(200)\n            .style(\"fill-opacity\", opacityselected);\n           \n            d3.selectAll(mouseoverClassId)\n            .transition(200)\n            .style(\"opacity\", opacityselected);\n      } //end of function mouseover\n\n      function createFilters(data){\n            //create only one filter display\n            var graphFilter = divchart.append('div')\n              .attr(\"class\", 'graphFilter '+ data.id)\n              .style('margin-left', plotConfig.marginLeft + 'px');\n            var filterLegendsDiv = graphFilter.append('div')\n              .append('label').style('border', '1px solid #ddd')\n              .text (\"Filter by Legends\");\n              filterLegendsDiv\n                .selectAll(\"div\")\n                .data(data.legends)\n                .enter()  \n                .append(\"div\")\n                .attr(\"class\", function(d,i){return \"legentFilter \"+ data.id + \" \" + TableService.toValidId(d);} )\n                .attr(\"style\", function(d,i){return \"opacity: \" + opacitydefault + \";background-color:\" + getColor(data,i) + \";\";})\n                .on('mouseover', function (d, i) {\n                    mouseover(\".\"+data.id +\".\" + TableService.toValidId(d));\n                })\n                .on('mouseout', function (d, i) {\n                    mouseout();\n                })\n                .append(\"label\")\n                .each(function (d, i) {\n                      // create checkbox for each data\n                      d3.select(this).append(\"input\")\n                        .attr(\"type\", \"checkbox\")\n                        .attr(\"checked\",function(d,i){\n                          if (data.legendsFilter[TableService.toValidId(d)] === true)\n                            return true;\n                          else \n                            return null;\n                        })\n                        .attr(\"style\", function(d,i){var color = getColor(data,i); return \"color: \" +color + \";background-color:\" + color + \";\";})\n                        .on(\"click\", function (d) {\n                            // filter by legends\n                            data.legendsFilter[TableService.toValidId(d)] = this.checked;\n                            createGroupedHorizontalBarChart(achartdata); \n                            createFilters(achartdata);\n                         });\n                      d3.select(this).append(\"span\")\n                          .text(function (d) {\n                              return d;\n                          });\n              });\n              var filterColoumnsDiv = graphFilter.append('div')\n                .append('label').style('border', '1px solid #ddd')\n                .text (\"Filter by Columns\");\n              filterColoumnsDiv\n                .selectAll(\"div\")\n                .data(data.labels)\n                .enter()  \n                .append(\"div\")\n                .attr(\"class\", function(d,i){return \"columnfilter \"+ data.id + \" \" + TableService.toValidId(d);} )\n                .on('mouseover', function (d, i){\n                      mouseover('.'+data.id+'.' + TableService.toValidId(d));\n                })\n                .on('mouseout', function (d, i){\n                      mouseout();\n                })\n                .append(\"label\")\n                .each(function (d, i) {\n                    // create checkbox for each data\n                    d3.select(this).append(\"input\")\n                      .attr(\"type\", \"checkbox\")\n                      .attr(\"checked\", function(d,i){\n                          if (data.labelsFilter[TableService.toValidId(d)] === true)\n                            return true;\n                          else \n                            return null;\n                      })\n                      .on(\"click\", function (d) {\n                          //filter by columns(labels)\n                          data.labelsFilter[TableService.toValidId(d)] = this.checked;     \n                          createGroupedHorizontalBarChart(achartdata); //2nd argument is not used\n                          createFilters(achartdata);\n                       });\n                    d3.select(this).append(\"span\")\n                        .text(function (d) {\n                            return d;\n                    });\n              });\n      } //end of function createFilter\n\n      function createGroupedHorizontalBarChart(data)\n      {\n        divchart.selectAll('*').remove();\n        divchart.attr(\"class\", achartdata.id )\n          .attr(\"style\", 'border:1px solid #ddd');\n         \n        var svg = divchart.append(\"svg:svg\")\n          .attr(\"class\", \"ghbchart \" + data.id);\n      \n        var filteredDataValues = [];\n        var filteredDataSysmlids=[];\n        var filteredDataColors=[];\n        var filteredDataLegends=[];//table row headers\n        var filteredDataLabels=[];//table column headers\n        var datalegendsfilter = data.legendsFilter;\n        var datalabelsfilter = data.labelsFilter;            \n        var counter = -1;\n\n        for (var i=0; i<data.labels.length; i++) {\n          if ( datalabelsfilter[TableService.toValidId(data.labels[i])]){\n            filteredDataLabels.push(data.labels[i]);\n            for (var j=0; j<data.values.length; j++) { //data.values.length == data.legends.length\n              counter++;\n              if (datalegendsfilter[TableService.toValidId(data.legends[j])]){\n                filteredDataValues.push(Number(data.values[j][i]));\n                filteredDataSysmlids.push(data.valueIds[j][i]);\n                filteredDataColors.push(getColor(data ,counter % data.legends.length));\n                filteredDataLegends.push(TableService.toValidId(data.legends[j]));\n              }\n            }\n          }\n        }\n        var filteredLegendsLength = filteredDataLegends.length/filteredDataLabels.length;\n        \n        var chartWidth       = plotConfig.width-260,\n            barHeight        = 20,\n            groupHeight      = barHeight * filteredLegendsLength,\n            gapBetweenGroups = 10,\n            spaceForLabels   = plotConfig.marginLeft,\n            spaceForLegend   = 200,\n            marginbottom = 50;\n        var chartHeight = barHeight * filteredDataValues.length + gapBetweenGroups * filteredDataLabels.length;\n\n        var x = d3.scaleLinear()//d3.scale.linear()\n            .domain([0, d3.max(filteredDataValues)])\n            .range([0, chartWidth]);\n\n        var y = d3.scaleLinear()//d3.scale.linear()\n            .range([chartHeight + gapBetweenGroups, 0]);\n\n        var yAxis = d3.axisLeft(y)//d3.svg.axis()\n            .tickFormat('')\n            .tickSize(0);\n                        \n        // Specify the chart area and dimensions\n        var chart = svg\n            .attr(\"width\", plotConfig.width)\n            .attr(\"height\", chartHeight + marginbottom);\n        \n        // Create bars\n        var bar = chart.selectAll(\"g\")\n            .data(filteredDataValues)\n            .enter().append(\"g\")\n            .attr(\"transform\", function(d, i) {\n              return \"translate(\" + spaceForLabels + \",\" + (i * barHeight + gapBetweenGroups * (0.5 + Math.floor(i/filteredLegendsLength))) + \")\";\n            });\n        var numRows = filteredDataLegends.length/filteredDataLabels.length;\n        // Create rectangles of the correct width\n        bar.append(\"rect\")\n            .attr('id', function(d,i){ return filteredDataSysmlids[i];})\n            .attr(\"fill\", function(d,i) { return filteredDataColors[i]; })\n            .style(\"fill-opacity\", opacitydefault)\n            .attr(\"class\", function(d,i){ \n              return \"ghbbar \"+ data.id + \" \" + filteredDataLegends[i] + \" \" + TableService.toValidId(filteredDataLabels[Math.floor(i/numRows)]);\n              })\n            .attr(\"width\", x)\n            .attr(\"height\", barHeight - 1)\n            .on('click', function(d, i) {\n              if (mmsViewCtrl)\n                  mmsViewCtrl.transcludeClicked(this.id); \n            })\n            .on('mouseover', function (d, i){\n               mouseover(\".\"+ data.id+\".\" + filteredDataLegends[i]);\n            })\n            .on('mouseout', function (d, i){\n              mouseout();\n            });\n        // Add text label in bar\n        bar.append(\"text\")\n            .attr(\"class\", function(d,i){ return \"ghbbar \"+data.id + \" \" + filteredDataLegends[i];})\n            .attr(\"x\", function(d) { return x(d) - 3; })\n            .attr(\"y\", barHeight / 2)\n            .attr(\"dy\", \".35em\")\n            .text(function(d) { return d; });\n\n        //left side label      \n        bar.each(function(d, i){\n            if (i % filteredLegendsLength === 0){\n               d3.select(this).append(\"text\")\n              .attr(\"class\", \"label\")\n              .attr(\"x\", function(d) { return - 10; })\n              .attr(\"y\", groupHeight / 2)\n              .attr(\"dy\", \".35em\")\n              .text(filteredDataLabels[Math.floor(i/filteredLegendsLength)]);\n            }\n        });\n        chart.append(\"g\")\n              .attr(\"class\", \"y axis\")\n              .attr(\"id\", \"ghbaxis\")\n              .attr(\"transform\", \"translate(\" + spaceForLabels + \", \" + -gapBetweenGroups/2 + \")\")\n              .call(yAxis);\n\n        // Draw legend\n        var legendRectSize = 18,\n            legendSpacing  = 4;\n        var mouseoverId;\n        var legend = chart.selectAll('.legend')\n            .data(data.legends)\n            .enter()\n            .append('g')\n            .attr('transform', function (d, i) {\n                var height = legendRectSize + legendSpacing;\n                var offset = -gapBetweenGroups/2;\n                var horz = spaceForLabels + chartWidth + 60 + legendRectSize;\n                var vert = i * height - offset;\n                return 'translate(' + horz + ',' + vert + ')';\n            })\n            .on('mouseover', function (d, i){\n               mouseover(\".\"+ data.id+\".\"+ TableService.toValidId(d));\n            })\n            .on('mouseout', function (d, i){\n              mouseout();\n            });\n\n        legend.append('rect')\n            .attr('class', function(d,i){ return 'legendRect ' + data.id+ \" \" + TableService.toValidId(d);})\n            .attr('width', legendRectSize)\n            .attr('height', legendRectSize)\n            .style(\"fill-opacity\", opacitydefault)\n            .style('fill', function (d, i) { return getColor(data,i); /*return color(i);*/ })\n            .style('stroke', function (d, i) {return getColor(data,i); /*return color(i);*/ });\n\n        legend.append('text')\n            .attr('class', 'legend')\n            .attr('x', legendRectSize + legendSpacing)\n            .attr('y', legendRectSize - legendSpacing)\n            .text(function (d, i) {return d; });\n      }\n      scope.render = function() {\n        TableService.readvalues(scope.plot, projectId, refId, commitId)\n       .then( function(value){\n        var tablebody = value.tablebody;\n        var tableheader = value.tableheader;\n        //scope.isHeader = value.isHeader;\n        scope.valuesO = value.tablebody.valuesO; //value objects used in watch\n        if (tablebody.c3_data.length === 0) { //no data\n          return;\n        }\n        var udcolors;\n        if (scope.plot.config.colors !== undefined){\n          udcolors = scope.plot.config.colors;\n        }\n        var rowvalues = [];\n        var cellIds = []; //0, 1, 2, 3\n        var legends = [];\n        var legendsFilter = [];\n        var rowvalue;\n        var cellId;\n        var cid = 0;\n        tablebody.c3_data.forEach( function (row){\n           legends.push(row[0]);\n           legendsFilter[row[0]] = true;\n           rowvalue = []; //reset\n           cellId = []; //reset\n           for ( var i = 1; i < row.length; i++){\n            rowvalue.push(row[i]);\n            cellId.push(cid++);\n           }\n           cellIds.push(cellId);\n           rowvalues.push(rowvalue);\n        });\n        var labelsFilter = []; \n        tableheader.forEach( function (item){\n          labelsFilter[item] = true;\n        });\n        achartdata = {\n            id: '_'+scope.$id,\n            labels: tableheader,\n            legends: legends, //row headers\n            colors: udcolors,\n            values: rowvalues,//table body without row headers\n            valueIds: cellIds,\n            legendsFilter: legendsFilter,\n            labelsFilter: labelsFilter\n           };\n          createGroupedHorizontalBarChart(achartdata);\n          createFilters(achartdata);\n          });\n      }; //end of render\n      scope.$watch('valuesO', function(newValue, oldValue) {\n        return scope.render();\n      },true); \n\n      //rect bar is clicked or table cell (Except rowHeaders) is clicked\n      scope.$on('elementSelected', function(event, eid, type) {\n          d3.selectAll(\"rect\").transition(200).style(\"fill-opacity\", opacitynotselected);\n      });\n     \n    }; //end of link\n\n    return {\n      restrict: 'EA',\n      require: '?^mmsView',\n       scope: {\n          plot: '<' \n      },\n      link: mmsChartLink\n    }; //return\n}\n","'use strict';\n angular.module('mms.directives')\n  .directive('mmsD3NormalizedStackedBarPlot', ['TableService','$window', mmsD3NormalizedStackedBarPlot]);\n  \n  /**\n  /* reference https://bl.ocks.org/mbostock/3886394\n  */\n  function mmsD3NormalizedStackedBarPlot(TableService, $window) {\n      \n    var mmsChartLink = function(scope, element, attrs, mmsViewCtrl) {\n      \n      var d3 = $window.d3;\n\n      var divchart = d3.select(element[0]).append('div');\n      //default \n      var defaultPlotConfig = {width : 960 /*parseInt(divchart.style(\"width\"))*0.95*/, height: 500, \n        marginTop:20, marginRight:60, marginBottom:30, marginLeft:40};\n      var plotId= \"d3nbplot\" + scope.$id;\n\n      var projectId, refId, commitId;\n      if (mmsViewCtrl) {\n        var viewVersion = mmsViewCtrl.getElementOrigin();\n        projectId = viewVersion.projectId;\n        refId = viewVersion.refId;\n        commitId = viewVersion.commitId;\n      }\n\n  function vf_pplot() {\n\n    divchart.selectAll('*').remove();\n    divchart.attr(\"id\", plotId);\n    var svg = divchart.append(\"svg:svg\");\n\n    var plotConfig = TableService.plotConfig(scope.plot.config.options, defaultPlotConfig);\n    svg.attr(\"width\", plotConfig.width);\n    svg.attr(\"height\", plotConfig.height);\n    var margin = {top: plotConfig.marginTop, right: plotConfig.marginRight, \n      bottom: plotConfig.marginBottom, left: plotConfig.marginLeft},\n\n    width = +svg.attr(\"width\") - margin.left - margin.right,\n    height = +svg.attr(\"height\") - margin.top - margin.bottom,\n    g = svg.append(\"g\").attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n \n    var x = d3.scaleBand()\n      .rangeRound([0, width])\n      .padding(0.1)\n      .align(0.1);\n\n    var y = d3.scaleLinear()\n        .rangeRound([height, 0]);\n\n    var z = d3.scaleOrdinal(d3.schemeCategory10);\n\n    var stack = d3.stack()\n        .offset(d3.stackOffsetExpand);\n     \n    var data = scope.tablebody.c3_data;\n    data = total(data);\n    data.sort(function(a, b) { \n      return b[scope.tablecolumnheader[0]] / b.total - a[scope.tablecolumnheader[0]] / a.total; \n    });\n   \n    x.domain(data.map(function(d) { return d.rowheader; })); \n    z.domain(scope.tablecolumnheader);\n\n    var serie = g.selectAll(\".serie\")\n      .data(stack.keys(scope.tablecolumnheader)(data))\n      .enter().append(\"g\")\n      .attr(\"class\", \"serie\")\n      .attr(\"fill\", function(d) { return z(d.key); });\n\n    serie.selectAll(\"rect\")\n      .data(function(d) { return d; })\n      .enter().append(\"rect\")\n      .attr(\"x\", function(d) { return x(d.data.rowheader); })\n      .attr(\"y\", function(d) { return y(d[1]); })\n      .attr(\"height\", function(d) { return y(d[0]) - y(d[1]); })\n      .attr(\"width\", x.bandwidth());\n\n    g.append(\"g\")\n      .attr(\"class\", \"axis axis--x\")\n      .attr(\"transform\", \"translate(0,\" + height + \")\")\n      .call(d3.axisBottom(x));\n\n    g.append(\"g\")\n      .attr(\"class\", \"axis axis--y\")\n      .call(d3.axisLeft(y).ticks(10, \"%\"));\n\n    var legend = serie.append(\"g\")\n      .attr(\"class\", \"legend\")\n      .attr(\"transform\", function(d) {\n         d = d[d.length - 1]; \n         return \"translate(\" + (x(d.data.rowheader) + x.bandwidth()) + \",\" + ((y(d[0]) + y(d[1])) / 2) + \")\"; \n       });\n\n    legend.append(\"line\")\n      .attr(\"x1\", -6)\n      .attr(\"x2\", 6)\n      .attr(\"stroke\", \"#000\");\n\n    legend.append(\"text\")\n      .attr(\"x\", 9)\n      .attr(\"dy\", \"0.35em\")\n      .attr(\"fill\", \"#000\")\n      .style(\"font\", \"10px sans-serif\")\n      .text(function(d) { return d.key; });\n  }\n\n  //add total in original row array.\n  function total(all) {\n    all.forEach(function(a){ \n      a.total = 0;\n      for ( var i = 0; i < scope.tablecolumnheader.length; i++){\n        a.total += Number(a[scope.tablecolumnheader[i]]);\n      }\n    });\n    return all;\n  }\n\n\n scope.render = function() {\n      TableService.readvalues2(scope.plot, projectId, refId, commitId)\n       .then( function(value){\n        scope.tablebody = value.tablebody;\n        scope.tablecolumnheader = value.tableheader;\n        scope.valuesO = value.tablebody.valuesO; //value objects used in watch\n        if (scope.tablebody.c3_data.length === 0) { //no data\n          return;\n        }\n        vf_pplot();\n      }); //end of TableService\n    };//end of render\n \n    scope.$watch('valuesO', function(newVals, oldVals) {\n        return scope.render();\n    }, true);\n    \n\n    }; //end of link\n    \n    return {\n      restrict: 'EA',\n      require: '?^mmsView',\n       scope: {\n        plot: '<'\n      },\n      link: mmsChartLink\n    }; //return\n }\n\n\n\n","'use strict';\n angular.module('mms.directives')\n    .directive('mmsD3ParallelAxisPlot', ['TableService', '$window', mmsD3ParallelAxisPlot]);\nfunction mmsD3ParallelAxisPlot(TableService,  $window) {\n      \n  var mmsChartLink = function(scope, element, attrs, mmsViewCtrl) {\n   \n    scope.rowHeaders=[]; //not null when render is called 1st time.      \n    var d3 = $window.d3;  \n    var divchart = d3.select(element[0]).append('div');  \n    \n    var defaultPlotConfig = {width : 900, \n        marginTop:0, marginRight:0, marginBottom:25, marginLeft:60};\n      \n\n    var projectId;\n    var refId;\n    var commitId;\n          \n    if (mmsViewCtrl) {\n      var viewVersion = mmsViewCtrl.getElementOrigin();\n      projectId = viewVersion.projectId;\n      refId = viewVersion.refId;\n      commitId = viewVersion.commitId;\n    }\n    \n    function vf_pplot(_out) {\n\n      var plotConfig = TableService.plotConfig(scope.plot.config.options, defaultPlotConfig);\n\n      var outputs = _out;\n      var width =plotConfig.width;\n      var height = plotConfig.width*0.37;\n      var m = [plotConfig.marginTop, plotConfig.marginRight, plotConfig.marginBottom, plotConfig.marginLeft]; //top, right, bottom, left\n      \n      var maxSize = 0;\n      var size = 0;\n            \n      //redefine top and right margin based on TB string length\n      maxSize = 0;\n      size = 0;\n      for (var i = 0; i < outputs.variables.length; i++)\n      {\n        size = outputs.variables[i].length; //length of the string\n        if (maxSize < size)\n          maxSize = size;\n      }\n      \n      m[0] = maxSize * 4.5 * 0.707 + 50; //to make label\n      m[1] = maxSize * 4.5 * 0.707 + 10;\n      \n      //define width and height\n      var w = width - m[1] - m[3],\n        h = height - m[0] - m[2];\n\n      var colorscale = d3.scaleOrdinal(d3.schemeCategory10);\n      var x = d3.scalePoint(d3.schemeCategory10).domain(outputs.variables).range([0, w]),\n      y = {};\n      var line = d3.line(),foreground;\n\n      divchart.selectAll('*').remove();\n      var svg = divchart\n        .append(\"svg:svg\")\n        .attr(\"class\", \"papchart\" + scope.$id + \" papchart\")\n        .attr(\"style\", 'border:1px solid #ddd')\n        .attr(\"width\", w + m[1] + m[3])\n        .attr(\"height\", h + m[0] + m[2])\n        .append(\"svg:g\")\n        .attr(\"transform\", \"translate(\" + m[3] + \",\" + m[0] + \")\");\n        \n      //Need to create a temporary object with the data, objectives, and threshold values\n      //to scale the axes properly\n      var minMax = {};\n\n      outputs.variables.forEach(function(d, i){\n        minMax[d] = {};\n        \n        //initialize minTest and maxTest variables\n        var minTest = outputs.table[0].values[d];\n        var maxTest = outputs.table[0].values[d];\n\n        for (var j = 0; j < outputs.table.length; j++)\n        {\n          //test to see if minTest is still the minimum\n          if (minTest > outputs.table[j].values[d])\n            minTest = outputs.table[j].values[d];\n          \n          //tests to see if maxTest is still the maximum\n          if (maxTest < outputs.table[j].values[d])\n            maxTest = outputs.table[j].values[d];\n        }\n        minMax[d].min = minTest;\n        minMax[d].max = maxTest;\n      });\n      \n      var range = {};\n      var minimum = {};\n      var maximum = {};\n\n      var percentScaling = 0.07;\n      \n      //make each minMax a bit bigger or smaller to better plot the data set\n      outputs.variables.forEach(function(d, i){\n        range[d] = Math.abs(minMax[d].max - minMax[d].min);\n      \n        minimum[d] = minMax[d].min - range[d] * percentScaling;\n        maximum[d] = minMax[d].max + range[d] * percentScaling;\n        \n        //what if both the min and the max were equal?  Give it some \"range\" about the point\n        if (minMax[d].max == minMax[d].min)\n        {\n          maximum[d] = minMax[d].max * (percentScaling + 1);\n          minimum[d] = minMax[d].max * (1 - percentScaling);\n        }\n        \n        //what if the only value for a variable is zero? Give it some \"range\" about zero\n        if (minMax[d].max === 0 && minMax[d].min === 0)\n        {\n          maximum[d] = percentScaling;\n          minimum[d] = -percentScaling;\n        }\n      });\n      \n\n      //Create a scale and brush for each variables.\n      outputs.variables.forEach(function (d) {\n        y[d] = d3.scaleLinear()\n          .domain([minimum[d], maximum[d]])\n          .range([h, 0]);\n        \n      });\n      \n      var tooltip = svg.append('text')\n       .style('opacity', 0)\n       .style('font-family', 'sans-serif')\n       .style('font-size', '13px');\n\n      \n      var axisData = [];\n      var tickData = [];\n      outputs.table.forEach(function(d){\n        if ( d.tickColor === undefined)\n          axisData.push(d);\n        else\n          tickData.push(d);\n      });\n      // Add foreground lines. background brush\n      foreground = svg.append(\"svg:g\")\n      .attr(\"class\", \"foreground\")\n      .selectAll(\"path\")\n      .data(axisData)\n      .enter().append(\"svg:path\")\n      .attr(\"d\", path)\n      .on(\"mouseover\", function(d) {\n          tooltip\n          .attr('x', d3.mouse(this)[0])\n          .attr('y', d3.mouse(this)[1])\n          .text(d.row)\n          .transition(200)\n          .style('opacity', 1);\n      })\n      .on(\"mouseout\", function() {\n        //remove the text element added on the mouseover event when the mouseout event is triggered\n         tooltip\n        .transition(200)\n        .style('opacity', 0);\n      })\n      .attr(\"stroke\", function(d, i){ return colorscale(i);})\n      .attr(\"fill\", \"none\")\n      .style(\"stroke-width\", \"1px\")\n      .attr(\"cid\", function(d,i){\n        return d.cid;\n      })\n      .attr(\"config\", function(d,i){\n        return d.design;\n      })\n         //.attr(\"title\", \"TEST\")\n      .attr(\"class\", function (d,i) {\n          var string = \"design \" + d.cid + \" selected\";\n            return string;\n      })\n      //add title to the path.  mouseover shows it in bubble looking\n      .append(\"svg:title\")\n      .text(function(d){return d.row;});\n\n      // Add a group element for each variables.\n      var g = svg.selectAll(\".variables\")\n        .data(outputs.variables)\n        .enter().append(\"svg:g\")\n        .attr(\"class\", \"variables\")\n        .attr(\"transform\", function(d,i) { \n            return \"translate(\" + x(d) + \")\"; \n          });\n\n      // Add an axis and title.\n      g.append(\"svg:g\")\n        .attr(\"class\", \"axis\")\n        .each(function(d) { \n          //d3.select(this).call(axis.scale(y[d])); \n          d3.select(this).call(d3.axisLeft(y[d]).ticks(5));\n        })\n      .append(\"svg:text\")\n        .data(outputs.variables)\n        .attr(\"y\", -12)\n        .attr(\"transform\", \"rotate(-45 0 0)\") //deg y x\n        .attr(\"x\", 0)\n        .attr(\"class\", \"axislabel\")\n        .attr(\"fill\", \"black\")\n        .text(function(d){\n          return d;\n        });\n\n        var axisTick;                \n        tickData.forEach(function(td){\n          //Adding axisTick\n          g.select(\"g.axis\").append(\"g\")\n          .attr(\"transform\", function (d) {\n              return \"translate(0,\" + y[d](td.values[d]) + \")\";\n          })\n          .attr(\"class\", \"objectivetick\")\n          .append(\"line\")\n          .attr(\"stroke\", td.tickColor)\n          .style(\"stroke-width\", \"3px\")\n          .attr(\"fill\", \"none\")\n          .attr(\"x1\", -5)\n          .attr(\"x2\", 6)\n          .attr(\"y2\", 0)\n          .on(\"mouseover\", function(d) {\n            tooltip\n            .attr('x', d3.mouse(this)[0] + x(d))\n            .attr('y', d3.mouse(this)[1] + y[d](td.values[d]))\n            .text(td.row)\n            .transition(200)\n            .style('opacity', 1);\n          })\n          .on(\"mouseout\", function(d) {\n            //remove the text element added on the mouseover event when the mouseout event is triggered\n             tooltip\n            .transition(200)\n            .style('opacity', 0);\n          });\n      });\n      // Returns the path for a given data point.\n      function path(d) {\n        d = d.values;\n        return line(outputs.variables.map(function (p) {\n            return [x(p), y[p](d[p])];\n          }));\n      }\n    }//end of vf_pplot()\n\n    function getTickColor(rowHeaderName){\n      if (scope.plot.config.ticks !== undefined){\n        for ( var kk = 0; kk < scope.plot.config.ticks.length; kk++){\n            if( scope.plot.config.ticks[kk].name === rowHeaderName )\n                return scope.plot.config.ticks[kk].color; \n         }\n      }\n      return undefined;\n    }\n\n    scope.render = function() {\n\n      TableService.readvalues(scope.plot, projectId, refId, commitId)\n       .then( function(value){\n        scope.tablebody = value.tablebody;\n        scope.tableheader = value.tableheader;\n        scope.isHeader = value.isHeader;\n        scope.valuesO = value.tablebody.valuesO; //value objects used in watch\n        if (scope.tablebody.c3_data.length === 0) { //no data\n          return;\n        }\n        var  dataseries= [];\n        var tickColor;\n        scope.tablebody.c3_data.forEach( function (row){\n            var values = [];\n            for (var i = 1; i < row.length; i++) {\n              values[scope.tableheader[i-1]] = row[i];\n              tickColor = getTickColor(row[0]);\n            }\n            dataseries.push( {row: row[0], tickColor: tickColor, values: values});\n        });\n        var modelData = {\n           variables: scope.tableheader,\n           table: dataseries //columnHeader and values\n        };\n        vf_pplot(modelData);\n      }); //end of TableService\n    };//end of render\n \n    scope.$watch('valuesO', function(newVals, oldVals) {\n        return scope.render();\n    }, true);\n      \n    \n  }; //end of link\n\n  return {\n    restrict: 'EA',\n    require: '?^mmsView',\n     scope: {\n      plot: '<'\n    },\n    link: mmsChartLink\n  }; //return\n}\n\n\n\n","'use strict';\n angular.module('mms.directives')\n  .directive('mmsD3RadarPlot', ['TableService','$window', mmsD3RadarPlot]);\n  function mmsD3RadarPlot(TableService, $window) {\n      \n    var mmsRadarChartLink = function(scope, element, attrs, mmsViewCtrl) {\n      var d3 = $window.d3;  \n      var colorscale = d3.scaleOrdinal(d3.schemeCategory10);\n\n      var scopetableColumnHeadersLabel= [];\n      var divchart = d3.select(element[0]).append('div');\n      \n      var defaultPlotConfig = {width : 700 /*parseInt(divchart.style(\"width\"))*0.95*/, height: 700, \n        marginTop:0, marginRight:0, marginBottom:0, marginLeft:0};\n      \n      var projectId;\n      var refId;\n      var commitId;\n        \n      if (mmsViewCtrl) {\n        var viewVersion = mmsViewCtrl.getElementOrigin();\n        projectId = viewVersion.projectId;\n        refId = viewVersion.refId;\n        commitId = viewVersion.commitId;\n      }\n      //if ( scope.plot.config.length !== 0){ \n        //scope.plot.config = JSON.parse(scope.plot.config.replace(/'/g, '\"')); //{\"colors: [5,6,7,8,9]\"}\n      //} \n     scope.render = function() {\n\n      TableService.readvalues(scope.plot, projectId, refId, commitId)\n       .then( function(value){\n        scope.tablebody = value.tablebody;\n        scope.tableheader = value.tableheader;\n        scope.isHeader = value.isHeader;\n        scope.valuesO = value.tablebody.valuesO; //value objects used in watch\n        if (scope.tablebody.c3_data.length === 0) { //no data\n          return;\n        }\n        \n        var rowvalues = []; //[][] {{axis: p2, value: 15}, {axis: p3: value: 1}}...\n        scope.tablebody.c3_data.forEach( function (row){\n          var rowvalue = [];\n          for (var i = 1; i < row.length; i++) //ignore row header\n            rowvalue.push({axis: scope.tableheader[i-1], value: row[i]});\n          rowvalues.push(rowvalue);\n        });\n\n        divchart.selectAll('*').remove();\n        divchart.attr(\"class\", \"radar\" + scope.$id)\n                .attr(\"style\", 'border:1px solid #ddd');\n        \n        RadarChart.draw(\"radar\" + scope.$id, rowvalues);\n        //add legends from tableheader\n        var legends = [];\n        scope.tablebody.c3_data.forEach( function(item){\n          legends.push(item[0]);\n        });\n        initiateLegend(legends, \"radar\" + scope.$id);\n      });  //TableService\n    }; //end of scope.render\n\n    scope.$watch('valuesO', function(newVals, oldVals) {\n        return scope.render();\n    }, true);\n   \n    var plotConfig = TableService.plotConfig(scope.plot.config.options, defaultPlotConfig);\n    \n    var cfg;\n    var RadarChart = {\n      draw: function(id, d){\n        cfg = {\n         radius: 5,\n         factor: 1,\n         w: plotConfig.width-200,\n         h: plotConfig.height-200,\n         factorLegend: 0.85,\n         levels: 3,\n         maxValue: 0,\n         radians: 2 * Math.PI,\n         opacityArea: 0.5,\n         ToRight: 5,\n         TranslateX: 80,\n         TranslateY: 80,\n         ExtraWidthX: 100,\n         ExtraWidthY:  0, /*100 original */\n         color: colorscale\n        };\n\n     \n      cfg.maxValue = Math.max(cfg.maxValue, \n      d3.max(d, function(i){\n        return d3.max(i.map(\n          function(o){return Number(o.value);}));\n        })\n      );\n      var allAxis = (d[0].map(function(i, j){return i.axis;}));\n      var total = allAxis.length;\n      var radius = cfg.factor*Math.min(cfg.w/2, cfg.h/2);\n   \n      var svg = divchart.append(\"svg:svg\")\n       .attr(\"class\", \"rdchart \" + scope.$id);\n      svg.attr(\"width\", plotConfig.width); \n      svg.attr(\"height\", plotConfig.height);\n\n      var g = svg\n        .append(\"g\")\n        .attr(\"transform\", \"translate(\" + cfg.TranslateX + \",\" + cfg.TranslateY + \")\");\n      var tooltip;\n      //Text indicating at what % each level is\n      for(var j=0; j<cfg.levels; j++){\n        var levelFactor2 = cfg.factor*radius*((j+1)/cfg.levels);\n        g.selectAll(\".levels\")\n         .data([1]) //dummy data\n         .enter()\n         .append(\"svg:text\")\n         .attr(\"x\", levelFactor2*(1-cfg.factor*Math.sin(0)))\n         .attr(\"y\", levelFactor2*(1-cfg.factor*Math.cos(0)))\n         .attr(\"class\", \"legend\")\n         .style(\"font-family\", \"sans-serif\")\n         .style(\"font-size\", \"10px\")\n         .attr(\"transform\", \"translate(\" + (cfg.w/2-levelFactor2 + cfg.ToRight) + \", \" + (cfg.h/2-levelFactor2) + \")\")\n         .attr(\"fill\", \"#737373\")\n         .text(d3.format(\".3g\")((j+1)*cfg.maxValue/cfg.levels));\n      }\n      function getPosition(i, range, factor, func){\n        factor = typeof factor !== 'undefined' ? factor : 1;\n        return range * (1 - factor * func(i * cfg.radians / total));\n      }\n      function getHorizontalPosition(i, range, factor){\n        return getPosition(i, range, factor, Math.sin);\n      }\n      function getVerticalPosition(i, range, factor){\n        return getPosition(i, range, factor, Math.cos);\n      }\n      // //levels && axises\n      var levelFactors = d3.range(0, cfg.levels).map(function(level) {\n        return radius * ((level + 1) / cfg.levels);\n      });\n      var levelGroups =  g.selectAll(\".levels\").data(levelFactors);\n      levelGroups.enter().append('g');\n      levelGroups.exit().remove();\n      levelGroups.attr('class', function(d, i) {\n        return 'level-group level-group-' + i;\n      });\n      var levelLine = levelGroups.selectAll('.level').data(function(levelFactor) {\n        return d3.range(0, total).map(function() { return levelFactor; });\n      });\n      levelLine.enter().append('line');\n      levelLine.exit().remove();\n      levelLine\n        .attr('class', 'level')\n        .attr('x1', function(levelFactor, i){ return getHorizontalPosition(i, levelFactor); })\n        .attr('y1', function(levelFactor, i){ return getVerticalPosition(i, levelFactor); })\n        .attr('x2', function(levelFactor, i){ return getHorizontalPosition(i+1, levelFactor); })\n        .attr('y2', function(levelFactor, i){ return getVerticalPosition(i+1, levelFactor); })\n        .style(\"stroke\", \"grey\")\n        .style(\"stroke-opacity\", \"0.75\")\n        .style(\"stroke-width\", \"0.3px\")\n        .attr('transform', function(levelFactor) {\n          return 'translate(' + (cfg.w/2-levelFactor) + ', ' + (cfg.h/2-levelFactor) + ')';\n        });\n      var series = 0;\n      var axis = g.selectAll(\".axis\")\n          .data(allAxis)\n          .enter()\n           .append(\"g\")\n          .attr(\"class\", \"axis\");\n      axis.append(\"line\")\n          .attr(\"x1\", cfg.w/2)\n          .attr(\"y1\", cfg.h/2)\n          .attr(\"x2\", function(d, i){return cfg.w/2*(1-cfg.factor*Math.sin(i*cfg.radians/total));})\n          .attr(\"y2\", function(d, i){return cfg.h/2*(1-cfg.factor*Math.cos(i*cfg.radians/total));})\n          .attr(\"class\", \"line\")\n          .style(\"stroke\", \"grey\")\n          .style(\"stroke-width\", \"1px\");\n      axis.append(\"text\")\n          .attr(\"class\", \"legend\")\n          .text(function(d){return d;})\n          .style(\"font-family\", \"sans-serif\")\n          .style(\"font-size\", \"12px\")\n          .attr(\"text-anchor\", \"middle\")\n          .attr(\"dy\", \"1.5em\")\n          .attr(\"transform\", function(d, i){return \"translate(0, -8)\";})\n          .attr(\"x\", function(d, i){return cfg.w/2*(1-cfg.factorLegend*Math.sin(i*cfg.radians/total))-60*Math.sin(i*cfg.radians/total);})\n          .attr(\"y\", function(d, i){return cfg.h/2*(1-Math.cos(i*cfg.radians/total))-20*Math.cos(i*cfg.radians/total);});\n       \n      var dataValues =[];\n      d.forEach(function(y, x){\n        dataValues = [];\n        g.selectAll(\".nodes\")\n        .data(y, function(j, i){\n          dataValues.push([\n          cfg.w/2*(1-(parseFloat(Math.max(j.value, 0))/cfg.maxValue)*cfg.factor*Math.sin(i*cfg.radians/total)), \n          cfg.h/2*(1-(parseFloat(Math.max(j.value, 0))/cfg.maxValue)*cfg.factor*Math.cos(i*cfg.radians/total))\n          ]);\n        });\n        dataValues.push(dataValues[0]);\n        g.selectAll(\".area\")\n         .data([dataValues])\n         .enter()\n         .append(\"polygon\")\n         .attr(\"class\", \"radar-chart-serie\"+series + \" \" + id)\n         .style(\"stroke-width\", \"2px\")\n         .style(\"stroke\", cfg.color(series))\n         .attr(\"points\",function(d) {\n           var str=\"\";\n           for(var pti=0;pti<d.length;pti++){\n             str=str+d[pti][0]+\",\"+d[pti][1]+\" \";\n           }\n           return str;\n          })\n         .style(\"fill\", function(j, i){return cfg.color(series);})\n         .style(\"fill-opacity\", 0.1)\n         .on('mouseover', function(d, i){\n            d3.select(this)\n              .transition(200)\n              .style(\"fill-opacity\", 0.7);\n         })\n          .on('mouseout', function(d,i){\n            d3.select(this)\n              .transition(200)\n              .style(\"fill-opacity\", 0.1);\n          });\n        series++;\n      });\n      series=0;\n      d.forEach(function(y, x){\n        g.selectAll(\".nodes\")\n        .data(y).enter()\n        .append(\"svg:circle\")\n        .attr(\"class\", \"radar-chart-serie\"+series + \" \" + id)\n        .attr('r', cfg.radius)\n        .attr(\"alt\", function(j){return Math.max(j.value, 0);})\n        .attr(\"cx\", function(j, i){\n          dataValues.push([\n          cfg.w/2*(1-(parseFloat(Math.max(j.value, 0))/cfg.maxValue)*cfg.factor*Math.sin(i*cfg.radians/total)), \n          cfg.h/2*(1-(parseFloat(Math.max(j.value, 0))/cfg.maxValue)*cfg.factor*Math.cos(i*cfg.radians/total))\n        ]);\n        return cfg.w/2*(1-(Math.max(j.value, 0)/cfg.maxValue)*cfg.factor*Math.sin(i*cfg.radians/total));\n        })\n        .attr(\"cy\", function(j, i){\n          return cfg.h/2*(1-(Math.max(j.value, 0)/cfg.maxValue)*cfg.factor*Math.cos(i*cfg.radians/total));\n        })\n        .attr(\"data-id\", function(j){return j.axis;})\n        .style(\"fill\", cfg.color(series)).style(\"fill-opacity\", 0.9)\n        .on('mouseover', function (d){\n              var newX =  parseFloat(d3.select(this).attr('cx')) - 10;\n              var newY =  parseFloat(d3.select(this).attr('cy')) - 5;\n              tooltip\n                .attr('x', newX)\n                .attr('y', newY)\n                .text(d.value.toString())\n                .transition(200)\n                .style('opacity', 1);\n              })\n        .on('mouseout', function(){\n              tooltip\n                .transition(200)\n                .style('opacity', 0);\n              })\n        .append(\"svg:title\")\n        .text(function(j){return Math.max(j.value, 0);});\n        series++;\n      });\n\n      //Tooltip\n      tooltip = g.append('text')\n             .style('opacity', 0)\n             .style('font-family', 'sans-serif')\n             .style('font-size', '13px');\n      }\n    }; //end of RadarChart\n   \n    function initiateLegend (LegendOptions, id){\n\n      var svg = d3.select(\".\" + id) //div\n        .selectAll('svg')\n        .append('svg')\n        .attr(\"width\", cfg.w+300)\n        .attr(\"height\", cfg.h);\n        //Initiate Legend \n      var legend = svg.append(\"g\")\n        .attr(\"class\", \"legend\")\n        .attr(\"height\", 100)\n        .attr(\"width\", 200)\n        .attr('transform', 'translate(50,50)');\n        \n          //Create colour squares\n      legend.selectAll('rect')\n        .data(LegendOptions)\n        .enter()\n        .append(\"rect\")\n        .attr(\"x\", cfg.w - 65)\n        .attr(\"y\", function(d, i){ return i * 20;})\n        .attr(\"width\", 10)\n        .attr(\"height\", 10)\n        .style(\"fill\", function(d, i){ return colorscale(i);})\n        .attr(\"fill-opacity\", 1)\n        .attr(\"rid\", function(d){return d;})\n        .on('mouseover', function (d, i){\n                d3.select(\".\" + id).selectAll(\"svg\").selectAll(\"polygon\")\n                 .transition(200)\n                 .style(\"fill-opacity\", 0.1); \n                d3.select(\".radar-chart-serie\"+i + \".\" + id)\n                 .transition(200)\n                 .style(\"fill-opacity\", 0.7);\n         })\n        .on('mouseout', function (d, i){\n              d3.select(\".\" + id).selectAll(\"svg\").selectAll(\"polygon\")\n                .transition(200)\n                .style(\"fill-opacity\", cfg.opacityArea);\n         });\n          //Create text next to squares\n      legend.selectAll('text')\n        .data(LegendOptions)\n        .enter()\n        .append(\"text\")\n        .attr(\"x\", cfg.w - 52)\n        .attr(\"y\", function(d, i){ return i * 20 + 9;})\n        .attr(\"font-size\", \"11px\")\n        .attr(\"fill\", \"#737373\")\n        .text(function(d) { return d; })\n        .on('mouseover', function (d, i){\n                d3.select(\".\" + id).selectAll(\"svg\").selectAll(\"polygon\")\n                 .transition(200)\n                 .style(\"fill-opacity\", 0.1); \n                d3.select(\".radar-chart-serie\"+i + \".\" + id)\n                 .transition(200)\n                 .style(\"fill-opacity\", 0.7);\n         })\n        .on('mouseout', function (d, i){\n              d3.select(\".\" + id).selectAll(\"svg\").selectAll(\"polygon\")\n                     .transition(200)\n                     .style(\"fill-opacity\", 0.1);\n         });\n      }//end of initiateLegend\n    }; //end of link\n\n    return {\n      restrict: 'EA',\n      require: '?^mmsView',\n       scope: {\n        plot: '<'\n      },\n      link: mmsRadarChartLink\n    }; //return\n }\n\n\n\n","'use strict';\n\n/** Used for annotating an element that doesn't have any commit history at all or for an element that is deleted but has commit history **/\nangular.module('mms.directives')\n    .directive('mmsAnnotation', ['$templateCache', '$rootScope', 'ViewService', 'UtilsService', mmsAnnotation]);\n\nfunction mmsAnnotation($templateCache, $rootScope, ViewService, UtilsService) {\n    var template = $templateCache.get('mms/templates/mmsAnnotation.html');\n    return {\n        restrict: 'A',\n        template: template,\n        scope: {\n            mmsReqOb: '<',\n            mmsRecentElement: '<',\n            mmsType: '<',\n            mmsCfLabel: '<'\n        },\n        controller: ['$scope', mmsAnnotationCtrl],\n        link: mmsAnnotationLink\n    };\n\n    function mmsAnnotationLink(scope, element, attrs) {\n        element.on('click', function() {\n            if(scope.mmsRecentElement) {\n                $rootScope.$broadcast('elementSelected', scope.mmsRecentElement, scope.mmsRecentElement._commitId, true);\n            }\n        });\n\n        scope.copyToClipboard = function($event) {\n            UtilsService.copyToClipboard(element.find('#tooltipElementId'), $event);\n        };\n    }\n\n    function mmsAnnotationCtrl($scope) {\n        var displayContent;\n        if ($scope.mmsRecentElement) {\n            displayContent = _getContentIfElementFound($scope.mmsType, $scope.mmsRecentElement);\n        } else {\n            displayContent = _getContentIfElementNotFound($scope.mmsType, $scope.mmsReqOb, $scope.mmsCfLabel);\n        }\n        $scope.displayContent = displayContent;\n    }\n\n    function _getContentIfElementFound(type, element) {\n        var AT = ViewService.AnnotationType;\n        var inlineContent = '';\n        var toolTipTitle;\n        var toolTipContent;\n        var classifierType = ViewService.getTypeFromClassifierId(element.classifierIds);\n\n        switch (classifierType) {\n            case 'ListT':\n            case 'TableT':\n            case 'ImageT':\n            case 'ParagraphT':\n            case 'SectionT':\n            case 'FigureT':\n                classifierType = classifierType.substring(0, classifierType.length - 1);\n                break;\n        }\n\n        switch (type) {\n            case AT.mmsTranscludeName:\n                inlineContent = element.name;\n                toolTipTitle = 'Referenced element not found';\n                toolTipContent = 'Displaying last found name as placeholder.';\n                break;\n            case AT.mmsTranscludeDoc:\n                inlineContent = element.documentation;\n                toolTipTitle = 'Referenced element not found';\n                toolTipContent = 'Displaying last found documentation as placeholder.';\n                break;\n            case AT.mmsTranscludeCom:\n                inlineContent = element.documentation;\n                toolTipTitle = 'Referenced comment not found.';\n                toolTipContent = 'Displaying last found comment content as a placeholder.';\n                break;\n            case AT.mmsViewLink:\n                inlineContent = element.name;\n                toolTipTitle = 'Referenced view link not found';\n                toolTipContent = 'Displaying last found view link as placeholder.';\n                break;\n            case AT.mmsTranscludeVal:\n                inlineContent = _getValueForTranscludeVal(element);\n                toolTipTitle = 'Referenced element not found';\n                toolTipContent = 'Displaying last found value as placeholder.';\n                break;\n            case AT.mmsPresentationElement:\n                inlineContent = element.documentation || '<span>(no text)</span>';\n                toolTipTitle = 'Referenced ' + classifierType + ' not found.';\n                toolTipContent = 'Displaying last found content as placeholder.';\n                break;\n        }\n\n        return {\n            inlineContent: inlineContent,\n            toolTipTitle: toolTipTitle,\n            toolTipContent: toolTipContent,\n            id: element.id\n        };\n    }\n\n    function _getContentIfElementNotFound(type, reqOb, cfLabel) {\n        var AT = ViewService.AnnotationType;\n        var inlineContent = '';\n        var label = cfLabel ? '(' + cfLabel + ')' : '';\n        switch (type) {\n            case AT.mmsTranscludeName:\n                inlineContent = 'cf name' + label + ' does not exist';\n                break;\n            case AT.mmsTranscludeDoc:\n                inlineContent = 'cf documentation' + label + ' does not exist';\n                break;\n            case AT.mmsTranscludeCom:\n                inlineContent = 'cf com' + label + ' does not exist';\n                break;\n            case AT.mmsTranscludeVal:\n                inlineContent = 'cf value' + label + ' does not exist';\n                break;\n            case AT.mmsViewLink:\n                inlineContent = 'view link does not exist';\n                break;\n            case AT.mmsPresentationElement:\n                inlineContent = 'presentation element does not exist';\n                break;\n        }\n\n        return {\n            inlineContent: inlineContent,\n            toolTipTitle: 'Element not found',\n            toolTipContent: '',\n            id: reqOb.elementId\n        };\n    }\n\n    function _getValueForTranscludeVal(element) {\n        var value = '';\n        if (element.type === 'Property' || element.type === 'Port' ||element.type === 'Slot') {\n            if (element.defaultValue) {\n                value = element.defaultValue.value;\n            } else if(element.value) {\n                value = element.value[0].value;\n            }\n        }\n        if (element.type === 'Constraint' && element.specification) {\n            value = element.specification.value;\n        }\n        return value;\n    }\n}\n","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsButtonBar', ['$templateCache', mmsButtonBar]);\n\nfunction mmsButtonBar($templateCache) {\n    var template = $templateCache.get('mms/templates/mmsButtonBar.html');\n\n    var mmsButtonBarLink = function(scope, element, attrs){\n\n    };\n\n    var mmsButtonBarCtrl = function($scope) {\n        if ($scope.mmsBbApi) {\n            var api = $scope.mmsBbApi;\n\n            api.select = function(parentButton, childButton) {\n                if(parentButton && childButton) {\n                    parentButton.dropdown_buttons.forEach(function(dropdownButton) {\n                        dropdownButton.selected = dropdownButton.id === childButton.id;\n                    });\n                }\n            };\n\n            api.setPermission = function (id, permission) {\n                $scope.buttons.forEach(function(button) {\n                    if (button.id === id)\n                        button.permission = permission;\n                });\n            };\n            \n            api.setTooltip = function (id, tooltip) {\n                $scope.buttons.forEach(function(button) {\n                    if (button.id === id)\n                        button.tooltip = tooltip;\n                });\n            };\n\n            api.setIcon = function (id, icon) {\n                $scope.buttons.forEach(function(button) {\n                    if (button.id === id)\n                        button.icon = icon;\n                });\n            };\n\n            api.setToggleState = function (id, state) {\n                $scope.buttons.forEach(function(button) {\n                    if (button.id === id) {\n                        if (button.togglable) {\n                            var original = button.toggle_state;\n                            if ((!original && state) || (original && !state))\n                                api.toggleButtonState(id);\n                        }\n                    }\n                });\n            };\n\n            api.getToggleState = function (id) {\n                var buttonTemp = {};\n                buttonTemp.toggle_state = false;\n\n                $scope.buttons.forEach(function(button) {\n                    if (button.id === id) {\n                        buttonTemp = button;\n                        if (! button.togglable) button.toggle_state = false;\n                        if (! button.toggle_state) button.toggle_state = false;\n                    }\n                });\n\n                return buttonTemp.toggle_state;\n            };\n\n            api.addButton = function(button) {\n                \n                if ($scope.buttons.count === 0) {\n                    button.placement = \"bottom-left\";\n                }\n                else if (!button.placement) {\n                // else {\n                    button.placement = \"bottom\";\n                }\n\n                if (button.togglable) {\n                    button.toggle_state = false;\n                    button.tooltip_orginal = button.tooltip;\n                }\n                button.icon_original = button.icon;\n\n                $scope.buttons.push(button);\n            };\n\n            api.toggleButtonSpinner = function (id) {\n                $scope.buttons.forEach(function(button) {\n                    if (button.id === id) {\n                        if (button.spinner) {\n                            button.icon = button.icon_original;\n                        }\n                        else {\n                            button.icon_original = button.icon;\n                            button.icon = 'fa fa-spinner fa-spin';\n                        }\n                        button.spinner = ! button.spinner;\n                    }\n                });\n            };\n\n            api.toggleButtonState = function (id) {\n                $scope.buttons.forEach(function(button) {\n                    if (button.id === id) {\n                        if (button.togglable) {\n                            button.toggle_state = !button.toggle_state;\n                            if (button.toggle_state && button.toggle_icon && button.toggle_tooltip) {\n                                button.icon = button.toggle_icon;\n                                button.tooltip = button.toggle_tooltip;\n                            }\n                            else {\n                                button.icon = button.icon_original;\n                                button.tooltip = button.tooltip_orginal;\n                            }\n                        }\n                    }\n                });\n            };\n\n            if (api.init) {\n                api.init();\n            }\n        }\n    };\n\n    return {\n        restrict: 'E', \n        template: template,\n        link: mmsButtonBarLink,\n        controller: ['$scope', mmsButtonBarCtrl],\n        scope: {\n            buttons: '<',\n            mmsBbApi: '<',\n            direction: '@'\n        }\n    };\n}\n","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsCf', ['$compile', mmsCf]);\n\n/**\n * @ngdoc directive\n * @name mms.directives.directive:mmsCf\n *\n * @requires $compile\n *\n * @restrict E\n *\n * @description\n * Given an element id, puts in the element's name binding, if there's a parent \n * mmsView directive, will notify parent view of transclusion on init and name change,\n * and on click\n *\n * @param {string} mmsElementId The id of the view\n * @param {string} mmsProjectId The project id for the view\n * @param {string} mmsCfType one of doc, val, name, com, img\n * @param {string=master} mmsRefId Reference to use, defaults to master\n * @param {string=latest} mmsCommitId Commit ID, default is latest\n * @param {boolean=false} nonEditable can edit inline or not\n * @param {bool} mmsWatchId set to true to not destroy element ID watcher\n */\nfunction mmsCf($compile) {\n    var mmsCfCtrl = function($scope) {\n        //INFO this was this.getWsAndVersion\n        this.getElementOrigin = function() {\n            return {\n                projectId: $scope.projectId,\n                refId: $scope.refId,\n                commitId: $scope.commitId\n            };\n        };\n    };\n\n    var mmsCfLink = function(scope, domElement, attrs, controllers) {\n        var mmsCfCtrl = controllers[0];\n        var mmsViewCtrl = controllers[1];\n\n        var changeElement = function(newVal, oldVal) {\n            if (!newVal) {\n                return;\n            }\n            if (!scope.mmsWatchId) {\n                idwatch();\n                commitwatch();\n            }\n            var projectId = scope.mmsProjectId;\n            var refId = scope.mmsRefId;\n            var commitId = scope.mmsCommitId;\n            if (mmsCfCtrl) {\n                var cfVersion = mmsCfCtrl.getElementOrigin();\n                if (!projectId)\n                    projectId = cfVersion.projectId;\n                if (!refId)\n                    refId = cfVersion.refId;\n                if (!commitId)\n                    commitId = cfVersion.commitId;\n            }\n            if (mmsViewCtrl) {\n                var viewVersion = mmsViewCtrl.getElementOrigin();\n                if (!projectId)\n                    projectId = viewVersion.projectId;\n                if (!refId)\n                    refId = viewVersion.refId;\n                if (!commitId)\n                    commitId = viewVersion.commitId;\n            }\n            if (!projectId) {\n                return;\n            }\n            scope.projectId = projectId;\n            scope.refId = refId ? refId : 'master';\n            scope.commitId = commitId ? commitId : 'latest';\n            scope.templateElementHtml = domElement[0].innerHTML;\n            if (scope.mmsCfType) {\n                domElement[0].innerHTML = '<mms-transclude-' + scope.mmsCfType + (scope.mmsGenerateForDiff ? ' mms-generate-for-diff=\"mmsGenerateForDiff\" ' : '') + ' mms-element-id=\"{{mmsElementId}}\" mms-project-id=\"{{projectId}}\" mms-ref-id=\"{{refId}}\" mms-commit-id=\"{{commitId}}\" non-editable=\"nonEditable\" mms-cf-label=\"{{templateElementHtml}}\"></mms-transclude-'+scope.mmsCfType+'>';\n                $compile(domElement.contents())(scope);\n            }\n        };\n\n        var idwatch = scope.$watch('mmsElementId', changeElement);\n        var commitwatch = scope.$watch('mmsCommitId', changeElement);\n    };\n\n    return {\n        restrict: 'E',\n        scope: {\n            mmsElementId: '@',\n            mmsProjectId: '@',\n            mmsRefId: '@',\n            mmsCommitId: '@',\n            mmsCfType: '@',\n            mmsWatchId: '@',\n            nonEditable: '<',\n            mmsGenerateForDiff: '<'\n        },\n        require: ['?^^mmsCf', '?^^mmsView'],\n        controller: ['$scope', mmsCfCtrl],\n        link: mmsCfLink\n    };\n}\n","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsCkeditor', ['$uibModal', '$templateCache', '$timeout', 'growl', 'CKEDITOR', '_', 'CacheService', 'ElementService', 'UtilsService', 'ViewService', 'URLService', 'MentionService', 'Utils', mmsCkeditor]);\n\n/**\n * @ngdoc directive\n * @name mms.directives.directive:mmsCkeditor\n * @element textarea\n *\n * @requires mms.CacheService\n * @requires mms.ElementService\n * @requires mms.UtilsService\n * @requires mms.ViewService\n * @requires $uibModal\n * @requires $templateCache\n * @requires $window\n * @requires $timeout\n * @requires growl\n * @requires CKEDITOR\n * @requires _\n *\n * @restrict A\n *\n * @description\n * Make any textarea with an ngModel attached to be a CKEditor wysiwyg editor. This\n * requires the CKEditor library. Transclusion is supported. ngModel is required.\n * ### Example\n * <pre>\n   <textarea mms-ckeditor ng-model=\"element.documentation\"></textarea>\n   </pre>\n */\nfunction mmsCkeditor($uibModal, $templateCache, $timeout, growl, CKEDITOR, _, CacheService, ElementService, UtilsService, ViewService, URLService, MentionService, Utils) { //depends on angular bootstrap\n    var generatedIds = 0;\n\n    var mmsCkeditorLink = function(scope, element, attrs, ngModelCtrl) {\n        if (!attrs.id) {\n            attrs.$set('id', 'mmsCkEditor' + generatedIds++);\n        }\n\n        var instance = null;\n        var transcludeModalTemplate = $templateCache.get('mms/templates/mmsCfModal.html');\n        var commentModalTemplate = $templateCache.get('mms/templates/mmsCommentModal.html');\n\n        // Controller for inserting cross reference\n        // Defines scope variables for html template and how to handle user click\n        // Also defines options for search interfaces -- see mmsSearch.js for more info\n        var transcludeCtrl = function($scope, $uibModalInstance) {\n            $scope.title = 'Insert cross reference';\n            $scope.description = 'Begin by searching for an element, then click a field to cross-reference.';\n            $scope.searchExisting = true;\n            $scope.newE = {name: '', documentation: ''};\n            $scope.requestName = false;\n            $scope.requestDocumentation = false;\n            $scope.showProposeLink = true;\n            $scope.nonEditableCheckbox = false;\n            $scope.showEditableOp = true;\n            $scope.choose = function(elem, property) {\n                var tag = '<mms-cf mms-cf-type=\"' + property + '\" mms-element-id=\"' + elem.id + '\" non-editable=\"' + $scope.nonEditableCheckbox + '\">[cf:' + elem.name + '.' + property + ']</mms-cf>';\n        $uibModalInstance.close(tag);\n            };\n            $scope.cancel = function() {\n                $uibModalInstance.dismiss();\n            };\n\n             // Set search result options\n            $scope.searchOptions= {};\n            $scope.searchOptions.getProperties = true;\n            $scope.searchOptions.callback = $scope.choose;\n            $scope.searchOptions.emptyDocTxt = 'This field is empty, but you can still click here to cross-reference a placeholder.';\n\n            $scope.makeNewAndChoose = function() {\n                if (!$scope.newE.name) {\n                    growl.error('Error: A name for your new element is required.');\n                    return;\n                } else if (!$scope.requestName && !$scope.requestDocumentation) {\n                    growl.error('Error: Selection of a property to cross-reference is required.');\n                    return;\n                }\n                $scope.proposeClass = \"fa fa-spin fa-spinner\";\n                var id = UtilsService.createMmsId();\n                var toCreate = {\n                    id: id,\n                    ownerId: \"holding_bin_\" + scope.mmsProjectId,\n                    name: $scope.newE.name,\n                    documentation: $scope.newE.documentation,\n                    type: 'Class',\n                    _appliedStereotypeIds: []\n                };\n                toCreate = UtilsService.createClassElement(toCreate);\n                var reqOb = {element: toCreate, projectId: scope.mmsProjectId, refId: scope.mmsRefId};\n\n                ElementService.createElement(reqOb)\n                .then(function(data) {\n                    if ($scope.requestName) {\n                        $scope.choose(data, 'name');\n                    } else if ($scope.requestDocumentation) {\n                        $scope.choose(data, 'doc');\n                    }\n                    $scope.proposeClass = \"\";\n                }, function(reason) {\n                    growl.error(\"Propose Error: \" + reason.message);\n                    $scope.proposeClass = \"\";\n                });\n            };\n            $scope.toggleRadio = function(field) {\n                if (field === \"name\") {\n                    $scope.requestName = true;\n                    $scope.requestDocumentation = false;\n                } else if (field === \"documentation\") {\n                    $scope.requestName = false;\n                    $scope.requestDocumentation = true;\n                }\n            };\n        };\n\n        var transcludeCallback = function(ed) {\n            var instance = $uibModal.open({\n                template: transcludeModalTemplate,\n                scope: scope,\n                controller: ['$scope', '$uibModalInstance', transcludeCtrl],\n                size: 'lg'\n            });\n            instance.result.then(function(tag) {\n                _addWidgetTag(ed, tag);\n            }, function() {\n                var focusManager = new CKEDITOR.focusManager( ed );\n                focusManager.focus();\n            });\n        };\n\n        // Controller for inserting view link\n        // Defines scope variables for html template and how to handle user click\n        // If user selects name or doc, link will be to first related doc\n        // Also defines options for search interfaces -- see mmsSearch.js for more info\n        var transcludeViewLinkCtrl = function($scope, $uibModalInstance, ApplicationService) {\n            $scope.title = 'Insert cross reference as link';\n            $scope.description = 'Search for a view or content element, click on its name or its document/section to insert link.';\n            $scope.showProposeLink = false;\n            $scope.searchExisting = true;\n            $scope.suppressNumbering = false;\n            $scope.linkType = 1;\n            $scope.linkText = '';\n\n            // Function to construct view link\n            var createViewLink = function (elem, did, vid, peid) {\n                var tag = '<mms-view-link';\n                if (did) {\n                    tag += ' mms-doc-id=\"' + did + '\"';\n                }\n                if (vid) {\n                    tag += ' mms-element-id=\"' + vid + '\"';\n                }\n                if (peid) {\n                    tag += ' mms-pe-id=\"' + peid + '\"';\n                }\n                if ($scope.linkType == 2) {\n                    tag += ' suppress-numbering=\"true\"';\n                }\n                if ($scope.linkType == 3 && $scope.linkText) {\n                    tag += ' link-text=\"' + $scope.linkText + '\"';\n                }\n                tag += '>[cf:' + elem.name + '.vlink]</mms-view-link>';\n                return tag;\n            };\n\n            $scope.choose = function(elem) {\n                var did = null;\n                var vid = null;\n                var peid = null;\n                var currentDoc = ApplicationService.getState().currentDoc;\n                if (elem._relatedDocuments && elem._relatedDocuments.length > 0) {\n                    var cur = _.find(elem._relatedDocuments, {id: currentDoc});\n                    if (cur) {\n                        did = currentDoc;\n                        if (cur._parentViews.length > 0) {\n                            vid = cur._parentViews[0].id;\n                        }\n                    } else {\n                        did = elem._relatedDocuments[0].id;\n                        if (elem._relatedDocuments[0]._parentViews.length > 0) {\n                            vid = elem._relatedDocuments[0]._parentViews[0].id;\n                        }\n                    }\n                }\n                if (elem.type === 'InstanceSpecification') {\n                    if (ViewService.isSection(elem)) {\n                        vid = elem.id;\n                    } else {\n                        peid = elem.id;\n                    }\n                } else {\n                    vid = elem.id;\n                }\n                var tag = createViewLink(elem, did, vid, peid);\n                $uibModalInstance.close(tag);\n            };\n            $scope.chooseDoc = function(doc, view, elem) {\n                var did = doc.id;\n                var vid = view.id;\n                var peid = null;\n                if (ViewService.isSection(elem)) {\n                    vid = elem.id;\n                } else if (ViewService.getPresentationElementType(elem)) {\n                    peid = elem.id;\n                }\n                var tag = createViewLink(elem, did, vid, peid);\n                $uibModalInstance.close(tag);\n            };\n            $scope.cancel = function() {\n                $uibModalInstance.dismiss();\n            };\n\n            var mainSearchFilter = function() {\n                var stereoQuery = {};\n                stereoQuery.terms = {\"_appliedStereotypeIds\": [UtilsService.VIEW_SID, UtilsService.DOCUMENT_SID].concat(UtilsService.OTHER_VIEW_SID)};\n\n                var classifierList = [];\n                var allClassifierIds = ViewService.TYPE_TO_CLASSIFIER_ID;\n                for (var k in allClassifierIds) {\n                    if (allClassifierIds.hasOwnProperty(k)) {\n                        classifierList.push(allClassifierIds[k]);\n                    }\n                }\n                var classifierIdQuery = {};\n                classifierIdQuery.terms = {\"classifierIds\": classifierList};\n                return {\n                    \"bool\": {\n                        \"should\": [\n                            stereoQuery,\n                            classifierIdQuery\n                        ]\n                    }\n                };\n            };\n\n            $scope.searchOptions = {\n                callback: $scope.choose,\n                relatedCallback: $scope.chooseDoc,\n                filterQueryList: [mainSearchFilter],\n                itemsPerPage: 200\n            };\n        };\n\n        var viewLinkCallback = function(ed) {\n            var instance = $uibModal.open({\n                template: transcludeModalTemplate,\n                scope: scope,\n                controller: ['$scope', '$uibModalInstance', 'ApplicationService', transcludeViewLinkCtrl],\n                size: 'lg'\n            });\n            instance.result.then(function(tag) {\n                _addWidgetTag(ed, tag);\n            });\n        };\n\n        var commentCtrl = function($scope, $uibModalInstance) {\n            var id = UtilsService.createMmsId();\n            $scope.comment = UtilsService.createClassElement({\n                id: id,\n                name: 'Comment ' + new Date().toISOString(),\n                documentation: '',\n                type: 'Class',\n                ownerId: \"holding_bin_\" + scope.mmsProjectId,\n                _appliedStereotypeIds: []\n            });\n            $scope.oking = false;\n            $scope.ok = function() {\n                if ($scope.oking) {\n                    growl.info(\"Please wait...\");\n                    return;\n                }\n                $scope.oking = true;\n                var reqOb = {element: $scope.comment, projectId: scope.mmsProjectId, refId: scope.mmsRefId};\n                ElementService.createElement(reqOb)\n                .then(function(data) {\n                    var tag = '<mms-cf mms-cf-type=\"com\" mms-element-id=\"' + data.id + '\">comment:' + data._creator + '</mms-cf>';\n                    $uibModalInstance.close(tag);\n                }, function(reason) {\n                    growl.error(\"Comment Error: \" + reason.message);\n                }).finally(function() {\n                    $scope.oking = false;\n                });\n            };\n            $scope.cancel = function() {\n                $uibModalInstance.dismiss();\n            };\n        };\n\n        var commentCallback = function(ed) {\n            var instance = $uibModal.open({\n                template: commentModalTemplate,\n                scope: scope,\n                controller: ['$scope', '$uibModalInstance', commentCtrl]\n            });\n            instance.result.then(function(tag) {\n                _addWidgetTag(ed, tag);\n            });\n        };\n\n        var resetCrossRef = function(type, typeString) {\n            angular.forEach(type, function(value, key) {\n                var transclusionObject = angular.element(value);\n                var transclusionId = transclusionObject.attr('mms-element-id');\n                var transclusionKey = UtilsService.makeElementKey({id: transclusionId, _projectId: scope.mmsProjectId, _refId: scope.mmsRefId});\n                var inCache = CacheService.get(transclusionKey);\n                if (inCache) {\n                    transclusionObject.html('[cf:' + inCache.name + typeString);\n                } else {\n                    //TODO create Utils function to handle request objects\n                    var reqOb = {elementId: transclusionId, projectId: scope.mmsProjectId, refId: scope.mmsRefId};\n                    ElementService.getElement(reqOb, 2)\n                    .then(function(data) {\n                        transclusionObject.html('[cf:' + data.name + typeString);\n                    }, function(reason) {\n                        var error;\n                        if (reason.status === 410)\n                            error = 'deleted';\n                        if (reason.status === 404)\n                            error = 'not found';\n                        transclusionObject.html('[cf:' + error + typeString);\n                    });\n                }\n            });\n        };\n\n        var mmsResetCallback = function(ed) {\n            var body = ed.document.getBody();\n            resetCrossRef(body.find(\"mms-cf[mms-cf-type='name']\").$, '.name]');\n            resetCrossRef(body.find(\"mms-cf[mms-cf-type='doc']\").$, '.doc]');\n            resetCrossRef(body.find(\"mms-cf[mms-cf-type='val']\").$, '.val]');\n            resetCrossRef(body.find('mms-view-link').$, '.vlink]');\n            update();\n        };\n\n        var update = function() {\n            // getData() returns CKEditor's processed/clean HTML content.\n            if (angular.isDefined(instance) && instance !== null)\n                ngModelCtrl.$setViewValue(instance.getData());\n        };\n        \n        // Formatting editor toolbar\n        var stylesToolbar = { name: 'styles', items : ['Format','FontSize','TextColor','BGColor' ] };\n        var basicStylesToolbar = { name: 'basicstyles', items : [ 'Bold','Italic','Underline', 'mmsExtraFormat'] };\n        var clipboardToolbar = { name: 'clipboard', items : [ 'Undo','Redo' ] };\n        var justifyToolbar = { name: 'paragraph', items : [ 'JustifyLeft','JustifyCenter','JustifyRight' ] };\n        var editingToolbar = { name: 'editing', items : [ 'Find','Replace' ] };\n        var linksToolbar = { name: 'links', items : [ 'Link','Unlink','-' ] };\n        var imageToolbar = { name: 'image', items: [ 'Image','Iframe' ] };\n        var listToolbar =  { name: 'list', items: [ 'NumberedList','BulletedList','Outdent','Indent' ] };\n        var equationToolbar = { name: 'equation', items: [ 'Mathjax','SpecialChar' ]};\n        var sourceToolbar = { name: 'source', items: [ 'Maximize','Source' ] };\n        var combinedToolbar = { name: 'combined', items: [{name: 'Mmscf', label: 'Cross Reference', command: 'mmscf'},\n            {name: 'Mmsvlink',label: 'View/Element Link',command: 'mmsvlink'}, 'Table', 'Image', 'Iframe', 'Mathjax', 'SpecialChar', {name: 'Mmscomment',label: 'Comment',   command: 'mmscomment'}, 'mmsExtraFeature' ]};\n        // var tableEquationToolbar = { name: 'tableEquation', items: ['Table', 'Mathjax', 'SpecialChar', '-']};\n\n        var thisToolbar = [stylesToolbar, basicStylesToolbar, justifyToolbar, listToolbar, linksToolbar, combinedToolbar, clipboardToolbar, editingToolbar, sourceToolbar];\n        switch(scope.mmsEditorType) {\n            case 'TableT':\n                //thisToolbar = [stylesToolbar, basicStylesToolbar, justifyToolbar, linksToolbar, tableEquationToolbar, dropdownToolbar, clipboardToolbar, editingToolbar, sourceToolbar];\n                break;\n            case 'ListT':\n                thisToolbar = [stylesToolbar, basicStylesToolbar, justifyToolbar, listToolbar, linksToolbar, equationToolbar, 'mmsExtraFeature', clipboardToolbar, editingToolbar, sourceToolbar];\n                break;\n            case 'Equation':\n                thisToolbar = [justifyToolbar, equationToolbar, sourceToolbar];\n                break;\n            case 'Figure':\n            case 'ImageT':\n                thisToolbar = [justifyToolbar, imageToolbar, sourceToolbar];\n                break;\n        }\n\n        var deb = _.debounce(function(e) {\n            update();\n        }, 1000);\n\n        $timeout(function() {\n            // Initialize ckeditor and set event handlers\n            $(element).val(ngModelCtrl.$modelValue);\n            instance = CKEDITOR.replace(attrs.id, {\n                // customConfig: '/lib/ckeditor/config.js',\n                mmscf: {callbackModalFnc: transcludeCallback},\n                mmscomment: {callbackModalFnc: commentCallback},\n                mmsvlink: {callbackModalFnc: viewLinkCallback},\n                mmsreset: {callback: mmsResetCallback},\n                contentsCss: CKEDITOR.basePath+'contents.css',\n                toolbar: thisToolbar\n            });\n\n            // Enable Autosave plugin only when provided with unique identifier (autosaveKey)\n            if ( attrs.autosaveKey ) {\n                // Configuration for autosave plugin\n                instance.config.autosave = {\n                    SaveKey: attrs.autosaveKey,\n                    delay: 5,\n                    NotOlderThen: 7200, // 5 days in minutes\n                    enableAutosave: true\n                };\n            } else {\n                instance.config.autosave = {enableAutosave: false};\n            }\n\n            instance.on( 'instanceReady', function() {\n                addCkeditorHtmlFilterRule(instance);\n                _addContextMenuItems(instance);\n                highlightActiveEditor(instance);\n            } );\n\n            function highlightActiveEditor(instance) {\n                var activeEditorClass = 'active-editor';\n                $('mms-transclude-doc').children('div').removeClass(activeEditorClass);\n                $(instance.element.$).closest('mms-transclude-doc').children('div').addClass(activeEditorClass);\n\n                instance.on('focus', function() {\n                    $('mms-transclude-doc').children('div').removeClass(activeEditorClass);\n                    $(instance.element.$).closest('mms-transclude-doc').children('div').addClass(activeEditorClass);\n                });\n            }\n\n            function addCkeditorHtmlFilterRule(instance) {\n                instance.dataProcessor.htmlFilter.addRules({\n                    elements: {\n                        $: function (element) {\n                            if (element.name === 'script') {\n                                element.remove();\n                                return;\n                            }\n                            \n                            if (element.name.startsWith('mms-')) {\n                                if (element.name !== 'mms-view-link' && element.name !== 'mms-cf' && element.name !== 'mms-group-docs' && element.name !== 'mms-diff-attr' && element.name !== 'mms-value-link') {\n                                    element.replaceWithChildren();\n                                    return;\n                                }\n                            }\n\n                            var attributesToDelete = Object.keys(element.attributes).filter(function(attrKey) {\n                                return attrKey.startsWith('ng-');\n                            });\n                            attributesToDelete.forEach(function(attrToDelete) {\n                                delete element.attributes[attrToDelete];\n                            });\n                        }\n                    }\n                });\n            }\n\n            instance.on( 'init', function(args) {\n                ngModelCtrl.$setPristine();\n            });\n\n            instance.on( 'change', deb);\n            instance.on( 'afterCommandExec', deb);\n            instance.on( 'resize', deb);\n            instance.on( 'destroy', deb);\n            instance.on( 'blur', function(e) {\n                instance.focusManager.blur();\n            });\n            instance.on( 'key', _keyHandler , null, null, 31); //priority is after indent list plugin's event handler\n\n            _addInlineMention();\n\n            if (scope.mmsEditorApi) {\n                scope.mmsEditorApi.save = function() {\n                    update();\n                };\n            }\n            instance.on('fileUploadRequest', function(evt) {\n                var fileLoader = evt.data.fileLoader;\n                var formData = new FormData();\n                var xhr = fileLoader.xhr;\n\n                xhr.open( 'POST', URLService.getPutArtifactsURL({projectId: scope.mmsProjectId, refId: scope.mmsRefId}), true );\n                formData.append('id', UtilsService.createMmsId().replace('MMS', 'VE'));\n                formData.append('file', fileLoader.file, fileLoader.fileName );\n                if (fileLoader.fileName) {\n                    formData.append('name', fileLoader.fileName);\n                }\n                fileLoader.xhr.send( formData );\n\n                // Prevented the default behavior.\n                evt.stop();\n            });\n            instance.on( 'fileUploadResponse', function( evt ) {\n                // Prevent the default response handler.\n                evt.stop();\n            \n                // Get XHR and response.\n                var data = evt.data;\n                var xhr = data.fileLoader.xhr;\n                var response = JSON.parse(xhr.response);\n            \n                if ( !response.artifacts || response.artifacts.length == 0) {\n                    // An error occurred during upload.\n                    //data.message = response[ 1 ];\n                    evt.cancel();\n                } else {\n                    data.url = '/alfresco' + response.artifacts[0].artifactLocation;\n                }\n            } );\n        }, 0, false);\n        \n        ngModelCtrl.$render = function() { //commenting out to see if it helps with cursors jumping problem without adverse effects\n        //side effect is will not sync if editing in both right pane and center pane at the same time\n            // if (!instance) {\n            //     instance = CKEDITOR.instances[attrs.id];\n            // } else {\n            //     var ranges = instance.getSelection().getRanges();\n            //     instance.setData(ngModelCtrl.$viewValue || '');\n            //     instance.getSelection().selectRanges( ranges );\n            // }\n        };\n        \n        scope.$on('$destroy', function() {\n            if (!instance) {\n                instance = CKEDITOR.instances[attrs.id];\n            } else {\n                MentionService.removeAllMentionForEditor(instance);\n                instance.destroy();\n                instance = null;\n            }\n        });\n\n        function _addWidgetTag(editor, tag) {\n            editor.insertHtml( tag );\n            Utils.focusOnEditorAfterAddingWidgetTag(editor);\n        }\n\n        function _addInlineMention() {\n            var keyupHandler;\n            CKEDITOR.instances[attrs.id].on('contentDom', function() {\n                keyupHandler = CKEDITOR.instances[instance.name].document.on('keyup', function(e) {\n                    if(_isMentionKey(e.data.$)) {\n                        MentionService.createMention(instance, scope.mmsProjectId, scope.mmsRefId);\n                    } else {\n                        MentionService.handleInput(e, instance, scope.mmsProjectId, scope.mmsRefId);\n                    }\n                });\n            });\n\n            CKEDITOR.instances[attrs.id].on('contentDomUnload', function() {\n                if (keyupHandler) {\n                    keyupHandler.removeListener();\n                }\n            });\n        }\n\n        function _keyHandler(e) {\n            if (_isMentionKey(e.data.domEvent.$)) {\n                return false; // to prevent \"@\" from getting written to the editor\n            }\n\n            // when tab is pressed or any of these special keys is pressed while the mention results show up, ignore default ckeditor's behaviour\n            var ignoreDefaultBehaviour = _isTabKey(e) || (_isSpecialKey(e) && MentionService.hasMentionResults(instance) );\n            if ( ignoreDefaultBehaviour ) {\n                e.cancel(); e.stop();\n            }\n\n            if (_isTabKey(e) && !_isShiftKeyOn(e.data.domEvent.$)) {\n                instance.insertHtml('&nbsp;&nbsp;&nbsp;&nbsp;');\n            }\n\n            if (!ignoreDefaultBehaviour) {\n                deb(e);\n            }\n        }\n\n        // 13 = enter, 38 = up arrow, 40 = down arrow\n        function _isSpecialKey(event) {\n            var key = event.data.domEvent.$.which;\n            return key === 13 || key === 38 || key === 40;\n        }\n\n        function _isTabKey(event) {\n            return event.data.domEvent.$.which === 9;\n        }\n\n        function _isMentionKey(keyboardEvent) {\n            return _isShiftKeyOn(keyboardEvent) && keyboardEvent.key === '@';\n        }\n\n        function _isShiftKeyOn(keyboardEvent) {\n            return keyboardEvent.shiftKey;\n        }\n\n        function _addContextMenuItems(editor) {\n            _addFormatAsCodeMenuItem(editor);\n        }\n\n        function _addFormatAsCodeMenuItem(editor) {\n            editor.addCommand('formatAsCode', {\n                exec: function (editor) {\n                    var selected_text = editor.getSelection().getSelectedText();\n                    var newElement = new CKEDITOR.dom.element(\"code\");\n                    newElement.addClass('inlineCode');\n                    newElement.setText(selected_text);\n                    editor.insertElement(newElement);\n                }\n            });\n            editor.addMenuGroup('veGroup');\n            editor.addMenuItem('formatAsCode', {\n                label: 'Format as inline code',\n                command: 'formatAsCode',\n                group: 'veGroup',\n                icon: 'codeSnippet'\n            });\n            editor.contextMenu.addListener(function (element) {\n                return {formatAsCode: CKEDITOR.TRISTATE_OFF};\n            });\n            editor.setKeystroke( CKEDITOR.CTRL + 75, 'formatAsCode' );\n        }\n    };\n\n    return {\n        priority: 10,\n        restrict: 'A',\n        require: 'ngModel',\n        scope: {\n            mmsProjectId: '@',\n            mmsRefId: '@',\n            autosaveKey: '@',\n            mmsEditorType: '@',\n            mmsEditorApi: '<?'\n        },\n        link: mmsCkeditorLink\n    };\n}\n","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsDiagramBlock', ['go', 'growl', 'ElementService', mmsDiagramBlock]);\n\nfunction mmsDiagramBlock(go, growl, ElementService) {\n\n  var mmsDiagramBlockCtrl = function(scope) {\n  };\n\n  var mmsDiagramBlockLink = function(scope, element, attrs) {\n\n      ElementService.getOwnedElements(scope.mmsDid, false, 'master', 'latest')\n      .then(function(data) {\n\n        var ownedElementsMap = {};\n\n        for (var i = 0; i < data.length; i++) {\n          ownedElementsMap[data[i].id] = data[i];\n        }\n\n        // create a list of all the nodes\n        var nodesMap = {};\n\n        var elem;\n\n        for (i = 0; i < data.length; i++) {\n          elem = data[i];\n\n          if (elem.type === 'Element') {\n\n            var node = { key: elem.id ,iskey: true, figure: \"Decision\", label: elem.name, children: [] };\n            \n            // does it have an owner and is the owner a member of this model?\n            if (elem.hasOwnProperty('ownerId') && \n                ownedElementsMap[elem.ownerId]) {\n              node.parent = elem.ownerId;\n            }\n\n            nodesMap[node.key] = node;\n          }\n        }\n\n        // associate children nodes with all the nodes and\n        var nodes = [];\n \n        for (var elem_id in nodesMap) {\n          var elem_node = nodesMap[elem_id];\n          nodes.push(elem_node);\n          if (elem_node.parent) {\n            nodesMap[elem_node.parent].children.push(elem_node);\n          }\n        }\n\n        // create a list of all the edges / relationships\n        var edges = [];\n\n        for (i = 0; i < data.length; i++) {\n          elem = data[i];\n\n          if (elem.type === 'Dependency') {\n\n            var edge = { from: elem._sourceIds[0], to: elem._targetIds[0]};\n\n            edges.push(edge);\n          }\n        }\n\n        // a graph is a set of nodes, edges\n        var graph = { nodes: nodes, edges : edges };\n\n\n\n        // create a list of components to diagram from the graph\n        var components = [];\n\n        for (i = 0; i < graph.nodes.length; i++) {\n          elem = graph.nodes[i];\n\n          var diagramNode = { key: elem.key, text: elem.label, color: \"lightblue\"};\n\n          /*var diagramNode = \n                    \n                    { \n                        key: elem.key,\n                        items: [ \n                         { name: \"Name: \", key: \"elem.key\", iskey: false, figure: \"Diamond\", color: \"purple\" },\n                         { name: \"Status: \", iskey: false, figure: \"Diamond\", color: \"purple\" } ],\n                         text: elem.label, color: \"lightblue\" \n                       \n                    }; */\n\n\n          // if the element has children then it should be a group\n          if (elem.children.length > 0) {\n            diagramNode.isGroup = true;\n          }\n\n          if (elem.parent) {\n            diagramNode.group = elem.parent;\n          }\n\n          components.push(diagramNode);\n        }\n\n        var $ = go.GraphObject.make;\n        var myDiagram =  // create a Diagram for the given HTML DIV element\n          $(go.Diagram, element[0],\n            {\n              allowDrop: true,\n                  // what to do when a drag-drop occurs in the Diagram's background\n                  mouseDrop:\n                    function(e) {\n                        // when the selection is dropped in the diagram's background,\n                        // make sure the selected Parts no longer belong to any Group\n                        var ok = myDiagram.commandHandler.addTopLevelParts(myDiagram.selection, true);\n                        if (!ok) myDiagram.currentTool.doCancel();\n                    },\n                  layout:\n                    $(go.GridLayout,\n                      { wrappingWidth: Infinity, alignment: go.GridLayout.Position,\n                          cellSize: new go.Size(1, 1) }),\n                  initialContentAlignment: go.Spot.Center,\n                  groupSelectionAdornmentTemplate:  // this applies to all Groups\n                    $(go.Adornment, go.Panel.Auto,\n                      $(go.Shape, \"Rectangle\",\n                        { fill: null, stroke: \"dodgerblue\", strokeWidth: 3 }),\n                      $(go.Placeholder)),\n                  \"commandHandler.archetypeGroupData\": { isGroup: true, category: \"OfNodes\" },\n                  \"undoManager.isEnabled\": true\n            });\n\n\n\n\n        myDiagram.addDiagramListener(\"ChangedSelection\", function(e) {\n\n            var selnode = myDiagram.selection.first();\n            myDiagram.model.selectedNodeData = (selnode instanceof go.Node ? selnode.data : null);\n            scope.$apply();\n\n        });\n\n\n        function highlightGroup(e, grp, show) {\n              if (!grp) return;\n              e.handled = true;\n              if (show) {\n                  // cannot depend on the grp.diagram.selection in the case of external drag-and-drops;\n                  // instead depend on the DraggingTool.draggedParts or .copiedParts\n                  var tool = grp.diagram.toolManager.draggingTool;\n                  var map = tool.draggedParts || tool.copiedParts;  // this is a Map\n                  // now we can check to see if the Group will accept membership of the dragged Parts\n                  if (grp.canAddMembers(map.toKeySet())) {\n                      grp.isHighlighted = true;\n                      return;\n                  }\n              }\n              grp.isHighlighted = false;\n          }\n\n           function finishDrop(e, grp) {\n              var ok = grp !== null && grp.addMembers(grp.diagram.selection, true);\n              if (!ok) grp.diagram.currentTool.doCancel();\n          }\n\n        myDiagram.groupTemplate =\n        $(go.Group, \"Auto\",\n          { // define the group's internal layout\n            layout: $(go.TreeLayout,\n                      { angle: 90, arrangement: go.TreeLayout.ArrangementHorizontal, isRealtime: false }),\n            // the group begins unexpanded;\n            // upon expansion, a Diagram Listener will generate contents for the group\n            isSubGraphExpanded: false,\n            // when a group is expanded, if it contains no parts, generate a subGraph inside of it\n            subGraphExpandedChanged: function(group) {\n              if (group.memberParts.count === 0) {\n                //randomGroup(group.data.key);\n              }\n            }\n          },\n          $(go.Shape, \"RoundedRectangle\",\n            { fill: null, stroke: \"gray\", strokeWidth: 2 }),\n          $(go.Panel, \"Vertical\",\n            { defaultAlignment: go.Spot.Left, margin: 4 },\n            $(go.Panel, \"Horizontal\",\n              { defaultAlignment: go.Spot.Top },\n              // the SubGraphExpanderButton is a panel that functions as a button to expand or collapse the subGraph\n              $(\"SubGraphExpanderButton\"),\n              $(go.TextBlock,\n                { font: \"Bold 18px Sans-Serif\", margin: 4 },\n                new go.Binding(\"text\", \"text\"))\n            ),\n            // create a placeholder to represent the area where the contents of the group are\n            $(go.Placeholder,\n              { padding: new go.Margin(0, 10) })\n          ) \n        ); // end Group\n\n\n\n        // whenever a GoJS transaction has finished modifying the model, update all Angular bindings\n        function updateAngular(e) {\n          if (e.isTransactionFinished) scope.$apply();\n        }\n\n\n\n        // notice when the value of \"model\" changes: update the Diagram.model\n      /*   scope.$watch(\"model\", function(var newmodel) {\n          var oldmodel = diagram.model;\n          if (oldmodel !== newmodel) {\n            if (oldmodel) oldmodel.removeChangedListener(updateAngular);\n            newmodel.addChangedListener(updateAngular);\n            diagram.model = newmodel;\n          }\n        }); */\n        // update the model when the selection changes\n\n       // the template for each attribute in a node's array of item data\n      var itemTempl =\n      $(go.Panel, \"Horizontal\",\n        $(go.Shape,                             //node's object rendering\n          { desiredSize: new go.Size(5, 5) },\n          new go.Binding(\"figure\", \"figure\"),\n          new go.Binding(\"fill\", \"color\")),\n        $(go.TextBlock,\n          { stroke: \"$black\",\n            font: \"bold 11px sans-serif\" },\n          new go.Binding(\"text\", \"\", go.Binding.toString))\n      ); \n\n\n\n  myDiagram.nodeTemplate =\n        $(go.Node, go.Panel.Auto,\n        {\n          selectionAdorned: true,\n          resizable: true,\n          layoutConditions: go.Part.LayoutStandard & ~go.Part.LayoutNodeSized,\n          fromSpot: go.Spot.Right,\n          toSpot: go.Spot.Left,\n          isShadowed: true,\n          // highlight when dragging over a Node that is inside a Group\n          mouseDragEnter: function(e, nod, prev) { highlightGroup(e, nod.containingGroup, true); },\n          mouseDragLeave: function(e, nod, next) { highlightGroup(e, nod.containingGroup, false); },\n          // dropping on a Node is the same as dropping on its containing Group, if any\n          mouseDrop: function(e, nod) { finishDrop(e, nod.containingGroup); }\n        },\n        $(go.Shape, \"RoundedRectangle\",\n          { isPanelMain: true, fill: \"#ACE600\", stroke: \"#558000\", strokeWidth: 2 },\n          new go.Binding(\"fill\", \"color\")),\n        $(go.Panel, \"Table\",\n          { margin: 4, maxSize: new go.Size(150, NaN) },\n          // the two TextBlocks in column 0 both stretch in width\n          // but align on the left side\n          $(go.RowColumnDefinition,\n            {\n              column: 0,\n              stretch: go.GraphObject.Horizontal,\n              alignment: go.Spot.Left\n            }),\n        $(go.TextBlock,\n          {    row: 0, column: 0,\n              maxSize: new go.Size(120, NaN),\n              margin: 2,\n              font: \"bold 10pt sans-serif\",\n              alignment: go.Spot.Top\n          },\n          new go.Binding(\"text\", \"text\")),//.makeTwoWay()),\n          /* $(go.TextBlock,\n            {\n              row: 1, column: 0, columnSpan: 2,\n              font: \"8pt sans-serif\"\n            },\n            new go.Binding(\"text\", \"\", theInfoTextConverter)) */\n\n        //panel for displaying properties\n         $(go.Panel, \"Vertical\",\n            { row: 1,\n              padding: 3,\n              alignment: go.Spot.TopLeft,\n              defaultAlignment: go.Spot.Left,\n              stretch: go.GraphObject.Horizontal,\n              itemTemplate: itemTempl },\n            new go.Binding(\"itemArray\", \"items\")) \n         )\n      );\n\n          //Links organization, keep links from crossing over nodes\n          myDiagram.linkTemplate =\n          $(go.Link,\n            { routing: go.Link.AvoidsNodes, corner: 5,\n            curve: go.Link.JumpGap },\n            $(go.Shape),\n            $(go.Shape, { toArrow: \"Standard\" })\n            );\n\n      // Link components to diagram\n      myDiagram.model = new go.GraphLinksModel(\n          components,\n          graph.edges\n      );\n    \n      myDiagram.model.selectedNodeData = null;\n\n\n      }, function(reason) {\n          growl.error('Block Diagram Error: ' + reason.message);\n      });\n  };\n\n  return {\n    restrict: 'E',\n    template: '<div></div>',  // just a simple DIV element\n    replace: true,\n    scope: { \n      mmsDid : '@'\n    },\n    controller: ['ElementService', mmsDiagramBlockCtrl],\n    link: mmsDiagramBlockLink\n  };\n}","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsDiffAttr', ['$compile', '$rootScope', '$interval', '$templateCache', '$q', 'ElementService', mmsDiffAttr]);\n\n/**\n * @ngdoc directive\n * @name mms.directives.directive:mmsDiffAttr\n *\n * @requires mms.ElementService\n * @requires $compile\n * @requires $rootScope\n * @requires $interval\n *\n * @restrict E\n *\n * @description\n *  Compares a element at two different refs/commits and generates a pretty diff.\n * ## Example\n * <mms-diff-attr mms-base-element-id=\"\" mms-attr=\"name|doc|val\"\n * (mms-base-project-id=\"\" mms-base-ref-id=\"\" mms-compare-ref-id=\"\"\n * mms-base-commit-id=\"\" mms-compare-commit-id=\"\")></mms-diff-attr>\n *\n * @param {string} mmsAttr Attribute to use -  ie `name`, `doc` or `value`\n * @param {string} mmsBaseElementId The id of the element to do comparison of\n * @param {string} mmsBaseProjectId Base project ID for original/base element\n * @param {string} mmsCompareProjectId Compare project ID for compare element\n * @param {string=master} mmsBaseRefId Base ref ID or master, defaults to current ref or master\n * @param {string=master} mmsCompareRefId Compare ref ID or master, defaults to base ref ID\n * @param {string=latest} mmsBaseCommitId Base commit id, default is latest\n * @param {string=latest} mmsCompareCommitId Compare commit id, default is latest\n */\nfunction mmsDiffAttr($compile, $rootScope, $interval, $templateCache, $q, ElementService) {\n    var template = $templateCache.get('mms/templates/mmsDiffAttr.html');\n\n    return {\n        restrict: 'E',\n        scope: {\n            mmsAttr: '@',\n\n            mmsBaseProjectId: '@',\n            mmsCompareProjectId: '@',\n\n            mmsBaseRefId: '@',\n            mmsCompareRefId: '@',\n\n            mmsBaseCommitId: '@',\n            mmsCompareCommitId: '@',\n\n            mmsBaseElementId: '@',\n            mmsCompareElementId: '@'\n        },\n        template: template,\n        link: mmsDiffAttrLink,\n        require: '?^^mmsView'\n    };\n\n    function mmsDiffAttrLink(scope, element, attrs, mmsViewCtrl) {\n        var viewOrigin = mmsViewCtrl ? mmsViewCtrl.getElementOrigin() : null;\n        scope.diffFinish = function() { scope.diffLoading = false; };\n        scope.$watch('mmsBaseCommitId', _commitIdChangeHandler);\n        scope.$watch('mmsCompareCommitId', _commitIdChangeHandler);\n\n        var baseNotFound = false;\n        var compNotFound = false;\n        var baseDeleted = false;\n        var compDeleted = false;\n\n        _setupDiff();\n\n        function _setupDiff() {\n            scope.diffLoading = true;\n\n            var baseProjectId = scope.mmsBaseProjectId || (viewOrigin ? viewOrigin.projectId : null);\n            var compareProjectId = scope.mmsCompareProjectId || baseProjectId;\n\n            var baseRefId = scope.mmsBaseRefId || (viewOrigin ? viewOrigin.refId : 'master');\n            var compareRefId = scope.mmsCompareRefId || baseRefId;\n\n            var baseCommitId = scope.mmsBaseCommitId || 'latest';\n            var compareCommitId = scope.mmsCompareCommitId || 'latest';\n\n            var baseElementId = scope.mmsBaseElementId;\n            var compareElementId = scope.mmsCompareElementId || baseElementId;\n\n            var isSame = _checkSameElement({\n                baseElementId: baseElementId,\n                compareElementId: compareElementId,\n\n                baseCommitId: baseCommitId,\n                compareCommitId: compareCommitId,\n\n                baseRefId: baseRefId,\n                compareRefId: compareRefId,\n\n                baseProjectId: baseProjectId,\n                compareProjectId: compareProjectId\n            });\n            if (isSame) {\n                return;\n            }\n\n            var baseElementPromise = _getElementData(baseProjectId, baseRefId, baseCommitId, baseElementId);\n            var comparedElementPromise = _getElementData(compareProjectId, compareRefId, compareCommitId, compareElementId);\n\n            $q.allSettled([baseElementPromise, comparedElementPromise]).then(function(responses) {\n                var message;\n\n                var respForBaseElement = responses[0];\n                if (respForBaseElement.state === 'fulfilled') {\n                    _fullyRender(respForBaseElement.value, function(baseElementHtml) {\n                        scope.baseElementHtml = baseElementHtml;\n                    });\n                } else {\n                    message = respForBaseElement.reason.message;\n                    if (message && message.toLowerCase().includes(\"deleted\")) {\n                        baseDeleted = true;\n                    } else {\n                        baseNotFound = true;\n                    }\n                    scope.baseElementHtml = '';\n                }\n\n                var respForComparedElement = responses[1];\n                if(respForComparedElement.state === 'fulfilled') {\n                    _fullyRender(respForComparedElement.value, function(comparedElementHtml) {\n                        scope.comparedElementHtml = comparedElementHtml;\n                    });\n                } else {\n                    message = respForComparedElement.reason.message;\n                    if (message && message.toLowerCase().includes(\"deleted\")) {\n                        compDeleted = true;\n                    } else {\n                        compNotFound = true;\n                    }\n                    scope.comparedElementHtml = '';\n                }\n                scope.message = _checkElementExistence();\n\n            });\n        }\n\n        function _commitIdChangeHandler(newVal, oldVal) {\n            if (newVal !== oldVal) {\n                _setupDiff();\n            }\n        }\n\n        function _getElementData(projectId, refId, commitId, elementId) {\n            return ElementService.getElement({\n                projectId:  projectId,\n                elementId:  elementId,\n                refId:      refId,\n                commitId:   commitId\n            });\n        }\n\n        function _fullyRender(data, finishRenderCb) {\n            var element = _createElement(scope.mmsAttr, data.id, data._projectId, data._refId, data._commitId);\n            var handler = $interval(function() {\n                var baseHtml = element.html();\n                if (!baseHtml.includes(\"(loading...)\")) {\n                    $interval.cancel(handler);\n                    finishRenderCb(baseHtml);\n                }\n            }, 10);\n        }\n\n        function _createElement(type, mmsElementId, mmsProjectId, mmsRefId, mmsCommitId) {\n            var html;\n            var ignoreMathjaxAutoFormatting = type === 'doc' || type === 'val' || type === 'com';\n            html = '<mms-cf ' + (ignoreMathjaxAutoFormatting ? 'mms-generate-for-diff=\"mmsGenerateForDiff\" ' : '') +  'mms-cf-type=\"{{type}}\" mms-element-id=\"{{mmsElementId}}\" mms-project-id=\"{{mmsProjectId}}\" mms-ref-id=\"{{mmsRefId}}\" mms-commit-id=\"{{mmsCommitId}}\"></mms-cf>';\n            var newScope = $rootScope.$new();\n            newScope = Object.assign(newScope, {\n                type: type,\n                mmsElementId: mmsElementId,\n                mmsProjectId: mmsProjectId,\n                mmsRefId: mmsRefId,\n                mmsCommitId: mmsCommitId,\n                mmsGenerateForDiff: true\n            });\n            return $compile(html)(newScope);\n        }\n\n        function _checkElementExistence() {\n            var message = '';\n            if (baseNotFound && compNotFound) {\n                message = ' Both base and compare elements do not exist.';\n            } else if (baseNotFound) {\n                message = ' This is a new element.';\n            } else if (compNotFound) {\n                message = ' Comparison element does not exist.';\n            }\n            if (baseDeleted && compDeleted) {\n                message = ' This element has been deleted.';\n            } else if (baseDeleted){\n                message = ' Base element has been deleted.';\n            } else if (compDeleted){\n                message = ' Comparison element has been deleted.';\n            }\n            return message;\n        }\n\n        function _checkSameElement(data) {\n            if ( (data.baseCommitId !== 'latest' && data.baseCommitId === data.compareCommitId ) ||\n                (data.baseCommitId === 'latest' && data.baseCommitId === data.compareCommitId && data.baseElementId === data.compareElementId && data.baseProjectId === data.compareProjectId && data.baseRefId === data.compareRefId )) {\n                scope.message = ' Comparing same version.';\n                scope.diffLoading = false;\n                return true;\n            }\n        }\n    }\n}\n","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsGroupDocs', ['ElementService', 'ViewService', 'growl', '$q', '$templateCache', '_', mmsGroupDocs]);\n\n/**\n * @ngdoc directive\n * @name mms.directives.directive:mmsGroupDocs\n *\n * @requires mms.ElementService\n *\n * @restrict E\n *\n * @description\n *\n * @param {string} mmsGroupId The id of the group to show documents for\n * @param {string=master} mmsRefId Ref, defaults to master\n * @param {string} mmsProjectId Project Id, if not stated will get from surrounding view\n */\nfunction mmsGroupDocs(ElementService, ViewService, growl, $q, $templateCache, _) {\n\n    var mmsGroupDocsLink = function(scope, element, attrs, controllers) {\n        var mmsCfCtrl = controllers[0];\n        var mmsViewCtrl = controllers[1];\n        var update = function(documents) {\n            var docs = [];\n            var groupId = scope.mmsGroupId === '' ? undefined : scope.mmsGroupId;\n            for (var i = 0; i < documents.length; i++) {\n                if ( (groupId === undefined || groupId === scope.projectId) && !documents[i]._groupId ) {\n                    docs.push(documents[i]);\n                } else if (documents[i]._groupId == scope.mmsGroupId) {\n                    docs.push(documents[i]);\n                }\n            }\n            scope.docs = docs;\n        };\n\n        var projectId = scope.mmsProjectId;\n        var refId = scope.mmsRefId;\n        if (mmsCfCtrl) {\n            var cfVersion = mmsCfCtrl.getElementOrigin();\n            if (!projectId) {\n                projectId = cfVersion.projectId;\n            }\n            if (!refId) {\n                refId = cfVersion.refId;\n            }\n        }\n        if (mmsViewCtrl) {\n            var viewVersion = mmsViewCtrl.getElementOrigin();\n            if (!projectId) {\n                projectId = viewVersion.projectId;\n            }\n            if (!refId) {\n                refId = viewVersion.refId;\n            }\n        }\n        if (!projectId) {\n            return;\n        }\n        scope.projectId = projectId;\n        scope.refId = refId ? refId : 'master';\n        ViewService.getProjectDocuments({\n            projectId: scope.projectId,\n            refId: scope.refId\n        }, 2).then(function(documents) {\n            update(documents);\n            scope.documents = documents;\n            scope.$watchCollection('documents', function(newVal, oldVal) {\n                update(newVal);\n            });\n        });\n    };\n\n\n    return {\n        restrict: 'E',\n        template: $templateCache.get('mms/templates/mmsGroupDocs.html'),\n        scope: {\n            mmsRefId: '@',\n            mmsProjectId: '@',\n            mmsGroupId: '@'\n        },\n        require: ['?^^mmsCf', '?^^mmsView'],\n        link: mmsGroupDocsLink\n    };\n}","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsHistory', ['Utils','ElementService', 'ProjectService', '$templateCache', '$q', '$animate', '$uibModal', '_', mmsHistory]);\n\n/**\n * @ngdoc directive\n * @name mms.directives.directive:mmsHistory\n *\n * @requires mms.ElementService\n * @requires mms.ProjectService\n * @requires $templateCache\n * @requires $q\n * @requires _\n *\n * @restrict E\n *\n * @description\n * Outputs a history window of the element whose id is specified. History includes\n * name of modifier and date of change. Also modified date links to spec output below.\n *\n * ### template (html)\n * ## Example for showing an element history\n *  <pre>\n    <mms-history mms-element-id=\"{{id}}\" mms-ref-id=\"{{refId}}\"\n                         mms-project-id=\"{{projectId}}\"></mms-history>\n    </pre>\n *\n * @param {string} mmsElementId The id of the element\n * @param {string} mmsProjectId The project id for the element\n * @param {string=master} mmsRefId Reference to use, defaults to master\n */\nfunction mmsHistory(Utils, ElementService, ProjectService, $templateCache, $q, $animate, $uibModal, _) {\n    var template = $templateCache.get('mms/templates/mmsHistory.html');\n\n    var mmsHistoryLink = function(scope, element, attrs) {\n        var ran = false;\n        var lastid = null;\n        scope.historyVer = 'latest';\n        scope.compareCommit = {\n            ref: {id: scope.mmsRefId},\n            compareHistory: null,\n            commitSelected: null,\n            isopen: false\n        };\n\n\n        // base data\n        scope.refList = [];\n        scope.baseCommit = {\n            refSelected: {id: scope.mmsRefId},\n            baseHistory: null,\n            commitSelected: null,\n            isopen: false,\n            refisopen: false\n        };\n\n\n        // Get current scope element info\n        var reqOb = {elementId: scope.mmsElementId, projectId: scope.mmsProjectId, refId: scope.mmsRefId};\n        ElementService.getElement(reqOb, 2, false)\n        .then(function(data) {\n            scope.element = data;\n        });\n\n        /**\n         * @ngdoc function\n         * @name mms.directives.directive:mmsHistory#changeElement\n         * @methodOf mms.directives.directive:mmsHistory\n         *\n         * @description\n         * Change scope history when another element is selected\n         */\n        var changeElement = function(newVal, oldVal) {\n            if (!newVal || (newVal == oldVal && ran))\n                return;\n            ran = true;\n            lastid = newVal;\n            scope.gettingHistory = true;\n            var reqOb = {elementId: scope.mmsElementId, projectId: scope.mmsProjectId, refId: scope.mmsRefId};\n            ElementService.getElementHistory(reqOb, 2)\n            .then(function(data) {\n                if (newVal !== lastid)\n                    return;\n                scope.historyVer = 'latest';\n                scope.compareCommit.compareHistory = data;\n                scope.compareCommit.commitSelected = scope.compareCommit.compareHistory[0];\n                getRefs();\n                scope.baseCommit.baseHistory = data;\n                if (data.length > 1) {\n                    scope.baseCommit.commitSelected = scope.compareCommit.compareHistory[1];\n                } else if (data.length > 0) {\n                    scope.baseCommit.commitSelected = scope.compareCommit.compareHistory[0];\n                } else {\n                    scope.baseCommit.commitSelected = '--- none ---';\n                }\n            }).finally(function() {\n                scope.gettingHistory = false;\n            });\n        };\n\n        // Get ref list for project and details on\n        var getRefs = function() {\n            ProjectService.getRefs(scope.mmsProjectId)\n            .then(function(data) {\n                scope.refList = data;\n                scope.compareCommit.ref = _.find(data, function(item) {\n                    return item.id == scope.mmsRefId;\n                });\n                scope.baseCommit.refSelected = scope.compareCommit.ref;\n            });\n        };\n\n        scope.commitClicked = function(version) {\n            scope.compareCommit.commitSelected = version;\n            scope.historyVer = scope.compareCommit.commitSelected.id;\n            scope.compareCommit.isopen = !scope.compareCommit.isopen;\n        };\n\n        scope.getElementHistoryByRef = function(ref) {\n            if (ref) {\n                scope.disableRevert = false;\n                // scope.gettingCompareHistory = true;\n                scope.baseCommit.refSelected = ref;\n                var reqOb = {elementId: scope.mmsElementId, projectId: scope.mmsProjectId, refId: ref.id};\n                ElementService.getElementHistory(reqOb, 2)\n                .then(function(data) {\n                    scope.baseCommit.baseHistory = data;\n                    if (data.length > 0) {\n                        scope.baseCommit.commitSelected = scope.baseCommit.baseHistory[0];\n                    }\n                }, function(error) {\n                    scope.baseCommit.baseHistory = [];\n                    scope.baseCommit.commitSelected = '';\n                    scope.disableRevert = true;\n                }).finally(function() {\n                    // scope.gettingCompareHistory = false;\n                    scope.baseCommit.refisopen = !scope.baseCommit.refisopen;\n                });\n            }\n        };\n\n        scope.baseCommitClicked = function(version) {\n            scope.baseCommit.commitSelected = version;\n            scope.baseCommit.isopen = !scope.baseCommit.isopen;\n        };\n\n        scope.changeElement = changeElement;\n        scope.$watch('mmsElementId', changeElement);\n        scope.$watch('mmsRefId', changeElement);\n\n\n        //TODO\n        // check if commit ids are the same - display to user that they are comparing same or disable the commit that matches\n        scope.revert = function() {\n            Utils.revertAction(scope, changeElement, element);\n        };\n\n    };\n\n    return {\n        restrict: 'E',\n        template: template,\n        scope: {\n            mmsElementId: '@',\n            mmsProjectId: '@',\n            mmsRefId: '@'\n        },\n        link: mmsHistoryLink\n    };\n}\n","'use strict';\n\nangular.module('mms.directives')\n    .directive('mmsHtmlDiff', ['$templateCache', '$timeout', 'MathJax', 'HtmlRenderedDiff', mmsHtmlDiff]);\n\nfunction mmsHtmlDiff($templateCache, $timeout, MathJax, HtmlRenderedDiff) {\n    var template = $templateCache.get('mms/templates/mmsHtmlDiff.html');\n    var htmlDiffIdPrefix = 'htmlDiff-';\n    return {\n        restrict: 'E',\n        scope: {\n            mmsBaseHtml: '<',\n            mmsComparedHtml: '<',\n            mmsDiffFinish: '<'\n        },\n        template: template,\n        controller: ['$scope', mmsHtmlDiffCtrl],\n        link: mmsHtmlDiffLink\n    };\n\n    function mmsHtmlDiffCtrl($scope) {\n        _performDiff($scope, $scope.mmsBaseHtml, $scope.mmsComparedHtml);\n    }\n\n    function mmsHtmlDiffLink(scope, element, attrs) {\n        scope.htmlDiffId = htmlDiffIdPrefix + scope.$id;\n        scope.$watch('mmsBaseHtml', function(newBaseHtml, oldBaseHtml) {\n            if (newBaseHtml !== oldBaseHtml) {\n                _performDiff(scope, scope.mmsBaseHtml, scope.mmsComparedHtml);\n            }\n        });\n\n        scope.$watch('mmsComparedHtml', function(newComparedHtml, oldComparedHtml) {\n            if(newComparedHtml !== oldComparedHtml) {\n                _performDiff(scope, scope.mmsBaseHtml, scope.mmsComparedHtml);\n            }\n        });\n    }\n\n    function _performDiff(scope, baseHtml, comparedHtml) {\n        scope.diffResult = HtmlRenderedDiff.generateDiff(_preformatHtml(baseHtml), _preformatHtml(comparedHtml));\n        $timeout(function() {\n            var diffContainer = $('#' + scope.htmlDiffId);\n            _formatImgDiff(diffContainer);\n            _formatRowDiff(diffContainer);\n            scope.mmsDiffFinish();\n        });\n    }\n\n    function _preformatHtml(html) {\n        return html.replace(/\\r?\\n|\\r|\\t/g, '').replace('<p class=\"ng-scope\">&nbsp;</p>', '');\n    }\n\n    function _formatImgDiff(diffContainer) {\n        diffContainer\n            .find('img')\n            .each(function () {\n                var img$ = $(this);\n                var imgPatcherClass = img$.hasClass('patcher-insert') ? 'patcher-insert' : img$.hasClass('patcher-delete') ? 'patcher-delete' : null;\n                if (imgPatcherClass) {\n                    img$.wrap('<span class=\"' + imgPatcherClass + '\">');\n                }\n            });\n    }\n\n    function _formatRowDiff(diffContainer) {\n        diffContainer\n            .find('tr')\n            .each(function () {\n                var tr$ = $(this);\n                var trPatcherClass = tr$.hasClass('patcher-insert') ? 'patcher-insert' : tr$.hasClass('patcher-delete') ? 'patcher-delete' : null;\n                if (trPatcherClass) {\n                   tr$.removeClass(trPatcherClass);\n                   tr$.children().each(function() {\n                       $(this).addClass(trPatcherClass);\n                   });\n                }\n            });\n    }\n}\n","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsJobs', ['$templateCache', '$http', '$location', '$window', 'growl', '_', '$q', '$rootScope',\n        'AuthService', 'ElementService', 'ProjectService', 'UtilsService', 'JobService', mmsJobs]);\n/**\n * @ngdoc directive\n * @name mms.directives.directive:mmsJobs\n *\n * @requires $templateCache\n * @requires $http\n * @requires $location\n * @requires _\n *\n * @restrict E\n *\n * @description\n * Shows you jobs that you have running, going to run and history of jobs.\n * As well as let you edit and add jobs\n *\n * ### template (html)\n * ## Example for showing an element jobs\n *  <pre>\n *   <mms-jobs></mms-jobs>\n * </pre>\n *\n * @param {string=master} mmsBranch Branch to use, defaults to master\n * @param {string=null} mmsDocId the id of the current document under which the job is being run\n */\nfunction mmsJobs($templateCache, $http, $location, $window, growl, _, $q, $rootScope,\n        AuthService, ElementService, ProjectService, UtilsService, JobService) {\n\n    var template = $templateCache.get('mms/templates/mmsJobs.html');\n    //:TODO have cases for each null; \"running\"; \"failed\"; \"completed\"; \"aborted\";\"unstable\"; \"disabled\"; \"waiting\";\n    var mmsJobsLink = function (scope, element, attrs) {\n        var ran;\n        scope.jobs = [];\n        scope.jobInstances = {};\n        // scope.editorEnabled = false; // Edit name of job\n        scope.loadingJobs = false;\n        scope.createJobCleared = true; // TODO do we need?\n        scope.runCleared = true;\n        // scope.deleteCleared = true;\n        scope.jobInput = {jobName: ''};\n        scope.hasRefArr = false;\n        scope.docEditable = false;\n        scope.docgenExists = false;\n\n        // Get ref list for project and details on\n        var getRefsInProgress = function() {\n            ProjectService.getRefs(scope.mmsProjectId)\n            .then(function(data) {\n                scope.refList = data.filter(function(ref) {\n                    if (ref.status === 'creating') {\n                        return true;\n                    }\n                });\n            });\n        };\n\n        var getJobInstances = function (jobId) {\n            scope.loading = true;\n            JobService.getJobInstances(jobId, scope.mmsProjectId, scope.mmsRefId)\n            .then(function (instances) {\n                scope.jobInstances[jobId] = instances;\n            }, function(error) {\n                scope.jobInstances[jobId] = {jobStatus: 'error getting job'};\n            }).finally(function () {\n                scope.loading = false;\n            });\n        };\n\n        // get all the jobs for current document\n        var getJobs = function () {\n            scope.jobs = [];\n            scope.loadingJobs = true;\n            JobService.getJobs(scope.mmsDocId, scope.mmsProjectId, scope.mmsRefId)\n            .then(function (jobs) {\n                for (var i = 0; i < jobs.length; i++) {\n                    scope.jobs.push(jobs[i]);\n                    getJobInstances(jobs[i].id);\n                    if (jobs[i].type === 'docgen') {\n                        scope.docgenExists = true;\n                    }\n                }\n            }, function (error) {\n                growl.error('There was a error in retrieving your job: ' + error.status);\n            }).finally(function () {\n                scope.loadingJobs = false;\n            });\n        };\n\n        //Callback function for document change\n        var changeDocument = function (newVal, oldVal) {\n            if (!newVal || (newVal == oldVal && ran))\n                return;\n            ran = true;\n            var lastid = newVal;\n            var refOb = null;\n            getRefsInProgress();\n            ProjectService.getRef(scope.mmsRefId, scope.mmsProjectId).then(function(data) {\n                refOb = data;\n                scope.mmsRefType = refOb.type;\n                var reqOb = {elementId: scope.mmsDocId, projectId: scope.mmsProjectId, refId: scope.mmsRefId};\n                ElementService.getElement(reqOb, 2, false)\n                .then(function (document) {\n                    if (newVal !== lastid) {\n                        return;\n                    }\n                    if (!UtilsService.isDocument(document)) {\n                        scope.isDoc = false;\n                        return;\n                    } else {\n                        scope.isDoc = true;\n                    }\n                    scope.doc = document;\n                    scope.docName = document.name;\n                    // Set job run permissions\n                    scope.docEditable = document._editable && scope.mmsRefType != 'Tag';\n                    scope.createJobCleared = scope.docEditable;\n                    scope.runCleared = scope.docEditable;\n                    getJobs();\n                });\n            });\n        };\n\n        // watch for the document to change\n        scope.$watch('mmsDocId', changeDocument);\n\n        var runJob = function (id) {\n            scope.runCleared = false;\n            var jobRunOb = {\n                \"id\" : id\n            };\n\n            JobService.runJob(jobRunOb, scope.mmsProjectId, scope.mmsRefId)\n            .then(function(data) {\n                growl.success('Your job is running!');\n            }, function(error) {\n                growl.error('Your job failed to run: ' + error.data.message);\n            }).finally(function() {\n                scope.runCleared = true;\n            });\n        };\n\n        // logic for running a job immediately\n        scope.createJobandRun = function (id) {\n            if (!id) {\n                createJob().then(function (job) {\n                    scope.jobs.push(job);\n                    runJob(job.id);\n                });\n            } else {\n                runJob(id);\n            }\n        };\n\n        // logic for adding a new job\n        var createJob = function() {\n            var deferred = $q.defer();\n            var defaultName = scope.jobInput.jobName;\n            scope.createJobCleared = false;\n            if (!scope.jobInput.jobName) {\n                defaultName = scope.docName + \"_DocGen_job\";\n            }\n            var thisSchedule = '';\n            // Do we allow users to input schedule??\n            // if(scope.myOutput !== '* * * * *' && scope.myOutput)\n            //     thisSchedule = scope.myOutput;\n\n            var jobOb = {\n                \"id\": scope.mmsDocId,\n                \"jobName\" : defaultName,\n                \"jobType\" : \"docgen\",\n                \"jobSchedule\" : thisSchedule,\n            };\n\n            JobService.createJob(jobOb, scope.mmsProjectId, scope.mmsRefId)\n            .then(function(job) {\n                growl.success('Your job has posted');\n                scope.docgenExists = true;\n                deferred.resolve(job);\n            }, function(error) {\n                growl.error('Your job failed to post: ' + error.data.message);\n            }).finally(function() {\n                scope.createJobCleared = true;\n            });\n            return deferred.promise;\n        };\n\n        scope.disableJob = function(jobId) {\n        //    var link = URLService.getJobURL(scope.mmsProjectId, scope.mmsRefId, jobId, $location.host());\n        //    scope.deleteCleared = false;\n        //    $http.delete(link).then(function() {\n        //        //TODO remove from jobs list\n        //        var indexOfJob = _.findLastIndex(scope.jobs, {id: jobId});\n        //        scope.jobs.splice(indexOfJob, 1);\n        //        growl.success('Your job has been deleted');\n        //     }, function(error){\n        //         growl.error('Your job failed to be deleted: ' + error.status);\n        //     }).finally(function(){\n        //         scope.deleteCleared = true;\n        //     });\n        };\n\n        scope.changePane = function(pane) {\n            $rootScope.$broadcast(pane);\n        };\n\n        // actions for stomp\n        scope.$on(\"stomp.updateJob\", function(event, updateJob) {\n            var jobId = updateJob.jobId;\n            if (scope.jobInstances[jobId]){\n                scope.jobInstances[jobId] = [updateJob];\n            }\n        });\n\n        scope.$on(\"stomp.branchCreated\", function(event, updateRef, projectId) {\n            getRefsInProgress();\n        });\n    };\n    return {\n        restrict: 'E',\n        template: template,\n        scope: {\n            mmsProjectId: '@',\n            mmsRefId: '@',\n            mmsDocId:'@'\n        },\n        link: mmsJobsLink\n    };\n}\n","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsMaturityBar', ['$window', mmsMaturityBar]);\n\n/**\n * @ngdoc directive\n * @name mms.directives.directive:mmsMaturityBar\n *\n * @restrict E\n *\n * @description\n *\n * @param {string} state The current state of the maturity bar\n */\nfunction mmsMaturityBar($window) {\n\n    var mmsMaturityBarLink = function(scope, element, attrs) {\n     \tvar d3 = $window.d3;  \n      \t\n      \tvar svgContainer = d3.select(element[0]).append('svg')\n\t\t                                  .attr(\"width\", 520)\n\t\t                                  .attr(\"height\", 70);\n\t\tvar colorRect;\n\n\t\tif(scope.state == \"Identified\") {\n\t\t  colorRect = [\"brown\",\"#B0B0B0\",\"#B0B0B0\",\"#B0B0B0\",\"#B0B0B0\"];\n\t\t} else if (scope.state == \"Draft\") {\n\t\t  colorRect = [\"#FF7519\",\"#FF7519\",\"#B0B0B0\",\"#B0B0B0\",\"#B0B0B0\"];\n\t\t} else if (scope.state == \"Prelim\") {\n\t\t  colorRect = [\"#FFAA00\",\"#FFAA00\",\"#FFAA00\",\"#B0B0B0\",\"#B0B0B0\"];\n\t\t} else if (scope.state == \"Baseline\") {\n\t\t  colorRect = [\"#04859E\",\"#04859E\",\"#04859E\",\"#04859E\",\"#B0B0B0\"];\n\t\t} else if (scope.state == \"Final\") {\n\t\t  colorRect = [\"#00BD39\",\"#00BD39\",\"#00BD39\",\"#00BD39\",\"#00BD39\"];\n\t\t} else {\n\t\t  colorRect = [\"#B0B0B0\",\"#B0B0B0\",\"#B0B0B0\",\"#B0B0B0\",\"#B0B0B0\"];\t\t\t\n\t\t}\n\n\t\tsvgContainer.append(\"rect\")\n\t\t    .attr(\"x\", 10)\n\t\t    .attr(\"y\", 10)\n\t\t    .attr(\"width\", 100)\n\t\t    .attr(\"height\", 50)\n\t\t    .style(\"fill\",colorRect[0])\n\t\t    .style(\"stroke\",\"#fff\")\n\t\t    .style(\"stroke-width\",3);\n\t\tsvgContainer.append(\"text\")\n\t\t    .text(\"Identified\")\n\t\t    .attr(\"x\",60)\n\t\t    .attr(\"y\",35)\n\t\t    .attr(\"dy\", \".35em\")\n\t\t    .attr(\"fill\",\"#fff\")\n\t\t    .attr(\"font-family\",\"sans-serif\")\n\t\t    .style(\"text-anchor\", \"middle\");\n\t\tsvgContainer.append(\"rect\")\n\t\t    .attr(\"x\", 110)\n\t\t    .attr(\"y\", 10)\n\t\t    .attr(\"width\", 100)\n\t\t    .attr(\"height\", 50)\n\t\t    .style(\"fill\",colorRect[1])\n\t\t    .style(\"stroke\",\"#fff\")\n\t\t    .style(\"stroke-width\",3);\n\t\tsvgContainer.append(\"text\")\n\t\t    .text(\"Draft\")\n\t\t    .attr(\"x\",160)\n\t\t    .attr(\"y\",35)\n\t\t    .attr(\"dy\", \".35em\")\n\t\t    .attr(\"fill\",\"#fff\")\n\t\t    .attr(\"font-family\",\"sans-serif\")\n\t\t    .style(\"text-anchor\", \"middle\");\n\t\tsvgContainer.append(\"rect\")\n\t\t    .attr(\"x\", 210)\n\t\t    .attr(\"y\", 10)\n\t\t    .attr(\"width\", 100)\n\t\t    .attr(\"height\", 50)\n\t\t    .style(\"fill\",colorRect[2])\n\t\t    .style(\"stroke\",\"#fff\")\n\t\t    .style(\"stroke-width\",3);\n\t\tsvgContainer.append(\"text\")\n\t\t    .text(\"Prelim\")\n\t\t    .attr(\"x\",260)\n\t\t    .attr(\"y\",35)\n\t\t    .attr(\"dy\", \".35em\")\n\t\t    .attr(\"fill\",\"#fff\")\n\t\t    .attr(\"font-family\",\"sans-serif\")\n\t\t    .style(\"text-anchor\", \"middle\");\n\t\tsvgContainer.append(\"rect\")\n\t\t    .attr(\"x\", 310)\n\t\t    .attr(\"y\", 10)\n\t\t    .attr(\"width\", 100)\n\t\t    .attr(\"height\", 50)\n\t\t    .style(\"fill\",colorRect[3])\n\t\t    .style(\"stroke\",\"#fff\")\n\t\t    .style(\"stroke-width\",3);\n\t\tsvgContainer.append(\"text\")\n\t\t    .text(\"Baseline\")\n\t\t    .attr(\"x\",360)\n\t\t    .attr(\"y\",35)\n\t\t    .attr(\"dy\", \".35em\")\n\t\t    .attr(\"fill\",\"#fff\")\n\t\t    .attr(\"font-family\",\"sans-serif\")\n\t\t    .style(\"text-anchor\", \"middle\");\n\t\tsvgContainer.append(\"rect\")\n\t\t    .attr(\"x\", 410)\n\t\t    .attr(\"y\", 10)\n\t\t    .attr(\"width\", 100)\n\t\t    .attr(\"height\", 50)\n\t\t    .style(\"fill\",colorRect[4])\n\t\t    .style(\"stroke\",\"#fff\")\n\t\t    .style(\"stroke-width\",3);\n\t\tsvgContainer.append(\"text\")\n\t\t    .text(\"Final\")\n\t\t    .attr(\"x\",460)\n\t\t    .attr(\"y\",35)\n\t\t    .attr(\"dy\", \".35em\")\n\t\t    .attr(\"fill\",\"#fff\")\n\t\t    .attr(\"font-family\",\"sans-serif\")\n\t\t    .style(\"text-anchor\", \"middle\");\n    };\n\n    return {\n        restrict: 'E',\n        template: '',\n        scope: {\n            state: '@'\n        },\n        link: mmsMaturityBarLink\n    };\n}","'use strict';\n\nangular.module('mms.directives')\n    .directive('mmsMention', ['$templateCache', 'MentionService', 'Utils', mmsMention]);\n\nfunction mmsMention($templateCache, MentionService, Utils) {\n    return {\n        template: $templateCache.get('mms/templates/mmsMention.html'),\n        scope: {\n            mmsEditor: '<',\n            mmsMentionValue: '<',\n            mmsMentionId: '<',\n            mmsProjectId: '<',\n            mmsRefId: '<'\n        },\n        controller: ['$scope', mmsMentionCtrl],\n        link: mmsMentionLink\n    };\n    function mmsMentionLink(scope, element, attrs, ctrls) {}\n\n    function mmsMentionCtrl($scope) {\n        $scope.fastCfListing = MentionService.getFastCfListing($scope.mmsProjectId, $scope.mmsRefId);\n        // expose this api on the controller itself so that it can be accessed by codes that use $compile service to construct this directive.\n        this.selectMentionItem = selectMentionItem;\n        $scope.selectMentionItem = selectMentionItem;\n\n        function selectMentionItem($item) {\n            _createCf($item);\n            MentionService.handleMentionSelection($scope.mmsEditor, $scope.mmsMentionId);\n        }\n\n        function _createCf($item) {\n            var tag = '<mms-cf mms-cf-type=\"' + $item.type + '\" mms-element-id=\"' + $item.id + '\">[cf:' + $item.name + '.' + $item.type + ']</mms-cf>';\n            $scope.mmsEditor.insertHtml(tag);\n            Utils.focusOnEditorAfterAddingWidgetTag($scope.mmsEditor);\n        }\n    }\n}\n\n// Used to sync value between input from the ckeditor and the uib-typeahead directive\nangular.module('mms.directives')\n    .directive('mmsMentionIntercept', ['$templateCache',  mmsMentionIntercept]);\n\nfunction mmsMentionIntercept() {\n    return {\n        scope: {\n            mmsMentionInterceptValue: '<'\n        },\n        controller: ['$scope', mmsTestingController],\n        require: ['ngModel'],\n        link: function(scope, el, attrs, ctls) {\n            scope.$watch('mmsMentionInterceptValue', function(newV, oldV) {\n                var ngModelCtrl = ctls[0];\n                ngModelCtrl.$setViewValue(newV);\n                ngModelCtrl.$render();\n            });\n        }\n    };\n    function mmsTestingController($scope) {}\n}\n","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsRefList', ['$templateCache', '$http', 'growl', '_', '$q', '$uibModal',\n        'UtilsService', 'JobService', 'ElementService', 'URLService', mmsRefList]);\n/**\n * @ngdoc directive\n * @name mms.directives.directive:mmsRefList\n *\n * @requires $templateCache\n * @requires $http\n * @requires $location\n * @requires _\n *\n * @restrict E\n *\n * @description\n * Displays a list of branches/tags with details. Provides options for taking action on ref.\n * For the time being it only allows for running a doc merge job on current document.\n *\n * @param {string=master} mmsProjectId Current project\n * @param {string=master} mmsRefId Current branch\n * @param {string=null} mmsDocId the id of the current document\n */\nfunction mmsRefList($templateCache, $http, growl, _ , $q, $uibModal,\n    UtilsService, JobService, ElementService, URLService) {\n\n    var template = $templateCache.get('mms/templates/mmsRefList.html');\n\n    var mmsRefListLink = function (scope, element, attrs) {\n        var ran;\n        scope.showMerge = URLService.getMmsServer().indexOf('opencae.jpl.nasa.gov') == -1;\n        scope.runCleared = true;\n        scope.docEditable = false;\n        scope.currentRefOb = _.find(scope.mmsBranches, { 'id': scope.mmsRefId });\n        if (scope.currentRefOb == undefined){\n            scope.currentRefOb = _.find(scope.mmsTags, { 'id': scope.mmsRefId });\n        }\n\n        // logic for adding a new job\n        var createJob = function() {\n            var deferred = $q.defer();\n            var defaultName = \"DocMerge_on_\" + scope.docName;\n            var jobOb = {\n                \"id\": scope.mmsDocId,\n                \"jobName\" : defaultName,\n                \"jobType\" : \"docmerge\"\n            };\n\n            JobService.createJob(jobOb, scope.mmsProjectId, scope.mmsRefId)\n            .then(function(job) {\n                deferred.resolve(job);\n                growl.success('Creating your job');\n            }, function(error) {\n                growl.error('Your job failed to post: ' + error.data.message);\n            });\n            return deferred.promise;\n        };\n\n        var runJob = function (id, fromRef, comment) {\n            scope.runCleared = false;\n            var postOb = {\n                \"fromRefId\": fromRef,\n                \"comment\": comment\n            };\n            var jobRunOb = {\n                \"id\": id,\n                \"post\": postOb\n            };\n            JobService.runJob(jobRunOb, scope.mmsProjectId, scope.mmsRefId)\n            .then(function(data) {\n                // growl.success('Your job is running!');\n            }, function(error) {\n                growl.error('Your job failed to run: ' + error.data.message);\n            // }).finally(function() {\n            //     scope.runCleared = true;//TODO clear when stomp gets completed message -use jobservice to handle?\n            });\n        };\n\n        scope.createJobandRun = function (refId, comment) {\n            var deferred = $q.defer();\n            // Check if the doc already has a job created\n            JobService.getJobs(scope.mmsDocId, scope.mmsProjectId, scope.mmsRefId)\n            .then(function (jobs) {\n                var jobExists = false;\n                var docmergeJobId;\n                for (var i = 0; i < jobs.length; i++) {\n                    if (jobs[i].associatedElementID === scope.mmsDocId && jobs[i].type === 'docmerge') {\n                        // If yes, assign id to run\n                        docmergeJobId = jobs[i].id;\n                        jobExists = true;\n                        break;\n                    }\n                }\n                if (jobExists) {\n                    runJob(docmergeJobId, refId, comment);\n                } else { // If not, create\n                    createJob().then(function(job) {\n                        runJob(job.id, refId, comment);\n                    });\n                }\n                deferred.resolve('ok');\n            }, function (error) {\n                growl.error('There was a error in retrieving your job: ' + error.status);\n            });\n            return deferred.promise;\n        };\n\n        //Callback function for document change\n        var changeDocument = function (newVal, oldVal) {\n            if (!newVal || (newVal == oldVal && ran))\n                return;\n            ran = true;\n            var reqOb = {elementId: scope.mmsDocId, projectId: scope.mmsProjectId, refId: scope.mmsRefId};\n            ElementService.getElement(reqOb, 2, false)\n            .then(function (document) {\n                if (!UtilsService.isDocument(document)) {\n                    scope.isDoc = false;\n                    return;\n                } else {\n                    scope.isDoc = true;\n                }\n                scope.doc = document;\n                scope.docName = document.name;\n                scope.docEditable = document._editable && scope.mmsRefType != 'Tag';\n            });\n        };\n\n        // watch for the document to change\n        scope.$watch('mmsDocId', changeDocument);\n\n\n        scope.docMergeAction = function (srcRef) {\n            var templateUrlStr = 'mms/templates/mergeConfirm.html';\n            scope.srcRefOb = srcRef;\n\n            var instance = $uibModal.open({\n                templateUrl: templateUrlStr,\n                scope: scope,\n                controller: ['$scope', '$uibModalInstance', '$filter', mergeDocCtrl]\n            });\n            instance.result.then(function(data) {\n                // TODO: do anything here?\n            });\n        };\n\n        var mergeDocCtrl = function($scope, $uibModalInstance, $filter) {\n            $scope.oking = false;\n            $scope.commitMessage = '';\n            $scope.createForm = true;\n\n            $scope.ok = function() {\n                if ($scope.oking) {\n                    growl.info(\"Please wait...\");\n                    return;\n                }\n                $scope.oking = true;\n                $scope.createJobandRun($scope.srcRefOb.id, $scope.commitMessage)\n                .then(function(data) {\n                    growl.success(\"Creating job to merge documents... please see the jobs pane for status updates\");\n                    $uibModalInstance.close(data);\n                }, function(reason) {\n                    growl.error(\"Could not merge document: \" + reason.message);\n                }).finally(function() {\n                    $scope.oking = false;\n                });\n            };\n    \n            $scope.cancel = function() {\n                $uibModalInstance.dismiss();\n            };\n        };\n\n        // actions for stomp\n        scope.$on(\"stomp.updateJob\", function(event, updateJob) {\n            if (updateJob.type === 'docmerge' && updateJob.associatedElementId === scope.mmsDocId && \n                updateJob.refId === scope.mmsRefId && updateJob.jobStatus === 'completed') {\n                    growl.success(scope.docName + ' has been merged');\n                    scope.runCleared = true; // disable apply until stomp gets completed message\n                }\n        });\n\n\n    };\n    return {\n        restrict: 'E',\n        template: template,\n        scope: {\n            mmsProjectId: '@',\n            mmsRefId: '@',\n            mmsRefType: '@',\n            mmsDocId:'@',\n            mmsBranches: '<',\n            mmsTags: '<'\n        },\n        link: mmsRefListLink\n    };\n}\n","'use strict';\n\nangular.module('mms.directives')\n    .directive('mmsSearch', ['$window', '$anchorScroll', 'CacheService', 'ElementService', 'ProjectService', 'UtilsService', 'ViewService', '_', 'growl', '$templateCache', '$timeout', mmsSearch]);\n\n/**\n * @ngdoc directive\n * @name mms.directives.directive:mmsSearch\n *\n * @restrict E\n *\n * @description\n * TBA\n * \n * @scope\n *\n */\nfunction mmsSearch($window, $anchorScroll, CacheService, ElementService, ProjectService, UtilsService, ViewService, _, growl, $templateCache, $timeout) {\n    var template = $templateCache.get('mms/templates/mmsSearch.html');\n    return {\n        restrict: 'E',\n        template: template,\n        link: mmsSearchLink,\n        scope: {\n            mmsOptions: '<',\n            mmsProjectId: '@',\n            mmsRefId: '@'\n        }\n    };\n\n\n    function mmsSearchLink(scope, element, attrs) {\n        // Main search variables\n        var baseSearchResults = [];\n        scope.showFilterOptions = !scope.mmsOptions.hideFilterOptions;\n        scope.searchLoading = false;\n        scope.mainSearch = {\n            searchText: '',\n            searchType: {\n                id: 'all',\n                label: 'All Fields'\n            },\n            selectedSearchMetatypes: []\n        };\n        scope.docsviews = {\n            selected: false\n        };\n        scope.refId = scope.mmsRefId ? scope.mmsRefId : 'master';\n\n        scope.qualifiedNameFormatter = function(qualifiedName) {\n            if (qualifiedName) {\n                var parts = qualifiedName.split('/');\n                var result = qualifiedName;\n                if (parts.length > 7) {\n                    result = parts.slice(0, 4).join('/') + '/.../' + parts.slice(parts.length - 3, parts.length).join('/');\n                }\n                return result;\n            }\n        };\n\n        scope.expandQualifiedName = function($event, qualifiedName) {\n            $event.currentTarget.innerHTML = qualifiedName;\n        };\n\n        scope.showMoreRelatedViews = function(element) {\n            element.remainingRelatedDocuments = element.allRelatedDocuments.slice(3, element.allRelatedDocuments.length);\n        };\n        // Search resulte settings\n        scope.activeFilter = [];\n\n        // Pagination settings\n        scope.totalResults = 0;\n        scope.paginationCache = [];\n        scope.currentPage = 0;\n        scope.itemsPerPage = 100;\n\n        // Advanced search settings\n        scope.advanceSearch = false;\n        scope.advanceSearchRows = [];\n        scope.stringQuery = scope.mainSearch.searchText; \n\n        // View propery settings\n        scope.showSearchResultProps = false;\n        scope.switchText = 'More';\n        scope.limitForProps = 6;\n\n        scope.closeSearch = function () {\n            $window.history.back();\n        };\n\n        // Set functions\n        ProjectService.getProjectMounts(scope.mmsProjectId, scope.refId); //ensure project mounts object is cached\n        // Function used to get string value of metatype names for advanced search\n        var getMetatypeSelection = function (id) {\n            var mainElement = angular.element(id);\n            return mainElement.find('div').attr('value');\n        };\n\n        // Get metatypes for dropdown options\n        var getMetaTypes = function () {\n            scope.metatypeSearch = \"fa fa-spin fa-spinner\";\n            ProjectService.getMetatypes(scope.mmsProjectId, scope.refId)\n                .then(function (data) {\n                    // cache metatypes\n                    scope.metatypeList = data;\n                }, function (reason) {\n                    growl.error(\"Search Error: \" + reason.message);\n                }).finally(function () {\n                    scope.metatypeSearch = \"\";\n                });\n        };\n        getMetaTypes();\n\n        scope.getTypeClass = function (element) {\n            // Get Type\n            return UtilsService.getElementTypeClass(element, ViewService.getElementType(element));\n        };\n\n        // Set search options\n        scope.fieldTypeList = [{\n                id: 'all',\n                label: 'All Fields'\n            },\n            {\n                id: 'name',\n                label: 'Name'\n            },\n            {\n                id: 'documentation',\n                label: 'Documentation'\n            },\n            {\n                id: 'value',\n                label: 'Value'\n            },\n            {\n                id: 'id',\n                label: 'ID'\n            },\n            {\n                id: 'metatype',\n                label: 'Metatype'\n            }\n        ];\n\n        scope.operatorList = ['And', 'Or', 'And Not'];\n\n        // settings for multiselect metatype dropdown\n        scope.metatypeSettings = {\n            scrollableHeight: '300px',\n            scrollable: true,\n            enableSearch: true,\n            displayProp: 'name',\n            showCheckAll: false,\n            smartButtonMaxItems: 10,\n            buttonClasses: ''\n        };\n\n        // event handler for multiselect metatype dropdown\n        scope.multiselectEvent = {\n            onItemSelect: function (ob) {\n                $timeout(function () {\n                    scope.stringQueryUpdate();\n                }, 500);\n            },\n            onItemDeselect: function (ob) {\n                $timeout(function () {\n                    scope.stringQueryUpdate();\n                }, 500);\n            },\n            onDeselectAll: function (ob) {\n                $timeout(function () {\n                    scope.stringQueryUpdate();\n                }, 500);\n            }\n        };\n\n        // Filter options\n        scope.getActiveFilterClass = function (item) {\n            if (!scope.activeFilter.length) {\n                return '';\n            }\n            return _.includes(scope.activeFilter, item);\n        };\n\n        scope.filterSearchResults = function (type) {\n            var tempArr = _.clone(scope.activeFilter);\n            if (_.includes(scope.activeFilter, type) ) {\n                _.pull(scope.activeFilter, type);\n            } else {\n                scope.activeFilter.push(type);\n            }\n            _applyFilters();\n        };\n\n        var _applyFilters = function () {\n            if (!scope.activeFilter.length) {\n                scope.searchResults = baseSearchResults;\n            } else {\n                scope.searchResults = _.filter(baseSearchResults, function (item) {\n                    return _.includes(scope.activeFilter, ViewService.getElementType(item));\n                });\n            }\n        };\n\n        scope.filterOptions = [\n            { display: \"Documents\", icon: null, type: \"Document\" },\n            // { display: \"Sections/Views\", icon: null, type: \"View\", \"Section\" },\n            { display: 'Text', icon:\"pe-type-Paragraph\", type: \"Paragraph\" },\n            { display: 'Tables', icon:\"pe-type-Table\", type: \"Table\" },\n            { display: 'Images', icon:\"pe-type-Image\", type: \"Image\" },\n            { display: 'Equations', icon:\"pe-type-Equation\", type: \"Equation\" },\n            { display: 'Comments', icon:\"pe-type-Comment\", type: \"Comment\" },\n            { display: 'Sections', icon:\"pe-type-Section\", type: \"Section\" },\n            { display: 'Views', icon:\"pe-type-View\", type: \"View\" },\n            { display: 'Requirements', icon:\"pe-type-Req\", type: \"Requirement\" }\n        ];\n\n        // var findRefineOptions = function (results) {\n        //     var presentationElements = _.map(results, ViewService.getElementType);\n        //     var uniqTypes = _.uniq(presentationElements);\n        //     scope.filterOptions = _.difference(uniqTypes, [false, undefined, '']);\n        // };\n\n        scope.$watch('searchResults', function (newVal) {\n            if (!newVal)\n                return;\n            if (!scope.mmsOptions.getProperties) {\n                return;\n            }\n            newVal.forEach(function (elem) {\n                if (elem._properties) {\n                    return;\n                }\n                // mms does not return properties will need to make a call for the results whose type is Class\n                // Call ElementService.getOwnedElements with depth of 2\n                // filter out results that have type = to Property and Slot\n                // for Property check that ownerId is same as the class id\n                if (elem.type === 'Class' || elem.type === 'Component') {\n                    var reqOb = {\n                        elementId: elem.id,\n                        projectId: elem._projectId,\n                        refId: elem._refId,\n                        depth: 2\n                    };\n                    ElementService.getOwnedElements(reqOb, 2)\n                        .then(function (data) {\n                            var properties = [];\n                            //TODO might not be elements\n                            angular.forEach(data, function (elt) {\n                                if (elt.type === 'Property' && elt.ownerId == elem.id) {\n                                    properties.push(elt);\n                                } else if (elt.type === 'Slot') {\n                                    properties.push(elt);\n                                }\n                            });\n                            elem._properties = properties;\n                            // OLD CODE - splits into 3cols\n                            // if (elem._properties && elem._properties[0]) {\n                            //     var properties2 = [];\n                            //     for (var i = 0; i < elem._properties.length; i++) {\n                            //         if (i % 3 === 0) {\n                            //             properties2.push([]);\n                            //         }\n                            //         properties2[properties2.length - 1].push(elem._properties[i]);\n                            //     }\n                            //     elem._properties2 = properties2;\n                            // }\n                        });\n                }\n            });\n        });\n\n\n        /**\n         * @ngdoc function\n         * @name mms.directives.directive:mmsSearch#stringQueryUpdate\n         * @methodOf mms.directives.directive:mmsSearch\n         *\n         * @description\n         * Updates advanced search main query input\n         */\n        scope.stringQueryUpdate = function () {\n            var rowLength = scope.advanceSearchRows.length;\n            scope.stringQuery = Array(rowLength + 1).join('(');\n            scope.stringQuery += scope.mainSearch.searchType.label + ':';\n            if (scope.mainSearch.searchType.id === 'metatype') {\n                scope.stringQuery += getMetatypeSelection('#searchMetatypeSelectAdvance');\n            } else {\n                scope.stringQuery += scope.mainSearch.searchText;\n            }\n            for (var i = 0; i < rowLength; i++) {\n                scope.stringQuery += ' ' + scope.advanceSearchRows[i].operator.toUpperCase() + ' ' + scope.advanceSearchRows[i].searchType.label + ':';\n                if (scope.advanceSearchRows[i].searchType.id === 'metatype') {\n                    scope.stringQuery += getMetatypeSelection('#searchMetatypeSelect-' + i) + ')';\n                } else {\n                    scope.stringQuery += scope.advanceSearchRows[i].searchText + ')';\n                }\n            }\n        };\n\n        /**\n         * @ngdoc function\n         * @name mms.directives.directive:mmsSearch#addAdvanceSearchRow\n         * @methodOf mms.directives.directive:mmsSearch\n         *\n         * @description\n         * Adds new row with empty fields and updates advanced search main query input\n         */\n        scope.addAdvanceSearchRow = function () {\n            scope.advanceSearchRows.push({\n                operator: 'And',\n                searchType: {\n                    id: 'all',\n                    label: 'All Fields'\n                },\n                searchText: '',\n                selectedSearchMetatypes: []\n            });\n            scope.stringQueryUpdate();\n        };\n        scope.addAdvanceSearchRow(); // Second row created by default\n\n        /**\n         * @ngdoc function\n         * @name mms.directives.directive:mmsSearch#removeRowAdvanceSearch\n         * @methodOf mms.directives.directive:mmsSearch\n         *\n         * @description\n         * Removes selected row and updates advanced search main query input\n         *\n         * @param {objecy} row advanced search row\n         */\n        scope.removeRowAdvanceSearch = function (row) {\n            scope.advanceSearchRows = _.without(scope.advanceSearchRows, row);\n            scope.stringQueryUpdate();\n        };\n\n        scope.modifyAdvanceSearch = function () {\n            scope.advanceSearch = !scope.advanceSearch;\n            scope.advancedSearchResults = !scope.advancedSearchResults;\n        };\n\n        scope.nextPage = function () {\n            if (scope.paginationCache[scope.currentPage + 1]) {\n                baseSearchResults = scope.paginationCache[scope.currentPage + 1];\n                scope.currentPage += 1;\n                _applyFilters();\n            } else {\n                scope.search(scope.mainSearch, scope.currentPage + 1, scope.itemsPerPage);\n            }\n            $anchorScroll('ve-search-results');\n\n        };\n\n        scope.prevPage = function () {\n            if (scope.paginationCache[scope.currentPage - 1]) {\n                baseSearchResults = scope.paginationCache[scope.currentPage - 1];\n                scope.currentPage -= 1;\n                _applyFilters();\n            } else {\n                scope.search(scope.mainSearch, scope.currentPage - 1, scope.itemsPerPage);\n            }\n        };\n\n        /**\n         * @ngdoc function\n         * @name mms.directives.directive:mmsSearch#search\n         * @methodOf mms.directives.directive:mmsSearch\n         *\n         * @description\n         * Call ElementService to make search post and get search results. Check for filterCallback\n         * to further filter search results. Reassign pagination variables.\n         *\n         * @param {object} query search type and keyword from user input\n         * @param {number} page page number of search results\n         * @param {number} numItems number of items to return per page\n         */\n        scope.search = function (query, page, numItems) {\n            scope.searchLoading = true;\n            var queryOb = buildQuery(query);\n            queryOb.from = page * numItems + page;\n            queryOb.size = numItems;\n            var reqOb = {\n                projectId: scope.mmsProjectId,\n                refId: scope.refId,\n                checkType: true\n            };\n            ElementService.search(reqOb, queryOb, 2)\n                .then(function (data) {\n                    var elements = data.elements;\n                    if (scope.mmsOptions.filterCallback) {\n                        scope.searchResults = scope.mmsOptions.filterCallback(elements);\n                        baseSearchResults = scope.searchResults;\n                    } else {\n                        scope.searchResults = elements;\n                        baseSearchResults = elements;\n                    }\n                    combineRelatedViews(scope);\n                    scope.totalResults = data.total;\n                    scope.maxPages = Math.ceil(scope.totalResults/scope.itemsPerPage);\n                    scope.currentPage = page;\n                    scope.paginationCache.push(scope.searchResults);\n                    if (scope.advanceSearch) {\n                        // scope.advanceSearch = !scope.advanceSearch;\n                        scope.advancedSearchResults = true;\n                    }\n                    _applyFilters();\n                    // scope.refineOptions = findRefineOptions(baseSearchResults);\n                }, function (reason) {\n                    growl.error(\"Search Error: \" + reason.message);\n                }).finally(function () {\n                    scope.searchLoading = false;\n                });\n        };\n\n        scope.newSearch = function (query) {\n            scope.paginationCache = [];\n            scope.search(query, 0, scope.itemsPerPage);\n        };\n\n        /**\n         * @ngdoc function\n         * @name mms.directives.directive:mmsSearch#getProjectMountsQuery\n         * @methodOf mms.directives.directive:mmsSearch\n         *\n         * @description\n         * Create a JSON object that returns a term key with a list of all mounted\n         * project ids within the current project.\n         * \n         * Elastic format\n         *\n         * @return {object} Elastic query JSON object with list of project mounts\n         */\n        var getProjectMountsQuery = function () {\n            var projList = [];\n            var projectTermsOb = {};\n\n            var mountCacheKey = ['project-mounts', scope.mmsProjectId, scope.refId];\n            if (CacheService.exists(mountCacheKey)) {\n                projList = CacheService.get(mountCacheKey);\n            } else {\n                // Get project element data to gather mounted project list\n                var cacheKey = ['project', scope.mmsProjectId, scope.refId];\n                var cachedProj = CacheService.get(cacheKey);\n                if (cachedProj) {\n                    getAllMountsAsArray(cachedProj, projList);\n                } else {\n                    var project = {\n                        'id': scope.mmsProjectId,\n                        '_refId': scope.refId\n                    };\n                    getAllMountsAsArray(project, projList);\n                }\n                CacheService.put(mountCacheKey, projList, false);\n            }\n\n            // Create Elastic filter\n            var q = {};\n            q._projectId = projList;\n            projectTermsOb.bool = {\n                should: projList\n            };\n            return projectTermsOb;\n        };\n\n        /**\n         * @ngdoc function\n         * @name mms.directives.directive:mmsSearch#getAllMountsAsArray\n         * @methodOf mms.directives.directive:mmsSearch\n         *\n         * @description\n         * Use projectsList to populate list with all the mounted project ids for\n         * specified project.\n         *\n         */\n        var getAllMountsAsArray = function (project, projectsList) {\n            projectsList.push({\n                bool: {\n                    must: [{\n                        term: {\n                            _projectId: project.id\n                        }\n                    }, {\n                        term: {\n                            _inRefIds: project._refId\n                        }\n                    }]\n                }\n            });\n            var mounts = project._mounts;\n            if (angular.isArray(mounts) && mounts.length !== 0) {\n                for (var i = 0; i < mounts.length; i++) {\n                    if (mounts[i]._mounts) {\n                        getAllMountsAsArray(mounts[i], projectsList);\n                    }\n                }\n            }\n            return;\n        };\n\n        var buildSearchClause = function (query) {\n            var clause = {};\n            var q = {};\n            var valueSearchFields = [\"defaultValue.value^3\", \"value.value^3\", \"specification.value^3\"];\n            if (query.searchType.id === 'all') {\n                // Set query term for ID\n                var idQuery = {};\n                idQuery.term = {\n                    \"id\": {\n                        \"value\": query.searchText,\n                        \"boost\": 10.0\n                    }\n                };\n\n                // Set query for value,doc,name fields\n                var allQuery = {};\n                q.query = query.searchText;\n                q.fields = valueSearchFields.slice();\n                q.fields.push('name^5', 'documentation');\n                q.fuzziness = 'AUTO';\n                allQuery.multi_match = q;\n                clause = {\n                    \"bool\": {\n                        \"should\": [\n                            idQuery,\n                            allQuery\n                        ]\n                    }\n                };\n            } else if (query.searchType.id === 'name' || query.searchType.id === 'documentation') {\n                // \"{\"query\":{\"bool\":{\"must\":[{\"match\":{\"name\":\"val\"}}]}}}\"\n                // \"{\"query\":{\"bool\":{\"must\":[{\"match\":{\"documentation\":\"val\"}}]}}}\"\n                var type = query.searchType.id;\n                q[type] = {\n                    query: query.searchText,\n                    fuzziness: 'AUTO'\n                };\n                clause.match = q;\n            } else if (query.searchType.id === 'id') {\n                // \"{\"query\":{\"bool\":{\"must\":[{\"term\":{\"id\":\"val\"}}]}}}\"\n                clause.term = {\n                    \"id\": query.searchText\n                };\n            } else if (query.searchType.id === 'value') {\n                // \"{\"query\":{\"bool\":{\"must\":[{\"multi_match\":{\"query\":\"val\",\"fields\":[\"defaultValue.value\",\"value.value\",\"specification.value\"]}}]}}}\"\n                q.query = query.searchText;\n                q.fields = valueSearchFields;\n                q.fuzziness = 'AUTO';\n                clause.multi_match = q;\n            } else if (query.searchType.id === 'metatype') {\n                var metatypeFilterList = _.pluck(query.selectedSearchMetatypes, 'id');\n\n                // Get all _appliedStereotypeIds, which have `_`\n                var appliedStereotypeFilter = [],\n                    typeFilter = [];\n                for (var i = 0; i < metatypeFilterList.length; i++) {\n                    //if underscore = appliedsterortype otherwise 'type'\n                    if (metatypeFilterList[i].includes('_')) {\n                        console.log(metatypeFilterList[i]);\n                        appliedStereotypeFilter.push(metatypeFilterList[i]);\n                    } else {\n                        typeFilter.push(metatypeFilterList[i]);\n                    }\n                }\n                // metatype clause\n                clause = {\n                    \"bool\": {\n                        \"should\": [{\n                                \"terms\": {\n                                    \"_appliedStereotypeIds\": appliedStereotypeFilter\n                                }\n                            },\n                            {\n                                \"terms\": {\n                                    \"type\": typeFilter\n                                }\n                            }\n                        ],\n                        \"minimum_should_match\": 1\n                    }\n                };\n            }\n            return clause;\n        };\n\n        /**\n         * @ngdoc function\n         * @name mms.directives.directive:mmsSearch#buildQuery\n         * @methodOf mms.directives.directive:mmsSearch\n         *\n         * @description\n         * Build JSON object for Elastic query.\n         *\n         *\n         * @return {object} {{query: {bool: {must: *[]}}}} JSON object from post data.\n         */\n        var buildQuery = function (query) {\n            // Set project and mounted projects filter\n            var projectTermsOb = getProjectMountsQuery();\n            var filterList = [projectTermsOb];\n\n            // Set custom filter options for query\n            if (scope.mmsOptions.filterQueryList) {\n                angular.forEach(scope.mmsOptions.filterQueryList, function (filterOb) {\n                    filterList.push(filterOb());\n                });\n            }\n\n            // Set filter for all views and docs, if selected\n            if (scope.docsviews.selected) {\n                var viewsAndDocs = {\n                    terms: {\n                        '_appliedStereotypeIds': [UtilsService.VIEW_SID, UtilsService.DOCUMENT_SID].concat(UtilsService.OTHER_VIEW_SID)\n                    }\n                };\n                filterList.push(viewsAndDocs);\n            }\n            filterList.push({\n                \"type\": {\n                    \"value\": \"element\"\n                }\n            });\n\n            // Set main query\n            var mainBoolQuery = {};\n            var jsonQueryOb = {};\n            var rowLength = scope.advanceSearchRows.length;\n            if (!scope.advanceSearch || rowLength === 0) {\n                mainBoolQuery = buildSearchClause(query);\n                mainBoolQuery = {\n                    \"bool\": {\n                        \"must\": mainBoolQuery,\n                    }\n                };\n            } else {\n                var clause2, clause1 = buildSearchClause(scope.mainSearch);\n                for (var i = 0; i < rowLength; i++) {\n                    // if must, must_not or should\n                    var row = scope.advanceSearchRows[i];\n                    var operator = row.operator;\n                    clause2 = buildSearchClause(row);\n                    if (operator === \"And\") {\n                        clause1 = {\n                            \"bool\": {\n                                \"must\": [clause1, clause2]\n                            }\n                        };\n                    } else if (operator === \"Or\") {\n                        clause1 = {\n                            \"bool\": {\n                                \"should\": [clause1, clause2],\n                                \"minimum_should_match\": 1\n                            }\n                        };\n                    } else if (operator === \"And Not\") {\n                        clause1 = {\n                            \"bool\": {\n                                \"must\": [clause1, {\n                                    \"bool\": {\n                                        \"must_not\": clause2\n                                    }\n                                }]\n                            }\n                        };\n                    }\n                }\n                mainBoolQuery = clause1;\n            }\n\n            jsonQueryOb = {\n                \"sort\": [\n                    \"_score\",\n                    {\n                        \"_modified\": {\n                            \"order\": \"desc\"\n                        }\n                    }\n                ],\n                \"query\": {},\n                \"indices_boost\" : [ {} ]\n            };\n            jsonQueryOb.query = mainBoolQuery;\n            jsonQueryOb.query.bool.filter = filterList;\n            jsonQueryOb.indices_boost[0][scope.mmsProjectId.toLowerCase()] = 2;\n            jsonQueryOb.aggs = getAggs();\n            return jsonQueryOb;\n        };\n\n        var getAggs = function () {\n            return {\n                \"elements\": {\n                    \"filter\": {\n                        \"bool\": {\n                            \"must\": [{\n                                    \"term\": {\n                                        \"_projectId\": 'PROJECT-5d574aa8-bc06-4e95-bf71-3f2151833e09'\n                                    }\n                                },\n                                {\n                                    \"term\": {\n                                        \"_inRefIds\": 'master'\n                                    }\n                                }\n                            ]\n                        }\n                    },\n                    \"aggs\": {\n                        \"types\": {\n                            \"terms\": {\n                                \"field\": \"type\",\n                                \"size\": 20\n                            }\n                        }\n                    }\n                }\n            };\n        };\n\n        var combineRelatedViews = function(scope) {\n            scope.searchResults.forEach(function(element) {\n                var allRelatedDocuments = [];\n                if (element._relatedDocuments) {\n                    element._relatedDocuments.forEach(function(relatedDoc) {\n                        relatedDoc._parentViews.forEach(function(parentView) {\n                            allRelatedDocuments.push({\n                                relatedDocument: relatedDoc,\n                                relatedView: parentView\n                            });\n                        });\n                    });\n                }\n                element.allRelatedDocuments = allRelatedDocuments;\n                element.someRelatedDocuments = allRelatedDocuments.slice(0, 3);\n            });\n        };\n\n        // Set options\n        if (scope.mmsOptions.searchResult) {\n            var data1 = scope.mmsOptions.searchResult;\n            scope.searchResults = data1;\n            scope.paginationCache.push(data1);\n        }\n        if (scope.mmsOptions.searchInput) {\n            scope.mainSearch.searchText = scope.mmsOptions.searchInput;\n            scope.newSearch(scope.mainSearch);\n        }\n        if (scope.mmsOptions.itemsPerPage) {\n            scope.itemsPerPage = scope.mmsOptions.itemsPerPage;\n        }\n        scope.emptyDocTxt = scope.mmsOptions.emptyDocTxt;\n        scope.userResultClick = function (elem, property) {\n            if (scope.mmsOptions.callback) {\n                scope.mmsOptions.callback(elem, property);\n            }\n        };\n        scope.userRelatedClick = function (event, doc, view, elem) {\n            event.preventDefault();\n            event.stopPropagation();\n            if (scope.mmsOptions.relatedCallback)\n                scope.mmsOptions.relatedCallback(doc, view, elem);\n        };\n    }\n\n}\n","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsSpec', ['Utils', 'AuthService', 'ElementService', 'UtilsService', 'ViewService', '$templateCache', 'growl', '_', mmsSpec]);\n\n/**\n * @ngdoc directive\n * @name mms.directives.directive:mmsSpec\n *\n * @requires mms.Utils\n * @requires mms.AuthService\n * @requires mms.ElementService\n * @requires mms.ViewService\n * @requires $compile\n * @requires $templateCache\n * @requires growl\n * @requires _\n *\n * @restrict E\n *\n * @description\n * Outputs a \"spec window\" of the element whose id is specified. Spec includes name,\n * documentation, and value if the element is a property. Also last modified time,\n * last user, element id. Editability is determined by a param and also element\n * editability. Documentation and string values can have html and can transclude other\n * element properties. Conflict can occur during save based on last server read time\n * and offers choice of force save, discard edit or simple merge. To control saving\n * or editing pass in an api object that will be populated with methods (see methods seciton):\n *\n * ## Example spec with full edit (given permission)\n * ### controller (js)\n *  <pre>\n    angular.module('app', ['mms.directives'])\n    .controller('SpecCtrl', ['$scope', function($scope) {\n        $scope.api = {}; //empty object to be populated by the spec api\n        $scope.edit = function() {\n            $scope.api.setEditing(true);\n        };\n        $scope.save = function() {\n            $scope.api.save()\n            .then(function(e) {\n                //success\n            }, function(reason) {\n                //failed\n            });\n        };\n    }]);\n    </pre>\n * ### template (html)\n *  <pre>\n    <div ng-controller=\"SpecCtrl\">\n        <button ng-click=\"edit()\">Edit</button>\n        <button ng-click=\"save()\">Save</button>\n        <mms-spec mms-eid=\"element_id\" mms-edit-field=\"all\" mms-spec-api=\"api\"></mms-spec>\n    </div>\n    </pre>\n * ## Example for showing an element spec at a certain time\n *  <pre>\n    <mms-spec mms-eid=\"element_id\" mms-version=\"2014-07-01T08:57:36.915-0700\"></mms-spec>\n    </pre>\n * ## Example for showing a current element with nothing editable\n *  <pre>\n    <mms-spec mms-eid=\"element_id\" mms-edit-field=\"none\"></mms-spec>\n    </pre>\n *\n * @param {string} mmsElementId The id of the view\n * @param {string} mmsProjectId The project id for the view\n * @param {string=master} mmsRefId Reference to use, defaults to master\n * @param {string=latest} mmsCommitId Commit ID, default is latest\n * @param {Object=} mmsSpecApi An empty object that'll be populated with api methods\n * @param {Object=} mmsElement An element object, if this is provided, a read only\n *      element spec for it would be shown, this will not use mms services to get the element\n */\nfunction mmsSpec(Utils, AuthService, ElementService, UtilsService, ViewService, $templateCache, growl, _) {\n    var template = $templateCache.get('mms/templates/mmsSpec.html');\n\n    var mmsSpecLink = function(scope, domElement, attrs) {\n        var ran = false;\n        var lastid = null; //race condition check\n        var keepMode = false;\n        scope.editing = false;\n        scope.editable = true;\n        scope.gettingSpec = false;\n        scope.isEnumeration = false;\n        //TODO pass proper args\n        scope.propertyTypeClicked = function(id) {\n            var elmentOb = {id: id, _projectId: scope.mmsProjectId, _refId: scope.mmsRefId};\n            scope.$emit('elementSelected', elmentOb);\n        };\n        if (scope.mmsElement) {\n            scope.element = scope.mmsElement;\n            Utils.setupValCf(scope);\n            scope.editable = false;\n            return;\n        }\n        scope.addHtml = function(value) {\n            value.value = \"<p>\" + value.value + \"</p>\";\n        };\n        scope.editorApi = {};\n\n        var getTypeClass = function(element) {\n            // Get Type\n            scope.elementTypeClass = UtilsService.getElementTypeClass(element, ViewService.getElementType(element));\n        };\n\n        /**\n         * @ngdoc function\n         * @name mms.directives.directive:mmsSpec#changeElement\n         * @methodOf mms.directives.directive:mmsSpec\n         *\n         * @description\n         * change element in the spec, this would reevaluate whether it's editable\n         *\n         * @param {string} newVal new element id\n         */\n        var changeElement = function(newVal, oldVal) {\n            if (!newVal || (newVal === oldVal && ran) || !scope.mmsProjectId) {\n                return;\n            }\n            scope.relatedDocuments = null;\n            ran = true;\n            lastid = newVal;\n            if (scope.edit && scope.editorApi.save) {\n                scope.editorApi.save();\n            }\n            scope.isEnumeration = false;\n            scope.isSlot = false;\n            scope.gettingSpec = true;\n            var extended = true;\n            if (scope.mmsCommitId && scope.mmsCommitId !== 'latest') {\n                extended = false;\n            }\n            var reqOb = {elementId: scope.mmsElementId, projectId: scope.mmsProjectId, refId: scope.mmsRefId, commitId: scope.mmsCommitId, extended: extended};\n            ElementService.getElement(reqOb, 2, false)\n            .then(function(data) {\n                if (newVal !== lastid) {\n                    return;\n                }\n                scope.element = data;\n                Utils.setupValCf(scope);\n                if (!scope.mmsCommitId || scope.mmsCommitId === 'latest') {\n                    ElementService.search(reqOb, {\n                        size: 1,\n                        sort : [{ _modified : {order : \"desc\"}}],\n                        query: {bool: {filter: [{term: {id: data.id}}, {term: {'_projectId': data._projectId}}]}}\n                    }, 2).then(function(searchResultOb) {\n                        if (newVal !== lastid) {\n                            return;\n                        }\n                        var searchResult = searchResultOb.elements;\n                        if (searchResult && searchResult.length == 1 && searchResult[0].id === data.id && searchResult[0]._relatedDocuments.length > 0) {\n                            scope.relatedDocuments = searchResult[0]._relatedDocuments;\n                        }\n                    });\n                }\n                if (!scope.element._editable ||\n                        (scope.mmsCommitId !== 'latest' && scope.mmsCommitId)) {\n                    scope.editable = false;\n                    scope.edit = null;\n                    scope.editing = false;\n                } else {\n                    ElementService.getElementForEdit(reqOb)\n                    .then(function(data) {\n                        if (newVal !== lastid)\n                            return;\n                        scope.edit = data;\n                        scope.editable = true;\n                        if (!keepMode)\n                            scope.editing = false;\n                        keepMode = false;\n                        if (scope.edit.type === 'Property' || scope.edit.type === 'Port' || scope.edit.type === 'Slot') {// angular.isArray(scope.edit.value)) {\n                            if (scope.edit.defaultValue)\n                                scope.editValues = [scope.edit.defaultValue];\n                            else if (scope.edit.value)\n                                scope.editValues = scope.edit.value;\n                            else\n                                scope.editValues = [];\n                                Utils.getPropertySpec(scope.element)\n                                .then( function(value) {\n                                    scope.isEnumeration = value.isEnumeration;\n                                    scope.isSlot = value.isSlot;\n                                    scope.options = value.options;\n                                }, function(reason) {\n                                    growl.error('Failed to get property spec: ' + reason.message);\n                                });\n                        }\n                        if (scope.edit.type === 'Constraint' && scope.edit.specification) {\n                            scope.editValues = [scope.edit.specification];\n                        }\n                    });\n                }\n                getTypeClass(scope.element);\n                scope.elementDataLink = '/alfresco/service/projects/'+scope.element._projectId+'/refs/'+scope.element._refId+'/elements/'+scope.element.id+'?commitId='+scope.element._commitId+'&alf_ticket='+AuthService.getTicket();\n                scope.gettingSpec = false;\n            }, function(reason) {\n                scope.gettingSpec = false;\n                //growl.error(\"Getting Element Error: \" + reason.message);\n            });\n        };\n        scope.changeElement = changeElement;\n        scope.$watch('mmsElementId', changeElement);\n        scope.$watch('mmsProjectId', changeElement);\n        scope.$watch('mmsCommitId', changeElement);\n        scope.$watch('mmsRefId', changeElement);\n\n        scope.copyToClipboard = function($event, selector) {\n            UtilsService.copyToClipboard(domElement.find(selector), $event);\n        };\n\n        scope.cleanupVal = function(obj) {\n            obj.value = parseInt(obj.value);\n        };\n\n        /**\n         * @ngdoc function\n         * @name mms.directives.directive:mmsSpec#revertEdits\n         * @methodOf mms.directives.directive:mmsSpec\n         *\n         * @description\n         * reset editing object back to base element values for name, doc, values\n         *\n         */\n        scope.revertEdits = function() {\n            Utils.revertEdits(scope, scope.edit, scope.editorApi);\n        };\n\n        /**\n         * @ngdoc function\n         * @name mms.directives.directive:mmsSpec#save\n         * @methodOf mms.directives.directive:mmsSpec\n         *\n         * @description\n         * save edited element\n         *\n         * @return {Promise} promise would be resolved with updated element if save is successful.\n         *      For unsuccessful saves, it will be rejected with an object with type and message.\n         *      Type can be error or info. In case of conflict, there is an option to discard, merge,\n         *      or force save. If the user decides to discord or merge, type will be info even though\n         *      the original save failed. Error means an actual error occured.\n         */\n        scope.save = function() {\n            return Utils.save(scope.edit, scope.editorApi, scope, false);\n        };\n\n        scope.hasHtml = function(s) {\n            return Utils.hasHtml(s);\n        };\n\n        /**\n         * @ngdoc function\n         * @name mms.directives.directive:mmsSpec#hasEdits\n         * @methodOf mms.directives.directive:mmsSpec\n         *\n         * @description\n         * whether editing object has changes compared to base element,\n         * currently compares name, doc, property values, if element is not\n         * editable, returns false\n         *\n         * @return {boolean} has changes or not\n         */\n        scope.hasEdits = function() {\n            return Utils.hasEdits(scope.edit);\n        };\n\n        Utils.setupValEditFunctions(scope);\n        \n        if (angular.isObject(scope.mmsSpecApi)) {\n            var api = scope.mmsSpecApi;\n            /**\n             * @ngdoc function\n             * @name mms.directives.directive:mmsSpec#toggleEditing\n             * @methodOf mms.directives.directive:mmsSpec\n             *\n             * @description\n             * toggles editing\n             *\n             * @return {boolean} toggle successful\n             */\n            api.toggleEditing = function() {\n                if (!scope.editing) {\n                    if (scope.editable)\n                        scope.editing = true;\n                    else\n                        return false;\n                } else {\n                    scope.editing = false;\n                }\n                return true;\n            };\n            /**\n             * @ngdoc function\n             * @name mms.directives.directive:mmsSpec#setEditing\n             * @methodOf mms.directives.directive:mmsSpec\n             *\n             * @description\n             * sets editing state\n             *\n             * @param {boolean} mode true or false\n             * @return {boolean} set successful\n             */\n            api.setEditing = function(mode) {\n                if (mode) {\n                    if (scope.editable)\n                        scope.editing = true;\n                    else\n                        return false;\n                } else\n                    scope.editing = false;\n                return true;\n            };\n            /**\n             * @ngdoc function\n             * @name mms.directives.directive:mmsSpec#getEditing\n             * @methodOf mms.directives.directive:mmsSpec\n             *\n             * @description\n             * get editing state\n             *\n             * @return {boolean} editing or not\n             */\n            api.getEditing = function() {\n                return scope.editing;\n            };\n            api.save = scope.save;\n            api.revertEdits = scope.revertEdits;\n            api.changeElement = scope.changeElement;\n            api.hasEdits = scope.hasEdits;\n            /**\n             * @ngdoc function\n             * @name mms.directives.directive:mmsSpec#getEdits\n             * @methodOf mms.directives.directive:mmsSpec\n             *\n             * @description\n             * get current edit object\n             *\n             * @return {Object} may be null or undefined, if not, is\n             *  current element object that can be edited (may include changes)\n             */\n            api.getEdits = function() {\n                return scope.edit;\n            };\n\n            api.setEdit = function(id) {\n                scope.mmsElementId = id;\n            };\n\n            api.keepMode = function() {\n                keepMode = true;\n            };\n\n            api.editorSave = function() {\n                if (scope.edit && scope.editorApi.save)\n                    scope.editorApi.save();\n            };\n        }\n    };\n\n    return {\n        restrict: 'E',\n        template: template,\n        scope: {\n            mmsElementId: '@',\n            mmsProjectId: '@',\n            mmsRefId: '@',\n            mmsCommitId: '@',\n            mmsElement: '<?',\n            mmsSpecApi: '<?',\n            noEdit: '@',\n            mmsDisplayOldContent: '<?'\n        },\n        link: mmsSpecLink\n    };\n}\n","'use strict';\n\nangular.module('mms.directives').directive('mmsToolbar', ['$templateCache', '$rootScope', mmsToolbar]);\n\nfunction mmsToolbar($templateCache, $rootScope)\n{\n\tvar template = $templateCache.get('mms/templates/mmsToolbar.html');\n\n\tvar mmsToolbarCtrl = function($scope)\n\t\t{\n\n\t\t\tif ($scope.mmsTbApi)\n\t\t\t{\n\t\t\t\tvar api = $scope.mmsTbApi;\n\n\t\t\t\tapi.select = function(id)\n\t\t\t\t{\n\t\t\t\t\t$scope.buttons.forEach(function(button)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (button.id === id && button.active)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t// button.selected = true;\n\t\t\t\t\t\t\t// $scope.clicked(button);\n\t\t\t\t\t\t\tif (!button.dynamic)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$scope.buttons.forEach(function(b)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tif (b === button)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tb.selected = true;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse b.selected = false;\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t// de-activate all dynamic buttons\n\t\t\t\t\t\t\t\t$scope.buttons.forEach(function(b)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tif (b.dynamic)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tb.active = false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\tif (button.dynamic_buttons)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tbutton.dynamic_buttons.forEach(function(b)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tb.active = true;\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//else\n\t\t\t\t\t\t// button.selected = false;\n\t\t\t\t\t});\n\t\t\t\t};\n\n\t\t\t\tapi.deactivate = function(id)\n\t\t\t\t{\n\t\t\t\t\t$scope.buttons.forEach(function(button)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (button.id === id)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (button.dynamic_buttons)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t// de-activate all dynamic buttons\n\t\t\t\t\t\t\t\tbutton.dynamic_buttons.forEach(function(b)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tb.active = false;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t};\n\n\t\t\t\tapi.setPermission = function(id, permission)\n\t\t\t\t{\n\t\t\t\t\t$scope.buttons.forEach(function(button)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (button.id === id) {\n\t\t\t\t\t\t\tbutton.permission = permission;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t};\n\n\t\t\t\tapi.setSelected = function(id, selected)\n\t\t\t\t{\n\t\t\t\t\t$scope.buttons.forEach(function(button)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (button.id === id) {\n\t\t\t\t\t\t\tbutton.selected = selected;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t};\n\n\t\t\t\tapi.setIcon = function(id, icon)\n\t\t\t\t{\n\t\t\t\t\t$scope.buttons.forEach(function(button)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (button.id === id) {\n\t\t\t\t\t\t\tbutton.icon = icon;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t};\n\n\t\t\t\tapi.addButton = function(button)\n\t\t\t\t{\n\t\t\t\t\tbutton.priority = $scope.buttons.length;\n\t\t\t\t\t$scope.buttons.push(button);\n\t\t\t\t\tif (button.dynamic_buttons)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar firstButton = true;\n\t\t\t\t\t\tbutton.dynamic_buttons.forEach(function(button)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (firstButton)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tbutton.pullDown = true;\n\t\t\t\t\t\t\t\tfirstButton = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbutton.priority = $scope.buttons.length + 1000;\n\t\t\t\t\t\t\t$scope.buttons.push(button);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tapi.toggleButtonSpinner = function(id)\n\t\t\t\t{\n\t\t\t\t\t$scope.buttons.forEach(function(button)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (button.id === id)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (button.spinner)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tbutton.icon = button.icon_original;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tbutton.icon_original = button.icon;\n\t\t\t\t\t\t\t\tbutton.icon = 'fa fa-spinner fa-spin';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbutton.spinner = !button.spinner;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t};\n\n\t\t\t\tapi.setOptions = function(id, options)\n\t\t\t\t{\n\t\t\t\t\t$scope.buttons.forEach(function(button)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (button.id === id)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (options.active !== null) button.active = options.active;\n\t\t\t\t\t\t\tif (options.icon !== null) button.icon = options.icon;\n\t\t\t\t\t\t\tif (options.id !== null) button.id = options.id;\n\t\t\t\t\t\t\tif (options.permission !== null) button.permission = options.permission;\n\t\t\t\t\t\t\tif (options.priority !== null) button.priority = options.priority;\n\t\t\t\t\t\t\tif (options.selected !== null) button.selected = options.selected;\n\t\t\t\t\t\t\tif (options.spinner !== null) button.spinner = options.spinner;\n\t\t\t\t\t\t\tif (options.tooltip !== null) button.tooltip = options.tooltip;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t};\n\n\t\t\t\tif (api.init)\n\t\t\t\t{\n\t\t\t\t\tapi.init();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\tvar mmsToolbarLink = function(scope, element, attrs)\n\t\t{\n\n\t\t\tscope.clicked = function(button)\n\t\t\t{\n\n\t\t\t\tif (!button.permission) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!button.active) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar toggleDecativeFlag = false;\n\t\t\t\tif (this.$root.ve_togglePane && $rootScope.mms_pane_toggleable !== false)\n\t\t\t\t{\n\t\t\t\t\tif (button.selected || this.$root.ve_togglePane.closed)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (button.selected && !this.$root.ve_togglePane.closed) toggleDecativeFlag = true;\n\t\t\t\t\t\tthis.$root.ve_togglePane.toggle();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (this.$root.ve_tbApi) this.$root.ve_tbApi.select(button.id);\n\n\t\t\t\tif (button.onClick) {\n\t\t\t\t\tbutton.onClick();\n\t\t\t\t} else if (scope.onClick) {\n\t\t\t\t\tscope.onClick({ button: button });\n\t\t\t\t}\n\n\t\t\t\tif (toggleDecativeFlag) {\n\t\t\t\t\tthis.$root.ve_tbApi.deactivate(button.id);\n\t\t\t\t}\n\n/*if (! button.dynamic)\n            {\n                scope.buttons.forEach(function(b) {\n                    if (b === button) {\n                        b.selected = true;\n                    } else\n                        b.selected = false;\n                });\n\n                // de-activate all dynamic buttons\n                scope.buttons.forEach(function(b) {\n                    if (b.dynamic) {\n                        b.active = false;\n                    }\n                });\n\n                if (button.dynamic_buttons) {\n                    button.dynamic_buttons.forEach(function(b) {\n                        b.active = true;\n                    });\n                }\n            }*/\n\n\t\t\t};\n\t\t};\n\n\n\n\treturn {\n\t\trestrict: 'E',\n\t\ttemplate: template,\n\t\tcontroller: ['$scope', mmsToolbarCtrl],\n\t\tlink: mmsToolbarLink,\n\t\tscope: {\n\t\t\tbuttons: '<',\n\t\t\tmmsTbApi: '<',\n\t\t\tonClick: '&',\n\t\t\tdirection: '@'\n\t\t}\n\t};\n}","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsTranscludeArt', ['ArtifactService','AuthService','URLService', mmsTranscludeArt]);\n\n/**\n * @ngdoc directive\n * @name mms.directives.directive:mmsTranscludeArt\n *\n * @requires mms.ArtifactService\n * @requires mms.AuthService\n * @requires mms.ElementService\n * @requires mms.URLService\n * @requires growl\n *\n * @restrict E\n *\n * @description\n * Given an artifact id, puts in an img or link to artifact. \n *\n * @param {string} mmsElementId The id of the artifact\n * @param {string} mmsProjectId The project id \n * @param {string=master} mmsRefId Reference to use, defaults to master\n * @param {string=latest} mmsCommitId Commit ID, default is latest\n */\nfunction mmsTranscludeArt(ArtifactService, AuthService, URLService) {\n\n    var mmsTranscludeArtLink = function(scope, element, attrs, controllers) {\n        // var mmsViewCtrl = controllers[0];\n        var processed = false;\n\n        scope.$watch('mmsElementId', function(newVal, oldVal) {\n            if (!newVal || (newVal === oldVal && processed) || !scope.mmsProjectId) {\n                return;\n            }\n            processed = true;\n            scope.projectId = scope.mmsProjectId;\n            scope.refId = scope.mmsRefId ? scope.mmsRefId : 'master';\n            scope.commitId = scope.mmsCommitId ? scope.mmsCommitId : 'latest';\n            var reqOb = {artifactId: scope.mmsElementId, projectId: scope.projectId, refId: scope.refId, commitId: scope.commitId};\n\n            var server = URLService.getMmsServer();\n            var ticket = '?alf_ticket=' + AuthService.getTicket();\n            element.addClass('isLoading');\n            \n            // Get the artifacts of the element\n            ArtifactService.getArtifact(reqOb)\n            .then(function(artifact) {\n                scope.artifact = artifact;\n                scope.url = server + '/alfresco' + artifact.artifactLocation + ticket;\n                if (artifact.contentType.indexOf('image') > -1) {\n                    scope.image = true;\n                }\n            }, function(reason) {\n                console.log('Error getting artifact ' + scope.mmsElementId);\n            }).finally(function() {\n                element.removeClass('isLoading');\n            });\n        });\n    };\n\n    return {\n        restrict: 'E',\n        template: '<img ng-if=\"image\" ng-src=\"{{url}}\"></img><a ng-if=\"!image\" ng-href=\"{{url}}\">{{artifact.name}}</a>',\n        scope: {\n            mmsElementId: '@',\n            mmsProjectId: '@',\n            mmsRefId: '@',\n            mmsCommitId: '@',\n            mmsCfLabel: '@'\n        },\n        require: ['?^^mmsView'],\n        link: mmsTranscludeArtLink\n    };\n}","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsTranscludeCom', ['Utils', 'ElementService', 'UtilsService', 'ViewService', 'UxService', '$templateCache', '$compile', 'growl', 'MathJax', mmsTranscludeCom]);\n\n/**\n * @ngdoc directive\n * @name mms.directives.directive:mmsTranscludeCom\n *\n * @requires mms.ElementService\n * @requires mms.UtilsService\n * @requires mms.ViewService\n * @requires mms.UxService\n * @requires mms.Utils\n * @requires $compile\n * @requires $templateCache\n * @requires growl\n * @requires MathJax\n *\n * @restrict E\n *\n * @description\n * Given an element id, puts in the element's documentation binding, if there's a parent \n * mmsView directive, will notify parent view of transclusion on init and doc change,\n * and on click. Nested transclusions inside the documentation will also be registered.\n * (This is different from mmsTranscludeDoc because of special styles applied to comments)\n *\n * @param {string} mmsElementId The id of the view\n * @param {string} mmsProjectId The project id for the view\n * @param {string=master} mmsRefId Reference to use, defaults to master\n * @param {string=latest} mmsCommitId Commit ID, default is latest\n */\nfunction mmsTranscludeCom(Utils, ElementService, UtilsService, ViewService, UxService, $templateCache, $compile, growl, MathJax) {\n\n    var template = $templateCache.get('mms/templates/mmsTranscludeDoc.html');\n    \n    var mmsTranscludeComCtrl = function ($scope) {\n\n        $scope.bbApi = {};\n        $scope.buttons = [];\n        $scope.buttonsInit = false;\n\n        $scope.bbApi.init = function() {\n            if (!$scope.buttonsInit) {\n                $scope.buttonsInit = true;\n                $scope.bbApi.addButton(UxService.getButtonBarButton(\"presentation-element-preview\", $scope));\n                $scope.bbApi.addButton(UxService.getButtonBarButton(\"presentation-element-save\", $scope));\n                $scope.bbApi.addButton(UxService.getButtonBarButton(\"presentation-element-saveC\", $scope));\n                $scope.bbApi.addButton(UxService.getButtonBarButton(\"presentation-element-cancel\", $scope));\n                $scope.bbApi.addButton(UxService.getButtonBarButton(\"presentation-element-delete\", $scope));\n                $scope.bbApi.setPermission(\"presentation-element-delete\", $scope.isDirectChildOfPresentationElement);\n            }     \n        };\n    };\n\n    var mmsTranscludeComLink = function(scope, domElement, attrs, controllers) {\n        var mmsViewCtrl = controllers[0];\n        var mmsViewPresentationElemCtrl = controllers[1];\n        scope.recompileScope = null;\n        scope.cfType = 'doc';\n\n        domElement.click(function(e) {\n            if (scope.startEdit && !scope.nonEditable)\n                scope.startEdit();\n\n            if (mmsViewCtrl)\n                mmsViewCtrl.transcludeClicked(scope.element);\n            if (scope.nonEditable && mmsViewCtrl && mmsViewCtrl.isEditable()) {\n                growl.warning(\"Comment is not editable.\");\n            }\n            e.stopPropagation();\n        });\n\n        var recompile = function(preview) {\n            if (scope.recompileScope) {\n                scope.recompileScope.$destroy();\n            }\n            scope.isEditing = false;\n            domElement.empty();\n            var doc = (preview ? scope.edit.documentation : scope.element.documentation) || '(No comment)';\n            doc += ' - <span class=\"mms-commenter\"> Comment by <b>' + scope.element._creator + '</b></span>';\n            if (preview) {\n                domElement[0].innerHTML = '<div class=\"panel panel-info\">'+doc+'</div>';\n            } else {\n                domElement[0].innerHTML = doc;\n            }\n            if (MathJax && !scope.mmsGenerateForDiff) {\n                MathJax.Hub.Queue([\"Typeset\", MathJax.Hub, domElement[0]]);\n            }\n            scope.recompileScope = scope.$new();\n            $compile(domElement.contents())(scope.recompileScope); \n            if (mmsViewCtrl) {\n                mmsViewCtrl.elementTranscluded(scope.element, 'Comment');\n            }\n        };\n\n        var idwatch = scope.$watch('mmsElementId', function(newVal, oldVal) {\n            if (!newVal || !scope.mmsProjectId) {\n                return;\n            }\n            idwatch();\n            if (UtilsService.hasCircularReference(scope, scope.mmsElementId, 'doc')) {\n                domElement.html('<span class=\"mms-error\">Circular Reference!</span>');\n                return;\n            }\n            scope.projectId = scope.mmsProjectId;\n            scope.refId = scope.mmsRefId ? scope.mmsRefId : 'master';\n            scope.commitId = scope.mmsCommitId ? scope.mmsCommitId : 'latest';\n            var reqOb = {elementId: scope.mmsElementId, projectId: scope.projectId, refId: scope.refId, commitId: scope.commitId, includeRecentVersionElement: true};\n            ElementService.getElement(reqOb, 1, false)\n            .then(function(data) {\n                scope.element = data;\n                recompile();\n                scope.panelType = \"Comment\";\n                if (scope.commitId === 'latest') {\n                    scope.$on('element.updated', function (event, elementOb, continueEdit) {\n                        if (elementOb.id === scope.element.id && elementOb._projectId === scope.element._projectId &&\n                            elementOb._refId === scope.element._refId && !continueEdit) {\n                            recompile();\n                        }\n                    });\n                }\n            }, function(reason) {\n                domElement.html('<span mms-annotation mms-req-ob=\"::reqOb\" mms-recent-element=\"::recentElement\" mms-type=\"::type\" mms-cf-label=\"::cfLabel\"></span>');\n                $compile(domElement.contents())(Object.assign(scope.$new(), {\n                    reqOb: reqOb,\n                    recentElement: reason.data.recentVersionOfElement,\n                    type: ViewService.AnnotationType.mmsTranscludeCom,\n                    cfLabel: scope.mmsCfLabel\n                }));\n            });\n        });\n\n        if (mmsViewCtrl) {\n\n            scope.isEditing = false;\n            scope.elementSaving = false;\n            scope.view = mmsViewCtrl.getView();\n            scope.isDirectChildOfPresentationElement = Utils.isDirectChildOfPresentationElementFunc(domElement, mmsViewCtrl);\n\n            scope.save = function() {\n                Utils.saveAction(scope, domElement, false);\n            };\n\n            scope.saveC = function() {\n                Utils.saveAction(scope, domElement, true);\n            };\n\n            scope.cancel = function() {\n                Utils.cancelAction(scope, recompile, domElement);\n            };\n\n            scope.startEdit = function() {\n                Utils.startEdit(scope, mmsViewCtrl, domElement, template, false);\n            };\n\n            scope.preview = function() {\n                Utils.previewAction(scope, recompile, domElement);\n            };\n        } \n\n        if (mmsViewPresentationElemCtrl) {\n\n            scope.delete = function() {\n                Utils.deleteAction(scope,scope.bbApi,mmsViewPresentationElemCtrl.getParentSection());\n            };\n\n            scope.instanceSpec = mmsViewPresentationElemCtrl.getInstanceSpec();\n            scope.instanceVal = mmsViewPresentationElemCtrl.getInstanceVal();\n            scope.presentationElem = mmsViewPresentationElemCtrl.getPresentationElement();\n            var auto = [ViewService.TYPE_TO_CLASSIFIER_ID.Image, ViewService.TYPE_TO_CLASSIFIER_ID.Paragraph,\n                ViewService.TYPE_TO_CLASSIFIER_ID.List, ViewService.TYPE_TO_CLASSIFIER_ID.Table];\n\n            if (auto.indexOf(scope.instanceSpec.classifierIds[0]) >= 0)\n            //do not allow model generated to be deleted\n                scope.isDirectChildOfPresentationElement = false;\n            if (scope.isDirectChildOfPresentationElement)\n                scope.panelTitle = scope.instanceSpec.name;\n            scope.panelType = 'Comment';\n        }\n    };\n\n    return {\n        restrict: 'E',\n        scope: {\n            mmsElementId: '@',\n            mmsProjectId: '@',\n            mmsRefId: '@',\n            mmsCommitId: '@',\n            nonEditable: '<',\n            mmsCfLabel: '@',\n            mmsGenerateForDiff: '<'\n        },\n        require: ['?^mmsView', '?^mmsViewPresentationElem'],\n        controller: ['$scope', mmsTranscludeComCtrl],\n        link: mmsTranscludeComLink\n    };\n}\n","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsTranscludeDoc', ['Utils','ElementService', 'UtilsService', 'ViewService', 'UxService', 'AuthService', '$compile', '$templateCache', 'growl', '_', 'MathJax', mmsTranscludeDoc]);\n\n/**\n * @ngdoc directive\n * @name mms.directives.directive:mmsTranscludeDoc\n *\n * @requires mms.ElementService\n * @requires mms.UtilsService\n * @requires mms.ViewService\n * @requires mms.UxService\n * @requires mms.Utils\n * @requires $compile\n * @requires $templateCache\n * @requires growl\n * @requires _\n * @requires MathJax\n *\n * @restrict E\n *\n * @description\n * Given an element id, puts in the element's documentation binding, if there's a parent \n * mmsView directive, will notify parent view of transclusion on init and doc change,\n * and on click. Nested transclusions inside the documentation will also be registered.\n * \n * ## Example\n *  <pre>\n    <mms-transclude-doc mms-element-id=\"element_id\"></mms-transclude-doc>\n    </pre>\n *\n * @param {string} mmsElementId The id of the view\n * @param {string} mmsProjectId The project id for the view\n * @param {string=master} mmsRefId Reference to use, defaults to master\n * @param {string=latest} mmsCommitId Commit ID, default is latest\n * @param {bool} mmsWatchId set to true to not destroy element ID watcher\n * @param {boolean=false} nonEditable can edit inline or not\n */\nfunction mmsTranscludeDoc(Utils, ElementService, UtilsService, ViewService, UxService, AuthService, $compile, $templateCache, growl, _, MathJax) {\n\n    var template = $templateCache.get('mms/templates/mmsTranscludeDoc.html');\n\n    var fixPreSpanRegex = /<\\/span>\\s*<mms-cf/g;\n    var fixPostSpanRegex = /<\\/mms-cf>\\s*<span[^>]*>/g;\n    var emptyRegex = /^\\s*$/;\n\n    var mmsTranscludeDocCtrl = function($scope) {\n\n        $scope.bbApi = {};\n        $scope.buttons = [];\n        $scope.buttonsInit = false;\n\n        $scope.bbApi.init = function() {\n            if (!$scope.buttonsInit) {\n                $scope.buttonsInit = true;\n                $scope.bbApi.addButton(UxService.getButtonBarButton(\"presentation-element-preview\", $scope));\n                $scope.bbApi.addButton(UxService.getButtonBarButton(\"presentation-element-save\", $scope));\n                $scope.bbApi.addButton(UxService.getButtonBarButton(\"presentation-element-saveC\", $scope));\n                $scope.bbApi.addButton(UxService.getButtonBarButton(\"presentation-element-cancel\", $scope));\n                $scope.bbApi.addButton(UxService.getButtonBarButton(\"presentation-element-delete\", $scope));\n                $scope.bbApi.setPermission(\"presentation-element-delete\", $scope.isDirectChildOfPresentationElement);\n            }\n        };\n    };\n\n    var mmsTranscludeDocLink = function(scope, domElement, attrs, controllers) {\n        var mmsViewCtrl = controllers[0];\n        var mmsViewPresentationElemCtrl = controllers[1];\n        scope.recompileScope = null;\n        scope.cfType = 'doc';\n        scope.editorApi = {};\n        domElement.click(function(e) {\n            if (scope.startEdit && !scope.nonEditable)\n                scope.startEdit();\n\n            if (mmsViewCtrl)\n                mmsViewCtrl.transcludeClicked(scope.element);\n            if (scope.nonEditable && mmsViewCtrl && mmsViewCtrl.isEditable()) {\n                growl.warning(\"Cross Reference is not editable.\");\n            }\n            e.stopPropagation();\n        });\n\n        var recompile = function(preview) {\n            if (scope.recompileScope) {\n                scope.recompileScope.$destroy();\n            }\n            domElement.empty();\n            var doc = preview ? scope.edit.documentation : scope.element.documentation;\n            if (!doc || emptyRegex.test(doc)) {\n                doc = '<p class=\"no-print placeholder\">(no ' + scope.panelType + ')</p>';\n            }\n            doc = doc.replace(fixPreSpanRegex, \"<mms-cf\");\n            doc = doc.replace(fixPostSpanRegex, \"</mms-cf>\");\n            if (preview) {\n                domElement[0].innerHTML = '<div class=\"panel panel-info\">'+doc+'</div>';\n            } else {\n                scope.isEditing = false;\n                domElement[0].innerHTML = doc;\n            }\n            $(domElement[0]).find('img').each(function(index) {\n                Utils.fixImgSrc($(this));\n            });\n            if (mmsViewPresentationElemCtrl) {\n                var peSpec = mmsViewPresentationElemCtrl.getPresentationElement();\n                var pe = mmsViewPresentationElemCtrl.getInstanceSpec();\n                if (pe && pe._veNumber && peSpec && (peSpec.type === 'TableT' || peSpec.type === 'Figure' || peSpec.type === 'Equation' || peSpec.type === 'ImageT')) {\n                    var type = (peSpec.type === 'TableT') ? 'table' : peSpec.type.toLowerCase();\n                    if (type === 'imaget') {\n                        type = 'figure';\n                    }\n                    UtilsService.addLiveNumbering(pe, $('#' + pe.id), type);\n                }\n            }\n            if (MathJax && !scope.mmsGenerateForDiff) {\n                MathJax.Hub.Queue([\"Typeset\", MathJax.Hub, domElement[0]]);\n            }\n            scope.recompileScope = scope.$new();\n            $compile(domElement.contents())(scope.recompileScope);\n            if (mmsViewCtrl) {\n                mmsViewCtrl.elementTranscluded(scope.element);\n            }\n        };\n\n        var idwatch = scope.$watch('mmsElementId', function(newVal) {\n            if (!newVal || !scope.mmsProjectId) {\n                return;\n            }\n            if (!scope.mmsWatchId) {\n                idwatch();\n            }\n            if (UtilsService.hasCircularReference(scope, scope.mmsElementId, 'doc')) {\n                domElement.html('<span class=\"mms-error\">Circular Reference!</span>');\n                return;\n            }\n            scope.projectId = scope.mmsProjectId;\n            scope.refId = scope.mmsRefId ? scope.mmsRefId : 'master';\n            scope.commitId = scope.mmsCommitId ? scope.mmsCommitId : 'latest';\n            domElement.html('(loading...)');\n            domElement.addClass(\"isLoading\");\n            var reqOb = {elementId: scope.mmsElementId, projectId: scope.projectId, refId: scope.refId, commitId: scope.commitId, includeRecentVersionElement: true};\n            ElementService.getElement(reqOb, 1, false)\n            .then(function(data) {\n                scope.element = data;\n                if (!scope.panelTitle) {\n                    scope.panelTitle = scope.element.name + \" Documentation\";\n                    scope.panelType = \"Text\";\n                }\n                recompile();\n                Utils.reopenUnsavedElts(scope, \"documentation\");\n\n                if (scope.commitId === 'latest') {\n                    scope.$on('element.updated', function (event, elementOb, continueEdit, stompUpdate) {\n                        if (elementOb.id === scope.element.id && elementOb._projectId === scope.element._projectId &&\n                            elementOb._refId === scope.element._refId && !continueEdit) {\n                            //actions for stomp\n                            if(stompUpdate && scope.isEditing === true) {\n                                growl.warning(\"This value has been changed: \" + elementOb.name +\n                                    \" modified by: \" + elementOb._modifier, {ttl: -1});\n                            } else {\n                                recompile();\n                            }\n                        }\n                    });\n                }\n            }, function(reason) {\n                domElement.html('<span mms-annotation mms-req-ob=\"::reqOb\" mms-recent-element=\"::recentElement\" mms-type=\"::type\" mms-cf-label=\"::cfLabel\"></span>');\n                $compile(domElement.contents())(Object.assign(scope.$new(), {\n                    reqOb: reqOb,\n                    recentElement: reason.data.recentVersionOfElement,\n                    type: ViewService.AnnotationType.mmsTranscludeDoc,\n                    cfLabel: scope.mmsCfLabel\n                }));\n            }).finally(function() {\n                domElement.removeClass(\"isLoading\");\n            });\n        });\n\n        if (mmsViewCtrl) {\n            scope.isEditing = false;\n            scope.elementSaving = false;\n            scope.view = mmsViewCtrl.getView();\n            //TODO remove this when deleting in parent PE directive\n            scope.isDirectChildOfPresentationElement = Utils.isDirectChildOfPresentationElementFunc(domElement, mmsViewCtrl);\n\n            scope.save = function() {\n                Utils.saveAction(scope, domElement, false);\n            };\n\n            scope.saveC = function() {\n                Utils.saveAction(scope, domElement, true);\n            };\n\n            scope.cancel = function() {\n                Utils.cancelAction(scope, recompile, domElement);\n            };\n\n            scope.startEdit = function() {\n                Utils.startEdit(scope, mmsViewCtrl, domElement, template, false);\n            };\n\n            scope.preview = function() {\n                Utils.previewAction(scope, recompile, domElement);\n            };\n        } \n\n        if (mmsViewPresentationElemCtrl) {\n            scope.delete = function() {\n                Utils.deleteAction(scope, scope.bbApi, mmsViewPresentationElemCtrl.getParentSection());\n            };\n\n            scope.instanceSpec = mmsViewPresentationElemCtrl.getInstanceSpec();\n            scope.instanceVal = mmsViewPresentationElemCtrl.getInstanceVal();\n            scope.presentationElem = mmsViewPresentationElemCtrl.getPresentationElement();\n            var auto = [ViewService.TYPE_TO_CLASSIFIER_ID.Image, ViewService.TYPE_TO_CLASSIFIER_ID.Paragraph,\n                ViewService.TYPE_TO_CLASSIFIER_ID.List, ViewService.TYPE_TO_CLASSIFIER_ID.Table];\n\n            if (auto.indexOf(scope.instanceSpec.classifierIds[0]) >= 0)\n            //do not allow model generated to be deleted\n                scope.isDirectChildOfPresentationElement = false;\n            if (scope.isDirectChildOfPresentationElement) {\n                scope.panelTitle = scope.instanceSpec.name;\n                scope.panelType = scope.presentationElem.type; //this is hack for fake table/list/equation until we get actual editors\n                if (scope.panelType.charAt(scope.panelType.length-1) === 'T')\n                    scope.panelType = scope.panelType.substring(0, scope.panelType.length-1);\n                if (scope.panelType === 'Paragraph')\n                    scope.panelType = 'Text';\n                if (scope.panelType === 'Figure' || scope.panelType === 'ImageT')\n                    scope.panelType = 'Image';\n            }\n            if (scope.presentationElem) {\n                scope.editorType = scope.presentationElem.type;\n            }\n        }\n    };\n\n    return {\n        restrict: 'E',\n        scope: {\n            mmsElementId: '@',\n            mmsProjectId: '@',\n            mmsRefId: '@',\n            mmsCommitId: '@',\n            mmsWatchId: '@',\n            nonEditable: '<',\n            mmsCfLabel: '@',\n            mmsGenerateForDiff: '<'\n        },\n        require: ['?^^mmsView','?^^mmsViewPresentationElem'],\n        controller: ['$scope', mmsTranscludeDocCtrl],\n        link: mmsTranscludeDocLink\n    };\n}\n","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsTranscludeImg', ['ArtifactService','AuthService','ElementService','URLService','growl', mmsTranscludeImg]);\n\n/**\n * @ngdoc directive\n * @name mms.directives.directive:mmsTranscludeImg\n *\n * @requires mms.ArtifactService\n * @requires mms.AuthService\n * @requires mms.ElementService\n * @requires mms.URLService\n * @requires growl\n *\n * @restrict E\n *\n * @description\n * Given an image id, puts in an img tag for the image url. \n *\n * @param {string} mmsElementId The id of the view\n * @param {string} mmsProjectId The project id for the view\n * @param {string=master} mmsRefId Reference to use, defaults to master\n * @param {string=latest} mmsCommitId Commit ID, default is latest\n */\nfunction mmsTranscludeImg(ArtifactService, AuthService, ElementService, URLService, growl) {\n\n    var mmsTranscludeImgLink = function(scope, element, attrs, controllers) {\n        var mmsViewCtrl = controllers[0];\n        var processed = false;\n        element.click(function(e) {\n            if (!mmsViewCtrl)\n                return false;\n            //TODO get element somehow\n            mmsViewCtrl.transcludeClicked(scope.element);\n            return false;\n        });\n\n        var changeElement = function(newVal, oldVal) {\n            if (!newVal || (newVal === oldVal && processed) || !scope.mmsProjectId) {\n                return;\n            }\n            processed = true;\n            scope.projectId = scope.mmsProjectId;\n            scope.refId = scope.mmsRefId ? scope.mmsRefId : 'master';\n            scope.commitId = scope.mmsCommitId ? scope.mmsCommitId : 'latest';\n            var reqOb = {elementId: scope.mmsElementId, projectId: scope.projectId, refId: scope.refId, commitId: scope.commitId};\n\n            var server = URLService.getMmsServer();\n            var ticket = '?alf_ticket=' + AuthService.getTicket();\n            element.addClass('isLoading');\n            ElementService.getElement(reqOb, 1, false)\n            .then(function(data) {\n                scope.element = data;\n                var artifactOb = {\n                    projectId: data._projectId,\n                    refId: data._refId,\n                    artifactIds : data._artifactIds,\n                    commitId: scope.commitId === 'latest' ? 'latest' : data._commitId\n                };\n\n                // Get the artifacts of the element\n                ArtifactService.getArtifacts(artifactOb)\n                .then(function(artifacts) {\n                    scope.artifacts = artifacts;\n                    for(var i = 0; i < artifacts.length; i++) {\n                        var artifact = artifacts[i];\n                        if (artifact.contentType == \"image/svg+xml\") {\n                            scope.svgImgUrl = server + '/alfresco' + artifact.artifactLocation + ticket;\n                        } else if (artifact.contentType == \"image/png\") {\n                            scope.pngImgUrl = server + '/alfresco' + artifact.artifactLocation + ticket;\n                        }\n                    }\n                }, function(reason) {\n                    console.log('Artifacts Error: ' + reason.message + ': ' + scope.mmsElementId);\n                });\n            }, function(reason) {\n                console.log('Cf Artifacts Error: ' + reason.message + ': ' + scope.mmsElementId);\n            }).finally(function() {\n                element.removeClass('isLoading');\n            });\n        };\n\n        scope.$watch('mmsElementId', changeElement);\n        scope.$watch('mmsRefId', changeElement);\n        scope.$watch('mmsCommitId', changeElement);\n    };\n\n    return {\n        restrict: 'E',\n        template: '<img class=\"mms-svg\" ng-src=\"{{svgImgUrl}}\"></img><img class=\"mms-png\" ng-src=\"{{pngImgUrl}}\"></img>',\n        scope: {\n            mmsElementId: '@',\n            mmsProjectId: '@',\n            mmsRefId: '@',\n            mmsCommitId: '@',\n            mmsCfLabel: '@'\n        },\n        require: ['?^^mmsView'],\n        link: mmsTranscludeImgLink\n    };\n}","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsTranscludeName', ['ElementService', 'UxService', '$compile', 'growl', '$templateCache', 'Utils', 'ViewService', mmsTranscludeName]);\n\n/**\n * @ngdoc directive\n * @name mms.directives.directive:mmsTranscludeName\n *\n * @requires mms.ElementService\n * @requires mms.UxService\n * @requires mms.Utils\n * @requires $compile\n * @requires $templateCache\n * @requires growl\n *\n * @restrict E\n *\n * @description\n * Given an element id, puts in the element's name binding, if there's a parent \n * mmsView directive, will notify parent view of transclusion on init and name change,\n * and on click\n *\n * @param {string} mmsElementId The id of the view\n * @param {string} mmsProjectId The project id for the view\n * @param {string=master} mmsRefId Reference to use, defaults to master\n * @param {string=latest} mmsCommitId Commit ID, default is latest\n * @param {bool} mmsWatchId set to true to not destroy element ID watcher\n * @param {boolean=false} nonEditable can edit inline or not\n */\nfunction mmsTranscludeName(ElementService, UxService, $compile, growl, $templateCache, Utils, ViewService) {\n\n    var template = $templateCache.get('mms/templates/mmsTranscludeName.html');\n    var defaultTemplate = '<span ng-if=\"element.name\">{{element.name}}</span><span ng-if=\"!element.name\" class=\"no-print placeholder\">(no name)</span>';\n    var editTemplate = '<span ng-if=\"edit.name\">{{edit.name}}</span><span ng-if=\"!edit.name\" class=\"no-print placeholder\">(no name)</span>';\n\n    var mmsTranscludeNameLink = function(scope, domElement, attrs, controllers) {\n        var mmsViewCtrl = controllers[0];\n        scope.recompileScope = null;\n        domElement.click(function(e) {\n            if (scope.noClick)\n                return;\n\n            if (scope.clickHandler) {\n                scope.clickHandler();\n                return;\n            }\n            if (scope.startEdit && !scope.nonEditable)\n                scope.startEdit();\n\n            if (!mmsViewCtrl)\n                return false;\n\n            if (scope.nonEditable && mmsViewCtrl && mmsViewCtrl.isEditable()) {\n                growl.warning(\"Cross Reference is not editable.\");\n            }\n            mmsViewCtrl.transcludeClicked(scope.element);\n            e.stopPropagation();\n        });\n\n        var recompile = function(preview) {\n            if (scope.recompileScope) {\n                scope.recompileScope.$destroy();\n            }\n            domElement.empty();\n            if (preview) {\n                domElement[0].innerHTML = '<div class=\"panel panel-info\">'+editTemplate+'</div>';\n            } else {\n                scope.isEditing = false;\n                domElement[0].innerHTML = defaultTemplate;\n            }\n            scope.recompileScope = scope.$new();\n            $compile(domElement.contents())(scope.recompileScope);\n            if (mmsViewCtrl) {\n                mmsViewCtrl.elementTranscluded(scope.element);\n            }\n        };\n\n        var idwatch = scope.$watch('mmsElementId', function(newVal, oldVal) {\n            if (!newVal || !scope.mmsProjectId) {\n                return;\n            }\n            if (!scope.mmsWatchId) {\n                idwatch();\n            }\n            scope.projectId = scope.mmsProjectId;\n            scope.refId = scope.mmsRefId ? scope.mmsRefId : 'master';\n            scope.commitId = scope.mmsCommitId ? scope.mmsCommitId : 'latest';\n\n            domElement.html('(loading...)');\n            domElement.addClass(\"isLoading\");\n            var reqOb = {elementId: scope.mmsElementId, projectId: scope.projectId, refId: scope.refId, commitId: scope.commitId, includeRecentVersionElement: true};\n            ElementService.getElement(reqOb, 1, false)\n            .then(function(data) {\n                scope.element = data;\n                recompile();\n                Utils.reopenUnsavedElts(scope, \"name\");\n                if (mmsViewCtrl) {\n                    mmsViewCtrl.elementTranscluded(scope.element);\n                }\n                if (scope.commitId === 'latest') {\n                    scope.$on('element.updated', function (event, elementOb, continueEdit, stompUpdate) {\n                        if (elementOb.id === scope.element.id && elementOb._projectId === scope.element._projectId &&\n                            elementOb._refId === scope.element._refId && !continueEdit) {\n                            //actions for stomp\n                            if (stompUpdate && scope.isEditing === true) {\n                                growl.warning(\"This value has been changed: \" + elementOb.name +\n                                    \" modified by: \" + elementOb._modifier, {ttl: -1});\n                            } else {\n                                recompile();\n                            }\n                        }\n                    });\n                }\n            }, function(reason) {\n                domElement.html('<span mms-annotation mms-req-ob=\"::reqOb\" mms-recent-element=\"::recentElement\" mms-type=\"::type\" mms-cf-label=\"::cfLabel\"></span>');\n                $compile(domElement.contents())(Object.assign(scope.$new(), {\n                    reqOb: reqOb,\n                    recentElement: reason.data.recentVersionOfElement,\n                    type: ViewService.AnnotationType.mmsTranscludeName,\n                    cfLabel: scope.mmsCfLabel\n                }));\n            }).finally(function() {\n                domElement.removeClass(\"isLoading\");\n            });\n        });\n\n\n\n        if (mmsViewCtrl) {\n\n            scope.isEditing = false;\n            scope.elementSaving = false;\n            scope.view = mmsViewCtrl.getView();\n\n            scope.save = function(e) {\n                e.stopPropagation();\n                Utils.saveAction(scope, domElement, false);\n            };\n\n            scope.cancel = function(e) {\n                e.stopPropagation();\n                Utils.cancelAction(scope, recompile, domElement);\n            };\n\n            scope.startEdit = function() {\n                Utils.startEdit(scope, mmsViewCtrl, domElement, template, false);\n            };\n\n        }\n    };\n\n    return {\n        restrict: 'E',\n        scope: {\n            mmsElementId: '@',\n            mmsProjectId: '@',\n            mmsRefId: '@',\n            mmsCommitId: '@',\n            mmsWatchId: '@',\n            noClick: '@',\n            nonEditable: '<',\n            clickHandler: '&?',\n            mmsCfLabel: '@'\n        },\n        require: ['?^^mmsView'],\n        // controller: ['$scope', mmsTranscludeNameCtrl],\n        link: mmsTranscludeNameLink\n    };\n}","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsTranscludeVal', ['ElementService', 'UtilsService', 'UxService', 'Utils', 'URLService', 'AuthService',\n    '$http', '_', '$compile', '$templateCache', 'growl', 'MathJax', 'ViewService', mmsTranscludeVal]);\n\n/**\n * @ngdoc directive\n * @name mms.directives.directive:mmsTranscludeVal\n *\n * @requires mms.ElementService\n * @requires mms.UtilsService\n * @requires mms.URLService\n * @requires mms.UxService\n * @requires mms.Utils\n * @requires $compile\n * @requires $http\n * @requires $templateCache\n * @requires growl\n * @requires _\n * @requires MathJax\n *\n * @restrict E\n *\n * @description\n * Given an element id, puts in the element's value binding, if there's a parent \n * mmsView directive, will notify parent view of transclusion on init and val change,\n * and on click. The element should be a Property. Nested transclusions within \n * string values will also be registered.\n *\n * @param {string} mmsElementId The id of the view\n * @param {string} mmsProjectId The project id for the view\n * @param {string=master} mmsRefId Reference to use, defaults to master\n * @param {string=latest} mmsCommitId Commit ID, default is latest\n */\nfunction mmsTranscludeVal(ElementService, UtilsService, UxService, Utils, URLService, AuthService, $http,\n                          _, $compile, $templateCache, growl, MathJax, ViewService) {\n    var valTemplate = $templateCache.get('mms/templates/mmsTranscludeVal.html');\n    var frameTemplate = $templateCache.get('mms/templates/mmsTranscludeValFrame.html');\n    var editTemplate = $templateCache.get('mms/templates/mmsTranscludeValEdit.html');\n    var emptyRegex = /^\\s*$/;\n\n    var mmsTranscludeCtrl = function ($scope, $rootScope) {\n\n        $scope.bbApi = {};\n        $scope.buttons = [];\n        $scope.buttonsInit = false;\n\n        $scope.bbApi.init = function() {\n            if (!$scope.buttonsInit) {\n                $scope.buttonsInit = true;\n                $scope.bbApi.addButton(UxService.getButtonBarButton(\"presentation-element-preview\", $scope));\n                $scope.bbApi.addButton(UxService.getButtonBarButton(\"presentation-element-save\", $scope));\n                $scope.bbApi.addButton(UxService.getButtonBarButton(\"presentation-element-saveC\", $scope));\n                $scope.bbApi.addButton(UxService.getButtonBarButton(\"presentation-element-cancel\", $scope));\n                $scope.bbApi.addButton(UxService.getButtonBarButton(\"presentation-element-delete\", $scope));\n                $scope.bbApi.setPermission(\"presentation-element-delete\", $scope.isDirectChildOfPresentationElement);\n            }\n        };\n    };\n\n    var mmsTranscludeValLink = function(scope, domElement, attrs, controllers) {\n        var mmsViewCtrl = controllers[0];\n        var mmsViewPresentationElemCtrl = controllers[1];\n        scope.recompileScope = null;\n        scope.cfType = 'val';\n        domElement.click(function(e) {\n            if (scope.startEdit && !scope.nonEditable) {\n                scope.startEdit();\n            }\n            if (mmsViewCtrl) {\n                mmsViewCtrl.transcludeClicked(scope.element);\n            }\n            if (scope.nonEditable && mmsViewCtrl && mmsViewCtrl.isEditable()) {\n                growl.warning(\"Cross Reference is not editable.\");\n            }\n            e.stopPropagation();\n        });\n\n        scope.addHtml = function(value) {\n            value.value = \"<p>\" + value.value + \"</p>\";\n        };\n\n        scope.cleanupVal = function(obj) {\n            obj.value = parseInt(obj.value);\n        };\n\n        var recompile = function(preview) {\n            if (scope.recompileScope) {\n                scope.recompileScope.$destroy();\n            }\n            var toCompileList = [];\n            var areStrings = false;\n            var values = scope.values;\n            if (preview) {\n                values = scope.editValues;\n            } else {\n                scope.isEditing = false;\n            }\n            for (var i = 0; i < values.length; i++) {\n                if (values[i].type === 'LiteralString') {\n                    areStrings = true;\n                    var s = values[i].value;\n                    if (s.indexOf('<p>') === -1) {\n                        s = s.replace('<', '&lt;');\n                    }\n                    toCompileList.push(s);\n                } else {\n                    break;\n                }\n            }\n            domElement.empty();\n            scope.recompileScope = scope.$new();\n            if (values.length === 0 || Object.keys(values[0]).length < 2) {\n                domElement[0].innerHTML = '<span class=\"no-print placeholder\">(no value)</span>';\n            } else if (areStrings) {\n                var toCompile = toCompileList.join(' ');\n                if (toCompile === '' || emptyRegex.test(toCompile)) {\n                    domElement[0].innerHTML = '<span class=\"no-print placeholder\">(no value)</span>';\n                    return;\n                }\n                if (preview) {\n                    domElement[0].innerHTML = '<div class=\"panel panel-info\">'+toCompile+'</div>';\n                } else {\n                    domElement[0].innerHTML = toCompile;\n                }\n                $(domElement[0]).find('img').each(function(index) {\n                    Utils.fixImgSrc($(this));\n                });\n                if (MathJax && !scope.mmsGenerateForDiff ) {\n                    MathJax.Hub.Queue([\"Typeset\", MathJax.Hub, domElement[0]]);\n                }\n                $compile(domElement.contents())(scope.recompileScope);\n            } else {\n                if (preview) {\n                    domElement[0].innerHTML = editTemplate;\n                } else {\n                    domElement[0].innerHTML = valTemplate;\n                }\n                $compile(domElement.contents())(scope.recompileScope);\n            }\n            if (mmsViewCtrl) {\n                mmsViewCtrl.elementTranscluded(scope.element);\n            }\n        };\n\n        var idwatch = scope.$watch('mmsElementId', function(newVal, oldVal) {\n            if (!newVal || !scope.mmsProjectId) {\n                return;\n            }\n            idwatch();\n            if (UtilsService.hasCircularReference(scope, scope.mmsElementId, 'val')) {\n                domElement.html('<span class=\"mms-error\">Circular Reference!</span>');\n                return;\n            }\n            domElement.html('(loading...)');\n            domElement.addClass(\"isLoading\");\n\n            scope.projectId = scope.mmsProjectId;\n            scope.refId = scope.mmsRefId ? scope.mmsRefId : 'master';\n            scope.commitId = scope.mmsCommitId ? scope.mmsCommitId : 'latest';\n            var reqOb = {elementId: scope.mmsElementId, projectId: scope.projectId, refId: scope.refId, commitId: scope.commitId, includeRecentVersionElement: true};\n            ElementService.getElement(reqOb, 1)\n            .then(function(data) {\n                scope.element = data;\n                Utils.setupValCf(scope);\n                recompile();\n                Utils.reopenUnsavedElts(scope, 'value');\n                if (scope.commitId === 'latest') {\n                    scope.$on('element.updated', function (event, elementOb, continueEdit, stompUpdate) {\n                        if (elementOb.id === scope.element.id && elementOb._projectId === scope.element._projectId &&\n                            elementOb._refId === scope.element._refId && !continueEdit) {\n                            //actions for stomp\n                            if(stompUpdate && scope.isEditing === true) {\n                                growl.warning(\"This value has been changed: \" + elementOb.name +\n                                    \" modified by: \" + elementOb._modifier, {ttl: -1});\n                            } else {\n                                Utils.setupValCf(scope);\n                                recompile();\n                            }\n                        }\n                    });\n                }\n            }, function(reason) {\n                domElement.html('<span mms-annotation mms-req-ob=\"::reqOb\" mms-recent-element=\"::recentElement\" mms-type=\"::type\" mms-cf-label=\"::cfLabel\"></span>');\n                $compile(domElement.contents())(Object.assign(scope.$new(), {\n                    reqOb: reqOb,\n                    recentElement: reason.data.recentVersionOfElement,\n                    type: ViewService.AnnotationType.mmsTranscludeVal,\n                    cfLabel: scope.mmsCfLabel\n                }));\n            }).finally(function() {\n                domElement.removeClass(\"isLoading\");\n            });\n        });\n\n        scope.hasHtml = function(s) {\n            return Utils.hasHtml(s);\n        };\n\n        Utils.setupValEditFunctions(scope);\n        \n        if (mmsViewCtrl) {\n            scope.isEditing = false;\n            scope.elementSaving = false;\n            scope.isDirectChildOfPresentationElement = Utils.isDirectChildOfPresentationElementFunc(domElement, mmsViewCtrl);\n            scope.view = mmsViewCtrl.getView();\n\n            scope.save = function() {\n                Utils.saveAction(scope, domElement, false);\n            };\n\n            scope.saveC = function() {\n                Utils.saveAction(scope, domElement, true);\n            };\n\n            scope.cancel = function() {\n                Utils.cancelAction(scope, recompile, domElement);\n            };\n\n            scope.startEdit = function() {\n                var id = scope.element.typeId;\n                if (scope.element.type === 'Slot')\n                    id = scope.element.definingFeatureId;\n                if (!id || (scope.isEnumeration && scope.options)) {\n                    Utils.startEdit(scope, mmsViewCtrl, domElement, frameTemplate, false);\n                    return;\n                }\n                Utils.getPropertySpec(scope.element)\n                .then( function(value) {\n                    scope.isEnumeration = value.isEnumeration;\n                    scope.isSlot = value.isSlot;\n                    scope.options = value.options;\n                    Utils.startEdit(scope, mmsViewCtrl, domElement, frameTemplate, false);\n                }, function(reason) {\n                    Utils.startEdit(scope, mmsViewCtrl, domElement, frameTemplate, false);\n                    growl.error('Failed to get property spec: ' + reason.message);\n                });\n            };\n\n            scope.preview = function() {\n                Utils.previewAction(scope, recompile, domElement);\n            };\n        }\n\n        if (mmsViewPresentationElemCtrl) {\n            scope.delete = function() {\n                Utils.deleteAction(scope,scope.bbApi,mmsViewPresentationElemCtrl.getParentSection());\n            };\n            scope.instanceSpec = mmsViewPresentationElemCtrl.getInstanceSpec();\n            scope.instanceVal = mmsViewPresentationElemCtrl.getInstanceVal();\n            scope.presentationElem = mmsViewPresentationElemCtrl.getPresentationElement();\n        }\n    };\n\n    return {\n        restrict: 'E',\n        //template: template,\n        scope: {\n            mmsElementId: '@',\n            mmsProjectId: '@',\n            mmsRefId: '@',\n            mmsCommitId: '@',\n            nonEditable: '<',\n            mmsCfLabel: '@',\n            mmsGenerateForDiff: '<'\n        },\n        require: ['?^^mmsView','?^^mmsViewPresentationElem'],\n        controller: ['$scope', mmsTranscludeCtrl],\n        link: mmsTranscludeValLink\n    };\n}\n","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsTree', ['ApplicationService', '$timeout', '$log', '$templateCache', '$filter', 'UtilsService', mmsTree]);\n\n/**\n * @ngdoc directive\n * @name mms.directives.directive:mmsTree\n *\n * @requires $timeout\n * @requires $templateCache\n *\n * @restrict E\n *\n * @description\n * Outputs a tree with customizable icons for different types of nodes and callback\n * for node branch clicked. Includes api, see methods section. (the name display is\n * angular data binded)\n * Object for tree model require (can have multiple roots):\n *  <pre>\n    [\n        {\n            label: 'root node name',\n            type: 'a type',\n            data: {name: 'name will be shown', ...},\n            children: [{...}]\n        },\n        {\n            label: 'another root node',\n            type: 'another type',\n            data: {name: 'another name', ...},\n            children: [{...}]\n        }\n    ]\n    </pre>\n * Tree options:\n *  <pre>\n    {\n        types: {\n            'a type': 'fa fa-file-o',\n            'another type': 'fa fa-file'\n        }\n    }\n    </pre>\n *\n * ## Example \n * ### controller (js)\n *  <pre>\n    angular.module('app', ['mms.directives'])\n    .controller('TreeCtrl', ['$scope', function($scope) {\n        $scope.api = {}; //empty object to be populated by the spec api\n        $scope.handler = function(branch) {\n            //branch selected\n        };\n        $scope.treeData = [\n            {\n                label: 'Root',\n                type: 'Package',\n                data: {\n                    name: 'Root',\n                    sysmlId: 'id',\n                    //any other stuff\n                },\n                children: [\n                    {\n                        label: 'Child',\n                        type: 'Class',\n                        data: {\n                            name: 'Child',\n                            sysmlId: 'blah',\n                            //other stuff\n                        },\n                        children: []\n                    }\n                ]\n            }\n        ];\n        $scope.options = {\n            types: {\n                'Package': 'fa fa-folder',\n                'Class': 'fa fa-bomb'\n            }\n        };\n    }]);\n    </pre>\n * ### template (html)\n *  <pre>\n    <div ng-controller=\"TreeCtrl\">\n        <mms-tree tree-data=\"treeData\" on-select=\"handler(branch)\" options=\"options\" tree-control=\"api\"></mms-tree>\n    </div>\n    </pre>\n *\n * @param {Array} treeData Array of root nodes\n * @param {Object=} treeControl Empty object to populate with api\n * @param {Object=} options Options object to customize icons for types and statuses\n * @param {string='fa fa-caret-right'} iconExpand icon to use when branch is collapsed\n * @param {string='fa fa-caret-down'} iconCollapse icon to use when branch is expanded\n * @param {string='fa fa-file'} iconDefault default icon to use for nodes\n */\nfunction mmsTree(ApplicationService, $timeout, $log, $templateCache, $filter, UtilsService) {\n\n    var mmsTreeLink = function(scope, element, attrs) {\n        scope.getHref = getHref;\n        if (!scope.options) {\n            scope.options = {\n                expandLevel: 1,\n                search: ''\n            };\n        }\n        if (!attrs.iconExpand)\n            attrs.iconExpand = 'fa fa-caret-right fa-lg fa-fw';\n        if (!attrs.iconCollapse)\n            attrs.iconCollapse = 'fa fa-caret-down fa-lg fa-fw';\n        if (!attrs.iconDefault)\n            attrs.iconDefault = 'fa fa-file fa-fw';\n        if (!scope.options.expandLevel && scope.options.expandLevel !== 0)\n            scope.options.expandLevel = 1;\n        var expand_level = scope.options.expandLevel;\n        if (!angular.isArray(scope.treeData)) {\n            $log.warn('treeData is not an array!');\n            return;\n        }\n\n        var for_each_branch = function(func, excludeBranch) {\n            var run = function(branch, level) {\n                func(branch, level);\n                if (branch.children) {\n                    for (var i = 0; i < branch.children.length; i++) {\n                        run(branch.children[i], level + 1);\n                    }\n                }\n            };\n            var rootLevelBranches = excludeBranch ? scope.treeData.filter(function(branch) { return branch !== excludeBranch; }) : scope.treeData;\n            rootLevelBranches.forEach(function (branch) { run(branch, 1); });\n        };\n\n        var remove_branch_impl = function (branch, singleBranch) {\n            var parent_branch = get_parent(branch);\n            if (!parent_branch) {\n                for (var j = 0; j < scope.treeData.length; j++) {\n                    if (scope.treeData[j].uid === branch.uid) {\n                        scope.treeData.splice(j,1);\n                        break;\n                    }\n                }\n                return;\n            }\n            for (var i = 0; i < parent_branch.children.length; i++) {\n                if (parent_branch.children[i].uid === branch.uid) {\n                    parent_branch.children.splice(i,1);\n                    if (singleBranch) {\n                        break;\n                    }\n                }\n            }\n        };\n\n        var remove_branch = function (branch) {\n            remove_branch_impl(branch, false);\n        };\n\n        var remove_single_branch = function (branch) {\n            remove_branch_impl(branch, true);\n        };\n\n        var get_parent = function(child) {\n            var parent = null;\n            if (child.parent_uid) {\n                for_each_branch(function(b) {\n                    if (b.uid === child.parent_uid) {\n                        parent = b;\n                    }\n                });\n            }\n            return parent;\n        };\n\n        var expandPathToSelectedBranch = function() {\n            if (selected_branch) {\n                expand_all_parents(selected_branch);\n                on_treeData_change();\n            }\n        };\n\n        var for_all_ancestors = function(child, fn) {\n            var parent = get_parent(child);\n            if (parent) {\n                fn(parent);\n                for_all_ancestors(parent, fn);\n            }\n        };\n\n        var expand_all_parents = function(child) {\n            for_all_ancestors(child, function(b) {\n                if(b.expandable === true)\n                {\n                    scope.expandCallback({ branch: b });\n                }\n                b.expanded = true;\n            });\n        };\n\n        var selected_branch = null;\n        /**\n         * @ngdoc function\n         * @name mms.directives.directive:mmsTree#select_branch\n         * @methodOf mms.directives.directive:mmsTree\n         * \n         * @description \n         * self explanatory\n         *\n         * @param {Object} branch branch to select\n         */\n        var select_branch = function(branch, noClick) {\n            if (!branch) {\n                if (selected_branch)\n                    selected_branch.selected = false;\n                selected_branch = null;\n                return;\n            }\n            if (branch !== selected_branch) {\n                if (selected_branch)\n                    selected_branch.selected = false;\n                branch.selected = true;\n                selected_branch = branch;\n                /*if(branch.expandable === true)\n                {\n                    scope.expandCallback({ branch: branch });\n                }*/\n                expand_all_parents(branch);\n                if (!noClick) {\n                    if (branch.onSelect) {\n                        $timeout(function() {\n                            branch.onSelect(branch);\n                        });\n                    } else if (scope.options.onSelect) {\n                        $timeout(function() {\n                            scope.options.onSelect(branch);\n                        });\n                    }\n                }\n                if (branch.data.id) {\n                    $timeout(function() {\n                        var el = angular.element('#tree-branch-' + branch.data.id);\n                        if (!el.isOnScreen()) {\n                            el.get(0).scrollIntoView();\n                        }\n                    }, 500, false);\n                }\n            // fix for when user presses browser back button\n            } else {\n                expand_all_parents(branch);\n            }\n        };\n\n        var on_initialSelection_change = function() {\n            if (scope.initialSelection) {\n                for_each_branch(function(b) {\n                    if (b.data.id === scope.initialSelection) {\n                        select_branch(b, true);\n                    }\n                });\n                on_treeData_change();\n            }\n        };\n\n        var on_treeData_change = function() {\n            for_each_branch(function(b, level) {\n                if (!b.uid)\n                    b.uid = '' + Math.random();\n            });\n            for_each_branch(function(b) {\n                if (angular.isArray(b.children)) {\n                    for (var i = 0; i < b.children.length; i++) {\n                        var child = b.children[i];\n                        child.parent_uid = b.uid;\n                    }\n                }\n            });\n            scope.tree_rows = [];\n            var add_branch_to_list = function(level, section, branch, visible, peNums) {\n                var expand_icon = \"\";\n                var type_icon = \"\";\n                var aggr = branch.aggr;\n                if (!aggr)\n                    aggr = \"\";\n                else\n                    aggr = '-' + aggr.toLowerCase();\n                var i = 0;\n                if (!branch.expanded)\n                    branch.expanded = false;\n                if ((branch.children && branch.children.length > 0) || (branch.expandable === true)) {\n                    var haveVisibleChild = false;\n                    if (branch.type !== 'view' && branch.type !== 'section')\n                        haveVisibleChild = true;\n                    for (i = 0; i < branch.children.length; i++) {\n                        if (!branch.children[i].hide) {\n                            haveVisibleChild = true;\n                            break;\n                        }\n                    }\n                    if (haveVisibleChild) {\n                        if (branch.expanded) {\n                            expand_icon = attrs.iconCollapse;\n                        } else {\n                            expand_icon = attrs.iconExpand;\n                        }\n                    } else\n                        expand_icon = \"fa fa-lg fa-fw\";\n                } else\n                    expand_icon = \"fa fa-lg fa-fw\";\n\n                if (branch.loading) {\n                    type_icon = \"fa fa-spinner fa-spin\";\n                } else if (scope.options && scope.options.types && scope.options.types[branch.type.toLowerCase() + aggr]) {\n                    type_icon = scope.options.types[branch.type.toLowerCase() + aggr];\n                } else {\n                    type_icon = attrs.iconDefault;\n                }\n\n                var number = section.join('.');\n                if (branch.type === 'figure' || branch.type === 'table' || branch.type === 'equation') {\n                    peNums[branch.type]++;\n                    if (scope.options.numberingDepth == 0) {\n                        number = peNums[branch.type];\n                    } else if (section.length >= scope.options.numberingDepth) {\n                        number = section.slice(0, scope.options.numberingDepth).join('.') + scope.options.numberingSeparator + peNums[branch.type];\n                    } else {\n                        var sectionCopy = section.slice();\n                        while (sectionCopy.length < scope.options.numberingDepth) {\n                            sectionCopy.push(0);\n                        }\n                        number = sectionCopy.join('.') + scope.options.numberingSeparator + peNums[branch.type]; \n                    }\n                } else if (branch.type !== 'view' && branch.type !== 'section') {\n                    number = '';\n                }\n                if (branch.data && branch.data.id && scope.options.sectionNumbering) {\n                    branch.data._veNumber = number;\n                }\n                if (branch.hide)\n                    visible = false;\n                scope.tree_rows.push({\n                    level: level,\n                    section: number,\n                    branch: branch,\n                    label: branch.label,\n                    expand_icon: expand_icon,\n                    visible: visible,\n                    type_icon: type_icon,\n                    children: branch.children\n                });\n                if (branch.children) {\n                    if (scope.options.sort) {\n                        branch.children.sort(scope.options.sort);\n                    }\n                    var j = scope.options.startChapter;\n                    if (j === null || j === undefined || level != 1) {\n                        j = 1;\n                    }\n                    for (i = 0; i < branch.children.length; i++) {\n                        var child_visible = visible && branch.expanded;\n                        //if (branch.children[i].type === 'section')\n                        //    add_branch_to_list(level + 1, ' ', branch.children[i], child_visible);\n                        if (branch.children[i].type === 'figure' || branch.children[i].type === 'table' || branch.children[i].type === 'equation') {\n                            add_branch_to_list(level + 1, section, branch.children[i], child_visible, peNums);\n                        } else {\n                            if (scope.options.sectionNumbering) {\n                                var nextSection = section.slice(); \n                                nextSection.push(j);\n                                if (nextSection.length <= scope.options.numberingDepth) {\n                                    peNums.table = 0; peNums.figure = 0; peNums.equaton = 0;\n                                }\n                                add_branch_to_list(level + 1, nextSection, branch.children[i], child_visible, peNums);\n                            } else {\n                                add_branch_to_list(level + 1, [], branch.children[i], child_visible, peNums);\n                            }\n                            j++;\n                        }\n                    }\n                }\n            };\n\n            if (scope.options.sort) {\n                scope.treeData.sort(scope.options.sort);\n            }\n\n            for (var i = 0; i < scope.treeData.length; i++) {\n                add_branch_to_list(1, [], scope.treeData[i], true, {figure: 0, table: 0, equation: 0});\n            }\n\n        };\n\n        scope.expandCallback = function(obj, e){\n            if(!obj.branch.expanded && scope.options.expandCallback) {\n               scope.options.expandCallback(obj.branch.data.id, obj.branch, false);\n            }\n            obj.branch.expanded = !obj.branch.expanded;\n            if (e) {\n                e.stopPropagation();\n                on_treeData_change();\n            }\n        };\n\n        scope.on_treeData_change = on_treeData_change;\n        scope.$watch('treeData', on_treeData_change, false);\n        scope.$watch('initialSelection', on_initialSelection_change);\n        scope.tree_rows = [];\n        scope.treeFilter = $filter('uiTreeFilter');\n\n        if (attrs.initialSelection) {\n            for_each_branch(function(b) {\n                if (b.data.id === attrs.initialSelection) {\n                    $timeout(function() {\n                        select_branch(b);\n                    });\n                }\n            });\n        }\n\n        for_each_branch(function(b, level) {\n            b.level = level;\n            b.expanded = b.level <= expand_level;\n        });\n\n        // on_treeData_change();\n\n        scope.user_clicks_branch = function(branch) {\n            if (branch !== selected_branch) \n                select_branch(branch);\n        };\n\n        scope.user_dblclicks_branch = function(branch) {\n            if (branch.onDblclick) {\n                $timeout(function() {\n                    branch.onDblclick(branch);\n                });\n            } else if (scope.options.onDblclick) {\n                $timeout(function() {\n                    scope.options.onDblclick(branch);\n                });\n            }\n        };\n\n        if (angular.isObject(scope.treeControl)) {\n            var tree = scope.treeControl;\n            /**\n             * @ngdoc function\n             * @name mms.directives.directive:mmsTree#expand_all\n             * @methodOf mms.directives.directive:mmsTree\n             * \n             * @description \n             * self explanatory\n             */\n            tree.expand_all = function() {\n                for_each_branch(function(b, level) {\n                    scope.expandCallback({ branch: b });\n                    b.expanded = true;\n                });\n                on_treeData_change();\n            };\n            /**\n             * @ngdoc function\n             * @name mms.directives.directive:mmsTree#collapse_all\n             * @methodOf mms.directives.directive:mmsTree\n             * \n             * @description \n             * self explanatory\n             */\n            tree.collapse_all = function(excludeBranch) {\n                for_each_branch(function(b, level) {\n                    b.expanded = false;\n                }, excludeBranch);\n                on_treeData_change();\n            };\n\n            tree.get_first_branch = function() {\n                if (scope.treeData.length > 0)\n                    return scope.treeData[0];\n            };\n            tree.select_first_branch = function() {\n                var b = tree.get_first_branch();\n                select_branch(b);\n            };\n            /**\n             * @ngdoc function\n             * @name mms.directives.directive:mmsTree#get_selected_branch\n             * @methodOf mms.directives.directive:mmsTree\n             * \n             * @description \n             * self explanatory\n             *\n             * @return {Object} current selected branch\n             */\n            tree.get_selected_branch = function() {\n                return selected_branch;\n            };\n\n            tree.clear_selected_branch = function() {\n                selected_branch = null;\n            };\n\n            tree.get_parent_branch = get_parent;\n            tree.select_branch = select_branch;\n            tree.get_children = function(b) {\n                return b.children;\n            };\n            tree.select_parent_branch = function(b) {\n                var p = tree.get_parent_branch(b);\n                if (p) \n                    tree.select_branch(p);\n            };\n            /**\n             * @ngdoc function\n             * @name mms.directives.directive:mmsTree#add_branch\n             * @methodOf mms.directives.directive:mmsTree\n             * \n             * @description \n             * self explanatory\n             *\n             * @param {Object} parent parent branch or null \n             * @param {Object} new_branch branch to add to parent or root\n             */\n            tree.add_branch = function(parent, new_branch, top) {\n                if (parent) {\n                    if (top)\n                        parent.children.unshift(new_branch);\n                    else\n                        parent.children.push(new_branch);\n                    parent.expanded = true;\n                } else {\n                    if (top)\n                        scope.treeData.unshift(new_branch);\n                    else\n                        scope.treeData.push(new_branch);\n                }\n                on_treeData_change();\n            };\n\n            tree.remove_branch = function(branch) {\n                remove_branch(branch);\n                on_treeData_change();\n            };\n\n            tree.remove_single_branch = function(branch) {\n                remove_single_branch(branch);\n                on_treeData_change();\n            };\n\n            tree.add_root_branch = function(new_branch) {\n                tree.add_branch(null, new_branch);\n            };\n            /**\n             * @ngdoc function\n             * @name mms.directives.directive:mmsTree#expand_branch\n             * @methodOf mms.directives.directive:mmsTree\n             * \n             * @description \n             * self explanatory\n             *\n             * @param {Object} branch branch to expand\n             */\n            tree.expand_branch = function(b) {\n                if (!b)\n                    b = tree.get_selected_branch();\n                if (b) {\n                    scope.expandCallback({ branch: b });\n                    b.expanded = true;\n                }\n                on_treeData_change();\n            };\n\n            tree.expandPathToSelectedBranch = expandPathToSelectedBranch;\n\n            /**\n             * @ngdoc function\n             * @name mms.directives.directive:mmsTree#collapse_branch\n             * @methodOf mms.directives.directive:mmsTree\n             * \n             * @description \n             * self explanatory\n             *\n             * @param {Object} branch branch to collapse\n             */\n            tree.collapse_branch = function(b) {\n                if (!b)\n                    b = selected_branch;\n                if (b)\n                    b.expanded = false;\n                on_treeData_change();\n            };\n            tree.get_siblings = function(b) {\n                var siblings;\n                var p = tree.get_parent_branch(b);\n                if (p)\n                    siblings = p.children;\n                else\n                    siblings = scope.treeData;\n                return siblings;\n            };\n            tree.get_next_sibling = function(b) {\n                var siblings = tree.get_siblings(b);\n                if (angular.isArray(siblings)) {\n                    var i = siblings.indexOf(b);\n                    if (i < siblings.length - 1)\n                        return siblings[i + 1];\n                }\n            };\n            tree.get_prev_sibling = function(b) {\n                var siblings = tree.get_siblings(b);\n                if (angular.isArray(siblings)) {\n                    var i = siblings.indexOf(b);\n                    if (i > 0) \n                        return siblings[i - 1];\n                }\n            };\n            tree.select_next_sibling = function(b) {\n                var next = tree.get_next_silbing(b);\n                if (next)\n                    tree.select_branch(next);\n            };\n            tree.select_prev_sibling = function(b) {\n                var prev = tree.get_prev_sibling(b);\n                if (prev)\n                    tree.select_branch(prev);\n            };\n            tree.get_first_child = function(b) {\n                if (!b)\n                    b = selected_branch;\n                if (b && b.children && b.children.length > 0)\n                    return b.children[0];\n            };\n            tree.get_closest_ancestor_next_sibling = function(b) {\n                var next = tree.get_next_sibling(b);\n                if (next)\n                    return next;\n                else {\n                    next = tree.get_parent_branch(b);\n                    return tree.get_closest_ancestor_next_sibling(next);\n                }\n            };\n            /**\n             * @ngdoc function\n             * @name mms.directives.directive:mmsTree#get_next_branch\n             * @methodOf mms.directives.directive:mmsTree\n             * \n             * @description \n             * self explanatory\n             *\n             * @param {Object} branch current branch\n             * @return {Object} next branch\n             */\n            tree.get_next_branch = function(b) {\n                if (!b)\n                    b = selected_branch;\n                if (b) {\n                    var next = tree.get_first_child(b);\n                    if (next)\n                        return next;\n                    else {\n                        next = tree.get_closest_ancestor_next_sibling(b);\n                        return next;\n                    }\n                }\n            };\n            /**\n             * @ngdoc function\n             * @name mms.directives.directive:mmsTree#select_next_branch\n             * @methodOf mms.directives.directive:mmsTree\n             * \n             * @description \n             * self explanatory\n             *\n             * @param {Object} branch current branch\n             */\n            tree.select_next_branch = function(b) {\n                var next = tree.get_next_branch(b);\n                if (next)\n                    tree.select_branch(next);\n            };\n            tree.last_descendant = function(b) {\n                if (b) {\n                    if (b.children.length === 0)\n                        return b;\n                    var last = b.children[b.children.length - 1];\n                    return tree.last_descendant(last);\n                }\n            };\n            /**\n             * @ngdoc function\n             * @name mms.directives.directive:mmsTree#get_prev_branch\n             * @methodOf mms.directives.directive:mmsTree\n             * \n             * @description \n             * self explanatory\n             *\n             * @param {Object} branch current branch\n             * @return {Object} previous branch\n             */\n            tree.get_prev_branch = function(b) {\n                var prev_sibling = tree.get_prev_sibling(b);\n                if (prev_sibling)\n                    return tree.last_descendant(prev_sibling);\n                return tree.get_parent_branch(b);\n            };\n            /**\n             * @ngdoc function\n             * @name mms.directives.directive:mmsTree#select_prev_branch\n             * @methodOf mms.directives.directive:mmsTree\n             * \n             * @description \n             * self explanatory\n             *\n             * @param {Object} branch current branch\n             */\n            tree.select_prev_branch = function(b) {\n                var prev = tree.get_prev_branch(b);\n                if (prev)\n                    tree.select_branch(prev);\n            };\n\n            /**\n             * @ngdoc function\n             * @name mms.directives.directive:mmsTree#refresh\n             * @methodOf mms.directives.directive:mmsTree\n             * \n             * @description \n             * rerender the tree when data or options change\n             */\n            tree.refresh = function() {\n                on_treeData_change();\n            };\n\n            tree.initialSelect = function() {\n                on_initialSelection_change();\n            };\n\n            tree.sort_branch = function(b, sortFunction) {\n                b.children.sort(sortFunction);\n            };\n\n            /**\n             * @ngdoc function\n             * @name mms.directives.directive:mmsTree#get_branch\n             * @methodOf mms.directives.directive:mmsTree\n             * \n             * @description \n             * Returns the branch with the specified data\n             */\n            tree.get_branch = function(data) {\n                var branch = null;\n                for_each_branch(function(b) {\n                    // if (angular.equals(b.data,data)) {\n                    //     branch = b;\n                    // }\n                    if (b.data.id === data.id) {\n                        branch = b;\n                    }\n                });\n                return branch;\n            };\n\n            tree.get_rows = function() {\n                return scope.tree_rows;\n            };\n\n            tree.user_clicks_branch = function(branch) {\n                return scope.user_clicks_branch(branch);\n            };\n\n        }\n\n        function getHref(row) {\n            var data = row.branch.data;\n            if (row.branch.type !== 'group' && UtilsService.isDocument(data) && !ApplicationService.getState().fullDoc) {\n                var ref = data._refId ? data._refId : 'master';\n                return UtilsService.PROJECT_URL_PREFIX + data._projectId + '/' + ref+ '/documents/' + data.id + '/views/' + data.id;\n            }\n        }\n    };\n\n    return {\n        restrict: 'E',\n        template: $templateCache.get('mms/templates/mmsTree.html'),\n        // replace: true,\n        scope: {\n            treeData: '<',\n            initialSelection: '@',\n            treeControl: '<',\n            options: '<'\n        },\n        link: mmsTreeLink\n    };\n}\n","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsTsDiagram', ['ElementService', '$templateCache', '$window', '$timeout', 'growl', 'ApplicationService', 'AuthService', 'URLService', mmsTsDiagram]);\n\n/**\n * @ngdoc directive\n * @name mms.directives.directive:mmsTsDiagram\n *\n * @requires mms.ElementService\n * @requires $templateCache\n * @requires $window\n * @requires growl\n * @requires ApplicationService\n * @requires AuthService\n *\n * @restrict E\n *\n * @description\n * //TODO - update\n *\n */\nfunction mmsTsDiagram(ElementService, $templateCache, $window, $timeout, growl, ApplicationService, AuthService, URLService) {\n    var importedTsJs = false;\n    var template = $templateCache.get('mms/templates/mmsTsDiagram.html');\n    var mapping = {};\n    // var deferreds = {};\n    var projectId2PeId = {};\n    var peId2projectId = {};\n    var projectIdLoaded = {};\n    var viewNameMapping = {\n        IBD: 'Internal Block Diagram',\n        BDD: 'Block Definition Diagram',\n        STM: 'State Machine',\n        ACT: 'Activity Diagram',\n        SD: 'Sequence Diagram',\n        PKG: 'Package Diagram',\n        PAR: 'Parametric Diagram',\n        REQ: 'Requirement Diagram',\n        UC: 'Use Case Diagram'\n    };\n    var controlMapping = {\n        IBD: 'IBD Controls',\n        BDD: 'BDD Controls',\n        STM: 'STM Controls',\n        ACT: 'ACT Controls',\n        SD: 'Controls',\n        PKG: 'PKG Controls',\n        PAR: 'PAR Controls',\n        REQ: 'REQ Controls',\n        UC: 'UC Controls'\n    };\n    var elementTableMapping = {\n        IBD: 'IBD Elements',\n        BDD: 'BDD Elements',\n        STM: 'STM Elements',\n        ACT: 'ACT Elements',\n        SD: 'Elements',\n        PKG: 'PKG Elements',\n        PAR: 'PAR Elements',\n        REQ: 'REQ Elements',\n        UC: 'UC Elements'\n    };\n    var relTableMapping = {\n        IBD: 'IBD Relationships',\n        BDD: 'BDD Relationships',\n        STM: 'STM Relationships',\n        ACT: 'ACT Relationships',\n        SD: 'Associations',\n        PKG: 'PKG Relationships',\n        PAR: 'PAR Relationships',\n        REQ: 'REQ Relationships',\n        UC: 'UC Relationships'\n    };\n    \n    $window.onPerspectivesCommandSuccess = function(successfulCommand) {\n        console.log(\"Perspectives command: \" + successfulCommand.command + \" completed successfully\");\n        $window.hidePerspectivesProgressIndicator();\n    };\n    $window.onPerspectivesCommandFailure = function(failedCommand, message, callstack) {\n        console.log(\"Perspectives command \" + failedCommand.commmand + \" failed. Reason is: \" + message);\n        $window.hidePerspectivesProgressIndicator();\n        console.log(callstack);\n    };\n    $window.onPerspectivesProjectLoad = function(projectID) {\n        console.log(\"All project UI elements should now be on the DOM for \" + projectID);\n    };\n    $window.onPerspectivesProjectReady = function(projectID) {\n        console.log(\"All project RPC calls are complete and you can now access all project resources via the DOM. \" + projectID);\n        if (!projectIdLoaded[projectID]) {\n            $window.showPerspectivesProgressIndicator();\n            $window.invokePerspectivesCommand(mapping[projectID]);\n            projectIdLoaded[projectID] = true;\n        }\n    };\n    $window.onPerspectivesViewLoaded = function(projectID, moduleName, modelID, viewID, viewName) {\n        console.log(\"The Perspectives view \" + viewID + \" is now on the DOM.\");\n    };\n    $window.onPerspectivesViewUpdated = function(projectID, moduleName, modelID, viewID, viewNamem, viewData) {\n        console.log(\"The Perspectives view\" + viewID + \" was udpdated with data \" + viewData);\n    };\n    $window.onPerspectivesViewCanvasRendered = function(projectID, moduleName, modelID, viewID, viewName) {\n        console.log(\"The Perspectives canvas for view\" + viewID + \" was rendered\");\n    };\n    $window.onPerspectivesMouseClickOnObject = function(data) {\n        if (data) {\n            console.log(\"JavaScript Callback = Mouse clicked on object with ID = \" + data.objectID);\n        }\n    };\n    $window.onPerspectivesMouseDoubleClickOnObject = function(data) {\n        if (data) {\n            console.log(\"JavaScript Callback = Mouse double clicked on object with ID = \" + data.objectID);\n        }\n    };\n    $window.PerspectivesErrorDialogHandler = function(message, callStackString) {\n        //prevent ts error dialog from appearing for any js exception\n        console.log(message);\n        console.log(callStackString);\n    };\n    //store global mapping of project name to hash, on*** functions can lookup the hash \n    var mmsTsDiagramLink = function(scope, element, attrs) {\n        if (!$window.invokePerspectivesCommand && !importedTsJs) {\n            $('body').append(\n            '<script type=\"text/javascript\" language=\"javascript\" src=\"/mms-ts/tsperspectives/tsperspectives.nocache.js\"></script>\\n' +\n            '<script type=\"text/javascript\" language=\"javascript\" src=\"/mms-ts/tsperspectives/dojo/dojo/dojo.js\"></script>\\n' +\n            '<script type=\"text/javascript\" language=\"javascript\" src=\"/mms-ts/tsperspectives/TSHovering.js\"></script>\\n' +\n            '<script type=\"text/javascript\" language=\"javascript\" src=\"/mms-ts/tsperspectives/TSButtonTooltip.js\"></script>');\n\n            importedTsJs = true;\n        }\n        var id = ApplicationService.createUniqueId();\n        if (peId2projectId[scope.mmsPeId]) {\n            id = peId2projectId[scope.mmsPeId];\n        } else {\n            peId2projectId[scope.mmsPeId] = id;\n        }\n        projectId2PeId[id] = scope.mmsPeId;\n\n        scope.containerId = \"tabContainer-\" + id;\n        scope.viewId = \"view-\" + id;\n        scope.tableId = \"table-\" + id;\n        scope.edgeTableId = \"edgeTable-\" + id;\n        scope.inspectorId = \"inspector-\" + id;\n        scope.controlsId = \"controls-\" + id;\n        scope.initElements = [];\n\n        var params = {\n            viewName: viewNameMapping[scope.mmsTspSpec.diagramType],\n            viewType: 'tsDrawingView',\n            tableName: elementTableMapping[scope.mmsTspSpec.diagramType],\n            edgeTableName: relTableMapping[scope.mmsTspSpec.diagramType],\n            inspectorName: 'Details',\n            controlsName: controlMapping[scope.mmsTspSpec.diagramType]\n        };\n\n        if (scope.mmsTspSpec && scope.mmsTspSpec.elements)\n            scope.initElements = scope.mmsTspSpec.elements;\n        if (scope.mmsTspSpec && scope.mmsTspSpec.context)\n            scope.context = scope.mmsTspSpec.context;\n\n        \n        var webProjectCommand = _createWebProjectCommand(scope, params, id);\n        mapping[id] = _createUpdateCommand(scope, params.viewName, id);\n        \n        function tryInvokeCommand() {\n            if (!$window.invokePerspectivesCommand) {\n                $timeout(tryInvokeCommand, 1000, false);\n            } else {\n                $window.invokePerspectivesCommand(webProjectCommand);\n            }\n        }\n        tryInvokeCommand();\n    };\n\n    function _getElementsArrayString(elements) {\n        return '[{\"id\": \"' + elements.join('\"}, {\"id\": \"') + '\"}]';\n    }\n\n    function _createWebProjectCommand(scope, params, id) {\n        var webProjectCommand = {\n            \"command\": \"WebProject\",\n            \"onload\": \"onPerspectivesProjectLoad\",\n            \"onready\": \"onPerspectivesProjectReady\", //quirk?\n            \"onfailure\": \"onPerspectivesCommandFailure\",\n            \"onsuccess\": \"onPerspectivesCommandSuccess\",\n            \"data\": [\n                {\n                    \"command\": \"LoadProject\",\n                    \"data\": {\n                        \"project\": id,\n                        \"filename\": \"project/MMS.tsp\"\n                    }\n                },\n                {\n                    \"command\": \"NewDefaultModel\",\n                    \"data\": {\n                        \"project\": id,\n                        \"module\": \"SysML\",\n                        \"modelID\": \"model-\" + id\n                    }\n                },\n                {\n                    \"command\": \"NewIntegrator\",\n                    \"data\": {\n                        \"project\": id,\n                        \"module\": \"SysML\",\n                        \"modelID\": \"model-\" + id,\n                        \"integratorName\": \"MMS ADD\",\n                        \"integratorID\": \"int-add-\" + id\n                    }\n                },\n                {\n                    \"command\": \"NewIntegrator\",\n                    \"data\": {\n                        \"project\": id,\n                        \"module\": \"SysML\",\n                        \"modelID\": \"model-\" + id,\n                        \"integratorName\": \"Filter Control Data\",\n                        \"integratorID\": \"int-fcd-\" + id,\n                        \"integratorFileLocation\": \"data/SysMLFilterDefaults.xlsx\"\n                    }\n                },\n                {\n                    \"command\": \"NewView\",\n                    \"data\": {\n                        \"project\": id,\n                        \"module\": \"SysML\",\n                        \"modelID\": \"model-\" + id,\n                        \"viewID\": \"view-\" + id,\n                        \"viewName\": params.viewName,\n                        \"viewClass\": params.viewType,\n                        \"onload\": \"onPerspectivesViewLoaded\",\n                        \"onupdate\": \"onPerspectivesViewUpdated\",\n                        \"oncanvasrendered\": \"onPerspectivesViewCanvasRendered\"\n                    }\n                },\n                {\n                    \"command\": \"NewView\",\n                    \"data\": {\n                        \"project\": id,\n                        \"module\": \"SysML\",\n                        \"modelID\": \"model-\" + id,\n                        \"viewID\": \"table-\" + id,\n                        \"viewName\": params.tableName,\n                        \"viewClass\": 'tsTableView',\n                        \"onload\": \"onPerspectivesViewLoaded\",\n                        \"onupdate\": \"onPerspectivesViewUpdated\",\n                        \"oncanvasrendered\": \"onPerspectivesViewCanvasRendered\"\n                        }\n                },\n                {\n                    \"command\": \"NewView\",\n                    \"data\": {\n                        \"project\": id,\n                        \"module\": \"SysML\",\n                        \"modelID\": \"model-\" + id,\n                        \"viewID\": \"edgeTable-\" + id,\n                        \"viewName\": params.edgeTableName,\n                        \"viewClass\": 'tsTableView',\n                        \"onload\": \"onPerspectivesViewLoaded\",\n                        \"onupdate\": \"onPerspectivesViewUpdated\",\n                        \"oncanvasrendered\": \"onPerspectivesViewCanvasRendered\"\n                        }\n                },\n                {\n                    \"command\": \"NewView\",\n                    \"data\": {\n                        \"project\": id,\n                        \"module\": \"SysML\",\n                        \"modelID\":\"model-\" + id,\n                        \"viewID\": \"\" + scope.inspectorId,\n                        \"viewName\": params.inspectorName,\n                        \"viewClass\": 'tsInspectorView',\n                        \"onload\": \"onPerspectivesViewLoaded\",\n                        \"onupdate\": \"onPerspectivesViewUpdated\",\n                        \"oncanvasrendered\": \"onPerspectivesViewCanvasRendered\"\n                        }\n                },\n                {\n                    \"command\": \"NewView\",\n                    \"data\": {\n                        \"project\": id,\n                        \"module\": \"SysML\",\n                        \"modelID\":\"model-\" + id,\n                        \"viewID\": \"\" + scope.controlsId,\n                        \"viewName\": params.controlsName,\n                        \"viewClass\": 'tsTreeView',\n                        \"onload\": \"onPerspectivesViewLoaded\",\n                        \"onupdate\": \"onPerspectivesViewUpdated\",\n                        \"oncanvasrendered\": \"onPerspectivesViewCanvasRendered\"\n                        }\n                },\n                {\n                    \"command\": \"NewTabPanel\",\n                    \"data\": {\n                        \"project\": id,\n                        \"module\": \"SysML\",\n                        \"modelID\": \"model-\" + id,\n                        \"id\": \"tabContainer-\" + id,\n                        \"widgetIDs\": [scope.viewId, scope.tableId, scope.edgeTableId,\n                         scope.inspectorId, scope.controlsId]\n                    }\n                }\n                \n            ]\n        };\n        return webProjectCommand;\n    }\n\n    function _createUpdateCommand(scope, viewName, id) {\n        var updateCommand = {\n            \"command\": \"Group\",\n            \"onsuccess\": \"onPerspectivesCommandSuccess\",\n            \"data\": [\n                {\n                    \"command\": \"Custom\",\n                    \"data\": {\n                        \"serverClassName\": \"gov.nasa.jpl.mbee.ems.action.SetMmsRestBaseUrlCommandImpl\",\n                        \"args\": [\"int-add-\" + id, URLService.getMmsServer() + URLService.getRoot()],\n                        \"modelID\": 'model-' + id,\n                        \"module\": \"SysML\",\n                        \"project\": id,\n                        \"viewID\": \"view-\" + id,\n                        \"viewName\": viewName\n                    }\n                }, \n                {\n                    \"command\": \"SetModelAttribute\",\n                    \"data\": {\n                        \"attributeName\": \"Ticket\",\n                        \"attributeValue\": AuthService.getTicket(),\n                        \"modelID\": 'model-' + id,\n                        \"module\": \"SysML\",\n                        \"project\": id,\n                        \"viewID\": \"view-\" + id,\n                        \"viewName\": viewName\n                    },\n                    \"onfailure\": \"onPerspectivesCommandFailure\",\n                },\n                {\n                    \"command\": \"SetModelAttribute\",\n                    \"data\": {\n                        \"attributeName\": \"MMSRefId\",\n                        \"attributeValue\": scope.mmsRefId,\n                        \"modelID\": 'model-' + id,\n                        \"module\": \"SysML\",\n                        \"project\": id,\n                        \"viewID\": \"view-\" + id,\n                        \"viewName\": viewName\n                    },\n                    \"onfailure\": \"onPerspectivesCommandFailure\",\n                },\n                {\n                    \"command\": \"SetModelAttribute\",\n                    \"data\": {\n                        \"attributeName\": \"MMSProjectId\",\n                        \"attributeValue\": scope.mmsProjectId,\n                        \"modelID\": 'model-' + id,\n                        \"module\": \"SysML\",\n                        \"project\": id,\n                        \"viewID\": \"view-\" + id,\n                        \"viewName\": viewName\n                    },\n                    \"onfailure\": \"onPerspectivesCommandFailure\",\n                }\n            ]\n        };\n        if (scope.context || (scope.initElements.length > 0)) {\n            var initialIntegratorIds = [];\n            if (scope.initElements.length > 0) {\n                updateCommand.data.push({\n                    \"command\": \"SetModelAttribute\",\n                    \"data\": {\n                        \"attributeName\": \"AddElements\",\n                        \"attributeValue\": _getElementsArrayString(scope.initElements),\n                        \"modelID\": 'model-' + id,\n                        \"module\": \"SysML\",\n                        \"project\": id,\n                        \"viewID\": \"view-\" + id,\n                        \"viewName\": viewName\n                    },\n                    \"onfailure\":\"onPerspectivesCommandFailure\",\n                });\n                initialIntegratorIds.push('int-add-' + id);\n            }\n            initialIntegratorIds.push('int-fcd-' + id);\n            updateCommand.data.push({\n                \"command\": \"Update\",\n                \"onsuccess\": \"onPerspectivesCommandSuccess\",\n                \"onfailure\": \"onPerspectivesCommandFailure\",\n                \"data\": {\n                    \"project\": id,\n                    \"module\": \"SysML\",\n                    \"integratorIDs\": initialIntegratorIds\n                }\n            });\n            if (scope.context) {\n                updateCommand.data.push({\n                    \"command\": \"Custom\",\n                            \"data\": {\n                                \"project\": id,\n                                \"module\": \"SysML\",\n                                \"modelID\": 'model-' + id,\n                                \"serverClassName\": \"gov.nasa.jpl.mbee.ems.command.NewContextCommand\",\n                                \"viewID\": \"view-\" + id,\n                                \"viewName\": viewName,\n                                \"args\": [\"\" + scope.context]\n                            },\n                    \"onfailure\": \"onPerspectivesCommandFailure\",\n                });\n            }\n        }\n        return updateCommand;\n    }\n\n    return {\n        restrict: 'E',\n        template: template,\n        scope: {\n            mmsProjectId: '@',\n            mmsRefId: '@',\n            mmsTspSpec: '<',\n            mmsPeId: '@'\n        },\n        link: mmsTsDiagramLink\n    };\n}","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsValueLink', ['ElementService', mmsValueLink]);\n\n/**\n * @ngdoc directive\n * @name mms.directives.directive:mmsValueLink\n *\n * @requires mms.ElementService\n *\n * @restrict E\n *\n * @description\n * Given an element id, generates a hyperlink with a cross-reference value\n *\n * @param {string} mmsElementId The id of the view\n * @param {string} mmsProjectId The project id for the view\n * @param {string=master} mmsRefId Reference to use, defaults to master\n * @param {string=latest} mmsCommitId Commit ID, default is latest\n * @param {string} mmsErrorText Text to display when element is not found\n * @param {string} mmsLinkText Text to display for hyperlink\n */\nfunction mmsValueLink(ElementService, $compile, growl) {\n\n    var mmsValueLinkLink = function(scope, element, attrs, controllers) {\n        var mmsCfCtrl = controllers[0];\n        var mmsViewCtrl = controllers[1];\n        var projectId = scope.mmsProjectId;\n        var refId = scope.mmsRefId;\n        var commitId = scope.mmsCommitId;\n        if (mmsCfCtrl) {\n            var cfVersion = mmsCfCtrl.getElementOrigin();\n            if (!projectId)\n                projectId = cfVersion.projectId;\n            if (!refId)\n                refId = cfVersion.refId;\n            if (!commitId)\n                commitId = cfVersion.commitId;\n        }\n        if (mmsViewCtrl) {\n            var viewVersion = mmsViewCtrl.getElementOrigin();\n            if (!projectId)\n                projectId = viewVersion.projectId;\n            if (!refId)\n                refId = viewVersion.refId;\n            if (!commitId)\n                commitId = viewVersion.commitId;\n        }\n        if (!projectId) {\n            return;\n        }\n        scope.projectId = projectId;\n        scope.refId = refId ? refId : 'master';\n        scope.commitId = commitId ? commitId : 'latest';\n        var reqOb = {elementId: scope.mmsElementId, projectId: scope.projectId, refId: scope.refId, commitId: scope.commitId};\n\n        ElementService.getElement(reqOb)\n        .then(function(data) {\n            if (data.type === 'Property') {\n                var value = data.defaultValue;\n                if (value && value.type === 'LiteralString')\n                    scope.url = value.value;\n            } else if (data.type === 'Slot') {\n                if (angular.isArray(data.value) && data.value.length > 0 && data.value[0].type === 'LiteralString') {\n                    scope.url = data.value[0].value;\n                }\n            } else {\n                if (scope.mmsErrorText){\n                    element.html('<span class=\"mms-error\">'+ scope.mmsErrorText +'</span>');\n                } else {\n                    if (scope.mmsErrorText){\n                        element.html('<span>'+ scope.mmsErrorText +'</span>');\n                    } else {\n                        element.html('<span class=\"mms-error\">Element does not provide link value.</span>');\n                    }\n                }\n            }\n        }, function(reason) {\n            element.html('<span class=\"mms-error\">Element was not found.</span>');\n        });\n    };\n\n    return {\n        restrict: 'E',\n        scope: {\n            mmsElementId: '@',\n            mmsProjectId: '@',\n            mmsRefId: '@',\n            mmsCommitId: '@',\n            mmsErrorText: '@',\n            mmsLinkText: '@',\n        },\n        require: ['?^^mmsCf', '?^^mmsView'],\n        template: '<a ng-href=\"{{url}}\">{{mmsLinkText}}</a>',\n        link: mmsValueLinkLink\n    };\n}","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsView', ['Utils', 'ViewService', 'ElementService', '$templateCache', 'growl', mmsView]);\n\n/**\n * @ngdoc directive\n * @name mms.directives.directive:mmsView\n *\n * @requires mms.ViewService\n * @requires mms.ElementService\n * @requires $templateCache\n * @requires growl\n *\n * @restrict E\n *\n * @description\n * Given a view id, renders the view according to the json given by mms.ViewService\n * The view has a text edit mode, where transclusions can be clicked. The view's last\n * modified time and author is the latest of any transcluded element modified time.\n * For available api methods, see methods section.\n *\n * ## Example\n * ### controller (js)\n *  <pre>\n    angular.module('app', ['mms.directives'])\n    .controller('ViewCtrl', ['$scope', function($scope) {\n        $scope.api = {}; //empty object to be populated by the view directive\n        $scope.handler = function(elementId) {\n            //element with elementId clicked in view\n        };\n        $scope.showComments = function() {\n            $scope.api.setShowComments(true);\n        };\n    }]);\n    </pre>\n * ### template (html)\n *  <pre>\n    <div ng-controller=\"ViewCtrl\">\n        <button ng-click=\"showComments()\">Show Comments</button>\n        <mms-view mms-element-id=\"view_element_id\" mms-project-id=\"view_project_id\" mms-cf-clicked=\"handler(elementId)\" mms-view-api=\"api\"></mms-view>\n    </div>\n    </pre>\n * ## Example view at a certain commit\n *  <pre>\n    <mms-view mms-element-id=\"view_element_id\" mms-project-id=\"view_project_id\" mms-commit-id=\"COMMIT_ID_HASH\"></mms-view>\n    </pre>\n *\n * @param {string} mmsElementId The id of the view\n * @param {string} mmsProjectId The project id for the view\n * @param {string=master} mmsRefId Reference to use, defaults to master\n * @param {string=latest} mmsCommitId Commit ID, default is latest\n * @param {expression=} mmsCfClicked The expression to handle transcluded elements in the\n *              view being clicked, this should be a function whose argument is 'elementId'\n */\n\nfunction mmsView(Utils, ViewService, ElementService, $templateCache, growl) {\n    var template = $templateCache.get('mms/templates/mmsView.html');\n\n    var mmsViewCtrl = function($scope) {\n        $scope.presentationElemCleanUpFncs = [];\n\n        this.isTranscludedElement = function(elementName) {\n            if (elementName === 'MMS-TRANSCLUDE-COM' ||\n                elementName === 'MMS-TRANSCLUDE-DOC' ||\n                elementName === 'MMS-TRANSCLUDE-IMG' ||\n                elementName === 'MMS-TRANSCLUDE-NAME' ||\n                elementName === 'MMS-TRANSCLUDE-VAL') {\n                return true;\n            }\n            return false;\n        };\n\n        this.isViewElement = function(elementName) {\n            if (elementName === 'MMS-VIEW-IMG' ||\n                elementName === 'MMS-VIEW-LIST' ||\n                elementName === 'MMS-VIEW-PARA' ||\n                elementName === 'MMS-VIEW-TABLE' ||\n                elementName === 'MMS-VIEW-TABLE-T' ||\n                elementName === 'MMS-VIEW-LIST-T' ||\n                elementName === 'MMS-VIEW-EQUATION') {\n                return true;\n            }\n            return false;\n        };\n\n        this.isPresentationElement = function(elementName) {\n            if (elementName === 'MMS-VIEW-PRESENTATION-ELEM') {\n                return true;\n            }\n            return false;\n        };\n\n        this.isEditable = function() {\n            return $scope.showEdits;\n        };\n\n        this.transcludeClicked = function(elementOb) {\n            if ($scope.mmsViewApi && $scope.mmsViewApi.elementClicked && elementOb)\n                $scope.mmsViewApi.elementClicked(elementOb);\n        };\n\n        this.elementTranscluded = function(elem, type) {\n            if (elem) {\n                if (elem._modified > $scope.modified && type !== 'Comment') {\n                    $scope.modified = elem._modified;\n                    if (elem._modifier)\n                        $scope.modifier = elem._modifier;\n                }\n                if ($scope.mmsViewApi && $scope.mmsViewApi.elementTranscluded)\n                    $scope.mmsViewApi.elementTranscluded(elem, type);\n            }\n        };\n\n        //INFO this was getWsAndVersion\n        this.getElementOrigin = function() {\n            return {\n                projectId: $scope.mmsProjectId,\n                refId: $scope.mmsRefId,\n                commitId: $scope.mmsCommitId\n            };\n        };\n\n        this.getView = function() {\n            // scope view gets set in the viewlink fnc\n            return $scope.view;\n        };\n\n        $scope.hoverIn = function() {\n            $scope.isHover = true;\n        };\n        $scope.hoverOut = function() {\n            $scope.isHover = false;\n        };\n    };\n\n    var mmsViewLink = function(scope, element, attrs) {\n        // Build request object\n        var reqOb = {elementId: scope.mmsElementId, projectId: scope.mmsProjectId, refId: scope.mmsRefId, commitId: scope.mmsCommitId};\n        var processed = false;\n        scope.setPeLineVisibility = function($event) {\n            window.setTimeout(function() {\n                var peContainer = $($event.currentTarget).closest('.add-pe-button-container');\n                if (peContainer.find('.dropdown-menu').css('display') == 'none') {\n                    peContainer.find('hr').css('visibility', 'hidden');\n                } else {\n                    peContainer.find('hr').css('visibility', 'visible');\n                }\n            });\n        };\n        scope.isSection = false;\n        var changeView = function(newVal, oldVal) {\n            if (!newVal || (newVal === oldVal && processed))\n                return;\n            processed = true;\n            element.addClass('isLoading');\n            ElementService.getElement(reqOb, 1)\n            .then(function(data) {\n                //view accepts a section element\n                if (data.type === 'InstanceSpecification') {\n                    scope.isSection = true;\n                }\n                var operand = [];\n                if (data._contents && data._contents.operand) {\n                    operand = data._contents.operand;\n                }\n                if (data.specification && data.specification.operand) {\n                    operand = data.specification.operand;\n                }\n                var dups = Utils.checkForDuplicateInstances(operand);\n                if (dups.length > 0) {\n                    growl.warning(\"There are duplicates in this view, dupilcates ignored!\");\n                }\n                if (data._veNumber) {\n                    scope.level = data._veNumber.split('.').length;\n                }\n                if (//data._numElements && data._numElements > 5000 &&\n                        scope.mmsCommitId && scope.mmsCommitId !== 'latest') {\n                    //threshold where getting view elements in bulk takes too long and it's not latest\n                    //getting cached individual elements should be faster\n                    scope.view = data;\n                    scope.modified = data._modified;\n                    scope.modifier = data._modifier;\n                    return;\n                }\n                ViewService.getViewElements(reqOb, 1)\n                .finally(function() {\n                    scope.view = data;\n                    scope.modified = data._modified;\n                    scope.modifier = data._modifier;\n                    element.removeClass('isLoading');\n                });\n            }, function(reason) {\n                growl.error('Getting View Error: ' + reason.message + ': ' + scope.mmsElementId);\n            }).finally(function() {\n                if (scope.view)\n                    element.removeClass('isLoading');\n            });\n        };\n        scope.$watch('mmsElementId', changeView);\n        scope.showElements = false;\n        scope.showComments = false;\n        scope.showEdits = false;\n\n\n        /**\n         * @ngdoc function\n         * @name mms.directives.directive:mmsView#addEltAction\n         * @methodOf mms.directives.directive:mmsView\n         *\n         * @description\n         * Add specified element at the defined 'index'\n         */\n        scope.addEltAction = function (index, type) {\n            if (!scope.showEdits) {\n                return;\n            }\n            scope.addPeIndex = index;\n            Utils.addPresentationElement(scope, type, scope.view);\n        };\n\n        /**\n         * @ngdoc function\n         * @name mms.directives.directive:mmsView#toggleShowElements\n         * @methodOf mms.directives.directive:mmsView\n         *\n         * @description\n         * toggle elements highlighting\n         */\n        scope.toggleShowElements = function() {\n            scope.showElements = !scope.showElements;\n            element.toggleClass('outline');\n        };\n\n        /**\n         * @ngdoc function\n         * @name mms.directives.directive:mmsView#toggleShowComments\n         * @methodOf mms.directives.directive:mmsView\n         *\n         * @description\n         * toggle comments visibility\n         */\n        scope.toggleShowComments = function() {\n            scope.showComments = !scope.showComments;\n            element.toggleClass('reviewing');\n        };\n\n        /**\n         * @ngdoc function\n         * @name mms.directives.directive:mmsView#toggleShowEdits\n         * @methodOf mms.directives.directive:mmsView\n         *\n         * @description\n         * toggle elements editing panel\n         */\n        scope.toggleShowEdits = function() {\n            scope.showEdits = !scope.showEdits;\n            element.toggleClass('editing');\n            // Call the callback functions to clean up frames, show edits, and\n            // re-open frames when needed:\n            for (var i = 0; i < scope.presentationElemCleanUpFncs.length; i++) {\n                scope.presentationElemCleanUpFncs[i]();\n            }\n        };\n\n        if (angular.isObject(scope.mmsViewApi)) {\n            var api = scope.mmsViewApi;\n            api.toggleShowElements = scope.toggleShowElements;\n            api.toggleShowEdits = scope.toggleShowEdits;\n            api.toggleShowComments = scope.toggleShowComments;\n\n            /**\n             * @ngdoc function\n             * @name mms.directives.directive:mmsView#setShowElements\n             * @methodOf mms.directives.directive:mmsView\n             *\n             * @description\n             * self explanatory\n             *\n             * @param {boolean} mode arg\n             */\n            api.setShowElements = function(mode) {\n                scope.showElements = mode;\n                if (mode)\n                    element.addClass('outline');\n                else\n                    element.removeClass('outline');\n            };\n\n            /**\n             * @ngdoc function\n             * @name mms.directives.directive:mmsView#setShowComments\n             * @methodOf mms.directives.directive:mmsView\n             *\n             * @description\n             * self explanatory\n             *\n             * @param {boolean} mode arg\n             */\n            api.setShowComments = function(mode) {\n                scope.showComments = mode;\n                if (mode)\n                    element.addClass('reviewing');\n                else\n                    element.removeClass('reviewing');\n            };\n\n            api.changeView = function(vid) {\n                scope.changeView(vid);\n            };\n\n            if (api.init) {\n                api.init(api);\n            }\n        }\n    };\n\n    return {\n        restrict: 'E',\n        template: template,\n        scope: {\n            mmsElementId: '@',\n            mmsProjectId: '@',\n            mmsRefId: '@',\n            mmsCommitId: '@',\n            mmsLink: '<',\n            mmsViewApi: '<'\n        },\n        controller: ['$scope', mmsViewCtrl],\n        link: mmsViewLink\n    };\n}","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsViewEquation', [mmsViewEquation]);\n\nfunction mmsViewEquation() {\n\n    return {\n        restrict: 'E',\n        template: '<mms-cf mms-cf-type=\"doc\" mms-element-id=\"{{para.source}}\"></mms-cf>',\n        scope: {\n            para: '<mmsPara'\n        }\n    };\n}","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsViewFigure', [mmsViewFigure]);\n\nfunction mmsViewFigure() {\n\n    return {\n        restrict: 'E',\n        template: '<mms-cf mms-cf-type=\"doc\" mms-element-id=\"{{para.source}}\"></mms-cf>',\n        scope: {\n            para: '<mmsPara'\n        }\n    };\n}","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsViewImg', [mmsViewImg]);\n\nfunction mmsViewImg() {\n    var template = '<figure><mms-cf mms-cf-type=\"img\" mms-element-id=\"{{image.id}}\"></mms-cf><figcaption><span ng-if=\"!image.excludeFromList\">Figure {{mmsPe._veNumber}}. </span>{{image.title || mmsPe.name}}</figcaption></figure>';\n    return {\n        restrict: 'E',\n        template: template,\n        scope: {\n            image: '<mmsImage',\n            mmsPe: '<'\n        },\n        link: function(scope, element, attrs) {\n        }\n    };\n}","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsViewLink', ['ElementService', 'UtilsService', '$compile', 'growl', 'ViewService', 'ApplicationService', mmsViewLink]);\n\n/**\n * @ngdoc directive\n * @name mms.directives.directive:mmsViewLink\n *\n * @requires mms.ElementService\n * @requires $compile\n *\n * @restrict E\n *\n * @description\n * Given a view id and optional document id, creates a html link\n *\n * @param {string} mmsElementId The id of the view\n * @param {string} mmsProjectId The project id for the view\n * @param {string=master} mmsRefId Reference to use, defaults to master\n * @param {string=latest} mmsCommitId Commit ID, default is latest\n * @param {string} mmsDocId Document context of view\n * @param {string} mmsPeId Document context of view\n */\nfunction mmsViewLink(ElementService, UtilsService, $compile, growl, ViewService, ApplicationService) {\n\n    var mmsViewLinkLink = function(scope, element, attrs, controllers) {\n        var mmsCfCtrl = controllers[0];\n        var mmsViewCtrl = controllers[1];\n        var processed = false;\n        scope.loading = true;\n        scope.target = scope.linkTarget ? scope.linkTarget : '_self';\n        scope.$watch('mmsElementId', function(newVal, oldVal) {\n            if (!newVal || (newVal === oldVal && processed))\n                return;\n            processed = true;\n\n            var projectId = scope.mmsProjectId;\n            var refId = scope.mmsRefId;\n            var commitId = scope.mmsCommitId;\n            var docid = scope.mmsDocId;\n            if (mmsCfCtrl) {\n                var cfVersion = mmsCfCtrl.getElementOrigin();\n                if (!projectId)\n                    projectId = cfVersion.projectId;\n                if (!refId)\n                    refId = cfVersion.refId;\n                if (!commitId)\n                    commitId = cfVersion.commitId;\n            }\n            if (mmsViewCtrl) {\n                var viewVersion = mmsViewCtrl.getElementOrigin();\n                if (!projectId)\n                    projectId = viewVersion.projectId;\n                if (!refId)\n                    refId = viewVersion.refId;\n                if (!commitId)\n                    commitId = viewVersion.commitId;\n            }\n            if (!projectId) {\n                return;\n            }\n            scope.projectId = projectId;\n            scope.refId = refId ? refId : 'master';\n            scope.commitId = commitId ? commitId : 'latest';\n            var id = scope.mmsElementId;\n            if (id) {\n                id = id.replace(/[^\\w\\-]/gi, '');\n            } else if (scope.mmsPeId && !scope.mmsDocId) {\n                id = ApplicationService.getState().currentDoc;\n            }\n\n            var reqOb = {elementId: id, projectId: projectId, refId: refId, commitId: commitId, includeRecentVersionElement: true};\n            ElementService.getElement(reqOb, 1)\n            .then(function(data) {\n                scope.element = data;\n                scope.name = data.name;\n                scope.type = 'Section ';\n                scope.suffix = '';\n                scope.hash = '#' + data.id;\n                if (scope.mmsPeId && scope.mmsPeId !== '') {\n                    var reqPEOb = {elementId: scope.mmsPeId, projectId: projectId, refId: refId, commitId: commitId};\n                    ElementService.getElement(reqPEOb)\n                    .then(function(pe) {\n                        scope.hash = '#' + pe.id;\n                        scope.element = pe;\n                        scope.name = pe.name;\n                        if (ViewService.isTable(pe)) {\n                            scope.type = 'Table ';\n                        } else if (ViewService.isFigure(pe)) {\n                            scope.type = \"Fig. \";\n                        } else if (ViewService.isEquation(pe)) {\n                            scope.type = \"Eq. (\";\n                            scope.suffix = ')';\n                        }\n                        if (ApplicationService.getState().fullDoc) {\n                            scope.href = UtilsService.PROJECT_URL_PREFIX + scope.projectId + '/' + scope.refId + '/documents/' + scope.docid + \"/full\" + scope.hash;\n                        } else {\n                            scope.href = UtilsService.PROJECT_URL_PREFIX + scope.projectId + '/' + scope.refId + '/documents/' + scope.docid + '/views/' + scope.vid + scope.hash;\n                        }\n                    });\n                }\n                if (UtilsService.isDocument(data)) {\n                    docid = data.id;\n                    scope.docid = docid;\n                    scope.vid = data.id;\n                } else if (UtilsService.isView(data) || data.type === 'InstanceSpecification') {\n                    if (!docid || docid === '') {\n                        docid = data.id;\n                    }\n                    scope.docid = docid;\n                    scope.vid = data.id;\n                } else {\n                    element.html(\"<span class=\\\"mms-error\\\">view link doesn't refer to a view</span>\");\n                }\n                scope.loading = false;\n                if (ApplicationService.getState().fullDoc) {\n                    scope.href = UtilsService.PROJECT_URL_PREFIX + scope.projectId + '/' + scope.refId + '/documents/' + scope.docid + '/full' + scope.hash;\n                } else {\n                    scope.href = UtilsService.PROJECT_URL_PREFIX + scope.projectId + '/' + scope.refId + '/documents/' + scope.docid + '/views/' + scope.vid;\n                }\n                scope.change = ApplicationService.getState().inDoc && (ApplicationService.getState().currentDoc == scope.docid) && !scope.suppressNumbering;\n            }, function(reason) {\n                element.html('<span mms-annotation mms-req-ob=\"::reqOb\" mms-recent-element=\"::recentElement\" mms-type=\"::type\"></span>');\n                $compile(element.contents())(Object.assign(scope.$new(), {\n                    reqOb: reqOb,\n                    recentElement: reason.data.recentVersionOfElement,\n                    type: ViewService.AnnotationType.mmsViewLink\n                }));\n                scope.loading = false;\n            });\n        });\n    };\n\n    return {\n        restrict: 'E',\n        scope: {\n            mmsElementId: '@',\n            mmsProjectId: '@',\n            mmsRefId: '@',\n            mmsCommitId: '@',\n            mmsDocId: '@',\n            mmsPeId: '@',\n            linkText: '@?',\n            linkClass: '@?',\n            linkIconClass: '@?',\n            linkTarget: '@?',\n            mmsExternalLink: '<?',\n            suppressNumbering: '<'\n        },\n        require: ['?^^mmsCf', '?^^mmsView'],\n        template: '<span ng-if=\"!loading\"><a target=\"{{target}}\" ng-class=\"linkClass\" ng-href=\"{{href}}\"><i ng-class=\"linkIconClass\" aria-hidden=\"true\"></i><span ng-if=\"linkText\">{{linkText}}</span><span ng-if=\"!linkText && change\">{{type}}{{element._veNumber}}{{suffix}}</span><span ng-if=\"!linkText && !change\">{{name || \"Unnamed View\"}}</span></a>' +\n        '<a class=\"external-link no-print\" target=\"_blank\" ng-href=\"{{href}}\" ng-if=\"mmsExternalLink\"><i class=\"fa fa-external-link ve-secondary-text pull-right\" aria-hidden=\"true\" title=\"Open document in new tab\"></i></a></span>',\n        link: mmsViewLinkLink\n    };\n}\n","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsViewList', ['$compile', 'UtilsService', 'Utils', mmsViewList]);\n\nfunction mmsViewList($compile, UtilsService, Utils) {\n\n    return {\n        restrict: 'E',\n        scope: {\n            list: '<mmsList'\n        },\n        link: function(scope, element, attrs) {\n            var html = UtilsService.makeHtmlList(scope.list);\n            element[0].innerHTML = html;\n            $(element[0]).find('img').each(function(index) {\n                Utils.fixImgSrc($(this));\n            });\n            $compile(element.contents())(scope);\n            return;\n        }\n    };\n}","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsViewListT', [mmsViewListT]);\n\nfunction mmsViewListT() {\n\n    return {\n        restrict: 'E',\n        template: '<mms-cf mms-cf-type=\"doc\" mms-element-id=\"{{para.source}}\"></mms-cf>',\n        scope: {\n            para: '<mmsPara'\n        }\n    };\n}","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsViewPara', ['$compile', 'UtilsService', 'Utils', mmsViewPara]);\n\nfunction mmsViewPara($compile, UtilsService, Utils) {\n\n    var mmsViewParaLink = function(scope, element, attrs) {\n        var html = UtilsService.makeHtmlPara(scope.para);\n        element[0].innerHTML = html;\n        $(element[0]).find('img').each(function(index) {\n            Utils.fixImgSrc($(this));\n        });\n        $compile(element.contents())(scope);\n        return;\n    };\n\n    return {\n        restrict: 'E',\n        scope: {\n            para: '<mmsPara'\n        },\n        link: mmsViewParaLink\n    };\n}","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsViewPlot', ['$compile','$window', mmsViewPlot]);\n\nfunction mmsViewPlot($compile, $window) {\n    var mmsViewLink = function(scope, domElement, element, attrs, mmsViewCtrl) {\n        if ( scope.plot.type === \"Plot\") {\n            if ( scope.plot.config !== undefined  && scope.plot.config.trim().length !== 0){\n                try{\n                    scope.plot.config = JSON.parse(scope.plot.config.replace(/'/g, '\"'));\n                    if( scope.plot.config.ptype !== undefined) {\n                        scope.plot.ptype = scope.plot.config.ptype;\n                    }\n                }\n                catch (err){\n                   console.log(\"error ignored\"); \n                }\n            }\n            domElement[0].innerHTML = '<figure><mms-' + scope.plot.ptype + '-plot plot=\"plot\"></mms-' + scope.plot.ptype + '-plot><figcaption>{{plot.title}}</figcaption></figure>';\n            $compile(domElement.contents())(scope);\n        }\n    };\n    return {\n        restrict: 'E',\n        require: '?^mmsView',\n        scope: {\n            plot: '<mmsPlot'\n        },\n        link: mmsViewLink\n    };\n}","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsViewPresentationElem', ['ViewService', 'ElementService', '$templateCache', '$timeout', '$location',\n    '$anchorScroll', '$compile', mmsViewPresentationElem]);\n\n/**\n * @ngdoc directive\n * @name mms.directives.directive:mmsViewPresentationElem\n *\n * @requires mms.ViewService\n * @requires mms.ElementService\n * @requires $templateCache\n * @requires $location\n * @requires $timeout\n * @requires $rootScope\n * @requires $anchorScroll\n * @requires growl\n *\n *\n * @restrict E\n *\n * @description\n * Given a InstanceVal, parses the element reference tree to get the corresponding\n * presentation element, and renders it in the view\n * \n * @param {Object} mmsInstanceVal A InstanceValue json object \n * @param {Object} mmsParentSection the parent section if available\n */\nfunction mmsViewPresentationElem(ViewService, ElementService, $templateCache, $timeout, $location, $anchorScroll, $compile) {\n    var template = $templateCache.get('mms/templates/mmsViewPresentationElem.html');\n\n    var mmsViewPresentationElemCtrl = function($scope) {\n        \n        $scope.presentationElemLoading = true;\n        this.getInstanceSpec = function() {\n            return $scope.instanceSpec;\n        };\n\n        this.getInstanceVal = function() {\n            return $scope.mmsInstanceVal;\n        };\n\n        this.getPresentationElement = function() {\n            return $scope.presentationElem;\n        };\n\n        this.getParentSection = function() {\n            return $scope.mmsParentSection;\n        };\n    };\n\n    var mmsViewPresentationElemLink = function(scope, element, attrs, mmsViewCtrl) {\n        if (scope.mmsInstanceVal) {\n            if (!scope.mmsInstanceVal.instanceId) {\n                element.html('<span class=\"mms-error\">Reference is null</span>');\n                return;\n            }\n            var projectId = null;\n            var refId = null;\n            var commitId = null;\n            if (mmsViewCtrl) {\n                var viewVersion = mmsViewCtrl.getElementOrigin();\n                projectId = viewVersion.projectId;\n                refId = viewVersion.refId;\n                commitId = viewVersion.commitId;\n            }\n            // Parse the element reference tree for the presentation element:\n            element.addClass(\"isLoading\");\n            var reqOb = {elementId: scope.mmsInstanceVal.instanceId, projectId: projectId, refId: refId, commitId: commitId, includeRecentVersionElement: true};\n            ElementService.getElement(reqOb, 1)\n            .then(function(instanceSpec) {\n                scope.presentationElem = ViewService.getPresentationElementSpec(instanceSpec);\n                scope.instanceSpec = instanceSpec;\n                scope.presentationElemLoading = false;\n                var hash = $location.hash();\n                if (hash === instanceSpec.id) {\n                    $timeout(function() {\n                        $anchorScroll();\n                    }, 1000, false);\n                }\n                if (mmsViewCtrl) {\n                    mmsViewCtrl.elementTranscluded(instanceSpec);\n                }\n                element.click(function(e) {\n                    if (mmsViewCtrl)\n                        mmsViewCtrl.transcludeClicked(instanceSpec);\n                    e.stopPropagation();\n                });\n            }, function(reason) {\n                if (reason.status === 500) {\n                    element.html('<span class=\"mms-error\">View element reference error: ' + scope.mmsInstanceVal.instanceId + ' invalid specification</span>');\n                } else {\n                    element.html('<span mms-annotation mms-req-ob=\"::reqOb\" mms-recent-element=\"::recentElement\" mms-type=\"::type\"></span>');\n                    $compile(element.contents())(Object.assign(scope.$new(), {\n                        reqOb: reqOb,\n                        recentElement: reason.data.recentVersionOfElement,\n                        type: ViewService.AnnotationType.mmsPresentationElement\n                    }));\n                }\n            }).finally(function() {\n                element.removeClass(\"isLoading\");\n            }); \n        } \n    };\n\n    return {\n        restrict: 'E',\n        template: template,\n        require: '?^^mmsView',\n        scope: {\n            mmsInstanceVal: '<',\n            mmsParentSection: '<',\n        },\n        controller: ['$scope', mmsViewPresentationElemCtrl],\n        link: mmsViewPresentationElemLink\n    };\n}","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsViewReorder', ['ElementService', 'ViewService', '$templateCache', 'growl', '$q', '_', mmsViewReorder]);\n\n/**\n * @ngdoc directive\n * @name mms.directives.directive:mmsViewReorder\n *\n * @requires mms.ViewService\n * @requires $templateCache\n *\n * @restrict E\n *\n * @description\n * Visualize and edit the structure of a view \n *\n * @param {string} mmsElementId The id of the view\n * @param {string} mmsProjectId The project id for the view\n * @param {string=master} mmsRefId Reference to use, defaults to master\n * @param {string=latest} mmsCommitId Commit ID, default is latest\n */\nfunction mmsViewReorder(ElementService, ViewService, $templateCache, growl, $q, _) {\n    var template = $templateCache.get('mms/templates/mmsViewReorder.html');\n\n    var mmsViewReorderCtrl = function($scope, ViewService) {\n        this.getEditing = function() {\n            return $scope.editing;\n        };\n        $scope.treeOptions = {\n            accept: function(sourceNodeScope, destNodeScope, destIndex) {\n                if (sourceNodeScope.element.isOpaque)\n                    return false;\n                if (destNodeScope.$element.hasClass('root'))\n                    return true;\n                if (ViewService.isSection(destNodeScope.element.presentationElement))\n                    return true;\n                return false;\n            }\n        };\n    };\n\n    var mmsViewReorderLink = function(scope, element, attrs) {\n        var ran = false;\n        var lastid = null; //race condition if view id changes fast and getting data for old id returns later than last id\n        scope.$watch('mmsElementId', function(newVal, oldVal) {\n            if (!newVal || newVal == oldVal && ran)\n                return;\n            ran = true;\n            lastid = newVal;\n            var commitId = scope.mmsCommitId;\n            commitId = commitId ? commitId : 'latest';\n            var reqOb = {elementId: scope.mmsElementId, projectId: scope.mmsProjectId, refId: scope.mmsRefId, commitId: commitId};\n            ElementService.getElement(reqOb)\n            .then(function(data) {\n                if (newVal !== lastid)\n                    return;\n                scope.view = data;\n                scope.editable = scope.view._editable && commitId === 'latest';\n\n                var contents = data._contents || data.specification;\n                if (contents) {\n                    ViewService.getElementReferenceTree(reqOb, contents)\n                    .then(function(elementReferenceTree) {\n                        if (newVal !== lastid)\n                            return;\n                        scope.elementReferenceTree = elementReferenceTree;\n                        scope.originalElementReferenceTree = _.cloneDeep(elementReferenceTree, function(value, key, object) {\n                            if (key === 'instanceId' || key === 'instanceSpecification' || key === 'presentationElement' || key === 'instanceVal')\n                                return value;\n                            return undefined;\n                        });\n                    }, function(reason) {\n                        if (newVal !== lastid)\n                            return;\n                        scope.elementReferenceTree = [];\n                        scope.originalElementReferenceTree = [];\n                    });\n                } else {\n                    scope.elementReferenceTree = [];\n                    scope.originalElementReferenceTree = [];\n                }\n\n            }, function(reason) {\n                if (newVal !== lastid)\n                    return;\n                growl.error('View Error: ' + reason.message);\n                scope.elementReferenceTree = [];\n                scope.originalElementReferenceTree = [];\n            });\n        });\n\n        scope.editing = false;\n        scope.elementReferenceTree = [];\n        scope.originalElementReferenceTree = [];\n\n        scope.toggleEditing = function() {\n            if (!scope.editable) \n                return false;\n            scope.editing = !scope.editing;\n            return true;\n        };\n\n        scope.save = function() {\n            var elementObsToUpdate = [];\n            var updateSectionElementOrder = function(elementReference) {\n                var sectionEdit = {\n                    id: elementReference.instanceId,\n                    //_modified: elementReference.instanceSpecification._modified,\n                    _projectId: elementReference.instanceSpecification._projectId,\n                    _refId: elementReference.instanceSpecification._refId,\n                    type: elementReference.instanceSpecification.type,\n                    specification: {\n                        type: \"Expression\"\n                    }\n                };\n                //sectionEdit.specialization = _.cloneDeep(elementReference.instanceSpecification.specialization);\n                var operand = sectionEdit.specification.operand = [];\n                var origOperand = elementReference.instanceSpecification.specification.operand;\n                for (var i = 0; i < elementReference.sectionElements.length; i++) {\n                    operand.push(elementReference.sectionElements[i].instanceVal);\n                    if (elementReference.sectionElements[i].sectionElements.length > 0)\n                        updateSectionElementOrder(elementReference.sectionElements[i]);\n                }\n                if (!angular.equals(operand, origOperand)) {\n                    elementObsToUpdate.push(sectionEdit);\n                }\n            };\n\n            var deferred = $q.defer();\n            if (!scope.editable || !scope.editing) {\n                deferred.reject({type: 'error', message: \"View isn't editable and can't be saved.\"});\n                return deferred.promise;\n            }\n            if (scope.elementReferenceTree.length === 0) {\n                deferred.reject({type: 'error', message: 'View contents were not initialized properly or is empty.'});\n                return deferred.promise;\n            }\n            var viewEdit = {\n                id: scope.view.id,\n                //_modified: scope.view._modified,\n                _projectId: scope.view._projectId,\n                _refId: scope.view._refId,\n                type: scope.view.type\n            };\n            //viewEdit.specialization = _.cloneDeep(scope.view.specialization);\n            if (scope.view._contents)\n                viewEdit._contents = JSON.parse(JSON.stringify(scope.view._contents));\n            if (scope.view.specification)\n                viewEdit.specification = JSON.parse(JSON.stringify(scope.view.specification));\n            var contents = viewEdit._contents || viewEdit.specification;\n            var origContents = scope.view._contents || scope.view.specification;\n            // Update the View edit object on Save\n            if (contents) {\n                contents.operand = [];\n                for (var i = 0; i < scope.elementReferenceTree.length; i++) {\n                    contents.operand.push(scope.elementReferenceTree[i].instanceVal);\n                }\n            }\n            if (viewEdit.view2view)\n                delete viewEdit.view2view;\n            if (contents && !angular.equals(contents.operand, origContents.operand)) {\n                elementObsToUpdate.push(viewEdit);\n            }\n                // promises.push(ViewService.updateView(viewEdit, scope.mmsRefId));\n            for (var j = 0; j < scope.elementReferenceTree.length; j++) {\n                if (scope.elementReferenceTree[j].sectionElements.length > 0)\n                    updateSectionElementOrder(scope.elementReferenceTree[j]);\n            }\n\n            return ElementService.updateElements(elementObsToUpdate, false);\n        };\n\n        scope.revert = function() {\n            scope.elementReferenceTree = _.cloneDeep(scope.originalElementReferenceTree, function(value, key, object) {\n                if (key === 'instanceId' || key === 'instanceSpecification' || key === 'presentationElement' || key === 'instanceVal')\n                   return value;\n                return undefined;\n            });\n        };\n\n        scope.refresh = function() {\n            var contents = scope.view._contents || scope.view.specification;\n            var reqOb = {elementId: scope.mmsElementId, projectId: scope.mmsProjectId, refId: scope.mmsRefId, commitId: scope.mmsCommitId};\n            if (contents) {\n                ViewService.getElementReferenceTree(reqOb, contents)\n                .then(function(elementReferenceTree) {\n                    scope.elementReferenceTree = elementReferenceTree;\n                    scope.originalElementReferenceTree = _.cloneDeep(elementReferenceTree, function(value, key, object) {\n                        if (key === 'instanceId' || key === 'instanceSpecification' || key === 'presentationElement' || key === 'instanceVal')\n                            return value;\n                        return undefined;\n                    });\n                }, function(reason) {\n                    scope.elementReferenceTree = [];\n                    scope.originalElementReferenceTree = [];\n                });\n            } else {\n                scope.elementReferenceTree = [];\n                scope.originalElementReferenceTree = [];\n            }        \n        };\n\n        if (angular.isObject(scope.mmsViewReorderApi)) {\n            var api = scope.mmsViewReorderApi;\n            api.toggleEditing = scope.toggleEditing;\n            api.save = scope.save;\n            api.refresh = scope.refresh;\n            api.setEditing = function(mode) {\n                if (!scope.editable && mode)\n                    return false;\n                scope.editing = mode;\n            };\n            api.revertEdits = scope.revert;\n        }\n    };\n\n    return {\n        restrict: 'E',\n        template: template,\n        scope: {\n            mmsElementId: '@',\n            mmsProjectId: '@',\n            mmsRefId: '@',\n            mmsCommitId: '@',\n            mmsViewReorderApi: '<'\n        },\n        controller: ['$scope', 'ViewService', mmsViewReorderCtrl],\n        link: mmsViewReorderLink\n    };\n}","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsViewSection', ['$compile', '$templateCache', '$rootScope', 'ViewService', 'UxService', 'Utils', 'growl', mmsViewSection]);\n\nfunction mmsViewSection($compile, $templateCache, $rootScope, ViewService, UxService, Utils, growl) {\n\n    var defaultTemplate = $templateCache.get('mms/templates/mmsViewSection.html');\n\n    var mmsViewSectionCtrl = function($scope, $rootScope) {\n\n        $scope.sectionInstanceVals = [];\n        $scope.bbApi = {};\n        $scope.buttons = [];\n        $scope.buttonsInit = false;\n        //$scope.element = $scope.section;  \n\n        $scope.bbApi.init = function() {\n            if (!$scope.buttonsInit) {\n                $scope.buttonsInit = true;\n                $scope.bbApi.addButton(UxService.getButtonBarButton(\"presentation-element-preview\", $scope));\n                $scope.bbApi.addButton(UxService.getButtonBarButton(\"presentation-element-save\", $scope));\n                $scope.bbApi.addButton(UxService.getButtonBarButton(\"presentation-element-saveC\", $scope));\n                $scope.bbApi.addButton(UxService.getButtonBarButton(\"presentation-element-cancel\", $scope));\n                $scope.bbApi.addButton(UxService.getButtonBarButton(\"presentation-element-delete\", $scope));\n                $scope.bbApi.setPermission(\"presentation-element-delete\", $scope.isDirectChildOfPresentationElement);\n            }\n        };\n\n    };\n\n    var mmsViewSectionLink = function(scope, domElement, attrs, controllers) {\n        scope.element = scope.section; // This is for methods in Utils\n        var mmsViewCtrl = controllers[0];\n        var mmsViewPresentationElemCtrl = controllers[1];\n        scope.setPeLineVisibility = function($event) {\n            window.setTimeout(function() {\n                var peContainer = $($event.currentTarget).closest('.add-pe-button-container');\n                if (peContainer.find('.dropdown-menu').css('display') == 'none') {\n                    peContainer.find('hr').css('visibility', 'hidden');\n                } else {\n                    peContainer.find('hr').css('visibility', 'visible');\n                }\n            });\n        };\n        domElement.click(function(e) {\n            //should not do anything if section is not an instancespec\n            if (scope.startEdit)\n                scope.startEdit();\n            if (mmsViewCtrl && mmsViewPresentationElemCtrl)\n                mmsViewCtrl.transcludeClicked(scope.section); //show instance spec if clicked\n            e.stopPropagation();\n        });\n\n        var recompile = function() {\n            scope.isEditing = false;\n            scope.inPreviewMode = false;\n        };\n\n        var recompileEdit = function() {\n            // do nothing\n        };\n\n        if (scope.section.specification && scope.section.specification.operand) {\n            var dups = Utils.checkForDuplicateInstances(scope.section.specification.operand);\n            if (dups.length > 0) {\n                growl.warning(\"There are duplicates in this section, dupilcates ignored!\");\n            }\n        }\n        if (scope.section._veNumber) {\n            scope.level = scope.section._veNumber.split('.').length;\n        }\n        domElement.append(defaultTemplate);\n        $compile(domElement.contents())(scope);\n\n        var projectId = scope.mmsProjectId;\n        var refId = scope.mmsRefId;\n        var commitId = scope.mmsCommitId;\n\n        if (mmsViewCtrl) {\n            var viewVersion = mmsViewCtrl.getElementOrigin();\n            if (!projectId)\n                projectId = viewVersion.projectId;\n            if (!refId)\n                refId = viewVersion.refId;\n            if (!commitId)\n                commitId = viewVersion.commitId;\n        }\n        scope.projectId = projectId;\n        scope.refId = refId ? refId : 'master';\n        scope.commitId = commitId ? commitId : 'latest';\n\n        if (mmsViewCtrl && mmsViewPresentationElemCtrl) {\n\n            scope.isEditing = false;\n            scope.inPreviewMode = false;\n            scope.elementSaving = false;\n            scope.cleanUp = false;\n            scope.instanceSpec = mmsViewPresentationElemCtrl.getInstanceSpec();\n            scope.instanceVal = mmsViewPresentationElemCtrl.getInstanceVal();\n            scope.presentationElem = mmsViewPresentationElemCtrl.getPresentationElement();\n            scope.view = mmsViewCtrl.getView();\n            scope.isDirectChildOfPresentationElement = Utils.isDirectChildOfPresentationElementFunc(domElement, mmsViewCtrl);\n            if (scope.instanceSpec.classifierIds[0] === ViewService.TYPE_TO_CLASSIFIER_ID.Section)\n                scope.isDirectChildOfPresentationElement = false;\n            var type = \"name\";\n\n            if (scope.commitId === 'latest') {\n                scope.$on('element.updated', function(event, elementOb, continueEdit) {\n                    if (elementOb.id === scope.element.id && elementOb._projectId === scope.element._projectId &&\n                        elementOb._refId === scope.element._refId && !continueEdit) {\n                        recompile();\n                    }\n                });\n            }\n\n            scope.save = function() {\n                Utils.saveAction(scope, domElement, false);\n            };\n\n            scope.saveC = function() {\n                Utils.saveAction(scope, domElement, true);\n            };\n\n            scope.cancel = function() {\n                Utils.cancelAction(scope, recompile, domElement);\n            };\n\n            scope.delete = function() {\n                Utils.deleteAction(scope, scope.bbApi, mmsViewPresentationElemCtrl.getParentSection());\n            };\n\n            scope.startEdit = function() {\n                Utils.startEdit(scope,mmsViewCtrl,domElement,null,scope.section);\n            };\n\n            scope.preview = function() {\n                Utils.previewAction(scope, recompileEdit, recompile, type);\n            };\n        }\n\n        scope.addEltAction = function(index, type, e) {\n            if (!mmsViewCtrl || !mmsViewCtrl.isEditable()) {\n                return;\n            }\n            e.stopPropagation();\n            scope.addPeIndex = index;\n            Utils.addPresentationElement(scope, type, scope.section);\n        };\n\n    };\n\n    return {\n        restrict: 'E',\n        scope: {\n            section: '<mmsSection' //this is json if contains, the instancespec if contents\n        },\n        require: ['?^mmsView','?^mmsViewPresentationElem'],\n        controller: ['$scope', '$rootScope', mmsViewSectionCtrl],\n        link: mmsViewSectionLink\n    };\n}","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsViewTable', ['$compile', '$timeout', '$document', '$window', 'UtilsService', 'Utils', mmsViewTable]);\n\nfunction mmsViewTable($compile, $timeout, $document, $window, UtilsService, Utils) {\n\n    var mmsViewTableLink = function(scope, element, attrs, ctrl) {\n        if (!scope.table.showIfEmpty && scope.table.body.length === 0)\n            return;\n\n        var tableConfig = UtilsService.tableConfig;\n\n        scope.searchTerm = '';\n        scope.showFilter = false;\n        scope.showSortReset = false;\n        scope.isAscending = false;\n        scope.getSortIconClass = function(cellColumn) {\n            var sortingColumnNumber = scope[tableConfig.showBindingForSortIcon];\n            if ( sortingColumnNumber !== cellColumn ) {\n                return ['fa', 'fa-sort', 'sort-default' ];\n            } else {\n                if ( scope.isAscending ) {\n                    return ['fa', 'fa-caret-down', 'sort-activated' ];\n                } else {\n                    return ['fa', 'fa-caret-up', 'sort-activated' ];\n                }\n            }\n        };\n\n        var html = UtilsService.makeHtmlTable(scope.table, true, true, scope.mmsPe);\n        html = '<div class=\"tableSearch ve-table-filter\">' +\n                '<button class=\"btn btn-sm export-csv-button btn-default\" ng-click=\"makeCsv()\">Export CSV</button> ' +\n                '<button class=\"btn btn-sm filter-table-button btn-default\" ng-click=\"showFilter = !showFilter\">Filter table</button> ' +\n                '<label class=\"btn btn-sm btn-default table-button\"><input type=\"checkbox\" class=\"fixed-header-checkbox\" ng-model=\"fixedHeaders\" ng-change=\"makeFixedHeader()\" /> Freeze Headers</label> ' +\n                '<label class=\"btn btn-sm btn-default table-button\"><input type=\"checkbox\" class=\"fixed-header-checkbox\" ng-model=\"fixedColumns\" ng-change=\"makeFixedColumn()\" /> Freeze Columns</label> ' +\n                '<label class=\"btn btn-sm table-button column-input-label\" ng-show=\"fixedColumns\">Columns to Freeze <input type=\"text\" ng-show=\"fixedColumns\" size=\"3\" class=\"column-input\" ng-model=\"numFixedColumns\" /></label> ' +\n                '<button class=\"btn btn-sm btn-default table-button\" ng-show=\"fixedColumns\" ng-click=\"updateFixedColumns()\">Update</button> ' +\n                '<button class=\"btn btn-sm reset-sort-button btn-default reset-sort-fade\" ng-show=\"showSortReset\" ng-click=\"resetSort()\">Reset Sort</button>' +\n                '<span class = \"ve-show-filter\" ng-show=\"showFilter\">' +\n                    '<form style=\"display: inline\" class=\"ve-filter-table-form\"><input type=\"text\" size=\"75\" placeholder=\"Filter table\" ng-model-options=\"{debounce: '+ tableConfig.filterDebounceRate  + '}\" ng-model=\"searchTerm\"></form>' +\n                '<span class = \"ve-filter-status\">Showing <strong>{{numFiltered}}</strong> of <strong>{{numTotal}}</strong> Rows: </span></span></div>' + \n                '<div class=\"table-wrapper\">' + html + '</div>';\n\n        scope.makeCsv = function() {\n            var csvString = element.find('.table-wrapper').children('table').table2CSV({delivery:'value'});\n            // var bom = \"\\xEF\\xBB\\xBF\"; //just for excel\n            var bom2 = \"\\uFEFF\";      //just for excel\n            var blob = new Blob([bom2 + csvString], {\n                    type: \"text/csv;charset=utf-8;\"\n                });\n\n            if (window.navigator.msSaveOrOpenBlob) {\n                navigator.msSaveBlob(blob,'TableData.csv');\n            } else {\n                var downloadContainer = angular.element('<div data-tap-disabled=\"true\"><a></a></div>');\n                var downloadLink = angular.element(downloadContainer.children()[0]);\n                downloadLink.attr('href', window.URL.createObjectURL(blob));\n                downloadLink.attr('download', 'TableData.csv');\n                downloadLink.attr('target', '_blank');\n\n                $document.find('body').append(downloadContainer);\n                $timeout(function () {\n                    downloadLink[0].click();\n                    downloadLink.remove();\n                }, null);\n            }\n        };\n\n        var fixedHeaders = null;\n        scope.fixedHeaders = false;\n        var fixedColumns = null;\n        scope.fixedColumns = false;\n        scope.numFixedColumns = 2;\n        var scroll = function() {\n            if (fixedColumns) {\n                fixedColumns.css('transform', 'translateX('+ this.scrollLeft +'px)');\n            }\n            if (fixedHeaders) {\n                fixedHeaders.css('transform', 'translateY('+ this.scrollTop +'px)');\n            }\n            if (fixedHeaders && fixedColumns) {\n                element.find('caption').css('transform', 'translate(' + this.scrollLeft + 'px, ' + this.scrollTop + 'px)');\n            }\n        };\n        scope.makeFixedHeader = function() {\n            if (!scope.fixedHeaders) {\n                element.find('.table-wrapper').removeClass('table-fix-head').css('height', '');\n                fixedHeaders.css('transform', '').css('will-change', '');\n                fixedHeaders = null;\n                $window.localStorage.setItem('ve-table-header-' + scope.mmsPe.id, 'false');\n                return;\n            }\n            element.find('.table-wrapper').addClass('table-fix-head').css('height', $window.innerHeight - 36*3);\n            //heights for navbar, menu, toolbar\n            fixedHeaders = element.find('thead, caption');\n            fixedHeaders.css('will-change', 'transform'); //browser optimization\n            element.find('.table-fix-head').on('scroll', scroll);\n            $window.localStorage.setItem('ve-table-header-' + scope.mmsPe.id, 'true');\n        };\n        scope.makeFixedColumn = function() {\n            if (!scope.fixedColumns) {\n                element.find('.table-wrapper').removeClass('table-fix-column').css('width', '');\n                fixedColumns.css('transform', '').css('will-change', '').removeClass('table-fixed-cell');\n                fixedColumns = null;\n                $window.localStorage.setItem('ve-table-column-' + scope.mmsPe.id, 'false');\n                return;\n            }\n            element.find('.table-wrapper').addClass('table-fix-column').css('width', $window.innerWidth - 400);\n            fixedColumns = findColumnCells('thead', 'th', scope.numFixedColumns);\n            fixedColumns = fixedColumns.add(findColumnCells('tbody', 'td', scope.numFixedColumns));\n            fixedColumns = fixedColumns.add(element.find('.table-fix-column caption'));\n            fixedColumns.css('will-change', 'transform'); //browser optimization\n            fixedColumns.addClass('table-fixed-cell');\n            element.find('.table-fix-column').on('scroll', scroll);\n            $window.localStorage.setItem('ve-table-column-' + scope.mmsPe.id, scope.numFixedColumns);\n        };\n        scope.updateFixedColumns = function() {\n            scope.fixedColumns = false;\n            scope.makeFixedColumn();\n            scope.fixedColumns = true;\n            scope.makeFixedColumn();\n        };\n        var findColumnCells = function(bodyTag, cellTag, n) {\n            var spanData = {}; //if spanData[curRow][curCol] is true that means that 'cell' should be \"\" due to merged cell\n            var curRow = 0;\n            var data = $();\n            element.find('.table-fix-column table').children(bodyTag).children('tr').each(function() {\n                var curCol = 0;\n                $(this).children(cellTag).each(function() {\n                    while(spanData[curRow] && spanData[curRow][curCol]) {\n                        curCol++;\n                    }\n                    if (curCol >= n) {\n                        return;\n                    }\n                    data = data.add($(this));\n                    var rowspan = $(this).attr('rowspan');\n                    if (rowspan) {\n                        rowspan = parseInt(rowspan);\n                        if (rowspan > 1) {\n                            for (var i = 1; i < rowspan; i++) {\n                                if (!spanData[curRow + i]) {\n                                    spanData[curRow + i] = {};\n                                }\n                                spanData[curRow + i][curCol] = true;\n                            }\n                        }\n                    }\n                    var colspan = $(this).attr('colspan');\n                    if (!colspan) {\n                        curCol++;\n                        return;\n                    }\n                    colspan = parseInt(colspan);\n                    while (colspan > 1) {\n                        curCol++;\n                        colspan--;\n                        if (rowspan > 1) {\n                            for (var j = 1; j < rowspan; j++) {\n                                spanData[curRow + j][curCol] = true;\n                            }\n                        }\n                    }\n                    curCol++;\n                });\n                curRow++;\n            });\n            return data;\n        };\n\n        element[0].innerHTML = html;\n        $(element[0]).find('img').each(function(index) {\n            Utils.fixImgSrc($(this));\n        });\n        var nextIndex = 0;\n        var thead = element.find('thead');\n        $compile(thead)(scope);\n        var searchbar = element.children('div')[0];\n        $compile(searchbar)(scope);\n        $compile(element.find('caption'))(scope);\n        //Add the search input here (before the TRS, aka the columns/rows)\n        var tbody = element.find('.table-wrapper').children('table').children('tbody');\n        var trs = tbody.children('tr');\n\n        var lastIndex = trs.length;\n        scope.numFiltered = lastIndex;\n        scope.numTotal = lastIndex;\n        function compile() {\n            $timeout(function() {\n                var first = nextIndex;\n                if (first > lastIndex)\n                    return;\n                var now = trs.slice(first, first + 300);\n                $compile(now)(scope);\n                nextIndex = first + 300;\n                if (nextIndex < lastIndex)\n                    compile();\n                else {\n                    if ($window.localStorage.getItem('ve-table-header-' + scope.mmsPe.id) == 'true') {\n                        scope.fixedHeaders = true;\n                        scope.makeFixedHeader();\n                    }\n                    var columnFix = $window.localStorage.getItem('ve-table-column-' + scope.mmsPe.id);\n                    if (columnFix != 'false' && columnFix != null && columnFix != 'null') {\n                        scope.fixedColumns = true;\n                        scope.numFixedColumns = columnFix;\n                        scope.makeFixedColumn();\n                    }\n                }\n            }, 100, false);\n        }\n        compile();\n\n        ctrl.addFullTableFilter(trs);\n        ctrl.addColumnsWiseFilter(tableConfig, trs);\n        ctrl.addSorting(trs, tbody);\n    };\n\n    var mmsViewTableController = ['$scope', function ($scope) {\n        var vm = this;\n\n        /** Full Table Filter **/\n        vm.addFullTableFilter = addFullTableFilter;\n        vm._addWatcherToFullTableFilterInput = _addWatcherToFullTableFilterInput;\n        vm._displaySomeRows = _displaySomeRows;\n        vm._fullTableFilter = _fullTableFilter;\n\n        /** Add Full Table Filter ability **/\n        function addFullTableFilter(trs) {\n            vm._fullTableFilterWatcherUnregisterFn = vm._addWatcherToFullTableFilterInput(function(){vm._fullTableFilter(trs);});\n        }\n\n        /** Add a watcher to the Full Table Filter Input **/\n        function _addWatcherToFullTableFilterInput(performFilter) {\n            return $scope.$watch('searchTerm', function (newInputVal, oldInputVal) {\n                if (newInputVal !== oldInputVal) {\n                    performFilter();\n                }\n            });\n        }\n\n        /** Filter rows by search term **/\n        function _fullTableFilter(trs) {\n            vm._resetColumnWiseFilterInputs();\n            if ( $scope.searchTerm === '' ) {\n                $scope.numFiltered = trs.length;\n                trs.show();\n            } else {\n                $scope.numFiltered = 0;\n                vm._displaySomeRows(trs, function() { $scope.numFiltered++; });\n            }\n        }\n\n        /** Display rows that match the filter term **/\n        function _displaySomeRows(trs, increaseNumOfRowToShow) {\n            var searchTerm = $scope.searchTerm;\n            var regExp = new RegExp(searchTerm, 'i');\n            for (var i = 0, numRows = trs.length; i < numRows; i++) {\n                var string = $(trs[i]).text();\n                if (regExp.test(string)) {\n                    $(trs[i]).show();\n                    increaseNumOfRowToShow();\n                } else {\n                    $(trs[i]).hide();\n                }\n            }\n        }\n        /** End of Full Table Filter **/\n\n\n\n        /** Column(s)-Wise Filter **/\n        vm.addColumnsWiseFilter = addColumnsWiseFilter;\n        vm._addWatchersForAllHeaderColumnsInput = _addWatchersForAllHeaderColumnsInput;\n        vm._addWatcherToColumnInput = _addWatcherToColumnInput;\n        vm._displayRowsMatchingAllColumnsFilterTerms = _displayRowsMatchingAllColumnsFilterTerms;\n        vm._storeColumnWiseFilterTerm = _storeColumnWiseFilterTerm;\n        vm._addNewColumnWiseFilterTerm = _addNewColumnWiseFilterTerm;\n        vm._updateExistingColumnWiseFilterTerm = _updateExistingColumnWiseFilterTerm;\n        vm._getCellValueForFiltering = _getCellValueForFiltering;\n        vm._resetColumnWiseFilterInputs = _resetColumnWiseFilterInputs;\n        vm._resetFullTableFilterInput = _resetFullTableFilterInput;\n\n        /** Add column(s)-wise filter ability **/\n        function addColumnsWiseFilter(tableConfig, trs) {\n            vm._columnsInputWatchers = vm._addWatchersForAllHeaderColumnsInput(tableConfig);\n            /**\n             * _filterTermForColumns is used to keep track of filter terms on each header's column for multi-columns\n             * filtering. Some header columns could be a merged column, and have children columns. \"columns\" property\n             * keeps track, of all the children columns number that it is a parent of. ie:\n             * {filterTermForColumn01: {filterTerm: 'A', columns: [0,1}], filterTermForColumn11: {filterTerm: 'B', columns: [1}]} **/\n            vm._filterTermForColumns = {};\n            $scope.filterByColumn = function (filterTerm, startColNum, endColNum, filterInputBinding) {\n                vm._resetFullTableFilterInput(trs);\n                vm._storeColumnWiseFilterTerm(vm._filterTermForColumns, filterInputBinding, startColNum, endColNum, filterTerm);\n                $scope.numFiltered = 0;\n                vm._displayRowsMatchingAllColumnsFilterTerms(trs, vm._filterTermForColumns, function() {$scope.numFiltered++;});\n            };\n        }\n\n        /** Add watchers to all header columns inputs for filtering **/\n        function _addWatchersForAllHeaderColumnsInput(tableConfig) {\n            var columnsInputWatchers = {};\n            if (!$scope.table.header) {\n                return;\n            }\n            $scope.table.header.forEach(function (headerRow) {\n                headerRow.forEach(function(cell) {\n                    var filterInputBinding = tableConfig.filterTermColumnPrefixBinding + cell.startCol + cell.endCol;\n                    vm._addWatcherToColumnInput(columnsInputWatchers, filterInputBinding, cell );\n                });\n            });\n            return columnsInputWatchers;\n        }\n\n        /** Add a watcher to one header column's input for filtering **/\n        function _addWatcherToColumnInput(columnsInputWatchers, filterInputBinding, cell) {\n            columnsInputWatchers[filterInputBinding] = {\n                deRegistration: $scope.$watch(filterInputBinding, function (newInputVal, oldInputVal) {\n                    if (newInputVal !== oldInputVal) {\n                        $scope.filterByColumn(newInputVal, cell.startCol, cell.endCol, filterInputBinding);\n                    }\n                }),\n                cell: cell\n            };\n        }\n\n        /** Clear out the filter term from the Full Table Filter input **/\n        function _resetFullTableFilterInput(trs) {\n            if ($scope.searchTerm !== '') {\n                vm._fullTableFilterWatcherUnregisterFn();\n                $scope.searchTerm = '';\n                vm._fullTableFilterWatcherUnregisterFn = vm._addWatcherToFullTableFilterInput(function(){vm._fullTableFilter(trs);});\n            }\n        }\n\n        /** Only show the rows that has contents matching all currently outstanding filter terms **/\n        function _displayRowsMatchingAllColumnsFilterTerms(trs, filterTermForColumns, increaseNumOfRowToShow) {\n            trs.toArray().forEach(function (row) {\n                var shouldKeepRow = Object.keys(filterTermForColumns).every(function(k) {\n                    var regExp = new RegExp(filterTermForColumns[k].filterTerm, 'i');\n                    return filterTermForColumns[k].columns.some(function(colNum) {\n                        return regExp.test(vm._getCellValueForFiltering(row, colNum));\n                    });\n                });\n                if (shouldKeepRow) {\n                    $(row).show();\n                    increaseNumOfRowToShow();\n                } else {\n                    $(row).hide();\n                }\n            });\n        }\n\n        /** Update or add a new filter term for a header column with the given filterInputBinding **/\n        function _storeColumnWiseFilterTerm(filterTermForColumns, filterInputBinding, startColNum, endColNum, filterTerm) {\n            if (filterTermForColumns[filterInputBinding]) {\n                vm._updateExistingColumnWiseFilterTerm(filterTermForColumns, filterInputBinding, filterTerm);\n            } else {\n                vm._addNewColumnWiseFilterTerm(filterTermForColumns, filterInputBinding, startColNum, endColNum, filterTerm);\n            }\n        }\n\n        /** Add a new filter term to a header column with the given filterInputBinding **/\n        function _addNewColumnWiseFilterTerm(filterTermForColumns, filterInputBinding, startColNum, endColNum, filterTerm) {\n            filterTermForColumns[filterInputBinding] = {filterTerm: filterTerm, columns: startColNum === endColNum ? [startColNum] : [startColNum, endColNum] };\n        }\n\n        /** Update a filter term for a header column with the given filterInputBinding **/\n        function _updateExistingColumnWiseFilterTerm(filterTermForColumns, filterInputBinding, filterTerm) {\n            filterTermForColumns[filterInputBinding].filterTerm = filterTerm;\n        }\n\n        /** Return the content of a cell given a row & columnIndex **/\n        function _getCellValueForFiltering(row, columnIndex) {\n            var cell = $(row).children('td').eq(columnIndex);\n            return cell.text().trim();\n        }\n\n        /** Clear out filter term(s) for all header's columns that used to be filtered by before **/\n        function _resetColumnWiseFilterInputs() {\n            var listOfFilterInputBindings = Object.keys(vm._filterTermForColumns);\n            if ( listOfFilterInputBindings.length > 0 ) {\n                listOfFilterInputBindings.forEach(function(filterInputBinding) {\n                    if (vm._filterTermForColumns[filterInputBinding].filterTerm !== '' ) {\n                        vm._columnsInputWatchers[filterInputBinding].deRegistration();\n                    }\n                    $scope[filterInputBinding] = '';\n                    vm._addWatcherToColumnInput(vm._columnsInputWatchers, filterInputBinding, vm._columnsInputWatchers[filterInputBinding].cell );\n                });\n                vm._filterTermForColumns = {};\n            }\n        }\n        /** End of Column(s)-Wise Filter **/\n\n\n\n        /** Sorting feature **/\n        vm.addSorting = addSorting;\n        vm._addDefaultSortOrder = _addDefaultSortOrder;\n        vm._addSortingBinding = _addSortingBinding;\n        vm._addSortResetBinding = _addSortResetBinding;\n        vm._comparator = _generalComparator;\n        vm._getCellValueForSorting = _getCellValueForSorting;\n        vm._displaySortedRows = _displaySortedRows;\n        vm._comparatorForSortReset = _comparatorForSortReset;\n        vm._rowSortOrderAttrName = 'data-original-row-num';\n        vm.__areAllCellValidNumber = _areAllCellValidNumber;\n\n        /** Add sorting ability **/\n        function addSorting(trs, tbody) {\n            vm._addDefaultSortOrder(trs);\n            vm._addSortingBinding(trs, tbody);\n            vm._addSortResetBinding(trs, tbody);\n        }\n\n        /** Remember the original row number for each row. Used to restore sort order **/\n        function _addDefaultSortOrder(trs) {\n            trs.each(function (rowNumber, tr) {\n                $(tr).attr(vm._rowSortOrderAttrName, rowNumber );\n            });\n        }\n\n        /** Used to sort columns(s). Add sort binding to each header columns of the outermost table **/\n        function _addSortingBinding(trs, tbody) {\n            var tableConfig = UtilsService.tableConfig;\n\n            $scope[tableConfig.showBindingForSortIcon] = -1;\n\n            $scope[tableConfig.sortByColumnFn] = function (sortColumnNum) {\n                $scope[tableConfig.showBindingForSortIcon] = sortColumnNum;\n                var rows = trs.toArray();\n                var sortedRows = _areAllCellValidNumber(rows, sortColumnNum) ?\n                    rows.sort(_numericalComparator(sortColumnNum)) : rows.sort(_generalComparator(sortColumnNum));\n\n                $scope.isAscending = !$scope.isAscending;\n\n                if (!$scope.isAscending) {\n                    sortedRows = sortedRows.reverse();\n                }\n\n                vm._displaySortedRows(sortedRows, tbody);\n                $scope.showSortReset = true;\n            };\n        }\n\n        /** Used to restore the sort order of table's rows **/\n        function _addSortResetBinding(trs, tbody) {\n            $scope.resetSort = function() {\n                var sortedRows = trs.toArray().sort(vm._comparatorForSortReset());\n                vm._displaySortedRows(sortedRows, tbody);\n\n                $scope.showSortReset = false;\n                $scope[UtilsService.tableConfig.showBindingForSortIcon] = -1;\n            };\n        }\n\n        /** A comparator for sorting table's rows. When one of them is null ( null is reserved for non-sortable content\n         *  such as  image, list, table ), that content is pushed to the end of the final sorted list regardless of\n         *  whether sorting asc or dsc **/\n        function _generalComparator(columnIndex) {\n            return function(rowA, rowB) {\n                var cellValueA = _getCellValueForSorting(rowA, columnIndex);\n                var cellValueB = _getCellValueForSorting(rowB, columnIndex);\n\n                if (cellValueA === null && cellValueB === null) {\n                    return 0;\n                }\n\n                if (cellValueA === null && cellValueB !== null) {\n                    return $scope.isAscending ? 1 : -1;\n                }\n\n                if (cellValueA !== null && cellValueB === null) {\n                    return $scope.isAscending ? -1 : 1;\n                }\n\n                if (cellValueA !== null && cellValueB !== null) {\n                    cellValueA = cellValueA.toLowerCase();\n                    cellValueB = cellValueB.toLowerCase();\n                    return cellValueA < cellValueB ? -1 : cellValueA > cellValueB ? 1 : 0;\n                }\n            };\n        }\n\n        /** Return true if and only if all cells' value can be converted to a valid number **/\n        function _areAllCellValidNumber(rows, columnIndex) {\n            return rows.every(function(row) {\n                return _isValidNumber(_getCellValueForSorting(row, columnIndex));\n            });\n        }\n\n        function _numericalComparator(columnIndex) {\n            return function(rowA, rowB) {\n                var cellValueA = Number(_getCellValueForSorting(rowA, columnIndex));\n                var cellValueB = Number(_getCellValueForSorting(rowB, columnIndex));\n                return cellValueA - cellValueB;\n            };\n        }\n\n        function _isValidNumber(val) {\n            return val !== null && !isNaN(Number(val));\n        }\n\n        /** Get content of a cell given its row and its columnIndex. Return null for a cell that contains non-sortable\n         *  content such as image, table, list **/\n        function _getCellValueForSorting(row, columnIndex) {\n            var cell = $(row).children('td').eq(columnIndex);\n            var containerDivContent = cell.children('div').contents();\n            // if there is no content, think of it as empty string\n            if (containerDivContent.length === 0) {\n                return '';\n            } else if(!containerDivContent.prop('tagName')) {\n                return cell.text().trim();\n            } else {\n                var cf = 'mms-cf';\n                var contentTag = containerDivContent.prop('tagName').toLowerCase();\n                var contentTagAttr = containerDivContent.attr('mms-cf-type');\n                if ( contentTag === 'img' || contentTag === 'table' || contentTag === cf && ( contentTagAttr === 'img' || contentTagAttr === 'table' )) {\n                    return null;\n                } else {\n                    return cell.text().trim();\n                }\n            }\n        }\n\n        /** Display newly sorted rows **/\n        function _displaySortedRows(sortedRows, tbody) {\n            $(sortedRows).detach().appendTo(tbody);\n        }\n\n        /** This special comparator is used to turn the table's rows into its original sort order **/\n        function _comparatorForSortReset() {\n            return function(rowA, rowB) {\n                var rowARowNumber = Number($(rowA).attr(vm._rowSortOrderAttrName));\n                var rowBRowNumber = Number($(rowB).attr(vm._rowSortOrderAttrName));\n                return rowARowNumber < rowBRowNumber ? -1 : rowARowNumber > rowBRowNumber ? 1 : 0;\n            };\n        }\n        /** End of Sorting feature **/\n    }];\n\n    return {\n        restrict: 'E',\n        scope: {\n            table: '<mmsTable',\n            mmsPe: '<'\n        },\n        controller: mmsViewTableController,\n        link: mmsViewTableLink\n    };\n}\n","'use strict';\n\nangular.module('mms.directives')\n.directive('mmsViewTableT', [mmsViewTableT]);\n\nfunction mmsViewTableT() {\n\n    return {\n        restrict: 'E',\n        template: '<mms-cf mms-cf-type=\"doc\" mms-element-id=\"{{para.source}}\"></mms-cf>',\n        scope: {\n            para: '<mmsPara'\n        }\n    };\n}","angular.module(\"mms.directives.tpls\", [\"mms/templates/mergeConfirm.html\", \"mms/templates/mmsAddPeButton.html\", \"mms/templates/mmsAnnotation.html\", \"mms/templates/mmsButtonBar.html\", \"mms/templates/mmsCfModal.html\", \"mms/templates/mmsCommentModal.html\", \"mms/templates/mmsDiffAttr.html\", \"mms/templates/mmsGroupDocs.html\", \"mms/templates/mmsHistory.html\", \"mms/templates/mmsHtmlDiff.html\", \"mms/templates/mmsJobs.html\", \"mms/templates/mmsMention.html\", \"mms/templates/mmsRefList.html\", \"mms/templates/mmsSearch.html\", \"mms/templates/mmsSearchResults.html\", \"mms/templates/mmsSpec.html\", \"mms/templates/mmsToolbar.html\", \"mms/templates/mmsTranscludeDoc.html\", \"mms/templates/mmsTranscludeName.html\", \"mms/templates/mmsTranscludeVal.html\", \"mms/templates/mmsTranscludeValEdit.html\", \"mms/templates/mmsTranscludeValFrame.html\", \"mms/templates/mmsTree.html\", \"mms/templates/mmsTsDiagram.html\", \"mms/templates/mmsView.html\", \"mms/templates/mmsViewPresentationElem.html\", \"mms/templates/mmsViewReorder.html\", \"mms/templates/mmsViewSection.html\", \"mms/templates/revertConfirm.html\", \"mms/templates/saveConflict.html\"]);\n\nangular.module(\"mms/templates/mergeConfirm.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mergeConfirm.html\",\n    \"<div class=\\\"modal-header\\\">\\n\" +\n    \"    <h4>Pull in changed presentation elements <span class=\\\"text-warning\\\">(beta)</span></h4>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-body revert-dialogue\\\">\\n\" +\n    \"    <p><b>{{docName}}:</b> Pull in changed Presentation Elements from <span class=\\\"{{srcRefOb.type}}-icon\\\"><b>{{srcRefOb.name}}</b></span> to <span class=\\\"{{currentRefOb.type}}-icon\\\"><b>{{currentRefOb.name}}</b></p>\\n\" +\n    \"\\n\" +\n    \"    <p style=\\\"padding-bottom:20px;\\\"> This will commit contents of source Presentation Elements (PEs)<a><i class=\\\"fa fa-question-circle\\\" uib-tooltip=\\\"Text, image, equation, and section elements\\\" tooltip-placement=\\\"bottom\\\"></i></a> to target PEs if source PEs have changed, and add new PEs from source to target if they do not exist on target.\\n\" +\n    \"        <!-- <a> More...</a> -->\\n\" +\n    \"    </p>\\n\" +\n    \"\\n\" +\n    \"    <div class=\\\"element-preview-box\\\">\\n\" +\n    \"        <p><i class=\\\"fa fa-exclamation-triangle\\\"></i><b>Notice:</b> Your document may not\\n\" +\n    \"            look complete unless your model merge was completed as well.\\n\" +\n    \"        </p>\\n\" +\n    \"        <p><i class=\\\"fa fa-exclamation-triangle\\\"></i><b>Before applying to your production\\n\" +\n    \"            branch</b> please <a>create a test branch</a> from your target branch, apply changes, and preview.</p>\\n\" +\n    \"    </div>\\n\" +\n    \"    <label>Optional change log message</label>\\n\" +\n    \"    <div class=\\\"commit-message-box\\\">\\n\" +\n    \"        <textarea ng-model=\\\"commitMessage\\\" style=\\\"width:100%\\\" rows=\\\"3\\\" placeholder=\\\"Describe your changes\\\"></textarea>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-footer\\\">\\n\" +\n    \"    <button class=\\\"btn btn-warning\\\" ng-click=\\\"ok()\\\">Pull</button>\\n\" +\n    \"    <button class=\\\"btn btn-default\\\" ng-click=\\\"cancel()\\\">Cancel</button>\\n\" +\n    \"</div>\\n\" +\n    \"\");\n}]);\n\nangular.module(\"mms/templates/mmsAddPeButton.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mmsAddPeButton.html\",\n    \"<div class=\\\"mms-add-pe-button\\\" ng-mouseover=\\\"setPeLineVisibility($event);\\\" ng-mouseleave=\\\"setPeLineVisibility($event);\\\">\\n\" +\n    \"  <span class=\\\"center btn-group dropdown\\\" uib-dropdown>\\n\" +\n    \"    <a type=\\\"button\\\" class=\\\"dropdown-toggle btn btn-sm\\\" ng-click=\\\"$event.stopPropagation(); setPeLineVisibility($event);\\\" uib-dropdown-toggle aria-expanded=\\\"true\\\" title=\\\"Add cross referenceable text, tables, images, equations, sections, and comments\\\">\\n\" +\n    \"        <i class=\\\"fa fa-plus\\\"></i>\\n\" +\n    \"    </a>\\n\" +\n    \"    <ul class=\\\"dropdown-menu\\\" uib-dropdown-menu role=\\\"add PE menu\\\">\\n\" +\n    \"      <li ng-click=\\\"addEltAction($index, 'Paragraph', $event)\\\">\\n\" +\n    \"        <a type=\\\"button\\\" class=\\\"add-element-button center view-add-paragraph pe-type-Paragraph\\\" title=\\\"Add text\\\">\\n\" +\n    \"          <span class=\\\"icon-title\\\">Text</span>\\n\" +\n    \"        </a>\\n\" +\n    \"      </li>\\n\" +\n    \"      <li ng-click=\\\"addEltAction($index, 'Table', $event)\\\">\\n\" +\n    \"        <a type=\\\"button\\\" class=\\\"add-element-button center view-add-table pe-type-Table\\\" title=\\\"Add table\\\">\\n\" +\n    \"          <span class=\\\"icon-title\\\">Table</span>\\n\" +\n    \"        </a>\\n\" +\n    \"      </li>\\n\" +\n    \"      <li ng-click=\\\"addEltAction($index, 'Image', $event)\\\">\\n\" +\n    \"        <a type=\\\"button\\\" class=\\\"add-element-button center view-add-image pe-type-Image\\\" title=\\\"Add image\\\">\\n\" +\n    \"          <span class=\\\"icon-title\\\">Image</span>\\n\" +\n    \"        </a>\\n\" +\n    \"      </li>\\n\" +\n    \"      <li ng-click=\\\"addEltAction($index, 'Equation', $event)\\\">\\n\" +\n    \"        <a type=\\\"button\\\" class=\\\"add-element-button center view-add-equation pe-type-Equation\\\" title=\\\"Add equation\\\">\\n\" +\n    \"          <span class=\\\"icon-title\\\">Equation</span>\\n\" +\n    \"        </a>\\n\" +\n    \"      </li>\\n\" +\n    \"      <li ng-click=\\\"addEltAction($index, 'Section', $event)\\\">\\n\" +\n    \"        <a type=\\\"button\\\" class=\\\"add-element-button center view-add-section pe-type-Section\\\" title=\\\"Add section\\\">\\n\" +\n    \"          <span class=\\\"icon-title\\\">Section</span>\\n\" +\n    \"        </a>\\n\" +\n    \"      </li>\\n\" +\n    \"      <li ng-click=\\\"addEltAction($index, 'Comment', $event)\\\">\\n\" +\n    \"        <a type=\\\"button\\\" class=\\\"add-element-button center view-add-comment pe-type-Comment\\\" title=\\\"Add comment\\\">\\n\" +\n    \"          <span class=\\\"icon-title\\\">Comment</span>\\n\" +\n    \"        </a>\\n\" +\n    \"      </li>\\n\" +\n    \"    </ul>\\n\" +\n    \"  </span>\\n\" +\n    \"</div>\\n\" +\n    \"<hr/>\");\n}]);\n\nangular.module(\"mms/templates/mmsAnnotation.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mmsAnnotation.html\",\n    \"<span class=\\\"mms-error\\\" uib-popover-template=\\\"'annotationTemplate.html'\\\" popover-popup-close-delay=\\\"500\\\" ng-bind-html=\\\"displayContent.inlineContent\\\" popover-placement=\\\"top-left\\\" popover-title=\\\"{{displayContent.toolTipTitle}}\\\"></span>\\n\" +\n    \"<script type=\\\"text/ng-template\\\" id=\\\"annotationTemplate.html\\\">\\n\" +\n    \"    <p>\\n\" +\n    \"        {{displayContent.toolTipContent}}\\n\" +\n    \"    </p>\\n\" +\n    \"    <p id=\\\"tooltipElementId\\\" style=\\\"position: absolute; left: -1000px; top: -1000px; \\\">\\n\" +\n    \"        {{displayContent.id}}\\n\" +\n    \"    </p>\\n\" +\n    \"    <button ng-click=\\\"copyToClipboard($event)\\\" class=\\\"btn btn-sm btn-default\\\"><i class=\\\"fa fa-copy\\\"></i>Copy Element ID</button>\\n\" +\n    \"</script>\\n\" +\n    \"\");\n}]);\n\nangular.module(\"mms/templates/mmsButtonBar.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mmsButtonBar.html\",\n    \"<span ng-repeat=\\\"button in buttons | filter: {permission: true}\\\">\\n\" +\n    \"\\n\" +\n    \"  <!-- Normal button -->\\n\" +\n    \"  <a type=\\\"button\\\" ng-if=\\\"!button.dropdown_buttons\\\" class=\\\"btn btn-tools btn-sm {{button.id}}\\\"\\n\" +\n    \"      ng-click=\\\"button.action($event)\\\" uib-tooltip=\\\"{{button.tooltip}}\\\" tooltip-append-to-body=\\\"false\\\"\\n\" +\n    \"      tooltip-trigger=\\\"mouseenter\\\" tooltip-popup-delay=\\\"100\\\" tooltip-placement=\\\"{{button.placement}}\\\">\\n\" +\n    \"      <i class=\\\"fa {{button.icon}}\\\"></i>{{button.text}}</a>\\n\" +\n    \"\\n\" +\n    \"  <!-- Button with dropdown buttons -->\\n\" +\n    \"  <span ng-if=\\\"button.dropdown_buttons\\\" class=\\\"btn-group\\\" uib-dropdown>\\n\" +\n    \"    <button type=\\\"button\\\" class=\\\"btn btn-tools btn-sm dropdown-toggle {{button.id}}\\\" uib-dropdown-toggle uib-tooltip=\\\"{{button.tooltip}}\\\"\\n\" +\n    \"        tooltip-append-to-body=\\\"false\\\" tooltip-trigger=\\\"mouseenter\\\" tooltip-popup-delay=\\\"100\\\"\\n\" +\n    \"        tooltip-placement=\\\"{{button.placement}}\\\">\\n\" +\n    \"        <i class=\\\"fa {{button.icon}}\\\"></i>{{button.button_content}}<span class=\\\"caret\\\"></span></button>\\n\" +\n    \"    <ul class=\\\"dropdown-menu\\\" role=\\\"menu\\\">\\n\" +\n    \"      <li>\\n\" +\n    \"          <a ng-repeat=\\\"dropdown_button in button.dropdown_buttons | filter: {permission: true}\\\" type=\\\"button\\\"\\n\" +\n    \"              class=\\\"center {{dropdown_button.id}} {{ button.id === 'view-mode-dropdown' && dropdown_button.selected ? 'checked-list-item' : ''}}\\\" ng-click=\\\"dropdown_button.action($event); mmsBbApi.select(button, dropdown_button)\\\"><i\\n\" +\n    \"              class=\\\"fa {{dropdown_button.icon}}\\\"> </i>&nbsp;{{dropdown_button.tooltip}}</a>\\n\" +\n    \"      </li>\\n\" +\n    \"    </ul>\\n\" +\n    \"  </span>\\n\" +\n    \"\\n\" +\n    \"</span>\\n\" +\n    \"\");\n}]);\n\nangular.module(\"mms/templates/mmsCfModal.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mmsCfModal.html\",\n    \"<div class=\\\"modal-header\\\">\\n\" +\n    \"    <h4>{{title}}</h4>\\n\" +\n    \"</div>\\n\" +\n    \"<div class=\\\"modal-body\\\">\\n\" +\n    \"    <div class=\\\"ve-light-tabs modal-top-tabs\\\" ng-show=\\\"showProposeLink\\\">\\n\" +\n    \"        <ul class=\\\"nav nav-tabs\\\">\\n\" +\n    \"            <li class=\\\"uib-tab nav-item tab-item\\\" ng-class=\\\"{'active': !searchExisting}\\\">\\n\" +\n    \"                <a class=\\\"nav-link\\\" ng-click=\\\"searchExisting = false\\\"><i class=\\\"fa fa-plus\\\"></i>Create New</a>\\n\" +\n    \"            </li>\\n\" +\n    \"            <li class=\\\"uib-tab nav-item tab-item\\\" ng-class=\\\"{'active': searchExisting}\\\">\\n\" +\n    \"                <a class=\\\"nav-link\\\" ng-click=\\\"searchExisting = true\\\"><i class=\\\"fa fa-search\\\"></i>Search for existing</a>\\n\" +\n    \"            </li>\\n\" +\n    \"        </ul>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"    <!-- Seach for exisiting panel -->\\n\" +\n    \"    <div ng-show=\\\"searchExisting\\\">\\n\" +\n    \"        <div class=\\\"transclude-modal-instructions\\\">\\n\" +\n    \"            {{description}}\\n\" +\n    \"        </div>\\n\" +\n    \"        <div class=\\\"form-group\\\" ng-show=\\\"!showProposeLink\\\"><br>\\n\" +\n    \"            <label>Link Text:</label>\\n\" +\n    \"            <div class=\\\"radio radio-with-label\\\">\\n\" +\n    \"                <label><input type=\\\"radio\\\" ng-model=\\\"linkType\\\" ng-value=\\\"1\\\">&nbsp;Document auto-numbering\\n\" +\n    \"                <a uib-tooltip=\\\"For links within current document, otherwise defaults to name\\\" tooltip-trigger=\\\"mouseenter\\\" tooltip-popup-delay=\\\"100\\\"><i class=\\\"fa fa-info-circle\\\"></i></a></label><br>\\n\" +\n    \"                <label><input type=\\\"radio\\\" ng-model=\\\"linkType\\\" ng-value=\\\"2\\\">&nbsp;Name</label><br>\\n\" +\n    \"                <label><input type=\\\"radio\\\" ng-model=\\\"linkType\\\" ng-value=\\\"3\\\">&nbsp;Custom&nbsp;\\n\" +\n    \"                    <input type=\\\"text\\\" ng-model=\\\"linkText\\\" placeholder=\\\"custom title\\\"/></label>\\n\" +\n    \"            </div>\\n\" +\n    \"        </div>\\n\" +\n    \"        <label ng-show=\\\"showEditableOp\\\" for=\\\"nonEditableCheckbox\\\">\\n\" +\n    \"            <input id=\\\"nonEditableCheckbox\\\" type=\\\"checkbox\\\" ng-model=\\\"nonEditableCheckbox\\\">&nbsp;Restrict editing\\n\" +\n    \"        </label>\\n\" +\n    \"\\n\" +\n    \"        <mms-search mms-options=\\\"searchOptions\\\" mms-project-id=\\\"{{mmsProjectId}}\\\" mms-ref-id=\\\"{{mmsRefId}}\\\"></mms-search>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"    <!-- Create New Panel -->\\n\" +\n    \"    <div ng-show=\\\"!searchExisting\\\">\\n\" +\n    \"        <form>\\n\" +\n    \"            <div class=\\\"form-group\\\">\\n\" +\n    \"                <label>Name </label><span class=\\\"star-mandatory\\\">*</span>\\n\" +\n    \"                <input class=\\\"form-control\\\" type=\\\"text\\\" ng-model=\\\"newE.name\\\" placeholder=\\\"Name your new element\\\" autofocus/>\\n\" +\n    \"            </div>\\n\" +\n    \"            <div class=\\\"form-group\\\">\\n\" +\n    \"                <label class=\\\"label-documentation\\\">Documentation</label>\\n\" +\n    \"                <textarea mms-ckeditor ng-model=\\\"newE.documentation\\\" mms-project-id=\\\"{{mmsProjectId}}\\\" mms-ref-id=\\\"{{mmsRefId}}\\\" class=\\\"textarea-transclude-modal\\\"></textarea>\\n\" +\n    \"            </div>\\n\" +\n    \"            <label>Property to cross-reference</label><span class=\\\"star-mandatory\\\">*</span>\\n\" +\n    \"            <div class=\\\"radio radio-with-label\\\">\\n\" +\n    \"                <label><input type=\\\"radio\\\" name=\\\"optradio\\\" value=\\\"true\\\" ng-click=\\\"toggleRadio('name')\\\">Name</label><br>\\n\" +\n    \"                <label><input type=\\\"radio\\\" name=\\\"optradio\\\" value=\\\"true\\\" ng-click=\\\"toggleRadio('documentation')\\\">Documentation</label>\\n\" +\n    \"            </div>\\n\" +\n    \"        </form>\\n\" +\n    \"\\n\" +\n    \"        <p class=\\\"help-block pull-left\\\"><i>Fields marked with <span class=\\\"star-mandatory\\\">*</span> are required</i></p>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\" +\n    \"<div class=\\\"modal-footer\\\">\\n\" +\n    \"    <button class=\\\"btn btn-primary\\\" ng-show=\\\"!searchExisting\\\" type=\\\"button\\\" ng-click=\\\"makeNewAndChoose()\\\">Create & Cross Reference<i class=\\\"{{proposeClass}}\\\"></i></button>\\n\" +\n    \"    <button class=\\\"btn btn-default\\\" ng-click=\\\"cancel()\\\">Cancel</button>\\n\" +\n    \"</div>\");\n}]);\n\nangular.module(\"mms/templates/mmsCommentModal.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mmsCommentModal.html\",\n    \"<div class=\\\"modal-header\\\">\\n\" +\n    \"    <h4>Insert a comment</h4>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-body comment-modal\\\">\\n\" +\n    \"    <div class=\\\"comment-modal-input\\\">\\n\" +\n    \"        <div class=\\\"form-group\\\">\\n\" +\n    \"            <label>Title</label>\\n\" +\n    \"            <input class=\\\"form-control\\\" ng-model=\\\"comment.name\\\" type=\\\"text\\\"\\n\" +\n    \"                   placeholder=\\\"Type a title for your comment here\\\" autofocus>\\n\" +\n    \"        </div>\\n\" +\n    \"        <div class=\\\"form-group\\\">\\n\" +\n    \"            <label>Comment</label>\\n\" +\n    \"            <textarea class=\\\"form-control\\\" rows=\\\"3\\\" ng-model=\\\"comment.documentation\\\" \\n\" +\n    \"                placeholder=\\\"Type your comment here\\\" ng-keyup=\\\"$event.keyCode == 13 ? ok(comment) : null\\\"></textarea>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-footer\\\">\\n\" +\n    \"    <button class=\\\"btn btn-primary\\\" ng-click=\\\"ok(comment)\\\">Create <i ng-show=\\\"oking\\\" class=\\\"fa fa-spin fa-spinner\\\"></i>\\n\" +\n    \"    </button>\\n\" +\n    \"    <button class=\\\"btn btn-default\\\" ng-click=\\\"cancel()\\\">Cancel</button>\\n\" +\n    \"</div>\");\n}]);\n\nangular.module(\"mms/templates/mmsDiffAttr.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mmsDiffAttr.html\",\n    \"<span ng-show=\\\"diffLoading\\\">\\n\" +\n    \"    <i class=\\\"fa fa-spin fa-spinner\\\"></i>\\n\" +\n    \"</span>\\n\" +\n    \"<span ng-hide=\\\"diffLoading\\\">\\n\" +\n    \"    <span class=\\\"text-info\\\" ng-if=\\\"message\\\"><i class=\\\"fa fa-info-circle\\\"></i>{{message}}</span>\\n\" +\n    \"    <mms-html-diff ng-if=\\\"baseElementHtml != undefined && comparedElementHtml != undefined\\\" mms-base-html=\\\"baseElementHtml\\\" mms-compared-html=\\\"comparedElementHtml\\\" mms-diff-finish=\\\"diffFinish\\\"></mms-html-diff>\\n\" +\n    \"</span>\");\n}]);\n\nangular.module(\"mms/templates/mmsGroupDocs.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mmsGroupDocs.html\",\n    \"<table class=\\\"table table-condensed\\\">\\n\" +\n    \"    <tr><th>Document(s)</th><!--<th>Last Modified</th><th>Last Modified By</th><th>Created</th>--></tr>\\n\" +\n    \"    <tr ng-repeat=\\\"doc in docs | orderBy: 'name'\\\">\\n\" +\n    \"        <td><mms-view-link mms-document-id=\\\"{{doc.id}}\\\" mms-element-id=\\\"{{doc.id}}\\\" mms-project-id=\\\"{{projectId}}\\\" mms-ref-id=\\\"{{refId}}\\\"></mms-view-link></td>\\n\" +\n    \"    </tr>\\n\" +\n    \"</table>\");\n}]);\n\nangular.module(\"mms/templates/mmsHistory.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mmsHistory.html\",\n    \"<h4 class=\\\"right-pane-title\\\">Element History\\n\" +\n    \"    <span ng-show=\\\"gettingHistory\\\"><i class=\\\"fa fa-spin fa-spinner\\\"></i></span>\\n\" +\n    \"</h4>\\n\" +\n    \"\\n\" +\n    \"<div style=\\\"margin-bottom:6px;\\\">\\n\" +\n    \"    <input type=\\\"checkbox\\\" style=\\\"margin-right:4px;\\\" ng-model=\\\"ModelData.ShowDiffPrototype\\\" ng-disabled=\\\"disableCompare\\\">Compare versions\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div style=\\\"position:relative;\\\">\\n\" +\n    \"    <div ng-if=\\\"ModelData.ShowDiffPrototype\\\" class=\\\"inline-diff-buttons fade-in-out\\\">\\n\" +\n    \"        <span class=\\\"inline-btn-label\\\">Before:</span>\\n\" +\n    \"        <div class=\\\"btn-group ve-light-dropdown\\\" uib-dropdown keyboard-nav is-open=\\\"baseCommit.isopen\\\" auto-close=\\\"outsideClick\\\" style=\\\"flex:2\\\" ng-hide=\\\"disableRevert\\\">\\n\" +\n    \"            <button class=\\\"dropdown-toggle\\\" type=\\\"button\\\" uib-dropdown-toggle>\\n\" +\n    \"                {{baseCommit.commitSelected._created | date:'M/d/yy h:mm a'}} by <b>{{baseCommit.commitSelected._creator}}</b><span ng-if=\\\"baseCommit.commitSelected.id === baseCommit.baseHistory[0].id\\\"> (Latest)</span>\\n\" +\n    \"                <i class=\\\"fa fa-caret-down\\\" aria-hidden=\\\"true\\\"></i>\\n\" +\n    \"            </button>\\n\" +\n    \"            <ul class=\\\"dropdown-menu menu-with-input\\\" uib-dropdown-menu role=\\\"menu\\\">\\n\" +\n    \"                <li class=\\\"dropdown-input\\\">\\n\" +\n    \"                    <input class=\\\"ve-plain-input\\\" ng-model=\\\"compareHistoryFilter\\\" type=\\\"text\\\" placeholder=\\\"Filter history on {{baseCommit.refSelected.type}}: {{baseCommit.refSelected.name}}\\\">\\n\" +\n    \"                </li>\\n\" +\n    \"                <li ng-click=\\\"baseCommitClicked(version)\\\" ng-repeat=\\\"version in baseCommit.baseHistory | filter:compareHistoryFilter\\\"\\n\" +\n    \"                    ng-class=\\\"{'checked-list-item': version === baseCommit.commitSelected,'secondary-checked-list-item': version === compareCommit.commitSelected}\\\"\\n\" +\n    \"                    ng-disabled=\\\"$index === 0\\\" tooltip-placement=\\\"left\\\" uib-tooltip=\\\"Selected after version\\\"\\n\" +\n    \"                    tooltip-append-to-body=\\\"version === compareCommit.commitSelected\\\" tooltip-enable=\\\"version === compareCommit.commitSelected\\\">\\n\" +\n    \"                    <a>{{version._created | date:'M/d/yy h:mm a'}} by <b>{{ version._creator }}</b><span ng-if=\\\"$index == 0\\\"> (Latest)</span></a>\\n\" +\n    \"                </li>\\n\" +\n    \"            </ul>\\n\" +\n    \"        </div>\\n\" +\n    \"\\n\" +\n    \"        <span class=\\\"inline-btn-label\\\" style=\\\"flex:2;text-align:right;\\\" ng-show=\\\"disableRevert\\\">Element does not exist</span>\\n\" +\n    \"\\n\" +\n    \"        <span class=\\\"inline-btn-label\\\"> on</span>\\n\" +\n    \"\\n\" +\n    \"        <div class=\\\"btn-group ve-light-dropdown\\\" uib-dropdown keyboard-nav is-open=\\\"baseCommit.refisopen\\\" auto-close=\\\"outsideClick\\\" style=\\\"flex:1\\\">\\n\" +\n    \"            <button class=\\\"dropdown-toggle\\\" type=\\\"button\\\" uib-dropdown-toggle>\\n\" +\n    \"                {{baseCommit.refSelected.type}}: <b>{{baseCommit.refSelected.name}}</b>\\n\" +\n    \"                <i class=\\\"fa fa-caret-down\\\" aria-hidden=\\\"true\\\"></i>\\n\" +\n    \"            </button>\\n\" +\n    \"            <ul class=\\\"dropdown-menu menu-with-input pull-right\\\" uib-dropdown-menu role=\\\"menu\\\">\\n\" +\n    \"                <li class=\\\"dropdown-input\\\">\\n\" +\n    \"                    <input class=\\\"ve-plain-input\\\" type=\\\"text\\\" placeholder=\\\"Filter branches/tags\\\" ng-model=\\\"refFilter\\\">\\n\" +\n    \"                </li>\\n\" +\n    \"                <li ng-click=\\\"getElementHistoryByRef(ref)\\\" ng-repeat=\\\"ref in refList | filter:refFilter\\\"\\n\" +\n    \"                    ng-class=\\\"{'checked-list-item': ref.id === baseCommit.refSelected.id}\\\">\\n\" +\n    \"                    <a>{{ ref.type }}: <b>{{ref.name}}</b></a>\\n\" +\n    \"                </li>\\n\" +\n    \"            </ul>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"    <div class=\\\"diff-dotted-connection fade-in-out\\\" ng-show=\\\"ModelData.ShowDiffPrototype\\\"></div>\\n\" +\n    \"    <div class=\\\"inline-diff-buttons\\\">\\n\" +\n    \"        <span class=\\\"inline-btn-label fade-in-out\\\" ng-show=\\\"ModelData.ShowDiffPrototype\\\">After:</span>\\n\" +\n    \"        <div class=\\\"btn-group ve-light-dropdown\\\" ng-class=\\\"{'flex-grow-shrink':ModelData.ShowDiffPrototype}\\\" uib-dropdown keyboard-nav is-open=\\\"compareCommit.isopen\\\" auto-close=\\\"outsideClick\\\" style=\\\"flex:2\\\">\\n\" +\n    \"            <button class=\\\"dropdown-toggle\\\" type=\\\"button\\\" uib-dropdown-toggle>\\n\" +\n    \"                <span>{{compareCommit.commitSelected._created | date:'M/d/yy h:mm a'}} by <b>{{compareCommit.commitSelected._creator}}</b></span>\\n\" +\n    \"                <span ng-if=\\\"compareCommit.commitSelected.id === compareCommit.compareHistory[0].id\\\"> (Latest)</span>\\n\" +\n    \"                <i class=\\\"fa fa-caret-down\\\" aria-hidden=\\\"true\\\"></i>\\n\" +\n    \"            </button>\\n\" +\n    \"            <ul class=\\\"dropdown-menu menu-with-input\\\" uib-dropdown-menu role=\\\"menu\\\">\\n\" +\n    \"                <li class=\\\"dropdown-input\\\">\\n\" +\n    \"                    <input class=\\\"ve-plain-input\\\" type=\\\"text\\\" placeholder=\\\"Filter history on {{compareCommit.ref.type}}: {{compareCommit.ref.name}}\\\" ng-model=\\\"historyFilter\\\">\\n\" +\n    \"                </li>\\n\" +\n    \"                <li ng-click=\\\"commitClicked(version)\\\" ng-repeat=\\\"version in compareCommit.compareHistory | filter:historyFilter\\\"\\n\" +\n    \"                    ng-class=\\\"{'checked-list-item': version === compareCommit.commitSelected,'secondary-checked-list-item': version === baseCommit.commitSelected && ModelData.ShowDiffPrototype}\\\"\\n\" +\n    \"                    tooltip-placement=\\\"left\\\" uib-tooltip=\\\"Selected before version\\\"\\n\" +\n    \"                    tooltip-append-to-body=\\\"version === baseCommit.commitSelected\\\" tooltip-enable=\\\"ModelData.ShowDiffPrototype && version === baseCommit.commitSelected\\\">\\n\" +\n    \"                    <a>{{version._created | date:'M/d/yy h:mm a'}} by <b>{{ version._creator }}</b><span ng-if=\\\"$index == 0\\\"> (Latest)</span></a>\\n\" +\n    \"                </li>\\n\" +\n    \"            </ul>\\n\" +\n    \"        </div>\\n\" +\n    \"        <span class=\\\"inline-btn-label\\\" ng-show=\\\"ModelData.ShowDiffPrototype\\\">on</span>\\n\" +\n    \"        <span class=\\\"inline-btn-label fade-in-out\\\" ng-show=\\\"ModelData.ShowDiffPrototype\\\" style=\\\"flex:1\\\">{{compareCommit.ref.type}}: <b>{{compareCommit.ref.name}}</b></span>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<hr class=\\\"spec-title-divider\\\">\\n\" +\n    \"\\n\" +\n    \"<div ng-if=\\\"ModelData.ShowDiffPrototype\\\">\\n\" +\n    \"    <div class=\\\"ve-notify-banner fade-in-out\\\" ng-show=\\\"disableRevert\\\">\\n\" +\n    \"        <span>Element does not exist on <strong>{{baseCommit.refSelected.type}}: {{baseCommit.refSelected.name}}</strong></span>\\n\" +\n    \"    </div>\\n\" +\n    \"    <div ng-hide=\\\"disableRevert\\\">\\n\" +\n    \"        <h1 class=\\\"prop element-title\\\">\\n\" +\n    \"            <mms-diff-attr mms-attr=\\\"name\\\"\\n\" +\n    \"                           mms-base-project-id=\\\"{{mmsProjectId}}\\\"\\n\" +\n    \"                           mms-base-ref-id=\\\"{{baseCommit.refSelected.id}}\\\"\\n\" +\n    \"                           mms-base-commit-id=\\\"{{baseCommit.commitSelected.id}}\\\"\\n\" +\n    \"                           mms-base-element-id=\\\"{{mmsElementId}}\\\"\\n\" +\n    \"                           mms-compare-ref-id=\\\"{{mmsRefId}}\\\"\\n\" +\n    \"                           mms-compare-commit-id=\\\"{{compareCommit.commitSelected.id}}\\\">\\n\" +\n    \"            </mms-diff-attr>\\n\" +\n    \"        </h1>\\n\" +\n    \"\\n\" +\n    \"        <h2 class=\\\"prop-title spec-view-doc-heading\\\">Documentation</h2>\\n\" +\n    \"        <mms-diff-attr mms-attr=\\\"doc\\\"\\n\" +\n    \"                       mms-base-project-id=\\\"{{mmsProjectId}}\\\"\\n\" +\n    \"                       mms-base-ref-id=\\\"{{baseCommit.refSelected.id}}\\\"\\n\" +\n    \"                       mms-base-commit-id=\\\"{{baseCommit.commitSelected.id}}\\\"\\n\" +\n    \"                       mms-base-element-id=\\\"{{mmsElementId}}\\\"\\n\" +\n    \"                       mms-compare-ref-id=\\\"{{mmsRefId}}\\\"\\n\" +\n    \"                       mms-compare-commit-id=\\\"{{compareCommit.commitSelected.id}}\\\">\\n\" +\n    \"        </mms-diff-attr>\\n\" +\n    \"\\n\" +\n    \"        <div ng-if=\\\"element.type === 'Property' || element.type === 'Port' || element.type === 'Slot'\\\">\\n\" +\n    \"            <h2 class=\\\"prop-title\\\">Property Value</h2>\\n\" +\n    \"            <span class=\\\"prop\\\">\\n\" +\n    \"                <mms-diff-attr mms-attr=\\\"val\\\"\\n\" +\n    \"                               mms-base-project-id=\\\"{{mmsProjectId}}\\\"\\n\" +\n    \"                               mms-base-ref-id=\\\"{{baseCommit.refSelected.id}}\\\"\\n\" +\n    \"                               mms-base-commit-id=\\\"{{baseCommit.commitSelected.id}}\\\"\\n\" +\n    \"                               mms-base-element-id=\\\"{{mmsElementId}}\\\"\\n\" +\n    \"                               mms-compare-ref-id=\\\"{{mmsRefId}}\\\"\\n\" +\n    \"                               mms-compare-commit-id=\\\"{{compareCommit.commitSelected.id}}\\\">\\n\" +\n    \"                </mms-diff-attr>\\n\" +\n    \"            </span>\\n\" +\n    \"        </div>\\n\" +\n    \"        <h2 class=\\\"prop-title\\\">Commit</h2>\\n\" +\n    \"        <span class=\\\"prop\\\">{{baseCommit.commitSelected.id}}<br>\\n\" +\n    \"        <img src=\\\"assets/images/arrow-change.svg\\\" class=\\\"change-connection\\\"><br>\\n\" +\n    \"        {{compareCommit.commitSelected.id}}</span>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<!-- Spec window -->\\n\" +\n    \"<div ng-hide=\\\"ModelData.ShowDiffPrototype\\\">\\n\" +\n    \"    <mms-spec mms-element-id=\\\"{{mmsElementId}}\\\" mms-project-id=\\\"{{mmsProjectId}}\\\" mms-ref-id=\\\"{{mmsRefId}}\\\" mms-commit-id=\\\"{{historyVer}}\\\" no-edit=\\\"true\\\"></mms-spec>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div ng-show=\\\"ModelData.ShowDiffPrototype && compareCommit.ref.type === 'Tag'\\\" class=\\\"revert-section fade-in-out\\\">\\n\" +\n    \"    <div>\\n\" +\n    \"        <span class=\\\"ve-secondary-text\\\">Cannot make changes on a <b>Tag</b>.</span>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\" +\n    \"<div ng-show=\\\"ModelData.ShowDiffPrototype && !disableRevert && compareCommit.ref.type !== 'Tag'\\\" class=\\\"revert-section fade-in-out\\\">\\n\" +\n    \"    <div>\\n\" +\n    \"        <span>To revert <b>documentation</b>, <b>name</b>, and <b>value</b> to before content ({{baseCommit.commitSelected._created | date:'M/d/yy h:mm a'}} by <b>{{baseCommit.commitSelected._creator}}</b>):</span>\\n\" +\n    \"        <button class=\\\"btn btn-warning btn-sm pull-right\\\" ng-click=\\\"revert()\\\">Revert</button>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\" +\n    \"\");\n}]);\n\nangular.module(\"mms/templates/mmsHtmlDiff.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mmsHtmlDiff.html\",\n    \"<div id=\\\"{{htmlDiffId}}\\\" class=\\\"htmlDiff\\\" ng-bind-html=\\\"diffResult\\\"></div>\\n\" +\n    \"\");\n}]);\n\nangular.module(\"mms/templates/mmsJobs.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mmsJobs.html\",\n    \"<h4 class=\\\"right-pane-title\\\">Jobs</h4>\\n\" +\n    \"<span ng-if=\\\"loadingJobs\\\"><i class=\\\"fa fa-spin fa-spinner\\\"></i></span>\\n\" +\n    \"<hr class=\\\"spec-title-divider\\\">\\n\" +\n    \"\\n\" +\n    \"<div id=\\\"ve-jobs-table\\\">\\n\" +\n    \"    <h3>View Editor</h3>\\n\" +\n    \"    <div ng-if=\\\"!refList.length\\\" class=\\\"text-center well empty-state\\\">\\n\" +\n    \"    <h4>No Current VE Jobs</h4>\\n\" +\n    \"    </div>\\n\" +\n    \"    <table class=\\\"table table-condensed\\\" ng-if=\\\"refList.length\\\">\\n\" +\n    \"        <thead>\\n\" +\n    \"            <tr>\\n\" +\n    \"                <td>Name</td>\\n\" +\n    \"                <td>Status</td>\\n\" +\n    \"                <td>Created</td>\\n\" +\n    \"            </tr>\\n\" +\n    \"        </thead>\\n\" +\n    \"        <tbody>\\n\" +\n    \"            <tr ng-repeat=\\\"ref in refList\\\">\\n\" +\n    \"                <td>{{ref.type}}: {{ref.name}}</td>\\n\" +\n    \"                <td>\\n\" +\n    \"                    <div ng-switch=\\\"ref.status\\\">\\n\" +\n    \"                        <span ng-switch-when=\\\"creating\\\">\\n\" +\n    \"                            <i class=\\\"fa fa-ellipsis-h in-progress-marker\\\" aria-hidden=\\\"true\\\"></i>{{ref.status}} \\n\" +\n    \"                        </span>\\n\" +\n    \"                        <span ng-switch-when=\\\"fail\\\">\\n\" +\n    \"                            <i class=\\\"fa fa-circle failed-marker\\\" aria-hidden=\\\"true\\\"></i>{{ref.status}} \\n\" +\n    \"                        </span>\\n\" +\n    \"                        <span ng-switch-when=\\\"created\\\">\\n\" +\n    \"                            <i class=\\\"fa fa-circle completed-marker\\\" aria-hidden=\\\"true\\\"></i>{{ref.status}}\\n\" +\n    \"                        </span>\\n\" +\n    \"                    </div>\\n\" +\n    \"                </td>\\n\" +\n    \"                <td>{{ref._created | date:'M/d/yy h:mm a'}}</td>\\n\" +\n    \"            </tr>\\n\" +\n    \"        </tbody>\\n\" +\n    \"    </table><br>\\n\" +\n    \"\\n\" +\n    \"\\n\" +\n    \"    <h3>PMA (Platform for Modeling and Analysis)</h3>\\n\" +\n    \"    <table class=\\\"table table-condensed\\\" ng-if=\\\"!loadingJobs && jobs.length\\\">\\n\" +\n    \"        <thead>\\n\" +\n    \"            <tr>\\n\" +\n    \"                <td>Name</td>\\n\" +\n    \"                <!--<td>Created</td>-->\\n\" +\n    \"                <td>Status</td>\\n\" +\n    \"                <td>Actions</td>\\n\" +\n    \"            </tr>\\n\" +\n    \"        </thead>\\n\" +\n    \"        <tbody>\\n\" +\n    \"            <tr ng-repeat=\\\"job in jobs\\\">\\n\" +\n    \"                <td>\\n\" +\n    \"                    <div ng-hide=\\\"editorEnabled\\\">\\n\" +\n    \"                        <b>{{job.name}}</b>\\n\" +\n    \"                        <!--<a class=\\\"ng-binding\\\" ng-click=\\\"enableEditor()\\\">-->\\n\" +\n    \"                            <!--<i class=\\\"fa fa-pencil\\\" aria-hidden=\\\"true\\\"></i>-->\\n\" +\n    \"                        <!--</a>-->\\n\" +\n    \"                    </div>\\n\" +\n    \"                    <!--<div ng-show=\\\"editorEnabled\\\">\\n\" +\n    \"                        <input ng-model=\\\"jobInput.jobName\\\" ng-show=\\\"editorEnabled\\\">\\n\" +\n    \"                        <a ng-click=\\\"save()\\\">Save</a>\\n\" +\n    \"                        or\\n\" +\n    \"                        <a ng-click=\\\"disableEditor()\\\">Cancel</a>\\n\" +\n    \"                    </div>-->\\n\" +\n    \"                </td>\\n\" +\n    \"                <!--<td>\\n\" +\n    \"                    <select class = \\\"form-control\\\">\\n\" +\n    \"                        {{job.create}}\\n\" +\n    \"                    </select>\\n\" +\n    \"                </td>-->\\n\" +\n    \"                <td>\\n\" +\n    \"                    <div ng-if=\\\"loading\\\">\\n\" +\n    \"                        <span><i class=\\\"fa fa-spinner fa-spin\\\"></i>&nbsp;Loading...</span>\\n\" +\n    \"                    </div>\\n\" +\n    \"                    <div ng-show=\\\"job.latestStatus || (jobInstances[job.id] && jobInstances[job.id].length)\\\">\\n\" +\n    \"                        <b>Build {{jobInstances[job.id][0].buildNumber}}</b>\\n\" +\n    \"                        <div class=\\\"build-details\\\" ng-switch=\\\"jobInstances[job.id][0].jobStatus\\\">\\n\" +\n    \"                            <span ng-switch-when=\\\"pending|loading|running|started\\\" ng-switch-when-separator=\\\"|\\\">\\n\" +\n    \"                                Started {{jobInstances[job.id][0].started | date:'M/d/yy h:mm a'}}<br>\\n\" +\n    \"                                <i class=\\\"fa fa-ellipsis-h in-progress-marker\\\" aria-hidden=\\\"true\\\"></i>in progress\\n\" +\n    \"                            </span>\\n\" +\n    \"                            <span ng-switch-when=\\\"failed\\\">\\n\" +\n    \"                                Completed {{jobInstances[job.id][0].completed | date:'M/d/yy h:mm a'}}<br>\\n\" +\n    \"                                <i class=\\\"fa fa-circle failed-marker\\\" aria-hidden=\\\"true\\\"></i>failed\\n\" +\n    \"                            </span>\\n\" +\n    \"                            <span ng-switch-when=\\\"completed\\\">\\n\" +\n    \"                                Completed {{jobInstances[job.id][0].completed | date:'M/d/yy h:mm a'}}<br>\\n\" +\n    \"                                <i class=\\\"fa fa-circle completed-marker\\\" aria-hidden=\\\"true\\\"></i>success\\n\" +\n    \"                            </span>\\n\" +\n    \"                            <span class=\\\"animate-switch\\\" ng-switch-default>{{jobInstances[job.id][0].jobStatus}}</span>\\n\" +\n    \"                            <a ng-attr-href=\\\"{{jobInstances[job.id][0].logUrl}}\\\" target=\\\"_blank\\\" rel=\\\"noopener noreferrer\\\" ng-show=\\\"jobInstances[job.id][0].logUrl\\\">log</a>\\n\" +\n    \"                        </div>\\n\" +\n    \"                    </div>\\n\" +\n    \"                    <div ng-if=\\\"(!jobInstances[job.id] || !jobInstances[job.id].length) && !loading\\\">\\n\" +\n    \"                        <span>No runs</span>\\n\" +\n    \"                    </div>\\n\" +\n    \"                </td>\\n\" +\n    \"                <td>\\n\" +\n    \"                    <div ng-if=\\\"jobInstances[job.id][0].type === 'docmerge'\\\">\\n\" +\n    \"                        <a ng-click=\\\"changePane('gotoTagsBranches')\\\">Go to branches/tags pane</a>\\n\" +\n    \"                    </div>\\n\" +\n    \"                    <div ng-switch=\\\"jobInstances[job.id][0].jobStatus\\\" ng-if=\\\"jobInstances[job.id][0].type != 'docmerge'\\\">\\n\" +\n    \"                        <span ng-switch-when=\\\"pending|loading|running|started\\\" ng-switch-when-separator=\\\"|\\\">\\n\" +\n    \"                        <button class=\\\"btn btn-primary btn-sm disabled\\\">\\n\" +\n    \"                            Run Now <i ng-show=\\\"!runCleared\\\" class=\\\"fa fa-spin fa-spinner\\\"></i>\\n\" +\n    \"                        </button>\\n\" +\n    \"                        </span>\\n\" +\n    \"                        <span ng-switch-default>\\n\" +\n    \"                            <button class=\\\"btn btn-primary btn-sm\\\" ng-class=\\\"{'disabled': !docEditable || !runCleared || loading}\\\" ng-click=\\\"!runCleared || createJobandRun(job.id)\\\">\\n\" +\n    \"                                Run Now <i ng-show=\\\"!runCleared\\\" class=\\\"fa fa-spin fa-spinner\\\"></i>\\n\" +\n    \"                            </button>\\n\" +\n    \"                        </span>\\n\" +\n    \"                    </div>\\n\" +\n    \"                </td>\\n\" +\n    \"            </tr>\\n\" +\n    \"        </tbody>\\n\" +\n    \"    </table>\\n\" +\n    \"    <div ng-if=\\\"!docgenExists && !loadingJobs\\\" class=\\\"text-center well empty-state\\\">\\n\" +\n    \"        <h4 ng-if=\\\"!jobs.length && !loadingJobs\\\">No Current PMA Jobs</h4>\\n\" +\n    \"        <p><i>What's PMA?</i> PMA regenerates views for the current document. \\n\" +\n    \"        <a target=\\\"_blank\\\" href=\\\"https://wiki.jpl.nasa.gov/display/opencae/View+Editor+User+Guide%3A+5+Jobs\\\">More</a></p>\\n\" +\n    \"        <p ng-if=\\\"mmsRefType == 'Tag'\\\">PMA is not available on tags.</p>\\n\" +\n    \"        <p ng-if=\\\"!isDoc\\\">Please select a document.</p>\\n\" +\n    \"        <button class=\\\"btn btn-primary\\\" ng-if=\\\"mmsRefType != 'Tag' && isDoc\\\" ng-click=\\\"!createJobCleared || createJobandRun()\\\" ng-class=\\\"{'disabled': !docEditable || !runCleared || !createJobCleared}\\\">\\n\" +\n    \"            Run DocGen <i ng-hide=\\\"createJobCleared\\\" class=\\\"fa fa-spin fa-spinner\\\"></i>\\n\" +\n    \"        </button>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"\");\n}]);\n\nangular.module(\"mms/templates/mmsMention.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mmsMention.html\",\n    \"<script type=\\\"text/ng-template\\\" id=\\\"customTemplate.html\\\">\\n\" +\n    \"    <a class=\\\"itemContainer\\\" ng-switch=\\\"match.model.type\\\">\\n\" +\n    \"        <span ng-switch-when=\\\"name\\\" class=\\\"nameContainer\\\">\\n\" +\n    \"            <div class=\\\"leftItem\\\">\\n\" +\n    \"                <i class=\\\"icon\\\" ng-class=\\\"match.model.iconClass\\\"></i>\\n\" +\n    \"                <span> name </span>\\n\" +\n    \"                <span id=\\\"{{match.model.id + match.model.type}}\\\" class=\\\"matchName mentionMatch\\\" ng-bind-html=\\\"match.model.name | underlineMatch:query\\\"></span>\\n\" +\n    \"                <br>\\n\" +\n    \"            </div>\\n\" +\n    \"            <div class=\\\"rightItem\\\">\\n\" +\n    \"                <span class=\\\"elementType\\\">{{match.model.elementType}}</span>\\n\" +\n    \"                <span>last mod {{match.model.editTime}} by\\n\" +\n    \"                    <span class=\\\"editor\\\">{{match.model.editor}}</span>\\n\" +\n    \"                </span>\\n\" +\n    \"            </div>\\n\" +\n    \"        </span>\\n\" +\n    \"        <span ng-switch-when=\\\"doc\\\" class=\\\"contentContainer\\\">\\n\" +\n    \"            <span> documentation </span>\\n\" +\n    \"            <span id=\\\"{{match.model.id + match.model.type}}\\\" class=\\\"content mentionMatch\\\">{{match.model.documentation}}</span>\\n\" +\n    \"        </span>\\n\" +\n    \"        <div ng-switch-when=\\\"val\\\" class=\\\"contentContainer\\\" ng-if=\\\"match.model.type === 'val'\\\">\\n\" +\n    \"            <span> value </span>\\n\" +\n    \"            <span id=\\\"{{match.model.id + match.model.type}}\\\" class=\\\"content mentionMatch\\\">{{match.model.value}}</span>\\n\" +\n    \"        </div>\\n\" +\n    \"    </a>\\n\" +\n    \"</script>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"mmsMention\\\" id={{mmsMentionId}}>\\n\" +\n    \"    <input style=\\\"display:none;\\\" mms-mention-intercept mms-mention-intercept-value=\\\"mmsMentionValue\\\"\\n\" +\n    \"           uib-typeahead=\\\"mentionItem as mentionItem.name for mentionItem in fastCfListing | filter:{name: $viewValue} | limitTo:10\\\"\\n\" +\n    \"           typeahead-template-url=\\\"customTemplate.html\\\" typeahead-on-select='selectMentionItem($item, $model)'\\n\" +\n    \"           ng-model=\\\"selected\\\" class=\\\"autocomplete-modal-typeahead form-control\\\"\\n\" +\n    \"           placeholder=\\\"Type an element name to Cf\\\" autofocus/>\\n\" +\n    \"</div>\\n\" +\n    \"\");\n}]);\n\nangular.module(\"mms/templates/mmsRefList.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mmsRefList.html\",\n    \"<input class=\\\"form-control\\\" ng-model=\\\"refFilter\\\" type=\\\"text\\\" placeholder=\\\"Filter branches/tags\\\">\\n\" +\n    \"\\n\" +\n    \"<table class=\\\"tags-table table table-condensed\\\">\\n\" +\n    \"    <thead>\\n\" +\n    \"        <tr>\\n\" +\n    \"            <td><h3 class=\\\"Tag-icon\\\">Tag</h3></td>\\n\" +\n    \"            <td><h3>Created</h3></td>\\n\" +\n    \"            <td ng-if=\\\"isDoc && docEditable && showMerge\\\"></td>\\n\" +\n    \"        </tr>\\n\" +\n    \"    </thead>\\n\" +\n    \"    <tbody ng-show=\\\"filteredTags.length\\\">\\n\" +\n    \"        <tr ng-repeat=\\\"tag in filteredTags = (mmsTags | orderBy:'-_created' | filter: {name : refFilter})\\\">\\n\" +\n    \"            <td>\\n\" +\n    \"                <a ui-sref=\\\"{refId: tag.id}\\\"><b>{{tag.name}}</b></a>\\n\" +\n    \"                <div>{{tag.description}}</div>\\n\" +\n    \"            </td>\\n\" +\n    \"            <td class=\\\"ve-secondary-text\\\">{{tag._created | date:'M/d/yy h:mm a'}}</td>\\n\" +\n    \"            <td ng-if=\\\"isDoc && docEditable && showMerge\\\">\\n\" +\n    \"                <div class=\\\"btn-group\\\" uib-dropdown is-open=\\\"status.isopen\\\">\\n\" +\n    \"                    <button type=\\\"button\\\" class=\\\"btn btn-default\\\" uib-dropdown-toggle ng-disabled=\\\"disabled\\\" title=\\\"Tag actions\\\">\\n\" +\n    \"                        <i class=\\\"fa fa-ellipsis-v\\\"></i>\\n\" +\n    \"                    </button>\\n\" +\n    \"                    <ul class=\\\"dropdown-menu pull-right\\\" uib-dropdown-menu role=\\\"menu\\\" aria-labelledby=\\\"single-button\\\">\\n\" +\n    \"                        <li role=\\\"menuitem\\\" style=\\\"padding:10px;\\\">\\n\" +\n    \"                            <button class=\\\"btn btn-default btn-sm\\\" ng-class=\\\"{'disabled': !docEditable || !runCleared}\\\" ng-click=\\\"docMergeAction(tag)\\\">\\n\" +\n    \"                                Pull In<i ng-show=\\\"!runCleared\\\" class=\\\"fa fa-spin fa-spinner\\\"></i>\\n\" +\n    \"                            </button> to this document on current branch\\n\" +\n    \"                        </li>\\n\" +\n    \"                    </ul>\\n\" +\n    \"                </div>\\n\" +\n    \"            </td>\\n\" +\n    \"        </tr>\\n\" +\n    \"    </tbody>\\n\" +\n    \"\\n\" +\n    \"    <tbody ng-show=\\\"mmsTags.length && !filteredTags.length\\\"><tr><td colspan=\\\"3\\\" class=\\\"ve-secondary-text\\\">No tags found</td></tr></tbody>\\n\" +\n    \"\\n\" +\n    \"    <tbody ng-hide=\\\"mmsTags.length\\\"><tr><td colspan=\\\"3\\\" class=\\\"ve-secondary-text\\\">No tags in current project.</td></tr></tbody>\\n\" +\n    \"\\n\" +\n    \"    <thead>\\n\" +\n    \"        <tr>\\n\" +\n    \"            <td><h3 class=\\\"Branch-icon\\\">Branch</h3></td>\\n\" +\n    \"            <td><h3>Created</h3></td>\\n\" +\n    \"            <td ng-if=\\\"isDoc && docEditable && showMerge\\\"></td>\\n\" +\n    \"        </tr>\\n\" +\n    \"    </thead>\\n\" +\n    \"    <tbody ng-show=\\\"filteredBranches.length\\\">\\n\" +\n    \"        <tr ng-repeat=\\\"branch in filteredBranches = (mmsBranches | orderBy:'-_created' | filter: {name : refFilter})\\\">\\n\" +\n    \"            <td>\\n\" +\n    \"                <a ui-sref=\\\"{refId: branch.id}\\\"><b>{{branch.name}}</b></a>\\n\" +\n    \"                <div>{{branch.description}}</div>\\n\" +\n    \"            </td>\\n\" +\n    \"            <td class=\\\"ve-secondary-text\\\">{{branch._created | date:'M/d/yy h:mm a'}}</td>\\n\" +\n    \"            <td ng-if=\\\"isDoc && docEditable && showMerge\\\">\\n\" +\n    \"                <div class=\\\"btn-group\\\" uib-dropdown is-open=\\\"status.isopen\\\">\\n\" +\n    \"                    <button type=\\\"button\\\" class=\\\"btn btn-default\\\" uib-dropdown-toggle ng-disabled=\\\"disabled\\\" title=\\\"Branch actions\\\">\\n\" +\n    \"                        <i class=\\\"fa fa-ellipsis-v\\\"></i>\\n\" +\n    \"                    </button>\\n\" +\n    \"                    <ul class=\\\"dropdown-menu pull-right\\\" uib-dropdown-menu role=\\\"menu\\\" aria-labelledby=\\\"single-button\\\">\\n\" +\n    \"                        <li role=\\\"menuitem\\\" style=\\\"padding:10px;\\\">\\n\" +\n    \"                            <button class=\\\"btn btn-default btn-sm\\\" ng-class=\\\"{'disabled': !docEditable || !runCleared}\\\" ng-click=\\\"docMergeAction(branch)\\\">\\n\" +\n    \"                                Pull In<i ng-show=\\\"!runCleared\\\" class=\\\"fa fa-spin fa-spinner\\\"></i>\\n\" +\n    \"                            </button> to this document on current branch\\n\" +\n    \"                        </li>\\n\" +\n    \"                    </ul>\\n\" +\n    \"                </div>\\n\" +\n    \"            </td>\\n\" +\n    \"        </tr>\\n\" +\n    \"    </tbody>\\n\" +\n    \"    <tbody><tr ng-hide=\\\"filteredBranches.length\\\"><td colspan=\\\"3\\\" class=\\\"ve-secondary-text\\\">No branches found</td></tr></tbody>\\n\" +\n    \"</table>\");\n}]);\n\nangular.module(\"mms/templates/mmsSearch.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mmsSearch.html\",\n    \"<div class=\\\"mms-search\\\">\\n\" +\n    \"    <div class=\\\"search-header\\\" ng-class=\\\"{searchresults : searchResults}\\\">\\n\" +\n    \"        <div class=\\\"mms-search-input\\\" ng-hide=\\\"advanceSearch || advancedSearchResults\\\">\\n\" +\n    \"            <form class=\\\"form-inline basic-search-form\\\" ng-submit=\\\"newSearch(mainSearch)\\\">\\n\" +\n    \"                <!-- search type menu -->\\n\" +\n    \"                <div class=\\\"form-group fixed-content-m\\\">\\n\" +\n    \"                    <label class=\\\"sr-only\\\" for=\\\"searchTypeSelect\\\">Search type menu</label>\\n\" +\n    \"                    <div class=\\\"btn-group ve-light-dropdown\\\" uib-dropdown keyboard-nav is-open=\\\"mainSearchType.isopen\\\">\\n\" +\n    \"                        <button id=\\\"searchTypeSelect\\\" class=\\\"dropdown-toggle\\\" type=\\\"button\\\" uib-dropdown-toggle>\\n\" +\n    \"                            {{mainSearch.searchType.label}}&nbsp;<i class=\\\"fa fa-caret-down\\\" aria-hidden=\\\"true\\\"></i>\\n\" +\n    \"                        </button>\\n\" +\n    \"                        <ul class=\\\"dropdown-menu\\\" uib-dropdown-menu role=\\\"menu\\\" aria-labelledby=\\\"searchTypeSelect\\\">\\n\" +\n    \"                            <li ng-click=\\\"mainSearch.searchType = type;\\\" ng-repeat=\\\"type in fieldTypeList\\\"\\n\" +\n    \"                                ng-class=\\\"{'checked-list-item': type.id === mainSearch.searchType.id}\\\">\\n\" +\n    \"                                <a>{{ type.label }}</a>\\n\" +\n    \"                            </li>\\n\" +\n    \"                        </ul>\\n\" +\n    \"                    </div>\\n\" +\n    \"                </div>\\n\" +\n    \"                <!-- search keyword input -->\\n\" +\n    \"                <div class=\\\"form-group\\\" ng-show=\\\"mainSearch.searchType.id != 'metatype'\\\">\\n\" +\n    \"                    <label class=\\\"sr-only\\\" for=\\\"searchInput\\\">Search keyword</label>\\n\" +\n    \"                    <input class=\\\"search-input\\\" type=\\\"text\\\" id=\\\"searchInput\\\" ng-model=\\\"mainSearch.searchText\\\" autofocus/>\\n\" +\n    \"                </div>\\n\" +\n    \"                <div class=\\\"form-group\\\" ng-if=\\\"mainSearch.searchType.id === 'metatype'\\\">\\n\" +\n    \"                    <label class=\\\"sr-only\\\" for=\\\"searchMetatypeSelect\\\">Search metatype menu</label>\\n\" +\n    \"                    <div id=\\\"searchMetatypeSelect\\\" ng-dropdown-multiselect=\\\"\\\" options=\\\"metatypeList\\\" selected-model=\\\"mainSearch.selectedSearchMetatypes\\\" extra-settings=\\\"metatypeSettings\\\"></div>\\n\" +\n    \"                </div>\\n\" +\n    \"                <button class=\\\"btn btn-primary\\\" type=\\\"button\\\" ng-click=\\\"newSearch(mainSearch)\\\">\\n\" +\n    \"                    <span class=\\\"btn-text\\\">Search</span> <i ng-if=\\\"searchLoading\\\" class=\\\"fa fa-spin fa-spinner\\\"></i>\\n\" +\n    \"                </button>\\n\" +\n    \"            </form>\\n\" +\n    \"            <div>\\n\" +\n    \"                <input type=\\\"checkbox\\\" ng-model=\\\"docsviews.selected\\\"> Search for Views and Documents\\n\" +\n    \"                <a class=\\\"pull-right\\\" ng-click=\\\"advanceSearch = !advanceSearch\\\">Advanced Search</a>\\n\" +\n    \"            </div>\\n\" +\n    \"        </div>\\n\" +\n    \"\\n\" +\n    \"        <div class=\\\"mms-search-input\\\" ng-show=\\\"advanceSearch\\\">\\n\" +\n    \"            <div class=\\\"misc-form-field search-nav-back\\\">\\n\" +\n    \"                <a ng-click=\\\"advanceSearch = !advanceSearch\\\"><i class=\\\"fa fa-arrow-left\\\"></i>Basic Search</a>\\n\" +\n    \"            </div>\\n\" +\n    \"            <!-- submit change -->\\n\" +\n    \"            <form class=\\\"form-inline advanced-query\\\" ng-submit=\\\"newSearch(mainSearch)\\\">\\n\" +\n    \"                <!-- advanced search query input disabled -->\\n\" +\n    \"                <h3 class=\\\"fixed-content-m\\\">Advanced Search</h3>\\n\" +\n    \"                <div class=\\\"form-group\\\">\\n\" +\n    \"                    <label class=\\\"sr-only\\\" for=\\\"searchQuery\\\">Advanced search query (disabled)</label>\\n\" +\n    \"                    <input class=\\\"search-input disabled-input\\\" type=\\\"text\\\" id=\\\"searchQuery\\\" ng-model=\\\"stringQuery\\\" disabled />\\n\" +\n    \"                </div>\\n\" +\n    \"                <button class=\\\"btn btn-primary\\\" type=\\\"button\\\" ng-click=\\\"newSearch(mainSearch)\\\">\\n\" +\n    \"                    <span class=\\\"btn-text\\\">Search</span> <i ng-if=\\\"searchLoading\\\" class=\\\"fa fa-spin fa-spinner\\\"></i>\\n\" +\n    \"                </button>\\n\" +\n    \"            </form>\\n\" +\n    \"\\n\" +\n    \"            <div class=\\\"form-inline\\\" style=\\\"justify-content: flex-end\\\">\\n\" +\n    \"                <div class=\\\"form-group fixed-content-s\\\">\\n\" +\n    \"                </div>\\n\" +\n    \"                <!-- search type menu -->\\n\" +\n    \"                <div class=\\\"form-group fixed-content-m\\\">\\n\" +\n    \"                    <label class=\\\"sr-only\\\" for=\\\"searchTypeSelectAdvance\\\">Search type menu</label>\\n\" +\n    \"                    <div class=\\\"btn-group ve-light-dropdown\\\" uib-dropdown keyboard-nav is-open=\\\"mainSearchType.isopen2\\\">\\n\" +\n    \"                        <button id=\\\"searchTypeSelectAdvance\\\" class=\\\"dropdown-toggle\\\" type=\\\"button\\\" uib-dropdown-toggle>\\n\" +\n    \"                            {{mainSearch.searchType.label}}&nbsp;<i class=\\\"fa fa-caret-down\\\" aria-hidden=\\\"true\\\"></i>\\n\" +\n    \"                        </button>\\n\" +\n    \"                        <ul class=\\\"dropdown-menu\\\" uib-dropdown-menu role=\\\"menu\\\" aria-labelledby=\\\"searchTypeSelectAdvance\\\">\\n\" +\n    \"                            <li ng-click=\\\"mainSearch.searchType = type; stringQueryUpdate()\\\" ng-repeat=\\\"type in fieldTypeList\\\"\\n\" +\n    \"                                ng-class=\\\"{'checked-list-item': type.id === mainSearch.searchType.id}\\\">\\n\" +\n    \"                                <a>{{ type.label }}</a>\\n\" +\n    \"                            </li>\\n\" +\n    \"                        </ul>\\n\" +\n    \"                    </div>\\n\" +\n    \"                </div>\\n\" +\n    \"                <!-- search keyword input -->\\n\" +\n    \"                <div class=\\\"form-group\\\" ng-show=\\\"mainSearch.searchType.id != 'metatype'\\\">\\n\" +\n    \"                    <label class=\\\"sr-only\\\" for=\\\"searchText\\\">Advanced search query</label>\\n\" +\n    \"                    <input class=\\\"search-input\\\" type=\\\"text\\\" id=\\\"searchText\\\" ng-model=\\\"mainSearch.searchText\\\" ng-change=\\\"stringQueryUpdate()\\\" autofocus/>\\n\" +\n    \"                </div>\\n\" +\n    \"                <!-- metatype multiselect -->\\n\" +\n    \"                <div class=\\\"form-group\\\" ng-if=\\\"mainSearch.searchType.id === 'metatype'\\\">\\n\" +\n    \"                    <label class=\\\"sr-only\\\" for=\\\"searchMetatypeSelectAdvance\\\">Search metatype menu</label>\\n\" +\n    \"                    <div id=\\\"searchMetatypeSelectAdvance\\\" ng-dropdown-multiselect=\\\"\\\" options=\\\"metatypeList\\\" selected-model=\\\"mainSearch.selectedSearchMetatypes\\\" extra-settings=\\\"metatypeSettings\\\" events=\\\"multiselectEvent\\\"></div>\\n\" +\n    \"                </div>\\n\" +\n    \"            </div>\\n\" +\n    \"\\n\" +\n    \"            <!-- Advanced search rows -->\\n\" +\n    \"            <div ng-repeat=\\\"row in advanceSearchRows\\\">\\n\" +\n    \"                <div class=\\\"form-inline\\\">\\n\" +\n    \"                    <!-- operator -->\\n\" +\n    \"                    <div class=\\\"form-group fixed-content-s\\\">\\n\" +\n    \"                        <label class=\\\"sr-only\\\" for=\\\"operator-{{$index}}\\\">Search row operator</label>\\n\" +\n    \"                        <div class=\\\"btn-group ve-light-dropdown\\\" uib-dropdown keyboard-nav is-open=\\\"row.operatorisopen\\\">\\n\" +\n    \"                            <button id=\\\"operator-{{$index}}\\\" class=\\\"dropdown-toggle\\\" type=\\\"button\\\" uib-dropdown-toggle>\\n\" +\n    \"                                {{row.operator}}&nbsp;<i class=\\\"fa fa-caret-down\\\" aria-hidden=\\\"true\\\"></i>\\n\" +\n    \"                            </button>\\n\" +\n    \"                            <ul class=\\\"dropdown-menu\\\" uib-dropdown-menu role=\\\"menu\\\" aria-labelledby=\\\"operator-{{$index}}\\\">\\n\" +\n    \"                                <li ng-click=\\\"row.operator = value; stringQueryUpdate()\\\" ng-repeat=\\\"(key, value) in operatorList\\\"\\n\" +\n    \"                                    ng-class=\\\"{'checked-list-item': value === row.operator}\\\">\\n\" +\n    \"                                    <a>{{ value }}</a>\\n\" +\n    \"                                </li>\\n\" +\n    \"                            </ul>\\n\" +\n    \"                        </div>\\n\" +\n    \"                    </div>\\n\" +\n    \"                    <!-- row search type menu -->\\n\" +\n    \"                    <div class=\\\"form-group fixed-content-m\\\">\\n\" +\n    \"                        <label class=\\\"sr-only\\\" for=\\\"searchTypeSelect-{{$index}}\\\">Search type menu</label>\\n\" +\n    \"                        <div class=\\\"btn-group ve-light-dropdown\\\" uib-dropdown keyboard-nav is-open=\\\"row.isopen\\\">\\n\" +\n    \"                            <button id=\\\"searchTypeSelect-{{$index}}\\\" class=\\\"dropdown-toggle\\\" type=\\\"button\\\" uib-dropdown-toggle>\\n\" +\n    \"                                {{row.searchType.label}}&nbsp;<i class=\\\"fa fa-caret-down\\\" aria-hidden=\\\"true\\\"></i>\\n\" +\n    \"                            </button>\\n\" +\n    \"                            <ul class=\\\"dropdown-menu\\\" uib-dropdown-menu role=\\\"menu\\\" aria-labelledby=\\\"searchTypeSelect-{{$index}}\\\">\\n\" +\n    \"                                <li ng-click=\\\"row.searchType = type; stringQueryUpdate()\\\" ng-repeat=\\\"type in fieldTypeList\\\"\\n\" +\n    \"                                    ng-class=\\\"{'checked-list-item': type.id === row.searchType.id}\\\">\\n\" +\n    \"                                    <a>{{ type.label }}</a>\\n\" +\n    \"                                </li>\\n\" +\n    \"                            </ul>\\n\" +\n    \"                        </div>\\n\" +\n    \"                    </div>\\n\" +\n    \"                    <!-- row search keyword input -->\\n\" +\n    \"                    <div class=\\\"form-group\\\" ng-show=\\\"row.searchType.id != 'metatype'\\\">\\n\" +\n    \"                        <label class=\\\"sr-only\\\" for=\\\"searchText-{{$index}}\\\">Advanced search query</label>\\n\" +\n    \"                        <input class=\\\"search-input\\\" type=\\\"text\\\" id=\\\"searchText-{{$index}}\\\" ng-model=\\\"row.searchText\\\" ng-change=\\\"stringQueryUpdate()\\\" autofocus/>\\n\" +\n    \"                    </div>\\n\" +\n    \"                    <!-- row metatype multiselect -->\\n\" +\n    \"                    <div class=\\\"form-group\\\" ng-if=\\\"row.searchType.id === 'metatype'\\\">\\n\" +\n    \"                        <label class=\\\"sr-only\\\" for=\\\"searchMetatypeSelect-{{$index}}\\\">Search metatype menu</label>\\n\" +\n    \"                        <div id=\\\"searchMetatypeSelect-{{$index}}\\\" ng-dropdown-multiselect=\\\"\\\" options=\\\"metatypeList\\\" selected-model=\\\"row.selectedSearchMetatypes\\\" extra-settings=\\\"metatypeSettings\\\" events=\\\"multiselectEvent\\\"></div>\\n\" +\n    \"                    </div>\\n\" +\n    \"                    <!-- remove row button -->\\n\" +\n    \"                    <a type=\\\"button\\\" ng-click=\\\"removeRowAdvanceSearch(row)\\\" class=\\\"btn btn-secondary\\\">\\n\" +\n    \"                        <i class=\\\"fa fa-times\\\"></i>\\n\" +\n    \"                    </a>\\n\" +\n    \"                </div>\\n\" +\n    \"            </div>\\n\" +\n    \"            <!-- add row button -->\\n\" +\n    \"            <a type=\\\"button\\\" ng-click=\\\"addAdvanceSearchRow()\\\" class=\\\"btn btn-secondary\\\">\\n\" +\n    \"                <i class=\\\"fa fa-plus\\\"></i>&nbsp;Add Row\\n\" +\n    \"            </a>\\n\" +\n    \"            <div class=\\\"advanced-views-docs\\\">\\n\" +\n    \"                <input type=\\\"checkbox\\\" ng-model=\\\"docsviews.selected\\\"> Search for Views and Documents\\n\" +\n    \"            </div>\\n\" +\n    \"        </div>\\n\" +\n    \"        <span class=\\\"close-button-container\\\">\\n\" +\n    \"            <span class=\\\"close-button\\\" ng-if=\\\"mmsOptions.closeable\\\" ng-click=\\\"closeSearch()\\\">\\n\" +\n    \"                <i tooltip-placement=\\\"left\\\" uib-tooltip=\\\"Close Search\\\"  class=\\\"fa fa-times\\\"></i>\\n\" +\n    \"            </span>\\n\" +\n    \"        </span>\\n\" +\n    \"\\n\" +\n    \"        <!-- <div ng-show=\\\"advancedSearchResults\\\" class=\\\"mms-search-input\\\"> -->\\n\" +\n    \"            <!-- advanced search query input disabled -->\\n\" +\n    \"            <!-- <div class=\\\"form-group\\\">\\n\" +\n    \"                <div class=\\\"misc-form-field search-nav-back\\\">\\n\" +\n    \"                    <a ng-click=\\\"advancedSearchResults = !advancedSearchResults\\\"><i class=\\\"fa fa-arrow-left\\\"></i>Basic Search</a>\\n\" +\n    \"                </div>\\n\" +\n    \"                <form class=\\\"form-inline\\\" ng-submit=\\\"newSearch(mainSearch)\\\"> -->\\n\" +\n    \"                    <!-- advanced search query input disabled -->\\n\" +\n    \"                    <!-- <h3 class=\\\"fixed-content-m\\\">Advanced Search</h3>\\n\" +\n    \"                    <label class=\\\"sr-only\\\" for=\\\"searchText\\\">Advanced search query (disabled)</label>\\n\" +\n    \"                    <span ng-click=\\\"modifyAdvanceSearch()\\\" class=\\\"search-input disabled-input-container\\\">\\n\" +\n    \"                        <input class=\\\"search-input disabled-input form-group\\\" type=\\\"text\\\" id=\\\"searchText\\\" ng-model=\\\"stringQuery\\\" disabled />\\n\" +\n    \"                    </span>\\n\" +\n    \"                    <a ng-click=\\\"modifyAdvanceSearch()\\\">Modify</a>\\n\" +\n    \"                </form>\\n\" +\n    \"            </div>\\n\" +\n    \"        </div> -->\\n\" +\n    \"    </div>\\n\" +\n    \"    <div class=\\\"slide-animate\\\" ng-include=\\\"'mms/templates/mmsSearchResults.html'\\\"></div>\\n\" +\n    \"    <div class=\\\"container-fluid search-nav\\\">\\n\" +\n    \"        <a ng-show=\\\"currentPage > 0\\\" ng-click=\\\"prevPage()\\\">&lt; Prev</a>\\n\" +\n    \"        <a ng-show=\\\"searchResults.length > 0 && currentPage < maxPages\\\" class=\\\"pull-right\\\" ng-click=\\\"nextPage()\\\">Next ></a>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"    <div class=\\\"container-no-results container-fluid\\\" ng-show=\\\"searchResults.length === 0 && !searchLoading\\\">\\n\" +\n    \"        <h3>No Results Found.</h3>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\" +\n    \"\");\n}]);\n\nangular.module(\"mms/templates/mmsSearchResults.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mmsSearchResults.html\",\n    \"<div id=\\\"ve-search-results\\\" class=\\\"misc-form-field results-count\\\" ng-hide=\\\"searchLoading || !paginationCache.length\\\">\\n\" +\n    \"    <div class=\\\"ve-search-filter\\\" ng-hide=\\\"!showFilterOptions\\\">\\n\" +\n    \"        <span class=\\\"label-for-filter ve-secondary-text\\\">FILTER: </span>\\n\" +\n    \"        <div class=\\\"btn-group btn-group-sm\\\" role=\\\"group\\\"  aria-label=\\\"mms-search-results-filter\\\">\\n\" +\n    \"            <button type=\\\"button\\\" ng-repeat=\\\"item in filterOptions\\\" ng-click=\\\"filterSearchResults(item.type)\\\"\\n\" +\n    \"            title=\\\"Filter {{item.display}}\\\" class=\\\"btn ve-btn-group-default {{item.icon}}\\\"\\n\" +\n    \"            ng-class=\\\"{'active': getActiveFilterClass(item.type)}\\\">{{item.display}}</button>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"    <div class=\\\"ve-secondary-text\\\">Showing <b>{{searchResults.length}}</b> <!--of {{searchResults.length}} -->search results. (Page {{currentPage + 1}})</div>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"search-results\\\" ng-show=\\\"searchResults.length > 0\\\">\\n\" +\n    \"    <div class=\\\"elem-wrapper\\\" ng-repeat=\\\"elem in filteredElms = (searchResults)\\\">\\n\" +\n    \"        <div class=\\\"elem-name-wrapper\\\">\\n\" +\n    \"            <span class=\\\"{{ getTypeClass(elem) }}\\\"></span>\\n\" +\n    \"            <a class=\\\"elem-name\\\" ng-click=\\\"userResultClick(elem, 'name')\\\">{{elem.name}}</a>\\n\" +\n    \"            <a class=\\\"elem-name\\\" ng-show=\\\"elem.type == 'Slot'\\\" ng-click=\\\"userResultClick(elem, 'name')\\\">\\n\" +\n    \"                <mms-transclude-name mms-element-id=\\\"{{elem.definingFeatureId}}\\\" mms-project-id=\\\"{{elem._projectId}}\\\" mms-ref-id=\\\"{{elem._refId}}\\\" no-click=\\\"true\\\"></mms-transclude-name>\\n\" +\n    \"            </a>\\n\" +\n    \"        </div>\\n\" +\n    \"        <div class=\\\"elem-qualified-name-wrapper\\\">\\n\" +\n    \"            <div ng-click=\\\"expandQualifiedName($event, elem._qualifiedName);\\\" class=\\\"elem-qualified-name\\\">\\n\" +\n    \"                {{qualifiedNameFormatter(elem._qualifiedName)}}\\n\" +\n    \"            </div>\\n\" +\n    \"        </div>\\n\" +\n    \"        <div ng-if=\\\"elem.type === 'Diagram' && elem._artifactIds\\\">\\n\" +\n    \"            <mms-transclude-img ng-click=\\\"userResultClick(elem, 'img')\\\" mms-element-id=\\\"{{elem.id}}\\\" mms-project-id=\\\"{{elem._projectId}}\\\" mms-ref-id=\\\"{{elem._refId}}\\\"></mms-transclude-img>\\n\" +\n    \"        </div>\\n\" +\n    \"        <div class=\\\"elem-documentation-wrapper\\\">\\n\" +\n    \"            <label>Documentation</label>\\n\" +\n    \"            <div class=\\\"elem-documentation\\\">\\n\" +\n    \"                <a ng-show=\\\"elem.documentation\\\" ng-bind-html=\\\"elem.documentation | limitTo:270\\\" ng-click=\\\"userResultClick(elem, 'doc')\\\"></a><span class=\\\"ellipses\\\">{{elem.documentation.length > 270 ? ' ...' : ''}}</span>\\n\" +\n    \"                <span><a ng-show=\\\"!elem.documentation\\\" ng-click=\\\"userResultClick(elem, 'doc')\\\">\\n\" +\n    \"                  {{emptyDocTxt}}\\n\" +\n    \"                  </a></span>\\n\" +\n    \"            </div>\\n\" +\n    \"        </div>\\n\" +\n    \"        <div ng-if=\\\"(elem.type === 'Property' || elem.type === 'Port') && elem.defaultValue\\\">\\n\" +\n    \"            <label>Value</label>\\n\" +\n    \"            <div class=\\\"elem-properties\\\">\\n\" +\n    \"                <a ng-click=\\\"userResultClick(elem, 'val')\\\">\\n\" +\n    \"                    {{elem.defaultValue.value + '' | limitTo:250 || elem.defaultValue.body[0] | limitTo:250 || 'Default Value'}}<span class=\\\"ellipses\\\">{{(elem.defaultValue.body[0] && elem.defaultValue.body.length > 1 || val.value.length > 250) ? ' ...' : '' }}</span>\\n\" +\n    \"                </a>\\n\" +\n    \"            </div>\\n\" +\n    \"        </div>\\n\" +\n    \"        <div ng-if=\\\"elem.type === 'Slot' && elem.value\\\">\\n\" +\n    \"            <label>Value</label>\\n\" +\n    \"            <div class=\\\"elem-properties\\\">\\n\" +\n    \"                <a ng-click=\\\"userResultClick(elem, 'val')\\\">\\n\" +\n    \"                    <span ng-repeat=\\\"val in elem.value\\\">\\n\" +\n    \"                        {{val.value + '' | limitTo:250 || val.body[0] | limitTo:250 || 'Default Value'}}<span class=\\\"ellipses\\\">{{(val.body[0] && val.body.length > 1 || val.value.length > 250) ? ' ...' : '' }}</span>{{$last ? '' : ', '}}\\n\" +\n    \"                    </span>\\n\" +\n    \"                </a>\\n\" +\n    \"            </div>\\n\" +\n    \"        </div>\\n\" +\n    \"        <div ng-if=\\\"elem.type === 'Constraint'\\\">\\n\" +\n    \"            <label>Specification</label>\\n\" +\n    \"            <div class=\\\"elem-specification\\\">\\n\" +\n    \"                <a ng-click=\\\"userResultClick(elem, 'val')\\\">\\n\" +\n    \"                    {{elem.specification.value + '' || 'Constraint Specification'}}\\n\" +\n    \"                </a>\\n\" +\n    \"            </div>\\n\" +\n    \"            <a ng-click=\\\"userResultClick(elem, 'val')\\\">\\n\" +\n    \"                <div ng-repeat=\\\"str in elem.specification.body\\\">\\n\" +\n    \"                    <div class=\\\"elem-specification\\\">{{str}}</div>\\n\" +\n    \"                </div>\\n\" +\n    \"            </a>\\n\" +\n    \"        </div>\\n\" +\n    \"        <div ng-if=\\\"elem._properties[0]\\\" class=\\\"elem-properties-wrapper ve-search\\\">\\n\" +\n    \"            <label>Properties</label>\\n\" +\n    \"            <table>\\n\" +\n    \"                <tr ng-repeat=\\\"property in elem._properties | limitTo : limitForProps\\\">\\n\" +\n    \"                    <td>\\n\" +\n    \"                        {{property.name}}<span ng-if=\\\"property.type === 'Slot'\\\"><mms-transclude-name mms-element-id=\\\"{{property.definingFeatureId}}\\\" mms-project-id=\\\"{{elem._projectId}}\\\" mms-ref-id=\\\"{{elem._refId}}\\\" no-click=\\\"true\\\"></mms-transclude-name></span>: \\n\" +\n    \"                    </td>\\n\" +\n    \"                    <td>\\n\" +\n    \"                        <a ng-click=\\\"userResultClick(property, 'val')\\\">{{property.defaultValue.value | limitTo:300}}\\n\" +\n    \"                            <span ng-if=\\\"property.type === 'Slot'\\\" ng-repeat=\\\"val in property.value | limitTo:4\\\">\\n\" +\n    \"                                <span ng-bind-html=\\\"val.value | limitTo:300\\\"></span>\\n\" +\n    \"                                <span ng-bind-html=\\\"val.body[0] | limitTo:300\\\"></span>\\n\" +\n    \"                                <span ng-if=\\\"!val.value && !val.body[0]\\\">Default Value</span>\\n\" +\n    \"                            </span>\\n\" +\n    \"                            <!-- set variable for limit -->\\n\" +\n    \"                            <span ng-if=\\\"property.value.length > 4 || property.defaultValue.value.length > 300\\\">...</span>\\n\" +\n    \"                        </a>\\n\" +\n    \"                    </td>\\n\" +\n    \"                </tr>\\n\" +\n    \"                <tr class=\\\"visibility-toggle\\\" ng-show=\\\"elem._properties.length > 6\\\">\\n\" +\n    \"                    <td></td>\\n\" +\n    \"                    <td>\\n\" +\n    \"                        <a ng-click=\\\"showSearchResultProps = !showSearchResultProps; showSearchResultProps ? switchText='Less' : switchText='More'; showSearchResultProps ? limitForProps=50 : limitForProps=6\\\" ng-class=\\\"{active: showSearchResultProps}\\\">{{switchText}}</a>\\n\" +\n    \"                    </td>\\n\" +\n    \"                </tr>\\n\" +\n    \"            </table>\\n\" +\n    \"        </div>\\n\" +\n    \"        <div ng-if=\\\"elem.allRelatedDocuments.length > 0\\\" class=\\\"elem-related-docs-wrapper\\\">\\n\" +\n    \"            <label>Related Documents</label>\\n\" +\n    \"            <!-- show no more than three related views here-->\\n\" +\n    \"            <div ng-repeat=\\\"doc in elem.someRelatedDocuments\\\" class=\\\"elem-documentation\\\">\\n\" +\n    \"                <mms-view-link suppress-numbering=\\\"true\\\" mms-project-id=\\\"{{elem._projectId}}\\\" mms-ref-id=\\\"{{elem._refId}}\\\" mms-doc-id=\\\"{{doc.relatedDocument.id}}\\\" mms-element-id=\\\"{{doc.relatedDocument.id}}\\\" ng-click=\\\"userRelatedClick($event, doc.relatedDocument, doc.relatedDocument, elem)\\\"></mms-view-link>\\n\" +\n    \"                > <mms-view-link suppress-numbering=\\\"true\\\" mms-project-id=\\\"{{elem._projectId}}\\\" mms-ref-id=\\\"{{elem._refId}}\\\" mms-doc-id=\\\"{{doc.relatedDocument.id}}\\\" mms-element-id=\\\"{{doc.relatedView.id}}\\\" ng-click=\\\"userRelatedClick($event, doc.relatedDocument, doc.relatedView, elem)\\\"></mms-view-link><br/>\\n\" +\n    \"            </div>\\n\" +\n    \"\\n\" +\n    \"            <!-- show the remaining related views when users click on \\\"More\\\" -->\\n\" +\n    \"            <div ng-if=\\\"elem.remainingRelatedDocuments\\\">\\n\" +\n    \"                <div ng-repeat=\\\"doc in elem.remainingRelatedDocuments\\\" class=\\\"elem-documentation\\\">\\n\" +\n    \"                    <mms-view-link suppress-numbering=\\\"true\\\" mms-project-id=\\\"{{elem._projectId}}\\\" mms-ref-id=\\\"{{elem._refId}}\\\" mms-doc-id=\\\"{{doc.relatedDocument.id}}\\\" mms-element-id=\\\"{{doc.relatedDocument.id}}\\\" ng-click=\\\"userRelatedClick($event, doc.relatedDocument, doc.relatedDocument, elem)\\\"></mms-view-link>\\n\" +\n    \"                    > <mms-view-link suppress-numbering=\\\"true\\\" mms-project-id=\\\"{{elem._projectId}}\\\" mms-ref-id=\\\"{{elem._refId}}\\\" mms-doc-id=\\\"{{doc.relatedDocument.id}}\\\" mms-element-id=\\\"{{doc.relatedView.id}}\\\" ng-click=\\\"userRelatedClick($event, doc.relatedDocument, doc.relatedView, elem)\\\"></mms-view-link><br/>\\n\" +\n    \"                </div>\\n\" +\n    \"            </div>\\n\" +\n    \"\\n\" +\n    \"            <div class=\\\"show-more-container\\\" ng-if=\\\"!elem.remainingRelatedDocuments && elem.allRelatedDocuments.length > elem.someRelatedDocuments.length\\\">\\n\" +\n    \"                <a class=\\\"show-more-btn\\\" ng-click=\\\"showMoreRelatedViews(elem);\\\"> {{(elem.allRelatedDocuments.length - elem.someRelatedDocuments.length) + ' More'}}\\n\" +\n    \"                </a>\\n\" +\n    \"            </div>\\n\" +\n    \"\\n\" +\n    \"        </div>\\n\" +\n    \"        <div ng-if=\\\"elem.type != 'InstanceSpecification'\\\">\\n\" +\n    \"            <label>Metatypes</label>\\n\" +\n    \"            <div class=\\\"elem-type-wrapper\\\">\\n\" +\n    \"                <span class=\\\"elem-type\\\">{{elem.type}}</span>\\n\" +\n    \"                <span ng-if=\\\"elem._appliedStereotypeIds.length\\\">\\n\" +\n    \"                    <span ng-repeat=\\\"type in elem._appliedStereotypeIds\\\">\\n\" +\n    \"                        <mms-transclude-name class=\\\"elem-type\\\" mms-element-id=\\\"{{type}}\\\" mms-project-id=\\\"{{elem._projectId}}\\\" mms-ref-id=\\\"{{elem._refId}}\\\" no-click=\\\"true\\\"></mms-transclude-name>\\n\" +\n    \"                    </span>\\n\" +\n    \"                </span>\\n\" +\n    \"            </div>\\n\" +\n    \"        </div>\\n\" +\n    \"        <div class=\\\"elem-updated-wrapper\\\">\\n\" +\n    \"            <div>Last modified {{elem._modified | date:'M/d/yy h:mm a'}} by <b>{{elem._modifier}}</b></div>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\" +\n    \"\");\n}]);\n\nangular.module(\"mms/templates/mmsSpec.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mmsSpec.html\",\n    \"<!-- HTML for edit mode -->\\n\" +\n    \"<div ng-if=\\\"!noEdit && editing\\\" class=\\\"editing\\\">\\n\" +\n    \"\\n\" +\n    \"    <h1 class=\\\"prop\\\" ng-if=\\\"edit.name !== undefined\\\"><input class=\\\"form-control ve-plain-input\\\" type=\\\"text\\\" ng-model=\\\"edit.name\\\"></h1>\\n\" +\n    \"    <span class=\\\"elem-updated-wrapper\\\">Last modified {{element._modified | date:'M/d/yy h:mm a'}} by <b>{{element._modifier}}</b></span>\\n\" +\n    \"\\n\" +\n    \"    <div ng-if=\\\"edit.type === 'Property' || edit.type === 'Port' || edit.type === 'Slot'\\\">\\n\" +\n    \"        <h2 class=\\\"prop-title spec-view-value-heading\\\">Property Value</h2>\\n\" +\n    \"        <div ng-if=\\\"!isEnumeration\\\">\\n\" +\n    \"            <div ng-if=\\\"editValues.length == 0\\\">\\n\" +\n    \"                <select ng-model=\\\"addValueType\\\" ng-options=\\\"key for (key, value) in addValueTypes\\\"></select>\\n\" +\n    \"                <button class=\\\"btn btn-sm btn-default\\\" ng-click=\\\"addValue(addValueType)\\\">Add</button>\\n\" +\n    \"            </div>\\n\" +\n    \"            <div ng-repeat=\\\"value in editValues\\\" ng-switch on=\\\"value.type\\\" ng-form=\\\"valForm\\\">\\n\" +\n    \"                <div ng-switch-when=\\\"LiteralInteger\\\" ng-class=\\\"{'has-error': valForm.$error.pattern}\\\">\\n\" +\n    \"                    <div class=\\\"form-inline\\\">\\n\" +\n    \"                    <input class=\\\"form-control ve-plain-input\\\" type=\\\"number\\\" ng-model=\\\"value.value\\\" ng-pattern=\\\"/^-?\\\\d+$/\\\" ng-blur=\\\"cleanupVal(value)\\\">&nbsp;\\n\" +\n    \"                    <a ng-if=\\\"!$first\\\" ng-click=\\\"removeVal($index)\\\"><i class=\\\"fa fa-close\\\"></i></a>\\n\" +\n    \"                    </div>\\n\" +\n    \"                    <label class=\\\"control-label mms-error-icon\\\" ng-show=\\\"valForm.$error.pattern\\\">Not a valid integer</label>\\n\" +\n    \"                </div>\\n\" +\n    \"                <div ng-switch-when=\\\"LiteralUnlimitedNatural\\\" ng-class=\\\"{'has-error': valForm.$error.pattern}\\\">\\n\" +\n    \"                    <div class=\\\"form-inline\\\">\\n\" +\n    \"                    <input class=\\\"form-control ve-plain-input\\\" type=\\\"number\\\" name=\\\"natVal\\\" ng-model=\\\"value.value\\\" ng-pattern=\\\"/^\\\\d+$/\\\" ng-blur=\\\"cleanupVal(value)\\\">&nbsp;\\n\" +\n    \"                    <a ng-if=\\\"!$first\\\" ng-click=\\\"removeVal($index)\\\"><i class=\\\"fa fa-close\\\"></i></a>\\n\" +\n    \"                    </div>\\n\" +\n    \"                    <label class=\\\"control-label mms-error-icon\\\" ng-show=\\\"valForm.$error.pattern\\\">Not a valid natural number</label>\\n\" +\n    \"                </div>\\n\" +\n    \"                <div ng-switch-when=\\\"LiteralBoolean\\\"><input type=\\\"checkbox\\\" ng-model=\\\"value.value\\\">&nbsp;{{value.value}}&nbsp;<a ng-if=\\\"!$first\\\" ng-click=\\\"removeVal($index)\\\"><i class=\\\"fa fa-close\\\"></i></a></div>\\n\" +\n    \"                <div ng-switch-when=\\\"LiteralReal\\\">\\n\" +\n    \"                    <div class=\\\"form-inline\\\">\\n\" +\n    \"                        <input class=\\\"form-control ve-plain-input\\\" type=\\\"number\\\" ng-model=\\\"value.value\\\" step=\\\"any\\\"><a ng-if=\\\"!$first\\\" ng-click=\\\"removeVal($index)\\\">&nbsp;<i class=\\\"fa fa-close\\\"></i></a>\\n\" +\n    \"                    </div>\\n\" +\n    \"                </div>\\n\" +\n    \"                <div ng-switch-when=\\\"LiteralString\\\">\\n\" +\n    \"                    <textarea ng-if=\\\"hasHtml(value.value)\\\" mms-ckeditor ng-model=\\\"value.value\\\" mms-project-id=\\\"{{element._projectId}}\\\" mms-ref-id=\\\"{{element._refId}}\\\" mms-element-id=\\\"{{element.id}}\\\" autosave-key=\\\"{{element._projectId + element._refId + element.id + 'index:' + $index}}\\\"></textarea>\\n\" +\n    \"                    <div ng-if=\\\"!hasHtml(value.value)\\\"><textarea ng-model=\\\"value.value\\\"></textarea><a ng-click=\\\"addHtml(value)\\\"><i class=\\\"fa fa-html5\\\"></i></a></div>\\n\" +\n    \"                    <a ng-if=\\\"!$first\\\" ng-click=\\\"removeVal($index)\\\"><i class=\\\"fa fa-close\\\"></i></a>\\n\" +\n    \"                </div>\\n\" +\n    \"                <div ng-switch-when=\\\"OpaqueExpression\\\">\\n\" +\n    \"                    <textarea ng-model=\\\"value.body[0]\\\"></textarea><a ng-if=\\\"!$first\\\" ng-click=\\\"removeVal($index)\\\"><i class=\\\"fa fa-close\\\"></i></a>\\n\" +\n    \"                </div>\\n\" +\n    \"                <div ng-switch-default>Editing not supported for now</div>\\n\" +\n    \"            </div>\\n\" +\n    \"            <div ng-if=\\\"editValues.length != 0 && isSlot\\\">\\n\" +\n    \"                <button class=\\\"btn btn-sm btn-default\\\" ng-click=\\\"addValue(editValues[0].type)\\\">Add</button>\\n\" +\n    \"            </div>\\n\" +\n    \"        </div>\\n\" +\n    \"        <div ng-if=\\\"isEnumeration\\\" ng-repeat=\\\"val in editValues\\\">\\n\" +\n    \"            <select ng-model=\\\"val.instanceId\\\" ng-options=\\\"el.id as el.name for el in options\\\">\\n\" +\n    \"            </select><a ng-if=\\\"!$first\\\" ng-click=\\\"removeVal($index)\\\"><i class=\\\"fa fa-close\\\"></i></a>\\n\" +\n    \"        </div>\\n\" +\n    \"        <div ng-if=\\\"(isSlot || editValues.length == 0) && isEnumeration\\\">\\n\" +\n    \"            <button class=\\\"btn btn-sm btn-default\\\" ng-click=\\\"addEnumerationValue()\\\">Add</button>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"    <div ng-if=\\\"edit.type === 'Constraint'\\\">\\n\" +\n    \"        <h2 class=\\\"prop-title spec-view-value-heading\\\">Constraint Specification</h2>\\n\" +\n    \"        <div ng-switch on=\\\"editValues[0].type\\\">\\n\" +\n    \"            <div ng-switch-when=\\\"LiteralInteger\\\"><input class=\\\"form-control ve-plain-input\\\" type=\\\"number\\\" ng-model=\\\"editValues[0].value\\\"></div>\\n\" +\n    \"            <div ng-switch-when=\\\"LiteralUnlimitedNatural\\\"><input class=\\\"form-control ve-plain-input\\\" type=\\\"number\\\" ng-model=\\\"editValues[0].value\\\"></div>\\n\" +\n    \"            <div ng-switch-when=\\\"LiteralBoolean\\\"><input type=\\\"checkbox\\\" ng-model=\\\"editValues[0].value\\\"></div>\\n\" +\n    \"            <div ng-switch-when=\\\"LiteralReal\\\"><input class=\\\"form-control ve-plain-input\\\" type=\\\"number\\\" ng-model=\\\"editValues[0].value\\\" step=\\\"any\\\"></div>\\n\" +\n    \"            <div ng-switch-when=\\\"LiteralString\\\">\\n\" +\n    \"                <textarea ng-model=\\\"editValues[0].value\\\"></textarea>\\n\" +\n    \"            </div>\\n\" +\n    \"            <div ng-switch-when=\\\"OpaqueExpression\\\">\\n\" +\n    \"                <textarea ng-model=\\\"editValues[0].body[0]\\\"></textarea>\\n\" +\n    \"            </div>\\n\" +\n    \"            <div ng-switch-default>Editing not supported for now</div>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"    <h2 class=\\\"prop-title spec-view-doc-heading\\\">Documentation</h2>\\n\" +\n    \"    <textarea ng-model=\\\"edit.documentation\\\" mms-ckeditor mms-editor-api=\\\"editorApi\\\" mms-project-id=\\\"{{element._projectId}}\\\" mms-ref-id=\\\"{{element._refId}}\\\" autosave-key=\\\"{{element._projectId + element._refId + element.id}}\\\"></textarea>\\n\" +\n    \"\\n\" +\n    \"    <h2 class=\\\"prop-title spec-view-type-heading\\\">Metatypes</h2>\\n\" +\n    \"    <span class=\\\"elem-type-wrapper prop\\\">\\n\" +\n    \"        <span class=\\\"elem-type\\\">{{element.type}}</span>\\n\" +\n    \"        <div ng-repeat=\\\"type in element._appliedStereotypeIds\\\" class=\\\"prop elem-type\\\"><mms-transclude-name mms-element-id=\\\"{{type}}\\\" mms-project-id=\\\"{{mmsProjectId}}\\\" mms-ref-id=\\\"{{mmsRefId}}\\\" no-click=\\\"true\\\"></mms-transclude-name></div>\\n\" +\n    \"    </span>\\n\" +\n    \"    <h2 class=\\\"prop-title\\\">Location</h2>\\n\" +\n    \"    <span class=\\\"prop\\\">{{element._qualifiedName}}</span>\\n\" +\n    \"    <h2 class=\\\"prop-title\\\">ID</h2>\\n\" +\n    \"    <span class=\\\"prop id\\\">{{element.id}}</span>\\n\" +\n    \"    <h2 class=\\\"prop-title\\\">Branch/Tag</h2>\\n\" +\n    \"    <span class=\\\"prop\\\">{{element._refId}}</span>\\n\" +\n    \"    <h2 class=\\\"prop-title\\\">Project</h2>\\n\" +\n    \"    <span class=\\\"prop\\\">{{element._projectId}}</span>\\n\" +\n    \"    <h2 class=\\\"prop-title\\\">Formatted Modified Time</h2>\\n\" +\n    \"    <span class=\\\"prop\\\">{{element._modified}}</span>\\n\" +\n    \"    <h2 class=\\\"prop-title\\\">Commit</h2>\\n\" +\n    \"    <span class=\\\"prop\\\">{{element._commitId}}</span>\\n\" +\n    \"</div>\\n\" +\n    \"<!-- HTML for view mode -->\\n\" +\n    \"<div ng-hide=\\\"editing\\\" class=\\\"reading\\\">\\n\" +\n    \"    <p class=\\\"text-center\\\" ng-show=\\\"gettingSpec\\\"><i class=\\\"fa fa-3x fa-spin fa-spinner\\\"></i></p>\\n\" +\n    \"\\n\" +\n    \"    <div ng-hide=\\\"gettingSpec\\\">\\n\" +\n    \"        <div class=\\\"text-warning\\\" ng-if=\\\"mmsDisplayOldContent\\\">\\n\" +\n    \"            <b> Element not found:</b> displaying last found content\\n\" +\n    \"        </div>\\n\" +\n    \"        <h1 class=\\\"prop element-title\\\" ng-class=\\\"{'mms-error': mmsDisplayOldContent}\\\"><span class=\\\"{{ elementTypeClass }}\\\"></span>{{element.name}}</h1>\\n\" +\n    \"        <span class=\\\"elem-updated-wrapper\\\">Last modified {{element._modified | date:'M/d/yy h:mm a'}} by <b>{{element._modifier}}</b></span>\\n\" +\n    \"\\n\" +\n    \"        <div ng-if=\\\"element.type === 'Property' || element.type === 'Port' || element.type === 'Slot'\\\">\\n\" +\n    \"            <h2 class=\\\"prop-title spec-view-value-heading\\\">Property Value</h2>\\n\" +\n    \"            <div ng-repeat=\\\"value in values\\\" ng-switch on=\\\"value.type\\\">\\n\" +\n    \"                <span class=\\\"prop\\\" ng-switch-when=\\\"LiteralInteger\\\">{{value.value}}</span>\\n\" +\n    \"                <span class=\\\"prop\\\" ng-switch-when=\\\"LiteralBoolean\\\">{{value.value}}</span>\\n\" +\n    \"                <span class=\\\"prop\\\" ng-switch-when=\\\"LiteralReal\\\">{{value.value | veRealNum}}</span>\\n\" +\n    \"                <span class=\\\"prop\\\" ng-switch-when=\\\"LiteralUnlimitedNatural\\\">{{value.value}}</span>\\n\" +\n    \"                <span class=\\\"prop\\\" ng-switch-when=\\\"LiteralString\\\" ng-bind-html=\\\"value.value\\\"></span>\\n\" +\n    \"                <span class=\\\"prop\\\" ng-switch-when=\\\"ElementValue\\\"><mms-transclude-name mms-watch-id=\\\"true\\\" mms-element-id=\\\"{{value.elementId}}\\\" mms-project-id=\\\"{{mmsProjectId}}\\\" mms-ref-id=\\\"{{mmsRefId}}\\\"></mms-transclude-name></span>\\n\" +\n    \"                <span class=\\\"prop\\\" ng-switch-when=\\\"InstanceValue\\\"><mms-transclude-name mms-watch-id=\\\"true\\\" mms-element-id=\\\"{{value.instanceId}}\\\" mms-project-id=\\\"{{mmsProjectId}}\\\" mms-ref-id=\\\"{{mmsRefId}}\\\"></mms-transclude-name></span>\\n\" +\n    \"                <span class=\\\"prop\\\" ng-switch-when=\\\"OpaqueExpression\\\">{{value.body[0]}}</span>\\n\" +\n    \"                <span class=\\\"prop\\\" ng-switch-default>{{value}}</span>\\n\" +\n    \"            </div>\\n\" +\n    \"            <h2 class=\\\"prop-title spec-view-value-heading\\\">Property Type</h2>\\n\" +\n    \"            <span class=\\\"prop\\\" ng-if=\\\"element.type === 'Property'\\\"><mms-transclude-name mms-watch-id=\\\"true\\\" mms-element-id=\\\"{{element.typeId}}\\\" mms-project-id=\\\"{{mmsProjectId}}\\\" mms-ref-id=\\\"{{mmsRefId}}\\\" click-handler=\\\"propertyTypeClicked(element.typeId)\\\"></mms-transclude-name></span>\\n\" +\n    \"            <span class=\\\"prop\\\" ng-if=\\\"element.type === 'Slot'\\\"><mms-transclude-name mms-watch-id=\\\"true\\\" mms-element-id=\\\"{{element.definingFeatureId}}\\\" mms-project-id=\\\"{{mmsProjectId}}\\\" mms-ref-id=\\\"{{mmsRefId}}\\\" click-handler=\\\"propertyTypeClicked(element.definingFeatureId)\\\"></mms-transclude-name></span>\\n\" +\n    \"        </div>\\n\" +\n    \"\\n\" +\n    \"        <div ng-if=\\\"element.type === 'Generalization' || element.type === 'Dependency'\\\">\\n\" +\n    \"            <h2 class=\\\"prop-title\\\">Source</h2>\\n\" +\n    \"            <span class=\\\"prop\\\"><mms-transclude-name mms-watch-id=\\\"true\\\" mms-element-id=\\\"{{element._sourceIds[0]}}\\\" mms-project-id=\\\"{{mmsProjectId}}\\\" mms-ref-id=\\\"{{mmsRefId}}\\\"></mms-transclude-name></span>\\n\" +\n    \"            <h2 class=\\\"prop-title\\\">Target</h2>\\n\" +\n    \"            <span class=\\\"prop\\\"><mms-transclude-name mms-watch-id=\\\"true\\\" mms-element-id=\\\"{{element._targetIds[0]}}\\\" mms-project-id=\\\"{{mmsProjectId}}\\\" mms-ref-id=\\\"{{mmsRefId}}\\\"></mms-transclude-name></span>\\n\" +\n    \"        </div>\\n\" +\n    \"\\n\" +\n    \"        <div ng-if=\\\"element.type === 'Connector'\\\">\\n\" +\n    \"            <h2 class=\\\"prop-title\\\">Path 1</h2>\\n\" +\n    \"            <span class=\\\"prop\\\" ng-repeat=\\\"path in element._propertyPathIds[0]\\\"><mms-transclude-name mms-watch-id=\\\"true\\\" mms-element-id=\\\"{{path}}\\\" mms-project-id=\\\"{{mmsProjectId}}\\\" mms-ref-id=\\\"{{mmsRefId}}\\\"></mms-transclude-name></span>\\n\" +\n    \"            <h2 class=\\\"prop-title\\\">Path 2</h2>\\n\" +\n    \"            <span class=\\\"prop\\\" ng-repeat=\\\"path in element._propertyPathIds[1]\\\"><mms-transclude-name mms-watch-id=\\\"true\\\" mms-element-id=\\\"{{path}}\\\" mms-project-id=\\\"{{mmsProjectId}}\\\" mms-ref-id=\\\"{{mmsRefId}}\\\"></mms-transclude-name></span>\\n\" +\n    \"        </div>\\n\" +\n    \"\\n\" +\n    \"        <div ng-if=\\\"element.type === 'Association'\\\">\\n\" +\n    \"            <h2 class=\\\"prop-title\\\">Role 1</h2>\\n\" +\n    \"            <span class=\\\"prop\\\"><mms-transclude-name mms-watch-id=\\\"true\\\" mms-element-id=\\\"{{element.memberEndIds[0]}}\\\" mms-project-id=\\\"{{mmsProjectId}}\\\" mms-ref-id=\\\"{{mmsRefId}}\\\"></mms-transclude-name></span>\\n\" +\n    \"            <h2 class=\\\"prop-title\\\">Role 2</h2>\\n\" +\n    \"            <span class=\\\"prop\\\"><mms-transclude-name mms-watch-id=\\\"true\\\" mms-element-id=\\\"{{element.memberEndIds[1]}}\\\" mms-project-id=\\\"{{mmsProjectId}}\\\" mms-ref-id=\\\"{{mmsRefId}}\\\"></mms-transclude-name></span>\\n\" +\n    \"        </div>\\n\" +\n    \"\\n\" +\n    \"        <div ng-if=\\\"element.type === 'Constraint'\\\">\\n\" +\n    \"            <h2 class=\\\"prop-title\\\">Constraint Specification</h2>\\n\" +\n    \"            <div ng-switch on=\\\"values[0].type\\\">\\n\" +\n    \"                <span class=\\\"prop\\\" ng-switch-when=\\\"LiteralInteger\\\">{{values[0].value}}</span>\\n\" +\n    \"                <span class=\\\"prop\\\" ng-switch-when=\\\"LiteralBoolean\\\">{{values[0].value}}</span>\\n\" +\n    \"                <span class=\\\"prop\\\" ng-switch-when=\\\"LiteralReal\\\">{{values[0].value | veRealNum}}</span>\\n\" +\n    \"                <span class=\\\"prop\\\" ng-switch-when=\\\"LiteralUnlimitedNatural\\\">{{values[0].value}}</span>\\n\" +\n    \"                <span class=\\\"prop\\\" ng-switch-when=\\\"LiteralString\\\" ng-bind-html=\\\"values[0].value\\\"></span>\\n\" +\n    \"                <span class=\\\"prop\\\" ng-switch-when=\\\"ElementValue\\\"><mms-transclude-name mms-watch-id=\\\"true\\\" mms-element-id=\\\"{{value.elementId}}\\\" mms-project-id=\\\"{{mmsProjectId}}\\\" mms-ref-id=\\\"{{mmsRefId}}\\\"></mms-transclude-name></span>\\n\" +\n    \"                <span class=\\\"prop\\\" ng-switch-when=\\\"OpaqueExpression\\\">{{values[0].body[0]}}</span>\\n\" +\n    \"                <span class=\\\"prop\\\" ng-switch-default>{{values}}</span>\\n\" +\n    \"            </div>\\n\" +\n    \"        </div>\\n\" +\n    \"\\n\" +\n    \"        <div ng-if=\\\"element.type === 'Diagram' && element._artifactIds\\\">\\n\" +\n    \"            <mms-transclude-img mms-element-id=\\\"{{element.id}}\\\" mms-ref-id=\\\"{{element._refId}}\\\" mms-project-id=\\\"{{element._projectId}}\\\" mms-commit-id=\\\"{{element._commitId}}\\\"></mms-transclude-img>\\n\" +\n    \"        </div>\\n\" +\n    \"\\n\" +\n    \"        <h2 class=\\\"prop-title spec-view-doc-heading\\\">Documentation <a ng-click=\\\"showDocHTML = !showDocHTML\\\"><i class=\\\"fa fa-code\\\"></i></a></h2>\\n\" +\n    \"        <p ng-show=\\\"!showDocHTML\\\" class=\\\"doc-text\\\">\\n\" +\n    \"            <mms-cf mms-cf-type=\\\"doc\\\" mms-element-id=\\\"{{element.id}}\\\" mms-project-id=\\\"{{element._projectId}}\\\" mms-ref-id=\\\"{{element._refId}}\\\" mms-commit-id=\\\"{{element._commitId}}\\\" mms-watch-id=\\\"true\\\"></mms-cf>\\n\" +\n    \"        </p>\\n\" +\n    \"        <div ng-show=\\\"showDocHTML\\\">{{element.documentation}}</div>\\n\" +\n    \"\\n\" +\n    \"        <div ng-if=\\\"relatedDocuments.length > 0\\\">\\n\" +\n    \"            <h2 class=\\\"prop-title\\\">Used by Documents/Views</h2>\\n\" +\n    \"            <span class=\\\"elem-related-docs-wrapper prop\\\">\\n\" +\n    \"                <div ng-repeat=\\\"relatedDocument in relatedDocuments\\\">\\n\" +\n    \"                    <span ng-repeat=\\\"relatedView in relatedDocument._parentViews\\\">\\n\" +\n    \"                        <mms-view-link suppress-numbering=\\\"true\\\" mms-project-id=\\\"{{element._projectId}}\\\" mms-ref-id=\\\"{{element._refId}}\\\" mms-doc-id=\\\"{{relatedDocument.id}}\\\" mms-element-id=\\\"{{relatedDocument.id}}\\\" link-target=\\\"_blank\\\" rel=\\\"noopener\\\"></mms-view-link>\\n\" +\n    \"                        > <mms-view-link suppress-numbering=\\\"true\\\" mms-project-id=\\\"{{element._projectId}}\\\" mms-ref-id=\\\"{{element._refId}}\\\" mms-doc-id=\\\"{{relatedDocument.id}}\\\" mms-element-id=\\\"{{relatedView.id}}\\\" link-target=\\\"_blank\\\" rel=\\\"noopener\\\"></mms-view-link><br/>\\n\" +\n    \"                    </span>\\n\" +\n    \"                </div>\\n\" +\n    \"            </span>\\n\" +\n    \"        </div>\\n\" +\n    \"\\n\" +\n    \"        <!-- <a ng-click=\\\"toggleAdvancedProperties = !toggleAdvancedProperties\\\" class=\\\"visibility-toggle\\\" ng-class=\\\"{active: toggleAdvancedProperties}\\\" ng-init=\\\"toggleAdvancedProperties=false\\\">Advanced</a>\\n\" +\n    \"        <div ng-show=\\\"toggleAdvancedProperties\\\"> -->\\n\" +\n    \"            <h2 class=\\\"prop-title\\\">Metatypes</h2>\\n\" +\n    \"            <span class=\\\"elem-type-wrapper prop\\\">\\n\" +\n    \"                <span class=\\\"elem-type\\\">{{element.type}}</span>\\n\" +\n    \"                <div ng-repeat=\\\"type in element._appliedStereotypeIds\\\" class=\\\"elem-type\\\"><mms-transclude-name mms-element-id=\\\"{{type}}\\\" mms-project-id=\\\"{{mmsProjectId}}\\\" mms-ref-id=\\\"{{mmsRefId}}\\\" no-click=\\\"true\\\"></mms-transclude-name></div>\\n\" +\n    \"            </span>\\n\" +\n    \"\\n\" +\n    \"            <div ng-if=\\\"element.type === 'InstanceSpecification'\\\">\\n\" +\n    \"                <h2 class=\\\"prop-title\\\">Classifiers</h2>\\n\" +\n    \"                <span class=\\\"prop\\\" ng-repeat=\\\"path in element.classifierIds\\\"><mms-transclude-name mms-watch-id=\\\"true\\\" mms-element-id=\\\"{{path}}\\\" mms-project-id=\\\"{{mmsProjectId}}\\\" mms-ref-id=\\\"{{mmsRefId}}\\\"></mms-transclude-name></span>\\n\" +\n    \"            </div>\\n\" +\n    \"\\n\" +\n    \"            <h2 class=\\\"prop-title\\\">Location</h2>\\n\" +\n    \"            <span class=\\\"prop\\\">{{element._qualifiedName}}</span>\\n\" +\n    \"            <h2 class=\\\"prop-title\\\">ID&nbsp;\\n\" +\n    \"                <button ng-click=\\\"copyToClipboard($event, '#spec-element-id')\\\" class=\\\"btn btn-sm btn-default\\\" uib-tooltip=\\\"Copy ID\\\">\\n\" +\n    \"                    <i class=\\\"fa fa-copy\\\"></i>\\n\" +\n    \"                </button>\\n\" +\n    \"            </h2>\\n\" +\n    \"            <span class=\\\"prop id\\\" title=\\\"Copy ID\\\">\\n\" +\n    \"                <span id=\\\"spec-element-id\\\" ng-click=\\\"copyToClipboard($event, '#spec-element-id')\\\">{{element.id}}</span>\\n\" +\n    \"            </span>\\n\" +\n    \"            <h2 class=\\\"prop-title\\\">Branch/Tag</h2>\\n\" +\n    \"            <span class=\\\"prop\\\">{{element._refId}}</span>\\n\" +\n    \"            <h2 class=\\\"prop-title\\\">Project</h2>\\n\" +\n    \"            <span class=\\\"prop\\\">{{element._projectId}}</span>\\n\" +\n    \"            <h2 class=\\\"prop-title\\\">Formatted Modified Time</h2>\\n\" +\n    \"            <span class=\\\"prop\\\">{{element._modified}}</span>\\n\" +\n    \"            <h2 class=\\\"prop-title\\\">Commit</h2>\\n\" +\n    \"            <span class=\\\"prop\\\" title=\\\"View raw element data\\\">\\n\" +\n    \"                <a target=\\\"_blank\\\" rel=\\\"noopener noreferrer\\\" ng-href=\\\"{{elementDataLink}}\\\">\\n\" +\n    \"                    {{element._commitId}}&nbsp;<i class=\\\"fa fa-external-link\\\" aria-hidden=\\\"true\\\"></i>\\n\" +\n    \"                </a>\\n\" +\n    \"            </span>\\n\" +\n    \"        <!-- </div> -->\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\" +\n    \"\");\n}]);\n\nangular.module(\"mms/templates/mmsToolbar.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mmsToolbar.html\",\n    \"<div class=\\\"right-toolbar\\\">\\n\" +\n    \"    <div class=\\\"toolbox\\\">\\n\" +\n    \"        <div ng-repeat=\\\"button in buttons | filter: {active: true, permission: true} | orderBy:'priority'\\\">\\n\" +\n    \"            <a class=\\\"tools {{button.id}}\\\"\\n\" +\n    \"               ng-class=\\\"{selected: button.selected, dynamic: button.dynamic, pulldown: button.pullDown}\\\"\\n\" +\n    \"               ng-click=\\\"clicked(button)\\\" uib-tooltip=\\\"{{button.tooltip}}\\\" tooltip-trigger=\\\"mouseenter\\\"\\n\" +\n    \"               tooltip-popup-delay=\\\"100\\\" tooltip-placement=\\\"left\\\" tooltip-append-to-body=\\\"true\\\"><i\\n\" +\n    \"                class=\\\"fa {{button.icon}}\\\"></i></a>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\" +\n    \"\");\n}]);\n\nangular.module(\"mms/templates/mmsTranscludeDoc.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mmsTranscludeDoc.html\",\n    \"<div class=\\\"panel panel-default no-print\\\">\\n\" +\n    \"    <div class=\\\"panel-heading clearfix\\\">\\n\" +\n    \"        <h3 class=\\\"panel-title pull-left\\\">\\n\" +\n    \"            <form class=\\\"form-inline\\\">\\n\" +\n    \"            <div class=\\\"form-group\\\">\\n\" +\n    \"                <span class=\\\"pe-type-{{panelType}}\\\">{{panelType}} :</span>\\n\" +\n    \"                <span ng-if=\\\"!isDirectChildOfPresentationElement\\\">{{panelTitle}}</span>\\n\" +\n    \"                <span ng-if=\\\"isDirectChildOfPresentationElement\\\"><input type=\\\"text\\\" class=\\\"form-control\\\" ng-model=\\\"edit.name\\\"/></span>\\n\" +\n    \"            </div></form>\\n\" +\n    \"        </h3>\\n\" +\n    \"        <div class=\\\"btn-group pull-right\\\">\\n\" +\n    \"            <mms-button-bar class=\\\"transclude-panel-toolbar\\\" buttons=\\\"buttons\\\" mms-bb-api=\\\"bbApi\\\"></mms-button-bar>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"    <div class=\\\"panel-body no-padding-panel\\\">\\n\" +\n    \"        <textarea ng-model=\\\"edit.documentation\\\" mms-ckeditor mms-editor-type=\\\"{{editorType}}\\\" mms-editor-api=\\\"editorApi\\\" mms-project-id=\\\"{{element._projectId}}\\\" mms-ref-id=\\\"{{element._refId}}\\\" autosave-key=\\\"{{element._projectId + element._refId + element.id}}\\\"></textarea>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\");\n}]);\n\nangular.module(\"mms/templates/mmsTranscludeName.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mmsTranscludeName.html\",\n    \"<form class=\\\"input-group\\\" ng-submit=\\\"save($event)\\\">\\n\" +\n    \"    <input type=\\\"text\\\" class=\\\"form-control\\\" ng-model=\\\"edit.name\\\" aria-describedby=\\\"basic-addon2\\\">\\n\" +\n    \"\t<span class=\\\"input-group-addon transclude-name-label\\\">Name</span>\\n\" +\n    \"    <span class=\\\"input-group-addon\\\" ng-click=\\\"save($event)\\\" title=\\\"Save\\\">\\n\" +\n    \"        <i ng-if=\\\"!elementSaving\\\" class=\\\"fa fa-save\\\"></i>\\n\" +\n    \"        <i ng-if=\\\"elementSaving\\\" class=\\\"fa fa-spinner fa-spin\\\"></i>\\n\" +\n    \"    </span>\\n\" +\n    \"    <span class=\\\"input-group-addon\\\" ng-click=\\\"cancel($event)\\\"><i class=\\\"fa fa-times\\\" title=\\\"Cancel\\\"></i></span>\\n\" +\n    \"</form>\\n\" +\n    \"\");\n}]);\n\nangular.module(\"mms/templates/mmsTranscludeVal.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mmsTranscludeVal.html\",\n    \"<span ng-repeat=\\\"value in ::values\\\" ng-switch on=\\\"value.type\\\">\\n\" +\n    \"    <span ng-switch-when=\\\"LiteralInteger\\\">{{::value.value}}</span>\\n\" +\n    \"    <span ng-switch-when=\\\"LiteralBoolean\\\">{{::value.value}}</span>\\n\" +\n    \"    <span ng-switch-when=\\\"LiteralReal\\\">{{::value.value | veRealNum}}</span>\\n\" +\n    \"    <span ng-switch-when=\\\"LiteralUnlimitedNatural\\\">{{::value.value}}</span>\\n\" +\n    \"    <span ng-switch-when=\\\"ElementValue\\\"><mms-transclude-name no-click=\\\"true\\\" mms-element-id=\\\"{{::value.elementId}}\\\" mms-project-id=\\\"{{projectId}}\\\" mms-ref-id=\\\"{{refId}}\\\" mms-commit-id=\\\"{{commitId}}\\\"></mms-transclude-name></span>\\n\" +\n    \"    <span ng-switch-when=\\\"InstanceValue\\\"><mms-transclude-name no-click=\\\"true\\\" mms-element-id=\\\"{{::value.instanceId}}\\\" mms-project-id=\\\"{{projectId}}\\\" mms-ref-id=\\\"{{refId}}\\\" mms-commit-id=\\\"{{commitId}}\\\"></mms-transclude-name></span>\\n\" +\n    \"    <span ng-switch-when=\\\"OpaqueExpression\\\">{{::value.body[0]}}</span>\\n\" +\n    \"    <span ng-switch-default>{{::value}}</span>\\n\" +\n    \"</span>\");\n}]);\n\nangular.module(\"mms/templates/mmsTranscludeValEdit.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mmsTranscludeValEdit.html\",\n    \"<div class=\\\"panel panel-info\\\">\\n\" +\n    \"    <span ng-repeat=\\\"value in editValues\\\" ng-switch on=\\\"value.type\\\">\\n\" +\n    \"        <span ng-switch-when=\\\"LiteralInteger\\\">{{value.value}}</span>\\n\" +\n    \"        <span ng-switch-when=\\\"LiteralBoolean\\\">{{value.value}}</span>\\n\" +\n    \"        <span ng-switch-when=\\\"LiteralReal\\\">{{value.value | veRealNum}}</span>\\n\" +\n    \"        <span ng-switch-when=\\\"LiteralUnlimitedNatural\\\">{{value.value}}</span>\\n\" +\n    \"        <span ng-switch-when=\\\"ElementValue\\\"><mms-transclude-name no-click=\\\"true\\\" mms-element-id=\\\"{{::value.elementId}}\\\" mms-project-id=\\\"{{projectId}}\\\" mms-ref-id=\\\"{{refId}}\\\" mms-commit-id=\\\"{{commitId}}\\\"></mms-transclude-name></span>\\n\" +\n    \"        <span ng-switch-when=\\\"InstanceValue\\\"><mms-transclude-name no-click=\\\"true\\\" mms-element-id=\\\"{{::value.instanceId}}\\\" mms-project-id=\\\"{{projectId}}\\\" mms-ref-id=\\\"{{refId}}\\\" mms-commit-id=\\\"{{commitId}}\\\"></mms-transclude-name></span>\\n\" +\n    \"        <span ng-switch-when=\\\"OpaqueExpression\\\">{{value.body[0]}}</span>\\n\" +\n    \"        <span ng-switch-default>{{value}}</span>\\n\" +\n    \"    </span>\\n\" +\n    \"</div>\");\n}]);\n\nangular.module(\"mms/templates/mmsTranscludeValFrame.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mmsTranscludeValFrame.html\",\n    \"<!-- Most of this code is borrowed from mmsSepc.html -->\\n\" +\n    \"<div class=\\\"panel panel-default no-print\\\">\\n\" +\n    \"    <div class=\\\"panel-heading clearfix\\\">\\n\" +\n    \"        <h3 class=\\\"panel-title pull-left\\\">Value : {{element.name}}</h3>\\n\" +\n    \"        <div class=\\\"btn-group pull-right\\\">\\n\" +\n    \"            <mms-button-bar class=\\\"transclude-panel-toolbar\\\" buttons=\\\"buttons\\\" mms-bb-api=\\\"bbApi\\\"></mms-button-bar>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"    <div class=\\\"panel-body\\\">\\n\" +\n    \"        <div ng-if=\\\"!isEnumeration\\\">\\n\" +\n    \"            <div ng-if=\\\"editValues.length == 0\\\">\\n\" +\n    \"                <select ng-model=\\\"addValueType\\\" ng-options=\\\"key for (key, value) in addValueTypes\\\"></select>\\n\" +\n    \"                <button class=\\\"btn btn-sm btn-default\\\" ng-click=\\\"addValue(addValueType)\\\">Add</button>\\n\" +\n    \"            </div>\\n\" +\n    \"            <span class=\\\"transclude-val\\\" ng-repeat=\\\"value in editValues\\\" ng-switch on=\\\"value.type\\\" ng-form=\\\"valForm\\\">\\n\" +\n    \"                <div ng-switch-when=\\\"LiteralInteger\\\" ng-class=\\\"{'has-error': valForm.$error.pattern}\\\">\\n\" +\n    \"                    <div class=\\\"form-inline\\\">\\n\" +\n    \"                    <input class=\\\"form-control ve-plain-input\\\" type=\\\"number\\\" name=\\\"intVal\\\" ng-model=\\\"value.value\\\" ng-pattern=\\\"/^-?\\\\d+$/\\\" ng-blur=\\\"cleanupVal(value)\\\">\\n\" +\n    \"                    <a ng-if=\\\"!$first\\\" ng-click=\\\"removeVal($index)\\\"><i class=\\\"fa fa-close\\\"></i></a>\\n\" +\n    \"                    </div>\\n\" +\n    \"                    <label class=\\\"control-label mms-error-icon\\\" ng-show=\\\"valForm.$error.pattern\\\">Not a valid integer</label>\\n\" +\n    \"                </div>\\n\" +\n    \"                <div ng-switch-when=\\\"LiteralUnlimitedNatural\\\" ng-class=\\\"{'has-error': valForm.$error.pattern}\\\">\\n\" +\n    \"                    <div class=\\\"form-inline\\\">\\n\" +\n    \"                    <input class=\\\"form-control ve-plain-input\\\" type=\\\"number\\\" name=\\\"natVal\\\" ng-model=\\\"value.value\\\" ng-pattern=\\\"/^\\\\d+$/\\\" ng-blur=\\\"cleanupVal(value)\\\">\\n\" +\n    \"                    <a ng-if=\\\"!$first\\\" ng-click=\\\"removeVal($index)\\\"><i class=\\\"fa fa-close\\\"></i></a>\\n\" +\n    \"                    </div>\\n\" +\n    \"                    <label class=\\\"control-label mms-error-icon\\\" ng-show=\\\"valForm.$error.pattern\\\">Not a valid natural number</label>\\n\" +\n    \"                </div>\\n\" +\n    \"                <div ng-switch-when=\\\"LiteralBoolean\\\"><input type=\\\"checkbox\\\" ng-model=\\\"value.value\\\">&nbsp;{{value.value}}&nbsp;<a ng-if=\\\"!$first\\\" ng-click=\\\"removeVal($index)\\\"><i class=\\\"fa fa-close\\\"></i></a></div>\\n\" +\n    \"                <div ng-switch-when=\\\"LiteralReal\\\">\\n\" +\n    \"                    <div class=\\\"form-inline\\\">\\n\" +\n    \"                    <input class=\\\"form-control ve-plain-input\\\" type=\\\"number\\\" ng-model=\\\"value.value\\\" step=\\\"any\\\">&nbsp;<a ng-if=\\\"!$first\\\" ng-click=\\\"removeVal($index)\\\"><i class=\\\"fa fa-close\\\"></i></a>\\n\" +\n    \"                    </div>\\n\" +\n    \"                </div>\\n\" +\n    \"                <div ng-switch-when=\\\"LiteralString\\\">\\n\" +\n    \"                    <textarea ng-if=\\\"hasHtml(value.value)\\\" mms-ckeditor mms-project-id=\\\"{{element._projectId}}\\\" mms-ref-id=\\\"{{element._refId}}\\\" autosave-key=\\\"{{element._projectId + element._refId + element.id + 'index:' + $index}}\\\" ng-model=\\\"value.value\\\"></textarea>\\n\" +\n    \"                    <div ng-if=\\\"!hasHtml(value.value)\\\"><textarea ng-model=\\\"value.value\\\"></textarea><a ng-click=\\\"addHtml(value)\\\"><i class=\\\"fa fa-html5\\\"></i></a></div>\\n\" +\n    \"                    <a ng-if=\\\"!$first\\\" ng-click=\\\"removeVal($index)\\\"><i class=\\\"fa fa-close\\\"></i></a>\\n\" +\n    \"                </div>\\n\" +\n    \"                <div ng-switch-when=\\\"OpaqueExpression\\\">\\n\" +\n    \"                    <textarea ng-model=\\\"value.body[0]\\\"></textarea><a ng-if=\\\"!$first\\\" ng-click=\\\"removeVal($index)\\\"><i class=\\\"fa fa-close\\\"></i></a>\\n\" +\n    \"                </div>\\n\" +\n    \"                <div ng-switch-default>Editing not supported for now</div>\\n\" +\n    \"            </span>\\n\" +\n    \"            <div ng-if=\\\"editValues.length != 0 && isSlot\\\">\\n\" +\n    \"                <button class=\\\"btn btn-sm btn-default\\\" ng-click=\\\"addValue(editValues[0].type)\\\">Add</button>\\n\" +\n    \"            </div>\\n\" +\n    \"        </div>\\n\" +\n    \"        <!-- if enum and isslot repeat values in element -->\\n\" +\n    \"        <div ng-if=\\\"isEnumeration\\\" ng-repeat=\\\"val in editValues\\\">\\n\" +\n    \"            <select ng-model=\\\"val.instanceId\\\" ng-options=\\\"el.id as el.name for el in options\\\"></select>\\n\" +\n    \"            <a ng-if=\\\"!$first\\\" ng-click=\\\"removeVal($index)\\\"><i class=\\\"fa fa-close\\\"></i></a>\\n\" +\n    \"        </div>\\n\" +\n    \"        <div ng-if=\\\"(isSlot || editValues.length == 0) && isEnumeration\\\">\\n\" +\n    \"            <button class=\\\"btn btn-sm btn-default\\\" ng-click=\\\"addEnumerationValue()\\\">Add</button>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"\\n\" +\n    \"\");\n}]);\n\nangular.module(\"mms/templates/mmsTree.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mmsTree.html\",\n    \"<ul class=\\\"nav nav-list nav-pills nav-stacked abn-tree\\\">\\n\" +\n    \"    <li ng-repeat=\\\"row in tree_rows | filter:{visible:true} track by row.branch.uid\\\" ng-hide=\\\"!treeFilter(row, options.search)\\\"\\n\" +\n    \"        ng-class=\\\"'level-' + {{row.level}}\\\" class=\\\"abn-tree-row\\\">\\n\" +\n    \"        <div class=\\\"arrow\\\" ng-click=\\\"user_clicks_branch(row.branch)\\\" ng-dblclick=\\\"user_dblclicks_branch(row.branch)\\\" ng-class=\\\"{'active-text': row.branch.selected}\\\" id=\\\"tree-branch-{{row.branch.data.id}}\\\">\\n\" +\n    \"            <div class=\\\"shaft\\\" ng-class=\\\"{'shaft-selected': row.branch.selected, 'shaft-hidden': !row.branch.selected}\\\">\\n\" +\n    \"                <a ng-href=\\\"{{getHref(row);}}\\\" class=\\\"tree-item\\\">\\n\" +\n    \"                    <i ng-class=\\\"{'active-text': row.branch.selected}\\\" ng-click=\\\"expandCallback(row, $event)\\\" class=\\\"indented tree-icon {{row.expand_icon}}\\\" ></i>\\n\" +\n    \"                    <i ng-class=\\\"{'active-text': row.branch.selected}\\\" class=\\\"indented tree-icon {{row.type_icon}}\\\" ></i>\\n\" +\n    \"                    <span class=\\\"indented tree-label\\\" ng-class=\\\"{'active-text': row.branch.selected}\\\">{{row.section}} {{row.branch.data.name}}</span>\\n\" +\n    \"                </a>\\n\" +\n    \"            </div>\\n\" +\n    \"        </div>\\n\" +\n    \"    </li>\\n\" +\n    \"</ul>\\n\" +\n    \"\");\n}]);\n\nangular.module(\"mms/templates/mmsTsDiagram.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mmsTsDiagram.html\",\n    \"<div class=\\\"tsTabPanel\\\" id=\\\"{{containerId}}\\\" style=\\\"width:95%;height:800px;\\\" ></div>\\n\" +\n    \"<div class=\\\"tsDrawingView\\\" id=\\\"{{viewId}}\\\" ></div>\\n\" +\n    \"<div class=\\\"tsTreeView\\\" id=\\\"{{controlsId}}\\\" ></div>\\n\" +\n    \"<div class=\\\"tsTableView\\\" id=\\\"{{tableId}}\\\" ></div>\\n\" +\n    \"<div class=\\\"tsTableView\\\" id=\\\"{{edgeTableId}}\\\" ></div>\\n\" +\n    \"<div class=\\\"tsInspectorView\\\" id=\\\"{{inspectorId}}\\\" ></div>\\n\" +\n    \"\");\n}]);\n\nangular.module(\"mms/templates/mmsView.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mmsView.html\",\n    \"<div id=\\\"{{mmsElementId}}\\\" ng-class=\\\"{landscape: view._printLandscape}\\\">\\n\" +\n    \"\\n\" +\n    \"    <h1 ng-if=\\\"mmsLink\\\" class=\\\"view-title\\\">\\n\" +\n    \"      <span class=\\\"ve-view-number\\\">{{view._veNumber}}</span> <mms-view-link ng-class=\\\"{'docTitle-underlined': isHover}\\\" mms-element-id=\\\"{{view.id}}\\\" mms-doc-id=\\\"{{view.id}}\\\"></mms-view-link>\\n\" +\n    \"      <mms-view-link class=\\\"open-document\\\" ng-mouseover=\\\"hoverIn()\\\" ng-mouseleave=\\\"hoverOut()\\\" mms-element-id=\\\"{{view.id}}\\\" mms-doc-id=\\\"{{view.id}}\\\" \\n\" +\n    \"        link-text=\\\"Open Document\\\" link-class=\\\"btn btn-primary no-print\\\" mms-external-link=\\\"true\\\" link-icon-class=\\\"fa fa-share\\\"></mms-view-link>\\n\" +\n    \"    </h1>\\n\" +\n    \"\\n\" +\n    \"    <h1 ng-if=\\\"!mmsLink\\\" class=\\\"view-title h{{level}}\\\">\\n\" +\n    \"        <span class=\\\"ve-view-number\\\">{{view._veNumber}}</span> <mms-transclude-name mms-element-id=\\\"{{view.id}}\\\" mms-project-id=\\\"{{view._projectId}}\\\" mms-ref-id=\\\"{{view._refId}}\\\"></mms-transclude-name>\\n\" +\n    \"    </h1>\\n\" +\n    \"\\n\" +\n    \"    <div class=\\\"ve-secondary-text last-modified no-print\\\">\\n\" +\n    \"      Last Modified: {{modified | date:'M/d/yy h:mm a'}} by <b>{{modifier}}</b>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"    <i ng-hide=\\\"view\\\" class=\\\"fa fa-2x fa-spinner fa-spin\\\"></i>\\n\" +\n    \"\\n\" +\n    \"    <div class=\\\"add-pe-button-container no-print\\\" ng-init=\\\"$index = -1\\\" ng-include=\\\"'mms/templates/mmsAddPeButton.html'\\\"></div>\\n\" +\n    \"    <div ng-if=\\\"view._contents\\\">\\n\" +\n    \"        <!-- Cant use track by instanceVal.instance b/c of possible duplicate entries -->\\n\" +\n    \"        <div ng-repeat=\\\"instanceVal in view._contents.operand track by instanceVal.instanceId\\\"> \\n\" +\n    \"            <mms-view-presentation-elem data-mms-instance-val=\\\"::instanceVal\\\"></mms-view-presentation-elem>\\n\" +\n    \"            <div class=\\\"add-pe-button-container no-print\\\" ng-include=\\\"'mms/templates/mmsAddPeButton.html'\\\"></div>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"    <div ng-if=\\\"view.specification\\\">\\n\" +\n    \"        <!-- Cant use track by instanceVal.instance b/c of possible duplicate entries -->\\n\" +\n    \"        <div ng-repeat=\\\"instanceVal in view.specification.operand track by instanceVal.instanceId\\\"> \\n\" +\n    \"            <mms-view-presentation-elem data-mms-instance-val=\\\"::instanceVal\\\"></mms-view-presentation-elem>\\n\" +\n    \"            <div class=\\\"add-pe-button-container no-print\\\" ng-include=\\\"'mms/templates/mmsAddPeButton.html'\\\"></div>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\");\n}]);\n\nangular.module(\"mms/templates/mmsViewPresentationElem.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mmsViewPresentationElem.html\",\n    \"<div ng-if=\\\"presentationElemLoading\\\" class=\\\"fa fa-spinner fa-spin\\\"></div>\\n\" +\n    \"<div id=\\\"{{instanceSpec.id}}\\\" ng-if=\\\"!presentationElemLoading\\\" ng-switch on=\\\"presentationElem.type\\\">\\n\" +\n    \"    <mms-view-para class=\\\"read-width\\\" data-mms-para=\\\"presentationElem\\\" ng-switch-when=\\\"Paragraph\\\"></mms-view-para>\\n\" +\n    \"    <mms-view-table data-mms-table=\\\"presentationElem\\\" mms-pe=\\\"instanceSpec\\\" ng-switch-when=\\\"Table\\\"></mms-view-table>\\n\" +\n    \"    <mms-view-table-t class=\\\"read-width\\\" data-mms-para=\\\"presentationElem\\\" ng-switch-when=\\\"TableT\\\"></mms-view-table-t>\\n\" +\n    \"    <mms-view-list class=\\\"read-width\\\" data-mms-list=\\\"presentationElem\\\" ng-switch-when=\\\"List\\\"></mms-view-list>\\n\" +\n    \"    <mms-view-list-t class=\\\"read-width\\\" data-mms-para=\\\"presentationElem\\\" ng-switch-when=\\\"ListT\\\"></mms-view-list-t>\\n\" +\n    \"    <mms-view-img data-mms-image=\\\"presentationElem\\\" mms-pe=\\\"instanceSpec\\\" ng-switch-when=\\\"Image\\\"></mms-view-img>\\n\" +\n    \"    <mms-view-section data-mms-section=\\\"presentationElem\\\" ng-switch-when=\\\"InstanceSpecification\\\"></mms-view-section>\\n\" +\n    \"    <mms-view-equation class=\\\"read-width\\\" data-mms-para=\\\"presentationElem\\\" ng-switch-when=\\\"Equation\\\"></mms-view-equation>\\n\" +\n    \"    <mms-view-figure class=\\\"read-width\\\" data-mms-para=\\\"presentationElem\\\" ng-switch-when=\\\"Figure\\\"></mms-view-figure>\\n\" +\n    \"    <mms-view-figure class=\\\"read-width\\\" data-mms-para=\\\"presentationElem\\\" ng-switch-when=\\\"ImageT\\\"></mms-view-figure>\\n\" +\n    \"    <mms-transclude-com class=\\\"read-width\\\" mms-element-id=\\\"{{presentationElem.source}}\\\" mms-project-id=\\\"{{instanceSpec._projectId}}\\\" mms-ref-id=\\\"{{instanceSpec._refId}}\\\" ng-switch-when=\\\"Comment\\\"></mms-transclude-com>\\n\" +\n    \"    <mms-view-plot data-mms-plot=\\\"presentationElem\\\" ng-switch-when=\\\"Plot\\\"></mms-view-plot>\\n\" +\n    \"    <mms-ts-diagram mms-pe-id=\\\"{{instanceSpec.id}}\\\" mms-project-id=\\\"{{instanceSpec._projectId}}\\\" mms-ref-id=\\\"{{instanceSpec._refId}}\\\" mms-tsp-spec=\\\"presentationElem\\\" ng-switch-when=\\\"TomSawyerDiagram\\\"></mms-ts-diagram>\\n\" +\n    \"</div>\");\n}]);\n\nangular.module(\"mms/templates/mmsViewReorder.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mmsViewReorder.html\",\n    \"<!-- Nested node template -->\\n\" +\n    \"<script type=\\\"text/ng-template\\\" id=\\\"nodes_renderer2.html\\\">\\n\" +\n    \"    <div ui-tree-handle data-nodrag=\\\"{{element.isOpaque ? 'true' : 'false'}}\\\"\\n\" +\n    \"         ng-class=\\\"{ 'grab' : !element.isOpaque, 'no-grab': element.isOpaque }\\\"\\n\" +\n    \"         title=\\\"{{element.isOpaque ? 'Docgen element is not reorderable' : ''}}\\\">\\n\" +\n    \"        \\n\" +\n    \"         {{element.presentationElement.type === 'InstanceSpecification' ? 'Section' : element.presentationElement.type}} : {{element.instanceSpecification.name}}\\n\" +\n    \"    </div>\\n\" +\n    \"    <ol ui-tree-nodes ng-model=\\\"element.sectionElements\\\">\\n\" +\n    \"        <li ng-repeat=\\\"element in element.sectionElements\\\" ui-tree-node ng-include=\\\"'nodes_renderer2.html'\\\">\\n\" +\n    \"        </li>\\n\" +\n    \"    </ol>\\n\" +\n    \"</script>\\n\" +\n    \"<div class=\\\"container-tree-reorder\\\">\\n\" +\n    \"    <h4 class=\\\"right-pane-title\\\">Reorder contents</h4>\\n\" +\n    \"    <hr class=\\\"spec-title-divider\\\">\\n\" +\n    \"    <div ng-show=\\\"!elementReferenceTree || elementReferenceTree.length == 0\\\">View contents loading or unavailable\\n\" +\n    \"    </div>\\n\" +\n    \"    <div ng-show=\\\"elementReferenceTree && elementReferenceTree.length > 0\\\"><b>Bold</b> view contents are reorderable</div>\\n\" +\n    \"    <div class=\\\"well\\\" ui-tree=\\\"treeOptions\\\">\\n\" +\n    \"        <ol ui-tree-nodes class=\\\"root\\\" ng-model=\\\"elementReferenceTree\\\">\\n\" +\n    \"            <li ng-repeat=\\\"element in elementReferenceTree\\\" ui-tree-node ng-include=\\\"'nodes_renderer2.html'\\\"></li>\\n\" +\n    \"        </ol>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\" +\n    \"\");\n}]);\n\nangular.module(\"mms/templates/mmsViewSection.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/mmsViewSection.html\",\n    \"<div ng-if=\\\"section.specification\\\">\\n\" +\n    \"    <div ng-show=\\\"! isEditing\\\">\\n\" +\n    \"        <h1 class=\\\"section-title h{{level}}\\\" ng-hide=\\\"inPreviewMode\\\">{{section._veNumber}} {{section.name}}</h1>\\n\" +\n    \"        <div ng-show=\\\"inPreviewMode\\\"><h1 class=\\\"section-title h{{level}}\\\">{{section._veNumber}} {{edit.name}}</h1></div>\\n\" +\n    \"    </div>\\n\" +\n    \"    <div ng-class=\\\"{'panel panel-default' : isEditing}\\\">\\n\" +\n    \"        <div ng-class=\\\"{'no-display' : ! isEditing}\\\" class=\\\"panel-heading clearfix no-print\\\">\\n\" +\n    \"            <h3 class=\\\"panel-title pull-left\\\">\\n\" +\n    \"                <div ng-class=\\\"{prop: isEditing}\\\"><input class=\\\"form-control\\\" type=\\\"text\\\" ng-model=\\\"edit.name\\\"/></div>\\n\" +\n    \"            </h3>\\n\" +\n    \"            <div class=\\\"btn-group pull-right\\\">\\n\" +\n    \"                <mms-button-bar class=\\\"transclude-panel-toolbar\\\" buttons=\\\"buttons\\\" mms-bb-api=\\\"bbApi\\\"></mms-button-bar>\\n\" +\n    \"            </div>\\n\" +\n    \"        </div>\\n\" +\n    \"        <div ng-class=\\\"{'panel-body' : isEditing}\\\">\\n\" +\n    \"            <div class=\\\"add-pe-button-container no-print\\\" ng-init=\\\"$index = -1\\\" ng-include=\\\"'mms/templates/mmsAddPeButton.html'\\\"></div>\\n\" +\n    \"            <div ng-repeat=\\\"instanceVal in section.specification.operand track by instanceVal.instanceId\\\">\\n\" +\n    \"                <mms-view-presentation-elem data-mms-instance-val=\\\"::instanceVal\\\" data-mms-parent-section=\\\"::section\\\"></mms-view-presentation-elem>\\n\" +\n    \"                <div class=\\\"add-pe-button-container no-print\\\" ng-include=\\\"'mms/templates/mmsAddPeButton.html'\\\"></div>\\n\" +\n    \"            </div>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\" +\n    \"\");\n}]);\n\nangular.module(\"mms/templates/revertConfirm.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/revertConfirm.html\",\n    \"<div class=\\\"modal-header\\\">\\n\" +\n    \"    <h4>Revert element documentation, name, and value</h4>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-body revert-dialogue\\\">\\n\" +\n    \"    <p>Revert documentation, name, and value of this element from \\n\" +\n    \"    <b>{{compareCommit.commitSelected._creator}} - {{compareCommit.commitSelected._created | date:'M/d/yy h:mm a'}}</b> on {{compareCommit.ref.type}}: <b>{{compareCommit.ref.name}}</b>\\n\" +\n    \"    to \\n\" +\n    \"    <b>{{baseCommit.commitSelected._creator}} - {{baseCommit.commitSelected._created | date:'M/d/yy h:mm a'}}</b>\\n\" +\n    \"    on {{baseCommit.refSelected.type}}: <b>{{baseCommit.refSelected.name}}</b>.</p>\\n\" +\n    \"    <p>This will create a new version under your user name on <b>{{compareCommit.ref.name}}.</b></p>\\n\" +\n    \"    <p>Cross reference contents will NOT be reverted.</p>\\n\" +\n    \"\\n\" +\n    \"    <h3>Preview Element</h3>\\n\" +\n    \"    <div class=\\\"element-preview-box\\\">\\n\" +\n    \"        <h1 class=\\\"prop element-title\\\">\\n\" +\n    \"            <mms-cf mms-cf-type=\\\"name\\\" mms-element-id=\\\"{{mmsElementId}}\\\" mms-project-id=\\\"{{mmsProjectId}}\\\" mms-ref-id=\\\"{{baseCommit.refSelected.id}}\\\" mms-commit-id=\\\"{{baseCommit.commitSelected.id}}\\\"></mms-cf>\\n\" +\n    \"        </h1>\\n\" +\n    \"        <h2 class=\\\"prop-title spec-view-doc-heading\\\">Documentation</h2>\\n\" +\n    \"        <p ng-show=\\\"!showDocHTML\\\" class=\\\"doc-text\\\">\\n\" +\n    \"            <mms-cf mms-cf-type=\\\"doc\\\" mms-element-id=\\\"{{mmsElementId}}\\\" mms-project-id=\\\"{{mmsProjectId}}\\\" mms-ref-id=\\\"{{baseCommit.refSelected.id}}\\\" mms-commit-id=\\\"{{baseCommit.commitSelected.id}}\\\"></mms-cf>\\n\" +\n    \"        </p>\\n\" +\n    \"        <div ng-if=\\\"element.type === 'Property' || element.type === 'Port' || element.type === 'Slot'\\\">\\n\" +\n    \"        <h2 class=\\\"prop-title\\\">Property Value</h2>\\n\" +\n    \"        <span class=\\\"prop\\\">\\n\" +\n    \"            <mms-cf mms-cf-type=\\\"val\\\" mms-element-id=\\\"{{mmsElementId}}\\\" mms-project-id=\\\"{{mmsProjectId}}\\\" mms-ref-id=\\\"{{baseCommit.refSelected.id}}\\\" mms-commit-id=\\\"{{baseCommit.commitSelected.id}}\\\"></mms-cf>\\n\" +\n    \"        </span></div>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-footer\\\">\\n\" +\n    \"    <button class=\\\"btn btn-warning \\\" ng-click=\\\"ok()\\\">Revert</button>\\n\" +\n    \"    <button class=\\\"btn btn-default\\\" ng-click=\\\"cancel()\\\">Cancel</button>\\n\" +\n    \"</div>\\n\" +\n    \"\");\n}]);\n\nangular.module(\"mms/templates/saveConflict.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"mms/templates/saveConflict.html\",\n    \"<div class=\\\"modal-header\\\"><h4>Conflict!</h4></div>\\n\" +\n    \"<div class=\\\"modal-body\\\">\\n\" +\n    \"    <p>This element has been updated on the server since the last read\\n\" +\n    \"        and your save is rejected!</p>\\n\" +\n    \"    <hr/>\\n\" +\n    \"    <h6>Latest</h6>\\n\" +\n    \"    <mms-spec mms-type=\\\"element\\\" mms-element=\\\"latest\\\" no-edit=\\\"true\\\"></mms-spec>\\n\" +\n    \"    <hr/>\\n\" +\n    \"    <p> Do you want to discard your edits and update to the latest or force an overwrite?</p>\\n\" +\n    \"</div>\\n\" +\n    \"<div class=\\\"modal-footer\\\">\\n\" +\n    \"    <button class=\\\"btn btn-warning\\\" ng-click=\\\"ok()\\\">Discard Edits</button>\\n\" +\n    \"    <button class=\\\"btn btn-warning\\\" ng-click=\\\"force()\\\">Force Save</button>\\n\" +\n    \"    <!--<button class=\\\"btn btn-sm btn-primary\\\" ng-click=\\\"merge()\\\">Try Merge Edits</button>-->\\n\" +\n    \"    <button class=\\\"btn btn-default\\\" ng-click=\\\"cancel()\\\">Cancel (Do nothing)</button>\\n\" +\n    \"</div>\\n\" +\n    \"\");\n}]);\n","'use strict';\n\n/**\n * @ngdoc overview\n * @name mms.directives\n * \n * @requires mms\n * @requires ui.bootstrap\n * @requires ui.sortable\n * @requires angular-growl\n *\n * @description\n * # mms.directives module\n * This module provides prebuilt components that are commonly used by the mms\n * client applications, for example, cross referencing and element \"spec window\".\n * Since this module contains directives with ui elements, there's more dependencies\n * then just using the services module. In the future it will be more pick and \n * choose instead of everything being in one module.\n *\n * ## Links to dependencies\n * * [ui.bootstrap](http://angular-ui.github.io/bootstrap/)\n * * [ui.sortable](https://github.com/angular-ui/ui-sortable) (this in turn depends on jquery and jqueryui)\n * * [jQuery](http://jquery.com/)\n * * [jQueryUI](http://jqueryui.com/)\n * * [bootstrap](http://getbootstrap.com/) (for styling and css)\n * * [angular-growl](https://github.com/JanStevens/angular-growl-2)\n * * [font awesome](http://fortawesome.github.io/Font-Awesome/)\n *\n * ## Example app that uses this module\n * The following example is an app that uses the directive mmsSpec to display\n * a spec window for an element\n *\n * ### HTML (index.html)\n *  <pre>\n    <!doctype html>\n    <html ng-app=\"exampleApp\">\n        <head>\n            <title>Example app</title>\n            <link rel=\"stylesheet\" href=\"bootstrap.css\" type=\"text/css\"/>\n            <link rel=\"stylesheet\" href=\"mms.css\"/> <!-- mms directives css stylings -->\n            <link rel=\"stylesheet\" href=\"font-awesome.css\"/>\n            <link rel=\"stylesheet\" href=\"angular-growl.css\"/>\n        </head>\n        <body>\n            <div growl></div> <!-- for notifications -->\n\n            <mms-spec mms-eid=\"_element_id\"></mms-spec>\n            <!-- this will display a 'spec window' for the element -->\n        \n        <!-- dependencies -->\n        <script src=\"jquery.js\"></script>\n        <script src=\"jquery-ui.js\"></script>\n        <script src=\"lodash.js\"></script>\n        <script src=\"angular.js\"></script>\n        <script src=\"sortable.js\"></script>\n        <script src=\"ui-bootstrap-tpls.js\"></script>\n        <script src=\"angular-growl.js\"></script>\n\n        <!-- mms -->\n        <script src=\"mms.js\"></script>\n        <script src=\"mms.directives.tpls.js\"></script>\n        <script src=\"mms.directives.js\"></script>\n\n        <!-- your app -->\n        <script src=\"app.js\"></script>\n        </body>\n    </html>\n    </pre>\n * ### JS (app.js)\n *  <pre>\n    angular.module('exampleApp', ['mms', 'mms.directives']);\n    </pre>\n */\nangular.module('mms.directives', ['mms', 'mms.directives.tpls', 'ui.bootstrap', 'angular-growl', 'angularjs-dropdown-multiselect', 'ui.tree-filter'])\n.config(['$sceProvider', 'growlProvider', 'uiTreeFilterSettingsProvider', function($sceProvider, growlProvider, uiTreeFilterSettingsProvider) {\n    $sceProvider.enabled(false);\n    growlProvider.onlyUniqueMessages(false);\n    growlProvider.globalTimeToLive({success: 5000, error: -1, warning: 5000, info: 5000});\n    growlProvider.globalPosition('bottom-right');\n    uiTreeFilterSettingsProvider.addresses = ['label'];\n    uiTreeFilterSettingsProvider.descendantCollection = 'children';\n}])\n.filter('veRealNum', function() {\n    return function(n) {\n        if (Number.isInteger(n)) {\n            return n + '.0';\n        }\n        return n;\n    };\n})\n.constant('CKEDITOR', window.CKEDITOR)\n.constant('MathJax', window.MathJax);\n","'use strict';\n\nvar directiveModule = angular.module('angularjs-dropdown-multiselect', []);\n\ndirectiveModule.directive('ngDropdownMultiselect', ['$filter', '$document', '$compile', '$parse', '_',\n\nfunction ($filter, $document, $compile, $parse, _) {\n\n    return {\n        restrict: 'AE',\n        scope: {\n            selectedModel: '=',\n            options: '=',\n            extraSettings: '=',\n            events: '=',\n            searchFilter: '=?',\n            translationTexts: '=',\n            groupBy: '@'\n        },\n        template: function (element, attrs) {\n            var checkboxes = attrs.checkboxes ? true : false;\n            var groups = attrs.groupBy ? true : false;\n\n            var template = '<div class=\"multiselect-parent btn-group dropdown-multiselect ve-light-dropdown\" ng-value=\"getButtonText()\">';\n            template += '<button type=\"button\" class=\"dropdown-toggle\" ng-class=\"settings.buttonClasses\" ng-click=\"toggleDropdown()\">{{getButtonText()}}&nbsp;<i class=\"fa fa-caret-down\" aria-hidden=\"true\"></i></button>';\n            template += '<ul class=\"dropdown-menu dropdown-menu-form menu-with-input\" ng-style=\"{display: open ? \\'block\\' : \\'none\\', height : settings.scrollable ? settings.scrollableHeight : \\'auto\\' }\" style=\"overflow-y: scroll\" >';\n            template += '<li ng-hide=\"!settings.showCheckAll || settings.selectionLimit > 0\"><a data-ng-click=\"selectAll()\"><span class=\"fa fa-check\"></span>  {{texts.checkAll}}</a>';\n            template += '<li ng-show=\"settings.showUncheckAll\"><a data-ng-click=\"deselectAll();\"><span class=\"remove-list-item\"></span>   {{texts.uncheckAll}}</a></li>';\n            //template += '<li ng-hide=\"(!settings.showCheckAll || settings.selectionLimit > 0) && !settings.showUncheckAll\" class=\"divider\"></li>';\n            template += '<li class=\"dropdown-input\" ng-show=\"settings.enableSearch\"><input type=\"text\" class=\"ve-plain-input\" ng-model=\"searchFilter\" placeholder=\"{{texts.searchPlaceholder}}\" /></li>';\n            //template += '<li ng-show=\"settings.enableSearch\" class=\"divider\"></li>';\n\n            if (groups) {\n                template += '<li ng-repeat-start=\"option in orderedItems | filter: searchFilter\" ng-show=\"getPropertyForObject(option, settings.groupBy) !== getPropertyForObject(orderedItems[$index - 1], settings.groupBy)\" role=\"presentation\" class=\"dropdown-header\">{{ getGroupTitle(getPropertyForObject(option, settings.groupBy)) }}</li>';\n                template += '<li ng-repeat-end role=\"presentation\">';\n            } else {\n                template += '<li role=\"presentation\" ng-repeat=\"option in options | filter: searchFilter\">';\n            }\n\n            template += '<a role=\"menuitem\" tabindex=\"-1\" ng-click=\"setSelectedItem(getPropertyForObject(option,settings.idProp))\">';\n\n            if (checkboxes) {\n                template += '<div class=\"checkbox\"><label><input class=\"checkboxInput\" type=\"checkbox\" ng-click=\"checkboxClick($event, getPropertyForObject(option,settings.idProp))\" ng-checked=\"isChecked(getPropertyForObject(option,settings.idProp))\" /> {{getPropertyForObject(option, settings.displayProp)}}</label></div></a>';\n            } else {\n                template += '<span data-ng-class=\"{\\'checked-list-item\\': isChecked(getPropertyForObject(option,settings.idProp))}\"></span> {{getPropertyForObject(option, settings.displayProp)}}</a>';\n            }\n\n            template += '</li>';\n\n            template += '<li class=\"divider\" ng-show=\"settings.selectionLimit > 1\"></li>';\n            template += '<li role=\"presentation\" ng-show=\"settings.selectionLimit > 1\"><a role=\"menuitem\">{{selectedModel.length}} {{texts.selectionOf}} {{settings.selectionLimit}} {{texts.selectionCount}}</a></li>';\n\n            template += '</ul>';\n            template += '</div>';\n\n            element.html(template);\n        },\n        link: function ($scope, $element, $attrs) {\n            var $dropdownTrigger = $element.children()[0];\n\n            $scope.toggleDropdown = function () {\n                $scope.open = !$scope.open;\n            };\n\n            $scope.checkboxClick = function ($event, id) {\n                $scope.setSelectedItem(id);\n                $event.stopImmediatePropagation();\n            };\n\n            $scope.externalEvents = {\n                onItemSelect: angular.noop,\n                onItemDeselect: angular.noop,\n                onSelectAll: angular.noop,\n                onDeselectAll: angular.noop,\n                onInitDone: angular.noop,\n                onMaxSelectionReached: angular.noop\n            };\n\n            $scope.settings = {\n                dynamicTitle: true,\n                scrollable: false,\n                scrollableHeight: '300px',\n                closeOnBlur: true,\n                displayProp: 'label',\n                idProp: 'id',\n                externalIdProp: 'id',\n                enableSearch: false,\n                selectionLimit: 0,\n                showCheckAll: true,\n                showUncheckAll: true,\n                closeOnSelect: false,\n                buttonClasses: 'btn btn-default',\n                closeOnDeselect: false,\n                groupBy: $attrs.groupBy || undefined,\n                groupByTextProvider: null,\n                smartButtonMaxItems: 0,\n                smartButtonTextConverter: angular.noop\n            };\n\n            $scope.texts = {\n                checkAll: 'Check All',\n                uncheckAll: 'Uncheck All',\n                selectionCount: 'checked',\n                selectionOf: '/',\n                searchPlaceholder: 'Search...',\n                buttonDefaultText: 'Select',\n                dynamicButtonTextSuffix: 'checked'\n            };\n\n            $scope.searchFilter = $scope.searchFilter || '';\n\n            if (angular.isDefined($scope.settings.groupBy)) {\n                $scope.$watch('options', function (newValue) {\n                    if (angular.isDefined(newValue)) {\n                        $scope.orderedItems = $filter('orderBy')(newValue, $scope.settings.groupBy);\n                    }\n                });\n            }\n\n            angular.extend($scope.settings, $scope.extraSettings || []);\n            angular.extend($scope.externalEvents, $scope.events || []);\n            angular.extend($scope.texts, $scope.translationTexts);\n\n            $scope.singleSelection = $scope.settings.selectionLimit === 1;\n\n            function getFindObj(id) {\n                var findObj = {};\n\n                if ($scope.settings.externalIdProp === '') {\n                    findObj[$scope.settings.idProp] = id;\n                } else {\n                    findObj[$scope.settings.externalIdProp] = id;\n                }\n\n                return findObj;\n            }\n\n            function clearObject(object) {\n                for (var prop in object) {\n                    delete object[prop];\n                }\n            }\n\n            if ($scope.singleSelection) {\n                if (angular.isArray($scope.selectedModel) && $scope.selectedModel.length === 0) {\n                    clearObject($scope.selectedModel);\n                }\n            }\n\n            if ($scope.settings.closeOnBlur) {\n                $document.on('click', function (e) {\n                    var target = e.target.parentElement;\n                    var parentFound = false;\n\n                    while (angular.isDefined(target) && target !== null && !parentFound) {\n                        if (_.contains(target.className.split(' '), 'multiselect-parent') && !parentFound) {\n                            if (target === $dropdownTrigger) {\n                                parentFound = true;\n                            }\n                        }\n                        target = target.parentElement;\n                    }\n\n                    if (!parentFound) {\n                        $scope.$apply(function () {\n                            $scope.open = false;\n                        });\n                    }\n                });\n            }\n\n            $scope.getGroupTitle = function (groupValue) {\n                if ($scope.settings.groupByTextProvider !== null) {\n                    return $scope.settings.groupByTextProvider(groupValue);\n                }\n\n                return groupValue;\n            };\n\n            $scope.getButtonText = function () {\n                if ($scope.settings.dynamicTitle && ($scope.selectedModel.length > 0 || (angular.isObject($scope.selectedModel) && _.keys($scope.selectedModel).length > 0))) {\n                    if ($scope.settings.smartButtonMaxItems > 0) {\n                        var itemsText = [];\n\n                        angular.forEach($scope.options, function (optionItem) {\n                            if ($scope.isChecked($scope.getPropertyForObject(optionItem, $scope.settings.idProp))) {\n                                var displayText = $scope.getPropertyForObject(optionItem, $scope.settings.displayProp);\n                                var converterResponse = $scope.settings.smartButtonTextConverter(displayText, optionItem);\n\n                                itemsText.push(converterResponse ? converterResponse : displayText);\n                            }\n                        });\n\n                        if ($scope.selectedModel.length > $scope.settings.smartButtonMaxItems) {\n                            itemsText = itemsText.slice(0, $scope.settings.smartButtonMaxItems);\n                            itemsText.push('...');\n                        }\n\n                        return itemsText.join(', ');\n                    } else {\n                        var totalSelected;\n\n                        if ($scope.singleSelection) {\n                            totalSelected = ($scope.selectedModel !== null && angular.isDefined($scope.selectedModel[$scope.settings.idProp])) ? 1 : 0;\n                        } else {\n                            totalSelected = angular.isDefined($scope.selectedModel) ? $scope.selectedModel.length : 0;\n                        }\n\n                        if (totalSelected === 0) {\n                            return $scope.texts.buttonDefaultText;\n                        } else {\n                            return totalSelected + ' ' + $scope.texts.dynamicButtonTextSuffix;\n                        }\n                    }\n                } else {\n                    return $scope.texts.buttonDefaultText;\n                }\n            };\n\n            $scope.getPropertyForObject = function (object, property) {\n                if (angular.isDefined(object) && object.hasOwnProperty(property)) {\n                    return object[property];\n                }\n\n                return '';\n            };\n\n            $scope.selectAll = function () {\n                $scope.deselectAll(false);\n                $scope.externalEvents.onSelectAll();\n\n                angular.forEach($scope.options, function (value) {\n                    $scope.setSelectedItem(value[$scope.settings.idProp], true);\n                });\n            };\n\n            $scope.deselectAll = function (sendEvent) {\n                sendEvent = sendEvent || true;\n\n                if (sendEvent) {\n                    $scope.externalEvents.onDeselectAll();\n                }\n\n                if ($scope.singleSelection) {\n                    clearObject($scope.selectedModel);\n                } else {\n                    $scope.selectedModel.splice(0, $scope.selectedModel.length);\n                }\n            };\n\n            $scope.setSelectedItem = function (id, dontRemove) {\n                var findObj = getFindObj(id);\n                var finalObj = null;\n\n                if ($scope.settings.externalIdProp === '') {\n                    finalObj = _.find($scope.options, findObj);\n                } else {\n                    finalObj = findObj;\n                }\n\n                if ($scope.singleSelection) {\n                    clearObject($scope.selectedModel);\n                    angular.extend($scope.selectedModel, finalObj);\n                    $scope.externalEvents.onItemSelect(finalObj);\n                    if ($scope.settings.closeOnSelect) $scope.open = false;\n\n                    return;\n                }\n\n                dontRemove = dontRemove || false;\n\n                var exists = _.findIndex($scope.selectedModel, findObj) !== -1;\n\n                if (!dontRemove && exists) {\n                    $scope.selectedModel.splice(_.findIndex($scope.selectedModel, findObj), 1);\n                    $scope.externalEvents.onItemDeselect(findObj);\n                } else if (!exists && ($scope.settings.selectionLimit === 0 || $scope.selectedModel.length < $scope.settings.selectionLimit)) {\n                    $scope.selectedModel.push(finalObj);\n                    $scope.externalEvents.onItemSelect(finalObj);\n                }\n                if ($scope.settings.closeOnSelect) $scope.open = false;\n            };\n\n            $scope.isChecked = function (id) {\n                if ($scope.singleSelection) {\n                    return $scope.selectedModel !== null && angular.isDefined($scope.selectedModel[$scope.settings.idProp]) && $scope.selectedModel[$scope.settings.idProp] === getFindObj(id)[$scope.settings.idProp];\n                }\n\n                return _.findIndex($scope.selectedModel, getFindObj(id)) !== -1;\n            };\n\n            $scope.externalEvents.onInitDone();\n        }\n    };\n}]);","'use strict';\n\nangular.module('mms.directives')\n.factory('Utils', ['$q','$uibModal','$timeout', '$templateCache','$rootScope','$compile', '$window', 'URLService', 'CacheService', 'ElementService','ViewService','UtilsService','AuthService', 'growl', Utils]);\n\n/**\n * @ngdoc service\n * @name mms.directives.Utils\n * @requires $q\n * @requires $uibModal\n * @requires $templateCache\n * @requires mms.WorkspaceService\n * @requires mms.ConfigService\n * @requires mms.ElementService\n * @requires _\n *\n * @description\n * Utility methods for performing edit like behavior to a transclude element\n * WARNING These are intended to be internal utility functions and not designed to be used as api\n *\n */\nfunction Utils($q, $uibModal, $timeout, $templateCache, $rootScope, $compile, $window, URLService, CacheService, ElementService, ViewService, UtilsService, AuthService, growl) {\n\n    function clearAutosaveContent(autosaveKey, elementType) {\n        if ( elementType === 'Slot' ) {\n            Object.keys($window.localStorage)\n                .forEach(function(key){\n                    if ( key.indexOf(autosaveKey) !== -1 ) {\n                        $window.localStorage.removeItem(key);\n                    }\n                });\n        } else {\n            $window.localStorage.removeItem(autosaveKey);\n        }\n    }\n\n    // var ENUM_ID = '_9_0_62a020a_1105704885400_895774_7947';\n    // var ENUM_LITERAL = '_9_0_62a020a_1105704885423_380971_7955';\n\n    var conflictCtrl = function($scope, $uibModalInstance) {\n        $scope.ok = function() {\n            $uibModalInstance.close('ok');\n        };\n        $scope.cancel = function() {\n            $uibModalInstance.close('cancel');\n        };\n        $scope.force = function() {\n            $uibModalInstance.close('force');\n        };\n        $scope.merge = function() {\n            $uibModalInstance.close('merge');\n        };\n    };\n\n    var setupValEditFunctions = function(scope) {\n        scope.addValueTypes = {string: 'LiteralString', boolean: 'LiteralBoolean', integer: 'LiteralInteger', real: 'LiteralReal'};\n        scope.addValue = function(type) {\n            var newValueSpec = null;\n            if (type === 'LiteralBoolean')\n                newValueSpec = UtilsService.createValueSpecElement({type: type, value: false, id: UtilsService.createMmsId(), ownerId: scope.element.id});\n            else if (type === 'LiteralInteger')\n                newValueSpec = UtilsService.createValueSpecElement({type: type, value: 0, id: UtilsService.createMmsId(), ownerId: scope.element.id});\n            else if (type === 'LiteralString')\n                newValueSpec = UtilsService.createValueSpecElement({type: type, value: '', id: UtilsService.createMmsId(), ownerId: scope.element.id});\n            else if (type === 'LiteralReal')\n                newValueSpec = UtilsService.createValueSpecElement({type: type, value: 0.0, id: UtilsService.createMmsId(), ownerId: scope.element.id});\n            scope.editValues.push(newValueSpec);\n            if (scope.element.type == 'Property' || scope.element.type == 'Port') {\n                scope.edit.defaultValue = newValueSpec;\n            }\n        };\n        scope.addValueType = 'LiteralString';\n        \n        scope.addEnumerationValue = function() {\n            var newValueSpec = UtilsService.createValueSpecElement({type: \"InstanceValue\", instanceId: scope.options[0], id: UtilsService.createMmsId(), ownerId: scope.element.id});\n            scope.editValues.push(newValueSpec);\n            if (scope.element.type == 'Property' || scope.element.type == 'Port') {\n                scope.edit.defaultValue = newValueSpec;\n            }\n        };\n\n        scope.removeVal = function(i) {\n            scope.editValues.splice(i, 1);\n        };\n    };\n\n    var setupValCf = function(scope) {\n        var data = scope.element;\n        if (data.type === 'Property' || data.type === 'Port') {\n            if (data.defaultValue) {\n                scope.values = [data.defaultValue];\n            } else {\n                scope.values = [];\n            }\n        }\n        if (data.type === 'Slot') {\n            scope.values = data.value;\n        }\n        if (data.type === 'Constraint' && data.specification) {\n            scope.values = [data.specification];\n        }\n        if (data.type === 'Expression') {\n            scope.values = data.operand;\n        }\n    };\n\n    /**\n     * @ngdoc function\n     * @name mms.directives.Utils#save\n     * @methodOf mms.directives.Utils\n     *\n     * @description\n     * save edited element\n     *\n     * @param {object} edit the edit object to save\n     * @param {object} [editorApi=null] optional editor api\n     * @param {object} scope angular scope that has common functions\n     * @return {Promise} promise would be resolved with updated element if save is successful.\n     *      For unsuccessful saves, it will be rejected with an object with type and message.\n     *      Type can be error or info. In case of conflict, there is an option to discard, merge,\n     *      or force save. If the user decides to discord or merge, type will be info even though\n     *      the original save failed. Error means an actual error occured.\n     */\n    var save = function(edit, editorApi, scope, continueEdit) {\n        var deferred = $q.defer();\n        if (editorApi && editorApi.save) {\n            editorApi.save();\n        }\n        ElementService.updateElement(edit)\n        .then(function(data) {\n            deferred.resolve(data);\n            setupValCf(scope);\n            $rootScope.$broadcast('element.updated', data, continueEdit);\n        }, function(reason) {\n            if (reason.status === 409) {\n                scope.latest = reason.data.elements[0];\n                var instance = $uibModal.open({\n                    template: $templateCache.get('mms/templates/saveConflict.html'),\n                    controller: ['$scope', '$uibModalInstance', conflictCtrl],\n                    scope: scope,\n                    size: 'lg'\n                });\n                instance.result.then(function(choice) {\n                    if (choice === 'ok') {\n                        var reqOb = {elementId: scope.latest.id, projectId: scope.latest._projectId, refId: scope.latest._refId, commitId: 'latest'};\n                        ElementService.cacheElement(reqOb, scope.latest, true);\n                        ElementService.cacheElement(reqOb, scope.latest, false);\n                    } else if (choice === 'force') {\n                        edit._read = scope.latest._read;\n                        edit._modified = scope.latest._modified;\n                        save(edit, editorApi, scope, continueEdit).then(function(resolved) {\n                            deferred.resolve(resolved);\n                        }, function(error) {\n                            deferred.reject(error);\n                        });\n                    } else {\n                        deferred.reject({type: 'cancel'});\n                    }\n                });\n            } else {\n                deferred.reject({type: 'error', message: reason.message});\n            }\n        });\n        return deferred.promise;\n    };\n\n    /**\n     * @ngdoc function\n     * @name mms.directives.Utils#hasEdits\n     * @methodOf  mms.directives.Utils\n     *\n     * @description\n     * whether editing object has changes compared to base element,\n     * currently compares name, doc, property values, if element is not\n     * editable, returns false\n     *\n     * @param {object} editOb edit object\n     * @return {boolean} has changes or not\n     */\n    var hasEdits = function (editOb) {\n        editOb._commitId = 'latest';\n        var cachedKey = UtilsService.makeElementKey(editOb);\n        var elementOb = CacheService.get(cachedKey);\n        if (editOb.name !== elementOb.name) {\n            return true;\n        }\n        if (editOb.documentation !== elementOb.documentation) {\n            return true;\n        }\n        if ((editOb.type === 'Property' || editOb.type === 'Port') && !angular.equals(editOb.defaultValue, elementOb.defaultValue)) {\n            return true;\n        } else if (editOb.type === 'Slot' && !angular.equals(editOb.value, elementOb.value)) {\n            return true;\n        } else if (editOb.type === 'Constraint' && !angular.equals(editOb.specification, elementOb.specification)) {\n            return true;\n        }\n        return false;\n    };\n\n    /**\n     * @ngdoc function\n     * @name mms.directives.Utils#revertEdits\n     * @methodOf mms.directives.Utils\n     *\n     * @description\n     * reset editing object back to base element values for name, doc, values\n     *\n     * @param {object} editOb scope with common properties\n     * @param {object} editorApi editor api to kill editor if reverting changes\n     */\n    var revertEdits = function(scope, editOb, editorApi) {\n        if (editorApi && editorApi.destroy) {\n            editorApi.destroy();\n        }\n        editOb._commitId = 'latest';\n        var cachedKey = UtilsService.makeElementKey(editOb);\n        var elementOb = CacheService.get(cachedKey);\n\n        if (elementOb.name) {\n            editOb.name = elementOb.name;\n        }\n        editOb.documentation = elementOb.documentation;\n        if (editOb.type === 'Property' || editOb.type === 'Port') {\n            editOb.defaultValue = JSON.parse(JSON.stringify(elementOb.defaultValue));\n            if (editOb.defaultValue) {\n                scope.editValues = [editOb.defaultValue];\n            } else {\n                scope.editValues = [];\n            }\n        } else if (editOb.type === 'Slot') {\n            editOb.value = JSON.parse(JSON.stringify(elementOb.value));\n            scope.editValues = editOb.value;\n        } else if (editOb.type === 'Constraint' && editOb.specification) {\n            editOb.specification = JSON.parse(JSON.stringify(elementOb.specification));\n            scope.editValues = [editOb.specification];\n        }\n    };\n\n    var handleError = function(reason) {\n        if (reason.type === 'info')\n            growl.info(reason.message);\n        else if (reason.type === 'warning')\n            growl.warning(reason.message);\n        else if (reason.type === 'error')\n            growl.error(reason.message);\n    };\n\n    /**\n     * @ngdoc function\n     * @name mms.directives.Utils#isEnumeration\n     * @methodOf mms.directives.Utils\n     *\n     * @description\n     * Check if element is enumeration and if true get enumerable options\n     *\n     * @param {object} elementOb element object\n     * @return {Promise} promise would be resolved with options and if object is enumerable.\n     *      For unsuccessful saves, it will be rejected with an object with reason.\n     */\n    var isEnumeration = function(elementOb) {\n        var deferred = $q.defer();\n        if (elementOb.type === 'Enumeration') {\n            var isEnumeration = true;\n            var reqOb = {\n                elementId: elementOb.id,\n                projectId: elementOb._projectId,\n                refId: elementOb._refId,\n                depth: 1\n            };\n            ElementService.getOwnedElements(reqOb).then(\n                function(val) {\n                    var newArray = [];\n                     // Filter for enumeration type\n                    for (var i = 0; i < val.length; i++) {\n                        if (val[i].type === 'EnumerationLiteral') {\n                            newArray.push(val[i]);\n                        }\n                    }\n                    newArray.sort(function(a, b) {\n                        return a.name.localeCompare(b.name);\n                    });\n                    deferred.resolve({options: newArray, isEnumeration: isEnumeration});\n                },\n                function(reason) {\n                    deferred.reject(reason);\n                }\n            );\n        } else {\n            deferred.resolve({options: [], isEnumeration: false});\n        }\n        return deferred.promise;\n    };\n\n    var getPropertySpec = function(elementOb) {\n        var deferred = $q.defer();\n        var id = elementOb.typeId;\n        var isSlot = false;\n        var isEnum = false;\n        var options = [];\n        if (elementOb.type === 'Slot') {\n            isSlot = true;\n            id = elementOb.definingFeatureId;\n        }\n        if (!id) { //no property type, will not be enum\n            deferred.resolve({options: options, isEnumeration: isEnum, isSlot: isSlot});\n            return deferred.promise;\n        }\n        // Get defining feature or type info\n        var reqOb = {elementId: id, projectId: elementOb._projectId, refId: elementOb._refId};\n        ElementService.getElement(reqOb)\n        .then(function(value) {\n            if (isSlot) {\n                if (!value.typeId) {\n                    deferred.resolve({options: options, isEnumeration: isEnum, isSlot: isSlot});\n                    return;\n                }\n                //if it is a slot\n                reqOb.elementId = value.typeId;\n                ElementService.getElement(reqOb) //this gets tyep of defining feature\n                .then(function(val) {\n                    isEnumeration(val)\n                    .then(function(enumValue) {\n                        if (enumValue.isEnumeration) {\n                            isEnum = enumValue.isEnumeration;\n                            options = enumValue.options;\n                        }\n                        deferred.resolve({options: options, isEnumeration: isEnum, isSlot: isSlot});\n                    }, function(reason) {\n                        deferred.resolve({options: options, isEnumeration: isEnum, isSlot: isSlot});\n                    });\n                });\n            } else {\n                isEnumeration(value)\n                .then(function(enumValue) {\n                    if (enumValue.isEnumeration) {\n                        isEnum = enumValue.isEnumeration;\n                        options = enumValue.options;\n                    }\n                    deferred.resolve({options: options, isEnumeration: isEnum, isSlot:isSlot });\n                }, function(reason) {\n                    deferred.reject(reason);\n                });\n            }\n        }, function(reason) {\n            deferred.resolve({options: options, isEnumeration: isEnum, isSlot: isSlot});\n        });\n        return deferred.promise;\n    };\n\n    /**\n    * @ngdoc function\n    * @name mms.directives.Utils#startEdit\n    * @methodOf mms.directives.Utils\n    * @description\n    * called by transcludes and section, adds the editing frame\n    * uses these in the scope:\n    *   element - element object for the element to edit (for sections it's the instance spec)\n    *   isEditing - boolean\n    *   commitId - calculated commit id\n    *   isEnumeration - boolean\n    *   recompileScope - child scope of directive scope\n    *   skipBroadcast - boolean (whether to broadcast presentationElem.edit for keeping track of open edits)\n    * sets these in the scope:\n    *   edit - editable element object\n    *   isEditing - true\n    *   inPreviewMode - false\n    *   editValues - array of editable values (for element that are of type Property, Slot, Port, Constraint)\n    *\n    * @param {object} scope scope of the transclude directives or view section directive\n    * @param {object} mmsViewCtrl parent view directive controller\n    * @param {object} domElement dom of the directive, jquery wrapped\n    * @param {string} template template to compile\n    * @param {boolean} doNotScroll whether to scroll to element\n    */\n    var startEdit = function(scope, mmsViewCtrl, domElement, template, doNotScroll) {\n        if (mmsViewCtrl.isEditable() && !scope.isEditing && scope.element && scope.element._editable && scope.commitId === 'latest') {\n            var elementOb = scope.element;\n            var reqOb = {elementId: elementOb.id, projectId: elementOb._projectId, refId: elementOb._refId};\n            ElementService.getElementForEdit(reqOb)\n            .then(function(data) {\n                scope.isEditing = true;\n                scope.inPreviewMode = false;\n                scope.edit = data;\n\n                if (data.type === 'Property' || data.type === 'Port') {\n                    if (scope.edit.defaultValue) {\n                        scope.editValues = [scope.edit.defaultValue];\n                    }\n                } else if (data.type === 'Slot') {\n                    if (angular.isArray(data.value)) {\n                        scope.editValues = data.value;\n                    }\n                } else if (data.type === 'Constraint' && data.specification) {\n                    scope.editValues = [data.specification];\n                }\n                if (!scope.editValues) {\n                    scope.editValues = [];\n                }\n                /*\n                if (scope.isEnumeration && scope.editValues.length === 0) {\n                    scope.editValues.push({type: 'InstanceValue', instanceId: null});\n                }\n                */\n                if (template) {\n                    if (scope.recompileScope) {\n                        scope.recompileScope.$destroy();\n                    }\n                    scope.recompileScope = scope.$new();\n                    domElement.empty();\n                    domElement.append(template);\n                    $compile(domElement.contents())(scope.recompileScope);\n                }\n                if (!scope.skipBroadcast) {\n                    // Broadcast message for the toolCtrl:\n                    $rootScope.$broadcast('presentationElem.edit',scope.edit);\n                } else {\n                    scope.skipBroadcast = false;\n                }\n                if (!doNotScroll) {\n                    scrollToElement(domElement);\n                }\n            }, handleError);\n\n            ElementService.isCacheOutdated(scope.element)\n            .then(function(data) {\n                if (data.status && data.server._modified > data.cache._modified) {\n                    growl.warning('This element has been updated on the server');\n                }\n            });\n        }\n    };\n\n    /**\n    * @ngdoc function\n    * @name mms.directives.Utils#saveAction\n    * @methodOf mms.directives.Utils\n    * @description\n    * called by transcludes and section, saves edited element\n    * uses these in the scope:\n    *   element - element object for the element to edit (for sections it's the instance spec)\n    *   elementSaving - boolean\n    *   isEditing - boolean\n    *   commitId - calculated commit id\n    *   bbApi - button bar api - handles spinny\n    * sets these in the scope:\n    *   elementSaving - boolean\n    *\n    * @param {object} scope scope of the transclude directives or view section directive\n    * @param {object} domElement dom of the directive, jquery wrapped\n    * @param {boolean} continueEdit save and continue\n    */\n    var saveAction = function(scope, domElement, continueEdit) {\n        if (scope.elementSaving) {\n            growl.info('Please Wait...');\n            return;\n        }\n        clearAutosaveContent(scope.element._projectId + scope.element._refId + scope.element.id, scope.edit.type);\n        if (scope.bbApi) {\n            if (!continueEdit) {\n                scope.bbApi.toggleButtonSpinner('presentation-element-save');\n            } else {\n                scope.bbApi.toggleButtonSpinner('presentation-element-saveC');\n            }\n        }\n        \n        scope.elementSaving = true;\n\n        var work = function() {\n            save(scope.edit, scope.editorApi, scope, continueEdit).then(function(data) {\n                scope.elementSaving = false;\n                if (!continueEdit) {\n                    scope.isEditing = false;\n                    $rootScope.$broadcast('presentationElem.save', scope.edit);\n                }\n                growl.success('Save Successful');\n                //scrollToElement(domElement);\n            }, function(reason) {\n                scope.elementSaving = false;\n                handleError(reason);\n            }).finally(function() {\n                if (scope.bbApi) {\n                    if (!continueEdit) {\n                        scope.bbApi.toggleButtonSpinner('presentation-element-save');\n                    } else {\n                        scope.bbApi.toggleButtonSpinner('presentation-element-saveC');\n                    }\n                }\n            });\n        };\n        $timeout(work, 1000, false); //to give ckeditor time to save any changes\n    };\n\n    /**\n    * @ngdoc function\n    * @name mms.directives.Utils#cancelAction\n    * @methodOf mms.directives.Utils\n    * @description\n    * called by transcludes and section, cancels edited element\n    * uses these in the scope:\n    *   element - element object for the element to edit (for sections it's the instance spec)\n    *   edit - edit object\n    *   elementSaving - boolean\n    *   isEditing - boolean\n    *   bbApi - button bar api - handles spinny\n    * sets these in the scope:\n    *   isEditing - false\n    *\n    * @param {object} scope scope of the transclude directives or view section directive\n    * @param {object} recompile recompile function object\n    * @param {object} domElement dom of the directive, jquery wrapped\n    */\n    var cancelAction = function(scope, recompile, domElement) {\n        if (scope.elementSaving) {\n            growl.info('Please Wait...');\n            return;\n        }\n        var cancelCleanUp = function() {\n            scope.isEditing = false;\n            revertEdits(scope, scope.edit);\n             // Broadcast message for the ToolCtrl:\n            $rootScope.$broadcast('presentationElem.cancel', scope.edit);\n            recompile();\n            // scrollToElement(domElement);\n        };\n        if (scope.bbApi) {\n            scope.bbApi.toggleButtonSpinner('presentation-element-cancel');\n        }\n        // Only need to confirm the cancellation if edits have been made:\n        if (hasEdits(scope.edit)) {\n            var instance = $uibModal.open({\n                templateUrl: 'partials/mms/cancelConfirm.html',\n                scope: scope,\n                controller: ['$scope', '$uibModalInstance', function($scope, $uibModalInstance) {\n                    $scope.ok = function() {\n                        clearAutosaveContent(scope.element._projectId + scope.element._refId + scope.element.id, scope.edit.type);\n                        $uibModalInstance.close('ok');\n                    };\n                    $scope.cancel = function() {\n                        $uibModalInstance.dismiss();\n                    };\n                }]\n            });\n            instance.result.then(function() {\n                cancelCleanUp();\n            }).finally(function() {\n                if (scope.bbApi) {\n                    scope.bbApi.toggleButtonSpinner('presentation-element-cancel');\n                }\n            });\n        } else {\n            cancelCleanUp();\n            if (scope.bbApi) {\n                scope.bbApi.toggleButtonSpinner('presentation-element-cancel');\n            }\n        }\n    };\n\n    var deleteAction = function(scope, bbApi, section) {\n        if (scope.elementSaving) {\n            growl.info('Please Wait...');\n            return;\n        }\n        // var id = section ? section.id : scope.view.id;\n        // ElementService.isCacheOutdated(id, scope.ws)\n        // .then(function(status) {\n        //     if (status.status) {\n        //         if (section && section.specification && !angular.equals(section.specification, status.server.specification)) {\n        //             growl.error('The view section contents is outdated, refresh the page first!');\n        //             return;\n        //         } else if (!section && scope.view._contents && !angular.equals(scope.view._contents, status.server._contents)) {\n        //             growl.error('The view contents is outdated, refresh the page first!');\n        //             return;\n        //         }\n        //     }\n             realDelete();\n        // }, function(reason) {\n        //     growl.error('Checking if view contents is up to date failed: ' + reason.message);\n        // });\n        function realDelete() {\n            bbApi.toggleButtonSpinner('presentation-element-delete');\n            scope.name = scope.edit.name;\n\n            var instance = $uibModal.open({\n                templateUrl: 'partials/mms/confirmRemove.html',\n                scope: scope,\n                controller: ['$scope', '$uibModalInstance', function($scope, $uibModalInstance) {\n                    $scope.ok = function() {\n                        clearAutosaveContent(scope.element._projectId + scope.element._refId + scope.element.id, scope.edit.type);\n                        $uibModalInstance.close('ok');\n                    };\n                    $scope.cancel = function() {\n                        $uibModalInstance.dismiss();\n                    };\n                }]\n            });\n            instance.result.then(function() {\n                var viewOrSec = section ? section : scope.view;\n                var reqOb = {elementId: viewOrSec.id, projectId: viewOrSec._projectId, refId: viewOrSec._refId, commitId: 'latest'};\n                ViewService.removeElementFromViewOrSection(reqOb, scope.instanceVal)\n                .then(function(data) {\n                    if (ViewService.isSection(scope.instanceSpec) || ViewService.isTable(scope.instanceSpec) || ViewService.isFigure(scope.instanceSpec) || ViewService.isEquation(scope.instanceSpec)) {\n                        // Broadcast message to TreeCtrl:\n                        $rootScope.$broadcast('viewctrl.delete.element', scope.instanceSpec);\n                    }\n\n                    $rootScope.$broadcast('view-reorder.refresh');\n\n                     // Broadcast message for the ToolCtrl:\n                    $rootScope.$broadcast('presentationElem.cancel',scope.edit);\n\n                    growl.success('Remove Successful');\n                }, handleError);\n\n            }).finally(function() {\n                scope.bbApi.toggleButtonSpinner('presentation-element-delete');\n            });\n        }\n    };\n\n    /**\n    * @ngdoc function\n    * @name mms.directives.Utils#previewAction\n    * @methodOf mms.directives.Utils\n    * @description\n    * called by transcludes and section, previews edited element\n    * uses these in the scope:\n    *   element - element object for the element to edit (for sections it's the instance spec)\n    *   edit - edit object\n    *   elementSaving - boolean\n    *   inPreviewMode - boolean\n    *   isEditing - boolean\n    *   bbApi - button bar api - handles spinny\n    * sets these in the scope:\n    *   skipBroadcast - true\n    *   inPreviewMode - false\n    *   isEditing - false\n    *   elementSaving - false\n    *\n    * @param {object} scope scope of the transclude directives or view section directive\n    * @param {object} recompile recompile function object\n    * @param {object} domElement dom of the directive, jquery wrapped\n    */\n    var previewAction = function(scope, recompile, domElement) {\n        if (scope.elementSaving) {\n            growl.info('Please Wait...');\n            return;\n        }\n        if (scope.edit && hasEdits(scope.edit) && !scope.inPreviewMode) {\n            scope.skipBroadcast = true; //preview next click to go into edit mode from broadcasting\n            scope.inPreviewMode = true;\n            recompile(true);\n        } else { //nothing has changed, cancel instead of preview\n            if (scope.edit && scope.isEditing) {\n                // Broadcast message for the ToolCtrl to clear out the tracker window:\n                $rootScope.$broadcast('presentationElem.cancel', scope.edit);\n                if (scope.element) {\n                    recompile();\n                }\n            }\n        }\n        scope.isEditing = false;\n        scope.elementSaving = false;\n        scrollToElement(domElement);\n    };\n\n    var isDirectChildOfPresentationElementFunc = function(element, mmsViewCtrl) {\n        var parent = element[0].parentElement;\n        while (parent && parent.nodeName !== 'MMS-VIEW-PRESENTATION-ELEM' && parent.nodeName !== 'MMS-VIEW') {\n            if (mmsViewCtrl.isTranscludedElement(parent.nodeName)) {\n                return false;\n            }\n            if (parent.nodeName === 'MMS-VIEW-TABLE' || parent.nodeName === 'MMS-VIEW-LIST' || parent.nodeName === 'MMS-VIEW-SECTION')\n                return false;\n            parent = parent.parentElement;\n        }\n        if (parent && parent.nodeName !== 'MMS-VIEW'){\n            return true;\n        }\n        return false;\n    };\n\n    var hasHtml = function(s) {\n        if (s.indexOf('<p>') === -1)\n            return false;\n        return true;\n    };\n\n    var scrollToElement = function(domElement) {\n        $timeout(function() {\n            var el = domElement.get(0);\n            if (domElement.isOnScreen())\n                return;\n            el.scrollIntoView();\n        }, 500, false);\n    };\n\n    var addPeCtrl = function($scope, $uibModalInstance, $filter) {\n        $scope.oking = false;\n        $scope.newPe = {name:''};\n        $scope.createForm = true;\n\n        var addPECallback = function(elementOb) {\n            if ($scope.oking) {\n                growl.info(\"Please wait...\");\n                return;\n            }\n            $scope.oking = true;\n            var instanceVal = {\n                instanceId: elementOb.id,\n                type: \"InstanceValue\"\n            };\n            ViewService.addElementToViewOrSection($scope.viewOrSectionOb, instanceVal, $scope.addPeIndex)\n                .then(function(data) {\n                    var elemType = $scope.presentationElemType;\n                    successUpdates(elemType, $scope.viewOrSectionOb.id);\n                    $uibModalInstance.close(data);\n                }, function(reason) {\n                    growl.error($scope.presentationElemType +\" Add Error: \" + reason.message);\n                }).finally(function() {\n                $scope.oking = false;\n            });\n        };\n\n        var peFilterQuery = function () {\n            var classIdOb = {};\n            if ($scope.presentationElemType === 'Table') {\n                classIdOb.classifierIds = [ViewService.TYPE_TO_CLASSIFIER_ID.TableT, ViewService.TYPE_TO_CLASSIFIER_ID.Table];\n            } else if ($scope.presentationElemType === 'List') {\n                classIdOb.classifierIds  = [ViewService.TYPE_TO_CLASSIFIER_ID.ListT, ViewService.TYPE_TO_CLASSIFIER_ID.List];\n            } else if ($scope.presentationElemType === 'Image') {\n                classIdOb.classifierIds = [ViewService.TYPE_TO_CLASSIFIER_ID.ImageT, ViewService.TYPE_TO_CLASSIFIER_ID.Image];\n            } else if ($scope.presentationElemType === 'Paragraph') {\n                classIdOb.classifierIds = [ViewService.TYPE_TO_CLASSIFIER_ID.ParagraphT, ViewService.TYPE_TO_CLASSIFIER_ID.Paragraph];\n            } else if ($scope.presentationElemType === 'Section') {\n                classIdOb.classifierIds = [ViewService.TYPE_TO_CLASSIFIER_ID.SectionT, ViewService.TYPE_TO_CLASSIFIER_ID.Section];\n            } else {\n                classIdOb.classifierIds = [ViewService.TYPE_TO_CLASSIFIER_ID[$scope.presentationElemType]];\n            }\n            var obj = {};\n            obj.terms = classIdOb;\n            return obj;\n        };\n\n        $scope.searchOptions = {\n            callback: addPECallback,\n            itemsPerPage: 200,\n            filterQueryList: [peFilterQuery],\n            hideFilterOptions: true\n        };\n\n        $scope.ok = function() {\n            if ($scope.oking) {\n                growl.info(\"Please wait...\");\n                return;\n            }\n            $scope.oking = true;\n            ViewService.createInstanceSpecification($scope.viewOrSectionOb, $scope.presentationElemType, $scope.newPe.name, $scope.addPeIndex)\n            .then(function(data) {\n                var elemType = $scope.presentationElemType;\n                successUpdates(elemType, $scope.viewOrSectionOb.id);\n                $uibModalInstance.close(data);\n            }, function(reason) {\n                growl.error($scope.presentationElemType + \" Add Error: \" + reason.message);\n            }).finally(function() {\n                $scope.oking = false;\n            });\n        };\n\n        $scope.cancel = function() {\n            $uibModalInstance.dismiss();\n        };\n    };\n\n    var successUpdates = function (elemType, id) {\n        $rootScope.$broadcast('view-reorder.refresh');\n        $rootScope.$broadcast('view.reorder.saved', id);\n        growl.success(\"Adding \" + elemType + \" Successful\");\n        // Show comments when creating a comment PE\n        if (elemType === 'Comment' && !$rootScope.veCommentsOn) {\n            $timeout(function() {\n                $('.show-comments').click();\n            }, 0, false);\n        }\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.directives.Utils#addPresentationElement\n     * @methodOf mms.directives.Utils\n     *\n     * @description\n     * Utility to add a new presentation element to view or section\n     *\n     * @param {Object} scope controller scope, expects $scope.ws (string) and $scope.site (object) to be there\n     * @param {string} type type of presentation element (Paragraph, Section)\n     * @param {Object} viewOrSection the view or section (instance spec) object\n     */\n    var addPresentationElement = function($scope, type, viewOrSectionOb) {\n        $scope.viewOrSectionOb = viewOrSectionOb;\n        $scope.presentationElemType = type;\n        var templateUrlStr = 'partials/mms/add-pe.html';\n\n        var instance = $uibModal.open({\n            templateUrl: templateUrlStr,\n            scope: $scope,\n            controller: ['$scope', '$uibModalInstance', '$filter', addPeCtrl]\n        });\n        instance.result.then(function(data) {\n            if (data.type !== 'InstanceSpecification' || ViewService.isSection(data)) {\n                return; //do not open editor for existing pes added or if pe/owner is a section\n            }\n            $timeout(function() { //auto open editor for newly added pe\n                $('#' + data.id).find('mms-transclude-doc,mms-transclude-com').click();\n            }, 0, false);\n        });\n    };\n\n    /**\n     * @ngdoc method\n     * @name mms.directives.Utils#reopenUnsavedElts\n     * @methodOf mms.directives.Utils\n     * @description\n     * called by transcludes when users have unsaved edits, leaves that view, and comes back to that view.\n     * the editor will reopen if there are unsaved edits.\n     * assumes no reload.\n     * uses these in the scope:\n     *   element - element object for the element to edit (for sections it's the instance spec)\n     *   ve_edits - unsaved edits object\n     *   startEdit - pop open the editor window\n     * @param {object} scope scope of the transclude directives or view section directive\n     * @param {String} transcludeType name, documentation, or value\n     */\n    var reopenUnsavedElts = function(scope, transcludeType){\n        var unsavedEdits = {};\n        if (scope.$root.ve_edits) {\n            unsavedEdits = scope.$root.ve_edits;\n        }\n        var key = scope.element.id + '|' + scope.element._projectId + '|' + scope.element._refId;\n        var thisEdits = unsavedEdits[key];\n        if (!thisEdits || scope.commitId !== 'latest') {\n            return;\n        }\n        if (transcludeType === 'value') {\n            if (scope.element.type === 'Property' || scope.element.type === 'Port') {\n                if (scope.element.defaultValue.value !== thisEdits.defaultValue.value ||\n                        scope.element.defaultValue.instanceId !== thisEdits.defaultValue.instanceId) {\n                    scope.startEdit();\n                }\n            } else if (scope.element.type === 'Slot') {\n                var valList1 = thisEdits.value;\n                var valList2 = scope.element.value;\n\n                // Check if the lists' lengths are the same\n                if (valList1.length !== valList2.length) {\n                    scope.startEdit();\n                } else {\n                    for (var j = 0; j < valList1.length; j++) {\n                        if (valList1[j].value !== valList2[j].value || valList1[j].instanceId !== valList2[j].instanceId) {\n                            scope.startEdit();\n                            break;\n                        }\n                    }\n                }\n            }\n        } else if (scope.element[transcludeType] !== thisEdits[transcludeType]) {\n            scope.startEdit();\n        }\n    };\n    /**\n     * @ngdoc method\n     * @name mms.directives.Utils#revertAction\n     * @methodOf mms.directives.Utils\n     * @description\n     * called by transcludes and section, cancels edited element\n     * uses these in the scope:\n     *   element - element object for the element to edit (for sections it's the instance spec)\n     *   edit - edit object\n     *   elementSaving - boolean\n     *   isEditing - boolean\n     *   bbApi - button bar api - handles spinny\n     * sets these in the scope:\n     *   isEditing - false\n     *\n     * @param {object} scope scope of the transclude directives or view section directive\n     * @param {object} recompile recompile function object\n     * @param {object} domElement dom of the directive, jquery wrapped\n     */\n    var revertAction = function($scope, preview, domElement) {\n        var templateUrlStr = 'mms/templates/revertConfirm.html';\n\n        var instance = $uibModal.open({\n            templateUrl: templateUrlStr,\n            scope: $scope,\n            size: 'lg',\n            windowClass: 'revert-spec',\n            controller: ['$scope', '$uibModalInstance', function($scope, $uibModalInstance) {\n                $scope.ok = function() {\n                    if ($scope.oking) {\n                        growl.info(\"Please wait...\");\n                        return;\n                    }\n                    $scope.oking = true;\n                    var revertEltInfo = {id: $scope.mmsElementId, _projectId : $scope.mmsProjectId, _refId: $scope.mmsRefId};\n                    var reqOb = {elementId: $scope.mmsElementId, projectId: $scope.mmsProjectId, refId: $scope.baseCommit.refSelected.id, commitId: $scope.baseCommit.commitSelected.id};\n                    ElementService.getElement(reqOb, 2, false)\n                    .then(function(data) {\n                        if (data.name) {\n                            revertEltInfo.name = data.name;\n                        }\n                        revertEltInfo.documentation = data.documentation;\n                        if (data.defaultValue) {\n                            revertEltInfo.defaultValue = data.defaultValue;\n                        }\n                        if (data.value) {\n                            revertEltInfo.value = data.value;\n                        }\n\n                        ElementService.updateElement(revertEltInfo)\n                        .then(function(data) {\n                            $rootScope.$broadcast('element.updated', data, false);\n                            $uibModalInstance.close();\n                            growl.success(\"Element reverted\");\n                        }, function(reason) {\n                            growl.error(\"Revert not compeleted - Error: \" + reason.message);\n                        }).finally(function() {\n                            $scope.oking = false;\n                        });\n                    });\n                };\n                $scope.cancel = function() {\n                    $uibModalInstance.dismiss();\n                };\n            }]\n        });\n        instance.result.then(function(data) {\n              // TODO: do anything here?\n        });\n    };\n\n    var checkForDuplicateInstances = function(operand) {\n        var seen = {}, dups = [], curr;\n        for (var i = 0; i < operand.length; i++) {\n            curr = operand[i].instanceId;\n            if (curr) {\n                if (seen[curr]) {\n                    dups.push(operand[i]);\n                    operand.splice(i, 1);\n                    i--;\n                    continue;\n                }\n                seen[curr] = true;\n            } else {\n                //instanceId is invalid?\n            }\n        }\n        return dups;\n    };\n\n    var fixImgSrc = function(imgDom) {\n        var src = imgDom.attr('src');\n        if (src) {\n            if (src.startsWith('../')) {\n                src.replace('../', '/alfresco/');\n            }\n            if (src.startsWith('/alfresco/')) {\n                imgDom.attr('src', URLService.getMmsServer() + src + '?alf_ticket=' + AuthService.getTicket());\n            }\n        }\n        if (imgDom.width() < 860) { //keep image relative centered with text if less than 9 in\n            return;\n        }\n        var parent = imgDom.parent('p');\n        if (parent.length > 0) {\n            if (parent.css('text-align') == 'center' || parent.hasClass('image-center')) {\n                imgDom.addClass('image-center');\n            }\n            imgDom.unwrap(); //note this removes parent p and puts img and any of its siblings in its place\n        }\n    };\n\n    var toggleLeftPane = function (searchTerm) {\n        if ( searchTerm && !$rootScope.ve_tree_pane.closed ) {\n            $rootScope.ve_tree_pane.toggle();\n        }\n\n        if ( !searchTerm && $rootScope.ve_tree_pane.closed ) {\n            $rootScope.ve_tree_pane.toggle();\n        }\n    };\n\n    var focusOnEditorAfterAddingWidgetTag = function(editor) {\n        var element = editor.widgets.focused.element.getParent();\n        var range = editor.createRange();\n        if(range) {\n            range.moveToClosestEditablePosition(element, true);\n            range.select();\n        }\n    };\n\n    return {\n        save: save,\n        hasEdits: hasEdits,\n        revertEdits: revertEdits,\n        startEdit: startEdit,\n        saveAction: saveAction,\n        cancelAction: cancelAction,\n        deleteAction: deleteAction,\n        previewAction: previewAction,\n        isDirectChildOfPresentationElementFunc: isDirectChildOfPresentationElementFunc,\n        hasHtml: hasHtml,\n        isEnumeration: isEnumeration,\n        getPropertySpec: getPropertySpec,\n        addPresentationElement: addPresentationElement,\n        setupValCf: setupValCf,\n        setupValEditFunctions: setupValEditFunctions,\n        revertAction: revertAction,\n        clearAutosaveContent: clearAutosaveContent,\n        reopenUnsavedElts: reopenUnsavedElts,\n        checkForDuplicateInstances: checkForDuplicateInstances,\n        fixImgSrc: fixImgSrc,\n        focusOnEditorAfterAddingWidgetTag: focusOnEditorAfterAddingWidgetTag,\n        toggleLeftPane: toggleLeftPane\n    };\n\n}\n","'use strict';\n\nangular.module('mmsApp')\n.factory('MmsAppUtils', ['$q', '$uibModal','$timeout', '$location', '$window', 'growl',\n    '$rootScope', '$filter', '$state', 'ElementService','ViewService', 'UtilsService', '_', MmsAppUtils]);\n\n/**\n * @ngdoc service\n * @name mmsApp.MmsAppUtils\n *\n * @description\n * Utilities\n */\nfunction MmsAppUtils($q, $uibModal, $timeout, $location, $window, growl,\n    $rootScope, $filter, $state, ElementService, ViewService, UtilsService, _) {\n\n    var tableToCsv = function(isDoc) { //Export to CSV button Pop-up Generated Here\n         var modalInstance = $uibModal.open({\n            templateUrl: 'partials/mms/tableExport.html',\n            controller: [\"$scope\", \"$uibModalInstance\", \"type\", function($scope, $uibModalInstance, type) {\n                $scope.type = type;\n                $scope.export = function() {\n                    $uibModalInstance.close('export');\n                };\n                $scope.cancel = function() {\n                    $uibModalInstance.dismiss();\n                };\n            }],\n            resolve: {\n                type: function() { return isDoc ? 'DOCUMENT' : 'VIEW';}\n            },\n            backdrop: 'static',\n            keyboard: false\n        });\n\n        var string = '<script src=\"https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js\"></script>' +\n            '<script>';\n            string += 'function doClick(id) { ' +\n            'var csvString = document.getElementById(id).value;' +\n            'var blob = new Blob([\"\\\\uFEFF\" + csvString], { ' +\n            '    type: \"text/csv;charset=utf-8;\" ' +\n            '}); ' +\n            '' +\n            'if (window.navigator.msSaveOrOpenBlob) { ' +\n            '    navigator.msSaveBlob(blob,\\'TableData.csv\\'); ' +\n            '} else { ' +\n            '' +\n            '    var downloadContainer = $(\\'<div data-tap-disabled=\"true\"><a></a></div>\\'); ' +\n            '    var downloadLink = $(downloadContainer.children()[0]); ' +\n            '    downloadLink.attr(\\'href\\', window.URL.createObjectURL(blob)); ' +\n            '    downloadLink.attr(\\'download\\', \\'TableData.csv\\'); ' +\n            '    downloadLink.attr(\\'target\\', \\'_blank\\'); ' +\n            ' ' +\n            '    $(window.document).find(\\'body\\').append(downloadContainer); ' +\n            '    /* $timeout(function () { */ ' +\n            '        downloadLink[0].click(); ' +\n            '        downloadLink.remove(); ' +\n            '    /* }, null); */ ' +\n            '} ' +\n            '} ';\n        string += '</script>';\n\n        modalInstance.result.then(function(choice) {\n            if (choice === 'export') {\n               var tableCSV = [];\n               // Grab all tables and run export to csv fnc\n                angular.element('#print-div').find(\"table\").each(function(elt){\n                    var tableObj = {};\n                    if (this.caption) {\n                        tableObj.caption = this.caption.innerHTML;\n                    } else {\n                        tableObj.caption = 'no caption';\n                    }\n                    tableObj.val = angular.element(this).table2CSV({delivery:'value'});\n                    tableCSV.push(tableObj);\n                });\n                var exportPopup = function(data) {\n                    var generator = window.open('', 'csv', 'height=600,width=800,scrollbars=1');\n                    generator.document.write('<html><head><title>Tables to CSV</title>');\n                    generator.document.write('</head><body >');\n                    generator.document.write(data);\n                    generator.document.write('</body></html>');\n                    generator.document.close();\n                    return true;\n                };\n                // generate text area content for popup\n                var genTextArea ='';\n                var num = 0;\n                angular.element(tableCSV).each(function(){\n                    genTextArea += '<h2>'+ this.caption +'</h2><div><button class=\"btn btn-sm btn-primary\" onclick=\"doClick(\\'textArea'+num+'\\')\">Save CSV</button></div><textArea cols=100 rows=15 wrap=\"off\" id=\"textArea'+num+'\">';\n                    genTextArea += this.val + '</textArea>';\n                    num++;\n                });\n                genTextArea += string;\n                exportPopup(genTextArea);\n            }\n        });\n    };\n\n    /**\n     * @ngdoc method\n     * @name mmsApp.MmsAppUtils#printModal\n     * @methodOf mmsApp.MmsAppUtils\n     *\n     * @description\n     * Click handler for print and export buttons. Opens modal or print \n     * confirmation and options to select from\n     *\n     * @param {Object} viewOrDocOb current document or view object\n     * @param {Object} refOb current branch/tag object\n     * @param {Boolean} isDoc viewOrDocOb is view or doc\n     * @param {Number} mode 1 = print, 2 = word, 3 = pdf\n     * @returns {Promise} The promise returned from UtilsService.exportHtmlAs - server response\n     *\n     */\n    var printModal = function(viewOrDocOb, refOb, isDoc, mode) {\n        var deferred = $q.defer();\n        var modalInstance = $uibModal.open({\n            templateUrl: 'partials/mms/printConfirm.html',\n            controller: [\"$scope\", \"$uibModalInstance\", function($scope, $uibModalInstance) {\n                $scope.type = isDoc ? 'DOCUMENT' : 'VIEW';\n                $scope.action = mode === 1 ? 'print' : mode === 3 ? 'Generate PDF' : 'Generate word';\n                $scope.label = mode === 3 ? 'PDF' : mode === 2 ? 'Word' : '';\n                $scope.mode = mode;\n                $scope.meta = {};\n                $scope.customizeDoc = {};\n                $scope.customizeDoc.useCustomStyle = false;\n                var print = angular.element(\"#print-div\");\n                if (print.find('.mms-error').length > 0) {\n                    $scope.hasError = true;\n                }\n\n                if (isDoc) {\n                    // If _printCss, use to set doc css for export/print\n                    $scope.customizeDoc.useCustomStyle = false;\n                    if (viewOrDocOb._printCss) {\n                        // If _printCss, show tab for custom css\n                        $scope.customizeDoc.useCustomStyle = true;\n                        $scope.customizeDoc.customCSS = viewOrDocOb._printCss;\n                    } else {\n                        $scope.customizeDoc.customCSS = UtilsService.getPrintCss(false, false, {});\n                    }\n\n                    // Get/Set document header/footer for PDF generation\n                    $scope.meta = {\n                        'top-left': 'loading...', top: 'loading...', 'top-right': 'loading...',\n                        'bottom-left': 'loading...', bottom: 'loading...', 'bottom-right': 'loading...'\n                    };\n                    ViewService.getDocMetadata({\n                        elementId: viewOrDocOb.id,\n                        projectId: viewOrDocOb._projectId,\n                        refId: viewOrDocOb._refId\n                    }, 2).then(function(metadata) {\n                        $scope.meta.top = metadata.top ? metadata.top : '';\n                        $scope.meta.bottom = metadata.bottom ? metadata.bottom : '';\n                        $scope.meta['top-left'] = metadata.topl ? metadata.topl : '';\n                        $scope.meta['top-right'] = metadata.topr ? metadata.topr : '';\n                        if (refOb && refOb.type === 'Tag') {\n                            $scope.meta['top-right'] = $scope.meta['top-right'] + ' ' + refOb.name;\n                        }\n                        var displayTime = refOb.type === 'Tag' ? refOb._timestamp : 'latest';\n                        if (displayTime === 'latest') {\n                            displayTime = new Date();\n                            displayTime = $filter('date')(displayTime, 'M/d/yy h:mm a');\n                        }\n                        $scope.meta['top-right'] = $scope.meta['top-right'] + ' ' + displayTime;\n                        $scope.meta['bottom-left'] = metadata.bottoml ? metadata.bottoml : '';\n                        $scope.meta['bottom-right'] = metadata.bottomr ? metadata.bottomr : 'counter(page)';\n                    }, function(reason) {\n                        $scope.meta['top-left'] = $scope.meta.top = $scope.meta['top-right'] = $scope.meta['bottom-left'] = $scope.meta.bottom = '';\n                        $scope.meta['bottom-right'] = 'counter(page)';\n                    });\n                }\n                $scope.unsaved = ($rootScope.ve_edits && !_.isEmpty($rootScope.ve_edits));\n                $scope.docOption = (!isDoc && (mode === 3 || mode === 2));\n                $scope.model = { genTotf: false, landscape: false, htmlTotf: false };\n                \n                $scope.saveStyleUpdate = function() {\n                    // To only update _printCss, create new ob with doc info\n                    $scope.elementSaving = true;\n                    var docOb = {id: viewOrDocOb.id, _projectId: viewOrDocOb._projectId, _refId: viewOrDocOb._refId};\n                    docOb._printCss = $scope.customizeDoc.customCSS;\n                    ElementService.updateElement(docOb).then(function() {\n                        $scope.elementSaving = false;\n                        growl.success('Save Successful');\n                    }, function() {\n                        $scope.elementSaving = false;\n                        growl.warning('Save was not complete. Please try again.');\n                    });\n                };\n                $scope.preview = function() {\n                    if (!$scope.previewResult) {\n                        $scope.previewResult = printOrGenerate(viewOrDocOb, 3, true, true, false);\n                        $scope.previewResult.tof = $scope.previewResult.tof + $scope.previewResult.toe;\n                    }\n                    var result = $scope.previewResult;\n                    var htmlArr = ['<html><head><title>' + viewOrDocOb.name + '</title><style type=\"text/css\">', $scope.customizeDoc.customCSS, '</style></head><body style=\"overflow: auto\">', result.cover];\n                    if (result.toc != '') htmlArr.push(result.toc);\n                    if (result.tot != '' && $scope.model.genTotf) htmlArr.push(result.tot);\n                    if (result.tof != '' && $scope.model.genTotf) htmlArr.push(result.tof);\n                    htmlArr.push(result.contents, '</body></html>');\n                    var htmlString = htmlArr.join('');\n                    var popupWin = $window.open('about:blank', '_blank', 'width=800,height=600,scrollbars=1,status=1,toolbar=1,menubar=1');\n                    popupWin.document.open();\n                    popupWin.document.write(htmlString);\n                    popupWin.document.close();\n                };\n                $scope.print = function() {\n                    $scope.customization = $scope.customizeDoc.useCustomStyle ? $scope.customizeDoc.customCSS : false;\n                    $uibModalInstance.close(['ok', $scope.model.genTotf, $scope.model.htmlTotf, $scope.model.landscape, $scope.meta, $scope.customization]);\n                };\n                $scope.fulldoc = function() {\n                    $uibModalInstance.close(['fulldoc']);\n                };\n                $scope.cancel = function() {\n                    $uibModalInstance.dismiss();\n                };\n            }],\n            backdrop: 'static',\n            keyboard: false\n        });\n        /* choice:\n        ['ok', $scope.model.genTotf, $scope.model.htmlTotf, $scope.model.landscape, $scope.meta]\n        [0] 'ok' - modal button to confirm print/export\n        [1] Generate List of Tables and Figures option\n        [2] HTML option checked - used to generate ToC from html\n        [3] Landscape option\n        [4] metadata:\n            bottom, bottom-left, bottom-right, top, top-left, top-right\n        [5] customization: CSS String || false\n        */\n        modalInstance.result.then(function(choice) {\n            if (choice[0] === 'ok') {\n                var result = printOrGenerate(viewOrDocOb, mode, isDoc, choice[1], choice[2]);\n                var customization = choice[5];\n                var css = customization ? customization : UtilsService.getPrintCss(choice[2], choice[3], choice[4]);\n                result.toe = choice[2] ? '' : result.toe;\n                if (mode === 1) {\n                    var popupWin = $window.open('about:blank', '_blank', 'width=800,height=600,scrollbars=1,status=1,toolbar=1,menubar=1');\n                    popupWin.document.open();\n                    popupWin.document.write('<html><head><title>' + viewOrDocOb.name + '</title><style type=\"text/css\">' + css + '</style></head><body style=\"overflow: auto\">' + result.cover + result.toc + result.tot + result.tof + result.toe + result.contents + '</body></html>');\n                    popupWin.document.close();\n                    $timeout(function() {\n                        popupWin.print();\n                    }, 1000, false);\n                } else {\n                    result.tof = choice[1] ? result.tof + result.toe : '';\n                    result.tot = choice[1] ? result.tot : '';\n                    var htmlArr = ['<html><head><title>' + viewOrDocOb.name + '</title><style type=\"text/css\">', css, '</style></head><body>', result.cover];\n                    if (result.toc != '') htmlArr.push(result.toc);\n                    if (result.tot != '') htmlArr.push(result.tot);\n                    if (result.tof != '') htmlArr.push(result.tof);\n                    htmlArr.push(result.contents, '</body></html>');\n                    var htmlString = htmlArr.join('');\n                    UtilsService.exportHtmlAs(mode, {htmlString: htmlString, name: viewOrDocOb.name, projectId: viewOrDocOb._projectId, refId: viewOrDocOb._refId, css: css})\n                        .then(function(result) {\n                            deferred.resolve(result);\n                        }, function(reason){\n                            deferred.reject(reason);\n                        });\n                }\n            } else {\n                $rootScope.ve_fullDocMode = true;\n                $rootScope.ve_bbApi.setToggleState('tree-full-document', true);\n                $state.go('project.ref.document.full', {search: undefined});\n            }\n        });\n        return deferred.promise;\n    };\n\n\n    /**\n     * @ngdoc method\n     * @name mmsApp.MmsAppUtils#printOrGenerate\n     * @methodOf mmsApp.MmsAppUtils\n     *\n     * @description\n     * Called by printModal to handle cleanup and building content needed for \n     * print, PDF or word export.\n     * Cleansup html i.e. removes no-print, ng-hide\n     *\n     * @param {Object} viewOrDocOb current document or view object\n     * @param {Number} mode 1 = print, 2 = word, 3 = pdf\n     * @param {Boolean} isDoc viewOrDocOb is view or doc\n     * @param {Boolean} genTotf whether to gen table of figures and tables (option from the modal form)\n     * @param {Boolean} htmlTotf include DocGen generated tables and rapid tables (option from the modal form)\n     * @returns {Object} Returns object with content needed for print/word export/PDF generation\n     * <pre>\n     * {\n     *      cover: cover page html,\n     *      contents: main content html,\n     *      toc: table of contents html,\n     *      tof: table of figures html,\n     *      tot: table of tables html,\n     *      toe: table of equations html\n     * }\n     * </pre>\n     */\n    var printOrGenerate = function(viewOrDocOb, mode, isDoc, genTotf, htmlTotf) {\n        var printContents = '';\n        var printElementCopy = angular.element(\"#print-div\");\n\n        // Conversion of canvas to its dataUrl must be done before \"clone\", because \"clone\" doesn't preserve\n        // canvas' content\n        var mapping = storeTomsawyerDiagramAsImg(printElementCopy);\n        printElementCopy = printElementCopy.clone();\n        replaceMmsTsDiagramWithImg(printElementCopy, mapping);\n\n        var hostname = $location.host();\n        var port = $location.port();\n        var protocol = $location.protocol();\n        var absurl = $location.absUrl();\n        var prefix = protocol + '://' + hostname + ((port == 80 || port == 443) ? '' : (':' + port));\n        var mmsIndex = absurl.indexOf('mms.html');\n        var toc = UtilsService.makeHtmlTOC($rootScope.ve_treeApi.get_rows());\n\n        // Conver to proper links for word/pdf\n        UtilsService.convertViewLinks(printElementCopy);\n\n        // Get correct table/image numbering based on doc hierarchy\n        var tableAndFigTOC = UtilsService.makeTablesAndFiguresTOC($rootScope.ve_treeApi.get_rows(), printElementCopy, false, htmlTotf);\n        var tof = tableAndFigTOC.figures;\n        var tot = tableAndFigTOC.tables;\n        var toe = tableAndFigTOC.equations;\n\n        // Customize TOC based on user choice\n        if (!isDoc) {\n            toc = tof = tot = toe = '';\n        }\n        if (!genTotf) {\n            tof = tot = toe = '';\n        }\n        angular.element(printElementCopy).find(\"a\").attr('href', function(index, old) {\n            if (!old)\n                return old;\n            if (old.indexOf('/') === 0)\n                return prefix + old;\n            if (old.indexOf('../../') === 0)\n                return prefix + old.substring(5);\n            if (old.indexOf('../') === 0)\n                return prefix + '/alfresco' + old.substring(2);\n            if (old.indexOf('mms.html') === 0)\n                return absurl.substring(0, mmsIndex) + old;\n            return old;\n        });\n\n        // Remove comments, table features, and all elements with classes: mms-error, no-print, ng-hide\n        printElementCopy.find('mms-transclude-com').remove();\n        printElementCopy.find('style').remove(); //prevent user inserted styles from interfering\n        printElementCopy.find('div.tableSearch').remove();\n        //printElementCopy.find('.mms-error').html('error');\n        printElementCopy.find('.no-print').remove();\n        printElementCopy.find('.ng-hide').remove();\n\n        // word doesn't support svg only png.\n        if (mode === 2) {\n            printElementCopy.find('.mms-svg').remove();\n        } else {\n            printElementCopy.find('.mms-png').remove();\n        }\n        // Remove all empty paragraphs\n        printElementCopy.find('p:empty').remove();\n        printElementCopy.find('p').each(function() {\n            var $this = $(this);\n            if ($this.html().replace(/\\s|&nbsp;/g, '').length === 0) {\n                $this.remove();\n            }\n        });\n        printElementCopy.find('[width]').not('img').not('.ve-fixed-width').removeAttr('width');\n        printElementCopy.find('[style]').not('hr').each(function() {\n            this.style.removeProperty('font-size');\n            this.style.removeProperty('width');\n            this.style.removeProperty('min-width');\n            this.style.removeProperty('height');\n            //remove frozen headers and column\n            this.style.removeProperty('transform');\n            this.style.removeProperty('will-change');\n        });\n        printElementCopy.find('.math').remove(); //this won't work in chrome for popups since chrome can't display mathml\n        printElementCopy.find('script').remove();\n        //printElementCopy.find('.MJX_Assistive_MathML').remove(); //pdf generation need mathml version\n\n        // Get doc cover page by doc ID\n        var cover = '';\n        if (isDoc) {\n            cover = printElementCopy.find(\"mms-view[mms-element-id='\" + viewOrDocOb.id + \"']\");\n            cover.remove();\n            // Add class to style cover page\n            cover.addClass('ve-cover-page');\n            cover = cover[0].outerHTML;\n        }\n        printContents = printElementCopy[0].outerHTML;\n\n        return { cover: cover, contents: printContents, toc: toc, tof: tof, tot: tot, toe: toe };\n    };\n\n    var handleChildViews = function(v, aggr, propId, projectId, refId, curItemFunc, childrenFunc, seen) {\n        var seenViews = seen;\n        if (!seenViews)\n            seenViews = {};\n        var deferred = $q.defer();\n        var curItem = curItemFunc(v, aggr, propId);\n        seenViews[v.id] = v;\n        var childIds = [];\n        var childAggrs = [];\n        var childPropIds = [];\n        if (!v._childViews || v._childViews.length === 0 || aggr === 'none') {\n            if (angular.isObject(curItem) && curItem.loading) {\n                curItem.loading = false;\n            }\n            deferred.resolve(curItem);\n            return deferred.promise;\n        }\n        for (var i = 0; i < v._childViews.length; i++) {\n            if (seenViews[v._childViews[i].id])\n                continue;\n            childIds.push(v._childViews[i].id);\n            childAggrs.push(v._childViews[i].aggregation);\n            childPropIds.push(v._childViews[i].propertyId);\n        }\n        ElementService.getElements({\n            elementIds: childIds,\n            projectId: projectId,\n            refId: refId\n        }, 2).then(function(childViews) {\n            var mapping = {};\n            for (var i = 0; i < childViews.length; i++) {\n                mapping[childViews[i].id] = childViews[i];\n            }\n            var childPromises = [];\n            var childNodes = [];\n            var processedChildViews = [];\n            for (i = 0; i < childIds.length; i++) {\n                var child = mapping[childIds[i]];\n                if (child && UtilsService.isView(child)) { //what if not found??\n                    childPromises.push(handleChildViews(child, childAggrs[i], childPropIds[i], projectId, refId, curItemFunc, childrenFunc, seenViews));\n                    childNodes.push(curItemFunc(child, childAggrs[i], childPropIds[i]));\n                    processedChildViews.push({id: child.id, aggregation: childAggrs[i], propertyId: childPropIds[i]});\n                }\n            }\n            v._childViews = processedChildViews;\n            childrenFunc(curItem, childNodes);\n            $q.all(childPromises).then(function(childNodes) {\n                deferred.resolve(curItem);\n            }, function(reason) {\n                deferred.reject(reason);\n            });\n        }, function(reason) {\n            deferred.reject(reason);\n        });\n        return deferred.promise;\n    };\n\n    var refreshNumbering = function(tree, centerElement) {\n        UtilsService.makeTablesAndFiguresTOC(tree, centerElement, true, false);\n    };\n\n    /** Store all tomsawyer diagram(canvas) as an img element **/\n    function storeTomsawyerDiagramAsImg(originalDom) {\n        var mapping = {};\n        originalDom.find('mms-ts-diagram').each(function(index){\n            var tsDom = $(this);\n            var canvas = tsDom.find('canvas')[0];\n            if(canvas) {\n                var imgElement = $('<img>');\n                imgElement.attr({'src': canvas.toDataURL(), 'width': '100%' });\n                mapping[index] = imgElement;\n            }\n        });\n        return mapping;\n    }\n\n    /** Replace all mms-ts-diagram elements with their corresponding img elements **/\n    function replaceMmsTsDiagramWithImg(element, mapping) {\n        element.find('mms-ts-diagram').each(function(index) {\n           var imgDom = mapping[index];\n           $(this).replaceWith(imgDom);\n        });\n    }\n\n    return {\n        printModal: printModal,\n        tableToCsv: tableToCsv,\n        handleChildViews: handleChildViews,\n        refreshNumbering: refreshNumbering\n    };\n}\n\n","'use strict';\n\nangular.module('mmsApp')\n.directive('mmsCurrentTag',['$rootScope', mmsCurrentTag]);\n\n/**\n* @ngdoc directive\n* @name mmsApp.directive:mmsCurrentTag\n*\n* @restrict E\n*\n* @description\n* Displays the current tag in which the view resides\n*\n*/\nfunction mmsCurrentTag($rootScope){\n\n  var mmsCurrentTagLink = function(scope, element, attrs){\n    var tag = $rootScope.mms_tag;\n    if (!tag || tag.name === 'latest') //if undefined (latest may be undefined)\n      scope.tag = 'Latest';\n    else {\n      scope.tag = tag.name;\n    }\n  };\n\n  return {\n    restrict: 'E',\n    scope: {},\n    template: '{{ tag }}',\n    link: mmsCurrentTagLink\n  };\n}\n","'use strict';\n\nangular.module('mmsApp')\n    .directive('runXlr', ['$http', '$uibModal', '$window', 'growl', 'ApplicationService', runXlr]);\n\nfunction runXlr($http, $uibModal, $window, growl, ApplicationService) {\n    return {\n        template: '<button class=\"btn btn-primary\" ng-click=\"runXLR()\">{{xlrTaskName}}</button>',\n        scope: {\n            templateId: '@',\n            xlrTaskName: '@',\n            xlrReleaseName: '@'\n        },\n        controller: ['$scope', runXlrCtrl],\n        link: runXlrLink\n    };\n    function runXlrLink(scope, element, attrs, ctrls) {}\n\n    function runXlrCtrl($scope) {\n        var modalOpen = false;\n        $scope.xlrTaskName = $scope.xlrTaskName ? $scope.xlrTaskName : 'Sync FN to JPL Network';\n        $scope.runXLR = runXLR;\n        function runXLR() {\n\n            modalOpen = true;\n            $uibModal.open({\n                template: '<div class=\"modal-header\"><h4>Please login to {{xlrTaskName}}.</h4></div><div class=\"modal-body\"><form name=\"loginForm\" ng-submit=\"login(credentials)\">' + \n                                '<input type=\"text\" class=\"form-control\" ng-model=\"credentials.username\" placeholder=\"Username\" style=\"margin-bottom: 1.5em;\" autofocus>' + \n                                '<input type=\"password\" class=\"form-control\" ng-model=\"credentials.password\" placeholder=\"Password\" style=\"margin-bottom: 1.5em;\">' + \n                                '<button class=\"btn btn-block btn-primary\" type=\"submit\">LOG IN <span ng-if=\"spin\" ><i class=\"fa fa-spin fa-spinner\"></i>' + \n                            '</span></button></form></div>',\n                scope: $scope,\n                backdrop: 'static',\n                controller: ['$scope', '$uibModalInstance', function ($scope, $uibModalInstance) {\n                    $scope.credentials = {\n                        username: '',\n                        password: ''\n                    };\n                    $scope.spin = false;\n\n                    function make_base_auth(user, password) {\n                        var tok = user + ':' + password;\n                        var hash = $window.btoa(tok);\n                        return \"Basic \" + hash;\n                    }\n                    $scope.login = function (credentials) {\n                        $scope.spin = true;\n                        var baseAuth = make_base_auth(credentials.username, credentials.password);\n                        var email = credentials.username + '@jpl.nasa.gov';\n                        var postBody = {\n                            \"releaseTitle\": $scope.xlrReleaseName ? $scope.xlrReleaseName : \"CAE Portal Sync\",\n                            \"releaseVariables\": {\n                                \"contentEditor\": credentials.username,\n                                \"editorEmail\": email\n                            },\n                            \"autoStart\": true\n                        };\n\n                        var link = \"/xlrapi/v1/templates/Applications/\" + $scope.templateId + \"/create\";\n                        var config = {\n                            method: 'POST',\n                            url: link,\n                            headers: {\n                                'Authorization': baseAuth,\n                                \"Content-Type\": \"application/json\",\n                                \"cache-control\": \"no-cache\",\n                            },\n                            \"data\": postBody,\n                            \"withCredentials\": true,\n                            \"async\": true,\n                            \"crossDomain\": true,\n                            \"processData\": false\n                        };\n                        $http(config).then(function() {\n                            growl.success($scope.xlrTaskName + ' is running. You will receive a completion email');\n                        }, function(error){\n                            growl.error($scope.xlrTaskName + ' has failed.');\n                        }).finally(function() {\n                            $scope.spin = false;\n                            modalOpen = false;\n                            $uibModalInstance.dismiss();\n                        });\n                    };\n                }],\n                size: 'md'\n            }).result.finally(function(){\n                modalOpen = false;\n            });\n\n        }\n\n    }\n}\n","'use strict';\n\nangular.module('mmsApp')\n.directive('veFooter', ['$templateCache', veFooter]);\n\n/**\n* @ngdoc directive\n* @name mmsApp.directive:veFooter\n*\n* @restrict E\n*\n* @description\n* Displays VE footer\n* Customize by updating partials/mms/veFooter.html\n*\n*/\nfunction veFooter($templateCache) {\n    var template = $templateCache.get('partials/mms/veFooter.html');\n\n    return {\n        restrict: 'E',\n        template: template,\n        transclude: true\n    };\n}","'use strict';\n\nangular.module('mmsApp')\n.directive('veMenu', ['CacheService','$state','$templateCache','$sce', '$timeout', 'UtilsService',veMenu]);\n\n/**\n * @ngdoc directive\n * @name mmsApp.directive:veMenu\n *\n * @requires mms.CacheService\n * @requires $state\n * @requires $templateCache\n * @requires $sce\n *\n * @restrict E\n *\n * @description\n * veMenu is responsible for gathering all breadcrumbs for current view and\n * displaying breadcrumbs accordingly. Breadcrumb list is truncated to\n * to fit window width.\n * veMenu is also repsonsible for gathering and displaying all projects, branches\n * and tags for selected view.\n *\n */\nfunction veMenu(CacheService, $state, $templateCache, $sce, $timeout, UtilsService) {\n    var template = $templateCache.get('partials/mms/veMenu.html');\n\n    var veMenuLink = function(scope, element, attrs) {\n        scope.getHrefForProject = getHrefForProject;\n        scope.getHrefForBranch = getHrefForBranch;\n        scope.getHrefForTag = getHrefForTag;\n        scope.htmlTooltip = $sce.trustAsHtml('Branch temporarily unavailable during duplication.');\n        scope.currentProject = scope.project.name;\n\n        if (scope.ref) {\n            scope.currentRef = scope.ref;\n            if (scope.ref.type === 'Branch') {\n                scope.currentBranch = scope.branch.name;\n            } else if (scope.ref.type === 'Tag') {\n                scope.currentTag = scope.tag.name;\n            }\n        }\n\n        scope.updateProject = function(project) {\n            if (project) {\n                $state.go('project.ref', {projectId: project.id, refId: 'master', search: undefined}, {reload: true});\n            }\n        };\n        scope.updateBranch = function(branch) {\n            if (branch.status != 'creating') {\n                $state.go($state.current.name, {projectId: scope.project.id, refId: branch.id, search: undefined}, {reload: true});\n            }\n        };\n        scope.updateTag = function(tag) {\n            if (tag.status != 'creating') {\n                $state.go($state.current.name, {projectId: scope.project.id, refId: tag.id, search: undefined}, {reload: true});\n            }\n        };\n        scope.refsView = function() {\n            $state.go('project', {projectId: scope.project.id}, {reload: true});\n        };\n        scope.isRefsView = function() {\n            if ( $state.includes('project') && !($state.includes('project.ref')) ) {\n                return true;\n            } else {\n                return false;\n            }\n        };\n        scope.$on(\"stomp.branchCreated\", function(event, createdRef, projectId) {\n            var cacheKey = ['refs', scope.project.id];\n            if (CacheService.exists(cacheKey) && scope.project.id === projectId) {\n                var refObs = CacheService.get(cacheKey);\n                var tag = [];\n                for (var i = 0; i < refObs.length; i++) {\n                    if (refObs[i].type === \"Tag\")\n                        tag.push(refObs[i]);\n                }\n                scope.tags = tag;\n                var branches = [];\n                for (var j = 0; j < refObs.length; j++) {\n                    if (refObs[j].type === \"Branch\")\n                        branches.push(refObs[j]);\n                }\n                scope.branches = branches;\n            }\n        });\n\n        var bcrumbs = [];\n        var child, parentId;\n        var groups = scope.groups;\n        var groupsMap = {};\n        if (scope.group !== undefined) {\n            for (var i = 0; i < groups.length; i++) {\n                groupsMap[groups[i].id] = {id: groups[i].id, name: groups[i].name, parentId: groups[i]._parentId};\n            }\n            child = scope.group;\n        }\n        if (scope.document !== undefined) {\n            child = scope.document;\n        }\n        if (child) {\n            if (child.type === 'Package') {//child.hasOwnProperty('_id')) {\n                bcrumbs.push({name: child.name, id: child.id, type: \"group\", alfLink: child._link, link: \"project.ref.preview({documentId: 'site_' + breadcrumb.id + '_cover', search: undefined})\"});\n                if(child._parentId) {\n                    parentId = child._parentId;\n                }\n            } else {\n                bcrumbs.push({name: child.name, id: child.id, type: \"doc\", link: \"project.ref.document({documentId: breadcrumb.id, search: undefined})\"});\n                if(child._groupId) {\n                    parentId = child._groupId;\n                }\n            }\n            if (parentId) {\n                while(groupsMap[parentId] !== undefined) {\n                    var id = groupsMap[parentId].id;\n                    bcrumbs.push({name: groupsMap[id].name, id: id, type: \"group\", link: \"project.ref.preview({documentId: 'site_' + breadcrumb.id + '_cover', search: undefined})\"});\n                    parentId = groupsMap[id].parentId;\n                }\n            }\n            scope.breadcrumbs = bcrumbs.reverse();\n            $timeout(function() {\n                var eltChildren = element.children().children();\n                var eltWidth = element.parent().width() - eltChildren[0].scrollWidth - eltChildren[2].scrollWidth;\n                var crumbcount = scope.breadcrumbs.length;\n                var liWidth = (eltWidth * 0.85)/crumbcount;\n                scope.truncateStyle = {'max-width': liWidth, 'white-space': 'nowrap', 'overflow': 'hidden', 'text-overflow': 'ellipsis', 'display': 'inline-block'};\n            });\n        }\n\n        function getHrefForProject(project) {\n            var refId = project._refId || 'master';\n            return UtilsService.PROJECT_URL_PREFIX + project.id + '/' + refId;\n        }\n\n        function getHrefForBranch(branch) {\n            var res = UtilsService.PROJECT_URL_PREFIX + scope.project.id + '/' + branch.id;\n            if (scope.document) {\n                res += '/documents/' + scope.document.id;\n            }\n            if (scope.view) {\n                res += '/views/' + scope.view.id;\n            }\n            return res;\n        }\n\n        function getHrefForTag(tag) {\n            return getHrefForBranch(tag);\n        }\n    };\n\n    return {\n        restrict: 'E',\n        template: template,\n        scope: {\n            org: '<mmsOrg',\n            project: '<mmsProject',\n            projects: '<mmsProjects',\n            group: '<mmsGroup',\n            groups: '<mmsGroups',\n            branch: '<mmsBranch',\n            ref: '<mmsRef',\n            refs: '<mmsRefs',\n            branches: '<mmsBranches',\n            tag: '<mmsTag',\n            tags: '<mmsTags',\n            document: '<mmsDocument',\n            view: '<mmsView'\n        },\n        link: veMenuLink\n    };\n}\n","'use strict';\n\nangular.module('mmsApp')\n.directive('veNav', ['$templateCache', '$rootScope', '$state', 'hotkeys', 'growl', '$location', '$uibModal', 'ApplicationService','AuthService', 'ProjectService', veNav]);\n\n/**\n * @ngdoc directive\n * @name mms.directives.directive:veNav\n *\n * @requires $templateCache\n *\n * @restrict E\n *\n * @description\n * A navbar that include navigation to other Organizations/Project along with helpful\n * links for the application. i.e. version, shortcut keys, about...\n * \n * The navbar is mobile friendly.\n * \n */\nfunction veNav($templateCache, $rootScope, $state, hotkeys, growl, $location, $uibModal, ApplicationService, AuthService, ProjectService) {\n    var template = $templateCache.get('partials/mms/veNav.html');\n\n    var veNavLink = function(scope, element, attrs) {\n        ProjectService.getOrgs().then(function(orgs){\n            scope.orgs = orgs;\n        });\n        scope.isNavCollapsed = true;\n        scope.updateOrg = function() {\n            $uibModal.open({\n                templateUrl: 'partials/mms/selectModal.html',\n                windowClass: 've-dropdown-short-modal',\n                scope: scope,\n                controller: ['$scope', '$uibModalInstance', function($scope, $uibModalInstance) {\n\n                    $scope.selectedOrg = $scope.org.name;\n                    $scope.selectedProject = $scope.project.name;\n\n                    var orgId = $scope.org.id;\n                    var projectId = $scope.project.id;\n\n                    $scope.selectOrg = function(org) { \n                        if(org) {\n                            orgId = org.id;\n                            $scope.selectedOrg = org.name;\n                            $scope.selectedProject = \"\";\n                            ProjectService.getProjects(orgId).then(function(data) {\n                                $scope.projects = data;\n                                if (data.length > 0) {\n                                    $scope.selectProject(data[0]);\n                                } else {\n                                    //no projects\n                                }\n                            });\n                        }\n                    }; \n                    $scope.selectProject = function(project) {\n                        if(project) {\n                            projectId = project.id;\n                            $scope.selectedProject = project.name;\n                        }\n                    };\n                    $scope.spin = false;\n                    $scope.continue = function() {\n                        if(orgId && projectId) {\n                            // was the same project selected? cancel...\n                            if ($scope.$parent.project.orgId === orgId &&\n                                $scope.$parent.project.id === projectId) {\n                                $scope.cancel();\n                            }\n                            else {\n                                $scope.spin = true;\n                                $state.go('project.ref', {orgId: orgId, projectId: projectId, refId: 'master', search: undefined}).then(function(data) {\n                                }, function(reject) {\n                                    $scope.spin = false;\n                                });\n                            }\n                        }\n                    };\n                    $scope.cancel = function() {\n                        $uibModalInstance.dismiss();\n                    };\n                }]\n            });\n        };\n        scope.toggleHelp = function() {\n            hotkeys.toggleCheatSheet();\n        };\n        scope.toggleAbout = function() {\n            scope.veV = '3.6.1';\n            scope.mmsV = 'Loading...';\n            ApplicationService.getMmsVersion().then(function(data) {\n                scope.mmsV = data;\n            }, function(reason) {\n                scope.mmsV = \"Could not retrieve due to failure: \" + reason.message;\n            });\n            $uibModal.open({\n                templateUrl: 'partials/mms/about.html',\n                scope: scope,\n                controller: ['$scope', '$uibModalInstance', function($scope, $uibModalInstance) {\n                    $scope.cancel = function() {\n                        $uibModalInstance.dismiss();\n                    };\n                }]\n            });\n        };\n        scope.logout = function() {\n            AuthService.logout().then(function() {\n                $state.go('login');\n            }, function() {\n                growl.error('You were not logged out');\n            });\n        };\n\n        scope.searchClass = \"\";\n        scope.search = function(searchText) {\n            if ($state.includes('project.ref.document.order')) {\n                growl.warning(\"Please finish reorder action first.\");\n                return;\n            // } else if ($state.includes('project.diff')) {\n            //     growl.warning(\"Please finish diff action first.\");\n            //     return;\n            } else {\n                if ($state.params.search === searchText)\n                    return;\n                scope.searchClass = \"fa fa-spin fa-spinner\";\n                $state.go($state.current.name, {search: searchText});\n            }\n        };\n        scope.stagingView = function(){ //changing to something \"opencae\"?\n            var hostName = $location.host();\n            var address = \"https://uatlinkhere\";\n            if (hostName !== 'localhost' && hostName.split('.')[0].substr(-3) !== 'uat')\n                address = 'https://' + hostName.split('.')[0] + '-uat.jpl.nasa.gov';\n            window.open(address ,'_blank');\n        };\n        AuthService.checkLogin().then(function(data) {\n            scope.username = data;\n        });\n        \n    };\n\n    return {\n        restrict: 'E',\n        template: template,\n        scope: {\n            title: '<mmsTitle', //page title - used in mobile view only\n            org: '<mmsOrg',\n            //orgs: '<mmsOrgs',\n            project: '<mmsProject',\n            projects: '<mmsProjects',\n            ref: '<mmsRef',\n            branch: '<mmsBranch',\n            branches: '<mmsBranches',\n            tag: '<mmsTag',\n            tags: '<mmsTags',\n            search: '<mmsSearch'\n        },\n        link: veNavLink\n    };\n}\n","angular.module(\"app.tpls\", [\"partials/mms/about.html\", \"partials/mms/add-pe.html\", \"partials/mms/cancelConfirm.html\", \"partials/mms/cancelModal.html\", \"partials/mms/confirmDelete.html\", \"partials/mms/confirmRemove.html\", \"partials/mms/docCover.html\", \"partials/mms/full-doc.html\", \"partials/mms/login.html\", \"partials/mms/manage-refs.html\", \"partials/mms/new-branch.html\", \"partials/mms/new-doc-or-group.html\", \"partials/mms/new-tag.html\", \"partials/mms/new-view.html\", \"partials/mms/pane-center.html\", \"partials/mms/pane-left.html\", \"partials/mms/pane-right.html\", \"partials/mms/printConfirm.html\", \"partials/mms/redirect.html\", \"partials/mms/reorder-groups.html\", \"partials/mms/reorder-views.html\", \"partials/mms/select.html\", \"partials/mms/selectModal.html\", \"partials/mms/tableExport.html\", \"partials/mms/veFooter.html\", \"partials/mms/veMenu.html\", \"partials/mms/veNav.html\"]);\n\nangular.module(\"partials/mms/about.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"partials/mms/about.html\",\n    \"<div class=\\\"modal-header\\\">\\n\" +\n    \"    <h4>About</h4>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-body\\\">\\n\" +\n    \"    <p>MMS Version : <b>{{mmsV}}</b></p>\\n\" +\n    \"    <p>View Editor Version : <b>{{veV}}</b></p>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-footer\\\">\\n\" +\n    \"    <button class=\\\"btn btn-default\\\" ng-click=\\\"cancel()\\\">Close</button>\\n\" +\n    \"</div>\\n\" +\n    \"\");\n}]);\n\nangular.module(\"partials/mms/add-pe.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"partials/mms/add-pe.html\",\n    \"<!-- TODO: This is almost the same as new-view.html.  Should be combined if possible -->\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-header\\\">\\n\" +\n    \"    <h4 class=\\\"pe-type-{{presentationElemType}}\\\">Add {{presentationElemType | lowercase}}</h4>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-body\\\">\\n\" +\n    \"    <div class=\\\"ve-light-tabs modal-top-tabs\\\">\\n\" +\n    \"        <ul class=\\\"nav nav-tabs\\\" ng-show=\\\"presentationElemType != 'Comment'\\\">\\n\" +\n    \"            <li class=\\\"uib-tab nav-item tab-item\\\" ng-class=\\\"{'active': createForm}\\\">\\n\" +\n    \"                <a class=\\\"nav-link\\\" ng-click=\\\"createForm = true\\\"><i class=\\\"fa fa-plus\\\"></i>Create New</a>\\n\" +\n    \"            </li>\\n\" +\n    \"            <li class=\\\"uib-tab nav-item tab-item\\\" ng-class=\\\"{'active': !createForm}\\\">\\n\" +\n    \"                <a class=\\\"nav-link\\\" ng-click=\\\"createForm = false\\\"><i class=\\\"fa fa-search\\\"></i>Search for existing</a>\\n\" +\n    \"            </li>\\n\" +\n    \"        </ul>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"    <div ng-show=\\\"createForm\\\">\\n\" +\n    \"        <div class=\\\"form-group\\\">\\n\" +\n    \"            <label>Name (optional):</label>\\n\" +\n    \"            <input class=\\\"form-control\\\" ng-model=\\\"newPe.name\\\" ng-keyup=\\\"$event.keyCode == 13 ? ok() : null\\\" type=\\\"text\\\" placeholder=\\\"Type a name for your {{presentationElemType}} here\\\"\\n\" +\n    \"                autofocus>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"    <div ng-show=\\\"!createForm\\\">\\n\" +\n    \"        <p>Begin by searching for the {{presentationElemType | lowercase}}, then click its name or documentation to add the {{presentationElemType | lowercase}}.</p>\\n\" +\n    \"        <mms-search mms-options=\\\"searchOptions\\\" mms-project-id=\\\"{{viewOrSectionOb._projectId}}\\\" mms-ref-id=\\\"{{viewOrSectionOb._refId}}\\\"></mms-search>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-footer\\\">\\n\" +\n    \"    <button class=\\\"btn btn-primary\\\" ng-show=\\\"createForm\\\" ng-click=\\\"ok()\\\">Create\\n\" +\n    \"        <i ng-show=\\\"oking\\\" class=\\\"fa fa-spin fa-spinner\\\"></i>\\n\" +\n    \"    </button>\\n\" +\n    \"    <button class=\\\"btn btn-default\\\" ng-click=\\\"cancel()\\\">Cancel</button>\\n\" +\n    \"</div>\");\n}]);\n\nangular.module(\"partials/mms/cancelConfirm.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"partials/mms/cancelConfirm.html\",\n    \"<div class=\\\"modal-header\\\">\\n\" +\n    \"    <h4>Discard Modifications</h4>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-body\\\">\\n\" +\n    \"    <p>\\n\" +\n    \"      There are unsaved modifications to this element, which may include html beautification.<br/>\\n\" +\n    \"      Are you sure you want to discard them? \\n\" +\n    \"    </p>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-footer\\\">\\n\" +\n    \"    <button class=\\\"btn btn-warning \\\" ng-click=\\\"ok()\\\">Discard</button>\\n\" +\n    \"    <button class=\\\"btn btn-default\\\" ng-click=\\\"cancel()\\\">Cancel</button>\\n\" +\n    \"</div>\\n\" +\n    \"\");\n}]);\n\nangular.module(\"partials/mms/cancelModal.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"partials/mms/cancelModal.html\",\n    \"<div class=\\\"assistModal\\\">\\n\" +\n    \"    <div class=\\\"modal-body\\\">\\n\" +\n    \"        <h3>Are you sure you want to exit this page?</h3>\\n\" +\n    \"        <br>\\n\" +\n    \"        <div>\\n\" +\n    \"            Your changes will not be saved if you leave this page, but you may come back to this page later using the\\n\" +\n    \"            same link.\\n\" +\n    \"        </div>\\n\" +\n    \"        <br>\\n\" +\n    \"        <span style=\\\"text-align: right; width: 100%; display: inline-block;\\\">\\n\" +\n    \"            <button class=\\\"btn btn-warning\\\" ng-click=\\\"exit()\\\">Leave page</button>\\n\" +\n    \"            <button class=\\\"btn btn-default\\\" ng-click=\\\"close()\\\">Stay on page</button>\\n\" +\n    \"        </span>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\");\n}]);\n\nangular.module(\"partials/mms/confirmDelete.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"partials/mms/confirmDelete.html\",\n    \"<div class=\\\"modal-header\\\">\\n\" +\n    \"    <h4>Confirm Delete</h4>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-body\\\">\\n\" +\n    \"    <p>Are you sure you want to delete {{type}} <b>&ldquo;{{name}}&rdquo;</b>?</p>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-footer\\\">\\n\" +\n    \"    <button class=\\\"btn btn-warning\\\" ng-click=\\\"ok()\\\">Delete <i ng-show=\\\"oking\\\" class=\\\"fa fa-spin fa-spinner\\\"></i></button>\\n\" +\n    \"    <button class=\\\"btn btn-default\\\" ng-click=\\\"cancel()\\\">Cancel</button>\\n\" +\n    \"</div>\");\n}]);\n\nangular.module(\"partials/mms/confirmRemove.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"partials/mms/confirmRemove.html\",\n    \"<div class=\\\"modal-header\\\">\\n\" +\n    \"    <h4>Confirm Remove</h4>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-body\\\">\\n\" +\n    \"    <p>Are you sure you want to remove {{type}} <b>&ldquo;{{name}}&rdquo;</b>?</p>\\n\" +\n    \"    <p ng-if=\\\"type != 'Document' && type != 'group'\\\">This will remove <b>&ldquo;{{name}}&rdquo;</b> from the hierarchy, but you can still access it in search.</p>\\n\" +\n    \"    <p ng-if=\\\"type === 'Document' || type === 'group'\\\">This will remove <b>&ldquo;{{name}}&rdquo;</b> from the project navigation, but you can still access it in search.</p>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-footer\\\">\\n\" +\n    \"    <button class=\\\"btn btn-warning\\\" ng-click=\\\"ok()\\\">Remove <i ng-show=\\\"oking\\\" class=\\\"fa fa-spin fa-spinner\\\"></i></button>\\n\" +\n    \"    <button class=\\\"btn btn-default\\\" ng-click=\\\"cancel()\\\">Cancel</button>\\n\" +\n    \"</div>\");\n}]);\n\nangular.module(\"partials/mms/docCover.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"partials/mms/docCover.html\",\n    \"<div>\\n\" +\n    \"    <div style=\\\"page-break-after:always\\\">\\n\" +\n    \"        <div style=\\\"text-align:center; font-size:32px\\\">{{meta.project}}</div>\\n\" +\n    \"        <div style=\\\"text-align:center; font-size:30px\\\">{{meta.title}}</div>\\n\" +\n    \"        <div style=\\\"text-align:center; font-size:12px\\\"> {{meta.version}} {{tag.name}}</div>\\n\" +\n    \"        <br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>\\n\" +\n    \"\\n\" +\n    \"        <div> Paper copies of this document may not be current and should not be relied on for official purposes.</div>\\n\" +\n    \"        <div> {{meta.titlelegal}}</div>\\n\" +\n    \"        <div> {{time | date:'M/d/yy h:mm a'}}</div>\\n\" +\n    \"        <div> {{meta.dnumber}}</div>\\n\" +\n    \"        <br/><br/>\\n\" +\n    \"        <div ng-if=\\\"meta.instlogo\\\"><img ng-src=\\\"{{meta.instlogo}}\\\"></div>\\n\" +\n    \"        <div> {{meta.inst1}}</div>\\n\" +\n    \"        <div> {{meta.inst2}}</div>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"\\n\" +\n    \"    <div style=\\\"page-break-after:always\\\">\\n\" +\n    \"        <div style=\\\"font-size:32px\\\" ng-if=\\\"meta.project\\\">{{meta.project}}</div>\\n\" +\n    \"        <div style=\\\"font-size:30px\\\">{{meta.title}}</div>\\n\" +\n    \"        <div style=\\\"font-size:12px\\\"><span ng-if=\\\"meta.version\\\">{{meta.version}}</span> {{tag.name}}</div>\\n\" +\n    \"        \\n\" +\n    \"        <div ng-if=\\\"meta.authors.length > 0\\\">\\n\" +\n    \"            <br/><br/>\\n\" +\n    \"            <div>PREPARED BY:</div>\\n\" +\n    \"            <div ng-repeat=\\\"author in meta.authors\\\">\\n\" +\n    \"                <br/><br/>\\n\" +\n    \"                <div><span>_____________________________________</span> <span class=\\\"pull-right\\\">________________</span></div>\\n\" +\n    \"                <div><span>{{author.firstname}} {{author.lastname}}</span><span class=\\\"pull-right\\\">Date</span></div>\\n\" +\n    \"                <div>{{author.title}}, {{author.orgname}} ({{author.orgnum}})</div>\\n\" +\n    \"            </div>\\n\" +\n    \"        </div>\\n\" +\n    \"\\n\" +\n    \"        <div ng-if=\\\"meta.approvers.length > 0\\\"> \\n\" +\n    \"            <br/><br/>\\n\" +\n    \"            <div>APPROVED BY:</div>\\n\" +\n    \"            <div ng-repeat=\\\"author in meta.approvers\\\">\\n\" +\n    \"                <br/><br/>\\n\" +\n    \"                <div><span>_____________________________________</span> <span class=\\\"pull-right\\\">________________</span></div>\\n\" +\n    \"                <div><span>{{author.firstname}} {{author.lastname}}</span><span class=\\\"pull-right\\\">Date</span></div>\\n\" +\n    \"                <div>{{author.title}}, {{author.orgname}} ({{author.orgnum}})</div>\\n\" +\n    \"            </div>\\n\" +\n    \"        </div>\\n\" +\n    \"\\n\" +\n    \"        <div ng-if=\\\"meta.concurrences.length > 0\\\">\\n\" +\n    \"            <br/><br/>\\n\" +\n    \"            <div>CONCURRED BY:</div>\\n\" +\n    \"            <div ng-repeat=\\\"author in meta.concurrences\\\">\\n\" +\n    \"                <br/><br/>\\n\" +\n    \"                <div><span>_____________________________________</span> <span class=\\\"pull-right\\\">________________</span></div>\\n\" +\n    \"                <div><span>{{author.firstname}} {{author.lastname}}</span><span class=\\\"pull-right\\\">Date</span></div>\\n\" +\n    \"                <div>{{author.title}}, {{author.orgname}} ({{author.orgnum}})</div>\\n\" +\n    \"            </div>\\n\" +\n    \"        </div>\\n\" +\n    \"\\n\" +\n    \"        <br/><br/>\\n\" +\n    \"        <div ng-if=\\\"meta.instlogo\\\"> <img ng-src=\\\"{{meta.instlogo}}\\\"></div>\\n\" +\n    \"        <div> {{meta.inst1}}</div>\\n\" +\n    \"        <div> {{meta.inst2}}</div>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"    <div style=\\\"page-break-after:always\\\">\\n\" +\n    \"        <div ng-if=\\\"meta.revisions.length > 0\\\"> \\n\" +\n    \"            <div style=\\\"text-align:center\\\"><b>Change Log</b></div>\\n\" +\n    \"            <table>\\n\" +\n    \"                <thead>\\n\" +\n    \"                    <tr><td>Version</td><td>Date</td><td>Sections Changed</td><td>Author</td></tr>\\n\" +\n    \"                </thead>\\n\" +\n    \"                <tbody>\\n\" +\n    \"                    <tr ng-repeat=\\\"rev in meta.revisions\\\"><td>{{rev.revnum}}</td><td>{{rev.date}}</td><td>{{rev.remark}}</td><td>{{rev.firstname}} {{rev.lastname}}</td></tr>\\n\" +\n    \"                </tbody>\\n\" +\n    \"            </table>\\n\" +\n    \"        </div>\\n\" +\n    \"\\n\" +\n    \"        <div ng-if=\\\"meta.emails.length > 0\\\">\\n\" +\n    \"            <br/>\\n\" +\n    \"            <div style=\\\"text-align:center\\\"><b>Distribution List</b></div>\\n\" +\n    \"            <div ng-repeat=\\\"email in meta.emails\\\">{{email}}</div>\\n\" +\n    \"        </div>\\n\" +\n    \"\\n\" +\n    \"        <br/><br/><br/><br/><br/><br/><br/><br/>\\n\" +\n    \"        <div ng-if=\\\"meta.instlogo\\\"> <img ng-src=\\\"{{meta.instlogo}}\\\"></div>\\n\" +\n    \"        <div> {{meta.inst1}}</div>\\n\" +\n    \"        <div> {{meta.inst2}}</div>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\");\n}]);\n\nangular.module(\"partials/mms/full-doc.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"partials/mms/full-doc.html\",\n    \"<div ng-if=\\\"search === null\\\">\\n\" +\n    \"    <div fa-pane pane-anchor=\\\"north\\\" pane-size=\\\"36px\\\" pane-no-toggle=\\\"true\\\" pane-no-scroll=\\\"true\\\">\\n\" +\n    \"        <div class=\\\"pane-center-toolbar\\\">\\n\" +\n    \"            <div class=\\\"doclib-link\\\">\\n\" +\n    \"                <a type=\\\"button\\\" class=\\\"btn btn-tools btn-sm\\\" target=\\\"_blank\\\" rel=\\\"noopener noreferrer\\\" ng-href=\\\"{{docLibLink}}\\\" uib-tooltip=\\\"Manage files\\\" tooltip-placement=\\\"bottom\\\" tooltip-popup-delay=\\\"100\\\">\\n\" +\n    \"                    <img src=\\\"assets/alfresco-icon-sm.png\\\">DocLib\\n\" +\n    \"                </a>\\n\" +\n    \"                <button type=\\\"button\\\" class=\\\"btn btn-tools btn-sm share-url\\\" ng-if=\\\"!ve_fn\\\" ng-click=\\\"handleShareURL()\\\" uib-tooltip=\\\"Share Page\\\" tooltip-placement=\\\"bottom\\\" tooltip-popup-delay=\\\"100\\\"\\n\" +\n    \"                        popover-trigger=\\\"outsideClick\\\" uib-popover-template=\\\"dynamicPopover.templateUrl\\\" popover-title=\\\"{{dynamicPopover.title}}\\\" popover-placement=\\\"bottom-left\\\">\\n\" +\n    \"                    <i class=\\\"fa fa-share-alt\\\"></i></button>\\n\" +\n    \"            </div>\\n\" +\n    \"            <div class=\\\"pane-center-btn-group\\\">\\n\" +\n    \"                <mms-button-bar buttons=\\\"buttons\\\" mms-bb-api=\\\"bbApi\\\" class=\\\"bordered-button-bar\\\"></mms-button-bar>\\n\" +\n    \"            </div>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"    <div fa-pane pane-anchor=\\\"center\\\" pane-scroll-api=\\\"scrollApi\\\">\\n\" +\n    \"        <i class=\\\"pane-center-spinner fa fa-5x fa-spinner fa-spin\\\" ng-show=\\\"ve_viewContentLoading\\\"></i>\\n\" +\n    \"        <div class=\\\"ve-notify-banner\\\" ng-show=\\\"refOb.type === 'Tag'\\\">\\n\" +\n    \"            <span><strong>Tags are read only:</strong> Switch to a branch to edit</span>\\n\" +\n    \"        </div>\\n\" +\n    \"        <div class=\\\"container-fluid ve-secondary-text\\\"> Document Last Modified: {{ latestElement | date:'M/d/yy h:mm a' }}</div>\\n\" +\n    \"        <div class=\\\"pane-center container-fluid\\\" id=\\\"print-div\\\">\\n\" +\n    \"            <div ng-repeat=\\\"view in views track by view.id\\\" ng-class=\\\"{chapter: view.topLevel, 'first-chapter': view.first}\\\">\\n\" +\n    \"                <mms-view mms-element-id=\\\"{{view.id}}\\\" mms-commit-id=\\\"latest\\\" mms-project-id=\\\"{{projectOb.id}}\\\" mms-ref-id=\\\"{{refOb.id}}\\\" mms-number=\\\"{{view.number}}\\\" mms-view-api=\\\"view.api\\\"></mms-view>\\n\" +\n    \"            </div>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div ng-if=\\\"search !== null\\\">\\n\" +\n    \"    <i class=\\\"pane-center-spinner fa fa-5x fa-spinner fa-spin\\\" ng-show=\\\"ve_viewContentLoading\\\"></i>\\n\" +\n    \"    <mms-search mms-options=\\\"searchOptions\\\" mms-project-id={{projectOb.id}} mms-ref-id=\\\"{{refOb.id}}\\\"></mms-search>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<script type=\\\"text/ng-template\\\" id=\\\"shareUrlTemplate.html\\\">\\n\" +\n    \"    <p id=\\\"ve-short-url\\\">\\n\" +\n    \"        {{(shortUrl)}}\\n\" +\n    \"    </p>\\n\" +\n    \"    <button ng-click=\\\"copyToClipboard($event)\\\" class=\\\"btn btn-sm btn-default\\\"><i class=\\\"fa fa-copy\\\"></i>Copy</button>\\n\" +\n    \"</script>\\n\" +\n    \"\");\n}]);\n\nangular.module(\"partials/mms/login.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"partials/mms/login.html\",\n    \"<div id=\\\"ve-login\\\" class=\\\"row\\\">\\n\" +\n    \"    <div class=\\\"account-wall\\\">\\n\" +\n    \"        <div>\\n\" +\n    \"            <h2>{{ pageTitle }}</h2>\\n\" +\n    \"        </div>\\n\" +\n    \"        <div>\\n\" +\n    \"            <form name=\\\"loginForm\\\" ng-submit=\\\"login(credentials)\\\">\\n\" +\n    \"                <span class=\\\"label-text\\\">Username:</span>\\n\" +\n    \"                <input type=\\\"text\\\" class=\\\"form-control login-input\\\" ng-model=\\\"credentials.username\\\" autofocus>\\n\" +\n    \"                <span class=\\\"label-text\\\">Password:</span>\\n\" +\n    \"                <input type=\\\"password\\\" class=\\\"form-control login-input\\\" ng-model=\\\"credentials.password\\\">\\n\" +\n    \"                <button class=\\\"btn btn-block btn-primary\\\" type=\\\"submit\\\">Log In\\n\" +\n    \"                    <span ng-if=\\\"spin\\\" ><i class=\\\"fa fa-spin fa-spinner\\\"></i></span>\\n\" +\n    \"                </button>\\n\" +\n    \"            </form>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\" +\n    \"\");\n}]);\n\nangular.module(\"partials/mms/manage-refs.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"partials/mms/manage-refs.html\",\n    \"<div class=\\\"container-fluid ve-no-panes\\\">\\n\" +\n    \"    <div class=\\\"row\\\">\\n\" +\n    \"        <div class=\\\"col-md-10 col-md-offset-1\\\">\\n\" +\n    \"            <a class=\\\"back-to-docs\\\" ui-sref=\\\"project.ref({refId: fromParams.id, search: undefined})\\\"\\n\" +\n    \"               ui-sref-opts=\\\"{reload:true}\\\">Back to Project Documents ({{fromParams.name}})</a>\\n\" +\n    \"            <h1 class=\\\"panel-title\\\">Manage Project branches/tags</h1>\\n\" +\n    \"            <div class=\\\"panel panel-default\\\">\\n\" +\n    \"                <div class=\\\"panel-body no-padding-panel\\\">\\n\" +\n    \"                    <div ng-show=\\\"refManageView\\\" class=\\\"col-md-4 ve-light-list-panels\\\">\\n\" +\n    \"                        <ul class=\\\"ve-light-list\\\">\\n\" +\n    \"                            <li class=\\\"ve-light-input\\\">\\n\" +\n    \"                                <input placeholder=\\\"Filter branches/tags\\\" class=\\\"ve-plain-input\\\" ng-model=\\\"refFilter\\\">\\n\" +\n    \"                            </li>\\n\" +\n    \"                            <li class=\\\"ref-title\\\">\\n\" +\n    \"                                <h2><i class=\\\"fa fa-code-fork\\\" aria-hidden=\\\"true\\\"></i>Branches</h2>\\n\" +\n    \"                            </li>\\n\" +\n    \"                            <li class=\\\"ref-item\\\" ng-repeat=\\\"branch in branches | orderBy:'name' | filter:{name:refFilter}\\\" ng-click=\\\"refClickHandler(branch)\\\"\\n\" +\n    \"                                ng-class=\\\"{'selected': branch.id === refSelected.id}\\\">\\n\" +\n    \"                                <a>{{ branch.name }}</a>\\n\" +\n    \"                            </li>\\n\" +\n    \"                            <li class=\\\"ref-title\\\">\\n\" +\n    \"                                <h2><i class=\\\"fa fa-tag\\\" aria-hidden=\\\"true\\\"></i>Tags</h2>\\n\" +\n    \"                            </li>\\n\" +\n    \"                            <li class=\\\"ref-item\\\" ng-repeat=\\\"tag in tags | orderBy:'name' | filter:{name:refFilter}\\\" ng-click=\\\"refClickHandler(tag)\\\"\\n\" +\n    \"                                ng-class=\\\"{'selected': tag.id === refSelected.id}\\\">\\n\" +\n    \"                                <a>{{ tag.name }}</a>\\n\" +\n    \"                            </li>\\n\" +\n    \"                            <li ng-if=\\\"!tags.length\\\" class=\\\"ve-secondary-text\\\">No Tags</li>\\n\" +\n    \"                        </ul>\\n\" +\n    \"                    </div>\\n\" +\n    \"                    <div class=\\\"col-md-8 ve-light-panels-detail\\\" ng-show=\\\"refSelected\\\">\\n\" +\n    \"                        <div class=\\\"panels-detail-title clearfix\\\">\\n\" +\n    \"                            <h3 class=\\\"{{refSelected.type}}-icon\\\">{{refSelected.name}}</h3>\\n\" +\n    \"                            <div class=\\\"ref-button-options\\\" style=\\\"float:right\\\">\\n\" +\n    \"                            <button class=\\\"btn btn-default\\\" ng-disabled=\\\"refSelected.status === 'creating'\\\" type=\\\"button\\\" ng-click=\\\"deleteRef()\\\" ng-if=\\\"refSelected.id != 'master'\\\"><i class=\\\"fa fa-trash\\\"></i> Delete</button>\\n\" +\n    \"                            <button class=\\\"btn btn-primary\\\" ng-disabled=\\\"refSelected.status === 'creating'\\\" type=\\\"button\\\" ng-click=\\\"addTag()\\\"><i class=\\\"fa fa-plus\\\"></i> Tag</button>\\n\" +\n    \"                            <button class=\\\"btn btn-primary\\\" ng-disabled=\\\"refSelected.status === 'creating'\\\" type=\\\"button\\\" ng-click=\\\"addBranch()\\\"><i class=\\\"fa fa-plus\\\"></i> Branch</button>\\n\" +\n    \"                            </div>\\n\" +\n    \"                            <!-- <mms-button-bar buttons=\\\"buttons\\\" mms-bb-api=\\\"bbApi\\\"></mms-button-bar> -->\\n\" +\n    \"                        </div>\\n\" +\n    \"                        <dl class=\\\"dl-horizontal ve-light-panels-detail-content\\\">\\n\" +\n    \"                            <dt></dt>\\n\" +\n    \"                            <dd ng-hide=\\\"refSelected.status === 'creating'\\\" class=\\\"link-section\\\">\\n\" +\n    \"                                <a ui-sref=\\\"project.ref({refId: refSelected.id, search: undefined})\\\" ui-sref-opts=\\\"{reload:true}\\\">Project Documents</a>\\n\" +\n    \"                            </dd>\\n\" +\n    \"                            <dd ng-show=\\\"refSelected.status === 'creating'\\\" class=\\\"link-section\\\">\\n\" +\n    \"                                <span uib-tooltip-html=\\\"htmlTooltip\\\" tooltip-placement=\\\"top\\\" tooltip-trigger=\\\"mouseenter\\\"\\n\" +\n    \"                                    tooltip-append-to-body=\\\"refSelected.status == 'creating'\\\" tooltip-enable=\\\"refSelected.status == 'creating'\\\"\\n\" +\n    \"                                    ng-class=\\\"{'branch-disabled': refSelected.status == 'creating'}\\\">Project Documents</span>\\n\" +\n    \"                            </dd>\\n\" +\n    \"                            <dt>Id</dt>\\n\" +\n    \"                            <dd>{{refSelected.id}}</dd>\\n\" +\n    \"                            <dt>Type</dt>\\n\" +\n    \"                            <dd>{{refSelected.type}}</dd>\\n\" +\n    \"                            <dt>Description</dt>\\n\" +\n    \"                            <dd>{{refSelected.description}}</dd>\\n\" +\n    \"                            <span ng-if=\\\"refSelected.id != 'master'\\\">\\n\" +\n    \"                            <dt>Time Created</dt>\\n\" +\n    \"                            <dd>{{refSelected._created}}</dd>\\n\" +\n    \"                            <dt>Creator</dt>\\n\" +\n    \"                            <dd>{{refSelected._creator}}</dd>\\n\" +\n    \"                            <!-- <dt>Last Modified</dt>\\n\" +\n    \"                            <dd>{{refSelected._modified}}</dd> -->\\n\" +\n    \"                            <dt>Modifier</dt>\\n\" +\n    \"                            <dd>{{refSelected._modifier}}</dd>\\n\" +\n    \"                            <dt>Parent Ref</dt>\\n\" +\n    \"                            <dd>{{refSelected.parentRefId}}</dd>\\n\" +\n    \"                            </span>\\n\" +\n    \"                        </dl>\\n\" +\n    \"                    </div>\\n\" +\n    \"                </div>\\n\" +\n    \"            </div>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\");\n}]);\n\nangular.module(\"partials/mms/new-branch.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"partials/mms/new-branch.html\",\n    \"<div class=\\\"modal-header\\\">\\n\" +\n    \"    <h4 class=\\\"branch-icon\\\">Create new branch from {{from}}</h4>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-body ve-new-ref\\\">\\n\" +\n    \"    <p class=\\\"modal-description\\\">A <b>branch</b> is a copy of your project for you to work on specific tasks or sandbox ideas, without interfering with other copies.\\n\" +\n    \"        <a ui-sref=\\\"project.ref.document.view({documentId: '_18_0_2_8630260_1446850132083_177552_51111', viewId: 'MMS_1453977130045_239e2aee-1243-4480-a6f8-61ff7bed700f', projectId: 'PROJECT-ID_10_15_15_1_41_52_PM_5b84f7be_1506a83819c__6bce_cae_tw_jpl_nasa_gov_128_149_19_85', refId: 'master', search: undefined})\\\">more</a></p>\\n\" +\n    \"    <div class=\\\"form-group\\\">\\n\" +\n    \"        <label>Name</label>\\n\" +\n    \"        <input class=\\\"form-control\\\" ng-model=\\\"branch.name\\\" type=\\\"text\\\"\\n\" +\n    \"            placeholder=\\\"Type a name for your branch here\\\" autofocus>\\n\" +\n    \"    </div>\\n\" +\n    \"    <div class=\\\"form-group\\\">\\n\" +\n    \"        <label>Description</label>\\n\" +\n    \"        <textarea class=\\\"form-control\\\" ng-model=\\\"branch.description\\\"></textarea>\\n\" +\n    \"    </div>\\n\" +\n    \"    <div class=\\\"form-group\\\">\\n\" +\n    \"        <label>Permission</label>\\n\" +\n    \"        <br />\\n\" +\n    \"        <input ng-model=\\\"branch.permission\\\" value=\\\"read\\\" type=\\\"radio\\\"> Read\\n\" +\n    \"        <br />\\n\" +\n    \"        <input ng-model=\\\"branch.permission\\\" value=\\\"write\\\" type=\\\"radio\\\"> Write\\n\" +\n    \"    </div>\\n\" +\n    \"    <div class=\\\"form-group\\\">\\n\" +\n    \"        <label>Point in History</label>\\n\" +\n    \"        <form>\\n\" +\n    \"            <div class=\\\"radio radio-with-label\\\">\\n\" +\n    \"                <label for=\\\"most-recent\\\">\\n\" +\n    \"                    <input id=\\\"most-recent\\\" type=\\\"radio\\\" name=\\\"most recent\\\" ng-model=\\\"branch.lastCommit\\\" ng-value=\\\"true\\\">Most Recent\\n\" +\n    \"                </label><br>\\n\" +\n    \"                <label for=\\\"specify-point\\\">\\n\" +\n    \"                    <input id=\\\"specify-point\\\" type=\\\"radio\\\" name=\\\"specify point\\\" ng-model=\\\"branch.lastCommit\\\" ng-value=\\\"false\\\">Specify a timestamp\\n\" +\n    \"                </label>\\n\" +\n    \"                <div class=\\\"indent ve-secondary-text timestamp-format\\\">\\n\" +\n    \"                    <i>(YYYY-MM-DDTHH:MM:SS)</i>\\n\" +\n    \"                </div>\\n\" +\n    \"            </div>\\n\" +\n    \"            <div class=\\\"indent\\\">\\n\" +\n    \"                <input class=\\\"datetimepicker\\\" id=\\\"branch\\\">\\n\" +\n    \"            </div>\\n\" +\n    \"        </form>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-footer\\\">\\n\" +\n    \"    <button class=\\\"btn btn-primary\\\" ng-click=\\\"ok()\\\">Create <i ng-show=\\\"oking\\\" class=\\\"fa fa-spin fa-spinner\\\"></i></button>\\n\" +\n    \"    <button class=\\\"btn btn-default\\\" ng-click=\\\"cancel()\\\">Cancel</button>\\n\" +\n    \"</div>\");\n}]);\n\nangular.module(\"partials/mms/new-doc-or-group.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"partials/mms/new-doc-or-group.html\",\n    \"<div class=\\\"modal-header\\\">\\n\" +\n    \"    <h4 class=\\\"item-type-{{itemType}}\\\">Create new {{itemType | lowercase}}</h4>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-body comment-modal\\\">\\n\" +\n    \"\\n\" +\n    \"    <div class=\\\"comment-modal-input\\\">\\n\" +\n    \"        <div class=\\\"form-group\\\">\\n\" +\n    \"            <label>Name:</label>\\n\" +\n    \"            <input ng-if=\\\"itemType === 'Document'\\\" class=\\\"form-control\\\" ng-model=\\\"newDoc.name\\\" type=\\\"text\\\"\\n\" +\n    \"                ng-keyup=\\\"$event.keyCode == 13 ? ok() : null\\\" placeholder=\\\"Type a name for your document here\\\" autofocus>\\n\" +\n    \"            <input ng-if=\\\"itemType === 'Group'\\\"class=\\\"form-control\\\" ng-model=\\\"newGroup.name\\\" type=\\\"text\\\"\\n\" +\n    \"                ng-keyup=\\\"$event.keyCode == 13 ? ok() : null\\\" placeholder=\\\"Type a name for your group here\\\" autofocus>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-footer\\\">\\n\" +\n    \"    <button class=\\\"btn btn-primary\\\" ng-click=\\\"ok()\\\">Create <i ng-show=\\\"oking\\\" class=\\\"fa fa-spin fa-spinner\\\"></i>\\n\" +\n    \"    </button>\\n\" +\n    \"    <button class=\\\"btn btn-default\\\" ng-click=\\\"cancel()\\\">Cancel</button>\\n\" +\n    \"</div>\");\n}]);\n\nangular.module(\"partials/mms/new-tag.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"partials/mms/new-tag.html\",\n    \"<div class=\\\"modal-header\\\">\\n\" +\n    \"    <h4 class=\\\"tag-icon\\\">Create new tag</h4>\\n\" +\n    \"    <span class=\\\"ve-notify-banner\\\">Tags are read only</span>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-body ve-new-ref\\\">\\n\" +\n    \"    <p class=\\\"modal-description\\\">A <b>tag</b> is a read-only version of your project at a specific moment in time, typically a release or review.\\n\" +\n    \"        <a ui-sref=\\\"project.ref.document.view({documentId: '_18_0_2_8630260_1446850132083_177552_51111', viewId: 'MMS_1453977130045_239e2aee-1243-4480-a6f8-61ff7bed700f', projectId: 'PROJECT-ID_10_15_15_1_41_52_PM_5b84f7be_1506a83819c__6bce_cae_tw_jpl_nasa_gov_128_149_19_85', refId: 'master', search: undefined})\\\">more</a></p>\\n\" +\n    \"    <div class=\\\"form-group\\\">\\n\" +\n    \"        <label>Name</label>\\n\" +\n    \"        <input class=\\\"form-control\\\" ng-model=\\\"tag.name\\\" type=\\\"text\\\"\\n\" +\n    \"            placeholder=\\\"Type a name for your tag here\\\" autofocus>\\n\" +\n    \"    </div>\\n\" +\n    \"    <div class=\\\"form-group\\\">\\n\" +\n    \"        <label>Description</label>\\n\" +\n    \"        <textarea class=\\\"form-control\\\" ng-model=\\\"tag.description\\\"></textarea>\\n\" +\n    \"    </div>\\n\" +\n    \"    <div class=\\\"form-group\\\">\\n\" +\n    \"        <label>Point in History</label>\\n\" +\n    \"        <form>\\n\" +\n    \"            <div class=\\\"radio radio-with-label\\\">\\n\" +\n    \"                <label for=\\\"most-recent\\\">\\n\" +\n    \"                    <input id=\\\"most-recent\\\" type=\\\"radio\\\" name=\\\"most recent\\\" ng-model=\\\"tag.lastCommit\\\" ng-value=\\\"true\\\">\\n\" +\n    \"                    Most Recent\\n\" +\n    \"                </label><br>\\n\" +\n    \"                <label for=\\\"specify-point\\\">\\n\" +\n    \"                    <input id=\\\"specify-point\\\" type=\\\"radio\\\" name=\\\"specify point\\\" ng-model=\\\"tag.lastCommit\\\" ng-value=\\\"false\\\">\\n\" +\n    \"                    Specify a timestamp\\n\" +\n    \"                </label>\\n\" +\n    \"                <div class=\\\"indent ve-secondary-text timestamp-format\\\">\\n\" +\n    \"                    <i>(YYYY-MM-DDTHH:MM:SS)</i>\\n\" +\n    \"                </div>\\n\" +\n    \"            </div>\\n\" +\n    \"            <div class=\\\"indent\\\">\\n\" +\n    \"                <input class=\\\"datetimepicker\\\" id=\\\"tag\\\">\\n\" +\n    \"            </div>\\n\" +\n    \"        </form>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-footer\\\">\\n\" +\n    \"    <button class=\\\"btn btn-primary\\\" ng-click=\\\"ok()\\\">Create <i ng-show=\\\"oking\\\" class=\\\"fa fa-spin fa-spinner\\\"></i></button>\\n\" +\n    \"    <button class=\\\"btn btn-default\\\" ng-click=\\\"cancel()\\\">Cancel</button>\\n\" +\n    \"</div>\");\n}]);\n\nangular.module(\"partials/mms/new-view.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"partials/mms/new-view.html\",\n    \"<div class=\\\"modal-header\\\">\\n\" +\n    \"    <h4 class=\\\"item-type-View\\\"></i>Add view</h4>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-body\\\">\\n\" +\n    \"    <div class=\\\"ve-light-tabs modal-top-tabs\\\">\\n\" +\n    \"        <ul class=\\\"nav nav-tabs\\\">\\n\" +\n    \"            <li class=\\\"uib-tab nav-item tab-item\\\" ng-class=\\\"{'active': createForm}\\\">\\n\" +\n    \"                <a class=\\\"nav-link\\\" ng-click=\\\"createForm = true\\\"><i class=\\\"fa fa-plus\\\"></i>Create New</a>\\n\" +\n    \"            </li>\\n\" +\n    \"            <li class=\\\"uib-tab nav-item tab-item\\\" ng-class=\\\"{'active': !createForm}\\\">\\n\" +\n    \"                <a class=\\\"nav-link\\\" ng-click=\\\"createForm = false\\\"><i class=\\\"fa fa-search\\\"></i>Search for existing</a>\\n\" +\n    \"            </li>\\n\" +\n    \"        </ul>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"    <div ng-show=\\\"createForm\\\">\\n\" +\n    \"        <div class=\\\"form-group\\\">\\n\" +\n    \"            <label>Name (optional):</label>\\n\" +\n    \"            <input class=\\\"form-control\\\" ng-model=\\\"newView.name\\\" ng-keyup=\\\"$event.keyCode == 13 ? ok() : null\\\" type=\\\"text\\\" placeholder=\\\"Type a name for your view here\\\" autofocus>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"    <div ng-show=\\\"!createForm\\\">\\n\" +\n    \"        <p>Begin by searching for the view, then click its name or documentation to add the view.</p>\\n\" +\n    \"        <div class=\\\"radio\\\">\\n\" +\n    \"            <label><input type=\\\"radio\\\" ng-model=\\\"newViewAggr.type\\\" value=\\\"shared\\\">Add view and its children</label><br>\\n\" +\n    \"            <label><input type=\\\"radio\\\" ng-model=\\\"newViewAggr.type\\\" value=\\\"none\\\">Add view only</label>\\n\" +\n    \"        </div>\\n\" +\n    \"        <mms-search mms-options=\\\"searchOptions\\\" mms-project-id=\\\"{{projectOb.id}}\\\" mms-ref-id=\\\"{{refOb.id}}\\\"></mms-search>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-footer\\\">\\n\" +\n    \"    <button class=\\\"btn btn-primary\\\" ng-show=\\\"createForm\\\" ng-click=\\\"ok()\\\">Create\\n\" +\n    \"        <i ng-show=\\\"oking\\\" class=\\\"fa fa-spin fa-spinner\\\"></i>\\n\" +\n    \"    </button>\\n\" +\n    \"    <button class=\\\"btn btn-default\\\" ng-click=\\\"cancel()\\\">Cancel</button>\\n\" +\n    \"</div>\");\n}]);\n\nangular.module(\"partials/mms/pane-center.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"partials/mms/pane-center.html\",\n    \"<div ng-if=\\\"view !== null && search === null\\\">\\n\" +\n    \"    <div fa-pane pane-anchor=\\\"north\\\" pane-size=\\\"36px\\\" pane-no-toggle=\\\"true\\\" pane-no-scroll=\\\"true\\\">\\n\" +\n    \"        <div class=\\\"pane-center-toolbar\\\">\\n\" +\n    \"            <div class=\\\"doclib-link\\\">\\n\" +\n    \"                <a type=\\\"button\\\" class=\\\"btn btn-tools btn-sm\\\" target=\\\"_blank\\\" rel=\\\"noopener noreferrer\\\" ng-href=\\\"{{docLibLink}}\\\" uib-tooltip=\\\"Manage files\\\" tooltip-placement=\\\"bottom\\\" tooltip-popup-delay=\\\"100\\\">\\n\" +\n    \"                    <img src=\\\"assets/alfresco-icon-sm.png\\\">DocLib\\n\" +\n    \"                </a>\\n\" +\n    \"                <button type=\\\"button\\\" class=\\\"btn btn-tools btn-sm share-url\\\" ng-if=\\\"!ve_fn\\\" ng-click=\\\"handleShareURL()\\\" uib-tooltip=\\\"Share Page\\\" tooltip-placement=\\\"bottom\\\" tooltip-popup-delay=\\\"100\\\"\\n\" +\n    \"                popover-trigger=\\\"outsideClick\\\" uib-popover-template=\\\"dynamicPopover.templateUrl\\\" popover-title=\\\"{{dynamicPopover.title}}\\\" popover-placement=\\\"bottom-left\\\">\\n\" +\n    \"                <i class=\\\"fa fa-share-alt\\\"></i></button>\\n\" +\n    \"            </div>\\n\" +\n    \"            <div class=\\\"pane-center-btn-group\\\">\\n\" +\n    \"                <mms-button-bar buttons=\\\"buttons\\\" mms-bb-api=\\\"bbApi\\\" class=\\\"bordered-button-bar\\\"></mms-button-bar>\\n\" +\n    \"            </div>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"    <div fa-pane pane-anchor=\\\"center\\\">\\n\" +\n    \"        <i class=\\\"pane-center-spinner fa fa-5x fa-spinner fa-spin\\\" ng-show=\\\"ve_viewContentLoading\\\"></i>\\n\" +\n    \"        <div ng-hide=\\\"ve_viewContentLoading\\\" class=\\\"container-fluid\\\">\\n\" +\n    \"            <div class=\\\"pane-center-inner\\\">\\n\" +\n    \"                <div class=\\\"ve-notify-banner\\\" ng-show=\\\"refOb.type === 'Tag'\\\">\\n\" +\n    \"                    <span><strong>Tags are read only:</strong> Switch to a branch to edit</span>\\n\" +\n    \"                </div>\\n\" +\n    \"                <div class=\\\"ve-secondary-text\\\">{{comments.count}} Comment<span ng-if=\\\"comments.count !== 1\\\">s</span>\\n\" +\n    \"                    <span ng-if=\\\"comments.count > 0\\\">\\n\" +\n    \"                        , Last Commented {{comments.lastCommented | date:'M/d/yy h:mm a'}} by <b>{{comments.lastCommentedBy}}</b></span>\\n\" +\n    \"                </div>\\n\" +\n    \"                <div id=\\\"print-div\\\" ng-if=\\\"viewOb\\\">\\n\" +\n    \"                    <mms-view mms-element-id=\\\"{{viewOb.id}}\\\" mms-commit-id=\\\"latest\\\"\\n\" +\n    \"                              mms-project-id=\\\"{{projectOb.id}}\\\" mms-ref-id=\\\"{{refOb.id}}\\\"\\n\" +\n    \"                              mms-view-api=\\\"viewApi\\\" mms-link=\\\"vidLink\\\"></mms-view>\\n\" +\n    \"                </div>\\n\" +\n    \"            </div>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div ng-if=\\\"search !== null\\\">\\n\" +\n    \"    <i class=\\\"pane-center-spinner fa fa-5x fa-spinner fa-spin\\\" ng-show=\\\"ve_viewContentLoading\\\"></i>\\n\" +\n    \"    <mms-search mms-options=\\\"searchOptions\\\" mms-project-id=\\\"{{projectOb.id}}\\\" mms-ref-id=\\\"{{refOb.id}}\\\"></mms-search>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<script type=\\\"text/ng-template\\\" id=\\\"shareUrlTemplate.html\\\">\\n\" +\n    \"    <p id=\\\"ve-short-url\\\">{{(shortUrl)}}</p>\\n\" +\n    \"    <button ng-click=\\\"copyToClipboard($event)\\\" class=\\\"btn btn-sm btn-default\\\"><i class=\\\"fa fa-copy\\\"></i>Copy</button>\\n\" +\n    \"</script>\\n\" +\n    \"\");\n}]);\n\nangular.module(\"partials/mms/pane-left.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"partials/mms/pane-left.html\",\n    \"<div fa-pane pane-anchor=\\\"north\\\" pane-size=\\\"78px\\\" pane-no-toggle=\\\"true\\\" pane-no-scroll=\\\"true\\\">\\n\" +\n    \"    <div class=\\\"pane-left\\\">\\n\" +\n    \"        <div class=\\\"pane-left-toolbar\\\" role=\\\"toolbar\\\">\\n\" +\n    \"            <mms-button-bar buttons=\\\"buttons\\\" mms-bb-api=\\\"bbApi\\\"></mms-button-bar>\\n\" +\n    \"        </div>\\n\" +\n    \"        <div class=\\\"tree-options\\\">\\n\" +\n    \"            <mms-button-bar buttons=\\\"treeButtons\\\" mms-bb-api=\\\"tbApi\\\"></mms-button-bar>\\n\" +\n    \"            <input class=\\\"ve-plain-input\\\" ng-model-optoins=\\\"{debounce: 1000}\\\"\\n\" +\n    \"                ng-model=\\\"treeOptions.search\\\" type=\\\"text\\\" placeholder=\\\"{{filterInputPlaceholder}}\\\"\\n\" +\n    \"                ng-change=\\\"searchInputChangeHandler();\\\" style=\\\"flex:2\\\">\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\" +\n    \"<div fa-pane pane-anchor=\\\"center\\\" pane-no-toggle=\\\"true\\\">\\n\" +\n    \"    <div class=\\\"pane-left\\\" style=\\\"display:table;\\\">\\n\" +\n    \"        <mms-tree ng-show=\\\"'showTree'==(activeMenu)\\\" tree-data=\\\"treeData\\\"\\n\" +\n    \"                tree-control=\\\"treeApi\\\" initial-selection=\\\"{{ve_treeInitial}}\\\" options=\\\"treeOptions\\\"></mms-tree>\\n\" +\n    \"\\n\" +\n    \"        <div data-ng-repeat=\\\"view in ::treeViewModes\\\" ng-show=\\\"view.id==(activeMenu)\\\">\\n\" +\n    \"            <h4 style=\\\"margin: 3px 0px 3px 10px;\\\">List of {{view.title}}</h4>\\n\" +\n    \"            <ul class=\\\"nav nav-list nav-pills nav-stacked abn-tree\\\">\\n\" +\n    \"                <li ng-repeat=\\\"row in view.branchList | filter:treeOptions.search track by $index\\\"\\n\" +\n    \"                    class=\\\"abn-tree-row\\\">\\n\" +\n    \"                    <div class=\\\"arrow\\\" ng-click=\\\"user_clicks_branch(row)\\\"\\n\" +\n    \"                        ng-class=\\\"{'active-text': row.branch.selected}\\\" id=\\\"tree-branch-{{view.id}}-{{row.data.id}}\\\">\\n\" +\n    \"                        <a class=\\\"tree-item\\\" style=\\\"padding-left: 20px; position:relative;\\\">\\n\" +\n    \"                            <i ng-class=\\\"{'active-text': row.branch.selected}\\\"\\n\" +\n    \"                            class=\\\"indented tree-icon fa {{view.icon}}\\\"></i>\\n\" +\n    \"                            <!-- TODO active branch -->\\n\" +\n    \"                            <span class=\\\"indented tree-label\\\" ng-class=\\\"{'active-text': row.branch.selected}\\\">{{row.data._veNumber}} {{row.data.name}}</span>\\n\" +\n    \"                        </a>\\n\" +\n    \"                    </div>\\n\" +\n    \"                </li>\\n\" +\n    \"            </ul>\\n\" +\n    \"        </div>\\n\" +\n    \"\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\" +\n    \"\");\n}]);\n\nangular.module(\"partials/mms/pane-right.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"partials/mms/pane-right.html\",\n    \"<div class=\\\"pane-right\\\">\\n\" +\n    \"    <div ng-if=\\\"documentOb\\\">\\n\" +\n    \"        <div class=\\\"container-fluid\\\" ng-show=\\\"show.element\\\">\\n\" +\n    \"            <h4 ng-if=\\\"specApi.getEditing()\\\" class=\\\"right-pane-title\\\">Edit Element</h4>\\n\" +\n    \"            <h4 ng-if=\\\"!specApi.getEditing()\\\" class=\\\"right-pane-title\\\">Preview Element</h4>\\n\" +\n    \"            <form class=\\\"form-horizontal\\\">\\n\" +\n    \"                <div class=\\\"form-group\\\">\\n\" +\n    \"                    <label class=\\\"col-sm-3 control-label\\\">Edits ({{veEditsLength()}}):</label>\\n\" +\n    \"                    <div class=\\\"col-sm-9\\\">\\n\" +\n    \"                        <select class=\\\"form-control\\\"\\n\" +\n    \"                            ng-options=\\\"eid as edit.type + ': ' + edit.name for (eid, edit) in ve_edits\\\"\\n\" +\n    \"                            ng-model=\\\"tracker.etrackerSelected\\\" ng-change=\\\"etrackerChange()\\\">\\n\" +\n    \"                        </select>\\n\" +\n    \"                    </div>\\n\" +\n    \"                </div>\\n\" +\n    \"            </form>\\n\" +\n    \"            <hr class=\\\"spec-title-divider\\\">\\n\" +\n    \"            <mms-spec mms-element-id=\\\"{{specInfo.id}}\\\" mms-commit-id=\\\"{{specInfo.commitId}}\\\"\\n\" +\n    \"                mms-ref-id=\\\"{{specInfo.refId}}\\\" mms-project-id=\\\"{{specInfo.projectId}}\\\"\\n\" +\n    \"                mms-display-old-content=\\\"specInfo.mmsDisplayOldContent\\\" mms-spec-api=\\\"specApi\\\"></mms-spec>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"    <div ng-if=\\\"documentOb\\\">\\n\" +\n    \"        <div class=\\\"container-fluid\\\" ng-if=\\\"show.history\\\">\\n\" +\n    \"            <mms-history mms-element-id=\\\"{{specInfo.id}}\\\" mms-ref-id=\\\"{{specInfo.refId}}\\\"\\n\" +\n    \"                mms-project-id=\\\"{{specInfo.projectId}}\\\"></mms-history>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"    <div class=\\\"container-fluid container-tags\\\" id=\\\"ve-branches-tags\\\" ng-show=\\\"show.tags\\\">\\n\" +\n    \"        <h4 class=\\\"right-pane-title\\\">Project Branches/Tags</h4>\\n\" +\n    \"        <hr class=\\\"spec-title-divider\\\">\\n\" +\n    \"        <mms-ref-list mms-doc-id=\\\"{{documentOb.id}}\\\" mms-project-id=\\\"{{projectOb.id}}\\\"\\n\" +\n    \"        mms-ref-id=\\\"{{refOb.id}}\\\" mms-ref-type=\\\"{{refOb.type}}\\\" mms-branches=\\\"branchObs\\\" mms-tags=\\\"tagObs\\\"></mms-ref-list>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"    <div class=\\\"container-fluid\\\" ng-show=\\\"show.reorder\\\">\\n\" +\n    \"        <mms-view-reorder mms-element-id=\\\"{{viewOb.id}}\\\" mms-project-id=\\\"{{viewOb._projectId}}\\\"\\n\" +\n    \"            mms-commit-id=\\\"{{viewCommitId}}\\\" mms-order=\\\"true\\\" mms-ref-id=\\\"{{viewOb._refId}}\\\"\\n\" +\n    \"            mms-view-reorder-api=\\\"viewContentsOrderApi\\\"></mms-view-reorder>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"    <div class=\\\"container-fluid\\\" ng-if=\\\"show.jobs\\\">\\n\" +\n    \"        <mms-jobs mms-doc-id=\\\"{{documentOb.id}}\\\" mms-project-id=\\\"{{projectOb.id}}\\\"\\n\" +\n    \"            mms-ref-id=\\\"{{refOb.id}}\\\"></mms-jobs>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\" +\n    \"\");\n}]);\n\nangular.module(\"partials/mms/printConfirm.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"partials/mms/printConfirm.html\",\n    \"<div class=\\\"modal-header\\\">\\n\" +\n    \"    <h4>{{action}} {{type | lowercase}}</h4>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-body\\\">\\n\" +\n    \"    <p ng-if=\\\"hasError\\\" class=\\\"mms-error-icon\\\">\\n\" +\n    \"        WARNING: There are cross reference errors in this document that will be reflected in the export.\\n\" +\n    \"    </p>\\n\" +\n    \"    <p ng-if=\\\"unsaved\\\" class=\\\"mms-error-icon\\\">\\n\" +\n    \"        WARNING: Unsaved changes may not be reflected (alt + a to save all)\\n\" +\n    \"    </p>\\n\" +\n    \"    <p ng-if=\\\"mode === 1\\\">\\n\" +\n    \"      This will bring up a popup where you can {{action}} the contents of this {{type === 'DOCUMENT' ? 'document' : 'view'}} , please disable any popup blockers if you don't\\n\" +\n    \"      see the popup. \\n\" +\n    \"      <br/><br/>If you don't see certain content appearing in the popup, please wait until the full document appears in this pane before clicking {{action}}.\\n\" +\n    \"    </p>\\n\" +\n    \"    <p ng-if=\\\"mode !== 1\\\">\\n\" +\n    \"     <span ng-if=\\\"type === 'VIEW'\\\">\\n\" +\n    \"      Click on {{action | uppercase}} to generate a {{label}} of this view (it will not include table of contents or cover pages). You will receive an email with subject line \\\"HTML to {{label}} generation completed\\\" with a link to the generated {{label | uppercase}}. If you want the full document instead, please click on GO TO FULL DOCUMENT.\\n\" +\n    \"     </span>\\n\" +\n    \"     <span ng-if=\\\"type === 'DOCUMENT'\\\">\\n\" +\n    \"      Please wait until the full document appears in this pane before continuing. You will receive an email with subject line \\\"HTML to {{label}} generation completed\\\" with a link to the generated {{label}}.\\n\" +\n    \"     </span>\\n\" +\n    \"    </p>\\n\" +\n    \"    <p ng-if=\\\"type == 'DOCUMENT' && mode === 3\\\">\\n\" +\n    \"      Choose either basic or advanced styling options.\\n\" +\n    \"    </p>    \\n\" +\n    \"    <br/>\\n\" +\n    \"    <div ng-if=\\\"type == 'DOCUMENT' && mode !== 1\\\">\\n\" +\n    \"    </div>\\n\" +\n    \"    <div ng-if=\\\"type == 'DOCUMENT' && mode !== 1\\\"><input type=\\\"checkbox\\\" ng-model=\\\"model.genTotf\\\"> Include List of Tables, Figures and Equations</div>\\n\" +\n    \"    <!-- <div ng-if=\\\"model.genTotf\\\" class=\\\"indent\\\"><input type=\\\"checkbox\\\" ng-model=\\\"model.htmlTotf\\\"> Use HTML for List (will not include equations and may differ from web numbering)</div> -->\\n\" +\n    \"    <br>\\n\" +\n    \"\\n\" +\n    \"    <div ng-if=\\\"type == 'DOCUMENT' && mode === 3\\\">\\n\" +\n    \"        <br>\\n\" +\n    \"        <form class=\\\"ve-light-tabs\\\">\\n\" +\n    \"            <input type=\\\"radio\\\" name=\\\"Options\\\" ng-click=\\\"customizeDoc.useCustomStyle = false\\\" data-ng-model=\\\"customizeDoc.useCustomStyle\\\" data-ng-value=\\\"false\\\">\\n\" +\n    \"            <label for=\\\"Basic\\\">Basic Options</label>&nbsp;&nbsp;&nbsp;\\n\" +\n    \"            <input type=\\\"radio\\\" name=\\\"Options\\\" ng-click=\\\"customizeDoc.useCustomStyle = true\\\" data-ng-model=\\\"customizeDoc.useCustomStyle\\\" data-ng-value=\\\"true\\\">\\n\" +\n    \"            <label for=\\\"Advanced\\\">Advanced Options (CSS)</label>\\n\" +\n    \"        </form>\\n\" +\n    \"\\n\" +\n    \"        <div class=\\\"well\\\" ng-show=\\\"!customizeDoc.useCustomStyle\\\">\\n\" +\n    \"        <form role=\\\"form\\\">\\n\" +\n    \"\\n\" +\n    \"            <div ng-if=\\\"mode !== 1\\\">\\n\" +\n    \"                <label>Orientation</label><br>\\n\" +\n    \"                <form>\\n\" +\n    \"                    <input type=\\\"radio\\\" name=\\\"export-orientation\\\" ng-model=\\\"model.landscape\\\" ng-value=\\\"false\\\">\\n\" +\n    \"                    <label for=\\\"portrait\\\" class=\\\"ve-font-weight-normal\\\">&nbsp;<i class=\\\"fa fa-file ve-secondary-text\\\"></i> Portrait</label><br>\\n\" +\n    \"                    <input type=\\\"radio\\\" name=\\\"export-orientation\\\" ng-model=\\\"model.landscape\\\" ng-value=\\\"true\\\">\\n\" +\n    \"                    <label for=\\\"landscape\\\" class=\\\"ve-font-weight-normal\\\">&nbsp;<i class=\\\"fa fa-file fa-rotate-270 ve-secondary-text\\\"></i> Landscape\\n\" +\n    \"                </form>\\n\" +\n    \"            </div>\\n\" +\n    \"            <br>\\n\" +\n    \"\\n\" +\n    \"            <div class=\\\"form-group\\\">\\n\" +\n    \"                <label>Header</label>\\n\" +\n    \"                <div class=\\\"row narrow-gutter-row\\\">\\n\" +\n    \"                    <div class=\\\"col-md-3\\\">\\n\" +\n    \"                        <input class=\\\"ve-plain-input\\\" type=\\\"text\\\" ng-model=\\\"meta['top-left']\\\" placeholder=\\\"Left\\\" aria-labelledby=\\\"left header\\\">\\n\" +\n    \"                    </div>\\n\" +\n    \"                    <div class=\\\"col-md-6\\\">\\n\" +\n    \"                        <input class=\\\"ve-plain-input\\\" type=\\\"text\\\" ng-model=\\\"meta.top\\\" placeholder=\\\"Center\\\" aria-labelledby=\\\"center header\\\">\\n\" +\n    \"                    </div>\\n\" +\n    \"                    <div class=\\\"col-md-3\\\">\\n\" +\n    \"                        <input class=\\\"ve-plain-input\\\" type=\\\"text\\\" ng-model=\\\"meta['top-right']\\\" placeholder=\\\"Right\\\" aria-labelledby=\\\"right header\\\">\\n\" +\n    \"                    </div>\\n\" +\n    \"                </div>\\n\" +\n    \"            </div>\\n\" +\n    \"            <div class=\\\"form-group\\\">\\n\" +\n    \"                <label for=\\\"footer\\\">Footer</label>\\n\" +\n    \"                <div class=\\\"row narrow-gutter-row\\\">\\n\" +\n    \"                    <div class=\\\"col-md-3\\\">\\n\" +\n    \"                        <input class=\\\"ve-plain-input\\\" type=\\\"text\\\" ng-model=\\\"meta['bottom-left']\\\" placeholder=\\\"Left\\\" aria-labelledby=\\\"left footer\\\">\\n\" +\n    \"                    </div>\\n\" +\n    \"                    <div class=\\\"col-md-6\\\">\\n\" +\n    \"                        <input class=\\\"ve-plain-input\\\" type=\\\"text\\\" ng-model=\\\"meta.bottom\\\" placeholder=\\\"Center\\\" aria-labelledby=\\\"center footer\\\">\\n\" +\n    \"                    </div>\\n\" +\n    \"                    <div class=\\\"col-md-3\\\">\\n\" +\n    \"                        <input class=\\\"ve-plain-input\\\" type=\\\"text\\\" ng-model=\\\"meta['bottom-right']\\\"  placeholder=\\\"Right\\\" aria-labelledby=\\\"right footer\\\">\\n\" +\n    \"                    </div>\\n\" +\n    \"                </div>\\n\" +\n    \"            </div>\\n\" +\n    \"            <p class=\\\"help-block\\\"><i>Use 'counter(page)' for page number</i></p>\\n\" +\n    \"\\n\" +\n    \"        </form>\\n\" +\n    \"        </div>\\n\" +\n    \"\\n\" +\n    \"        <div class=\\\"well\\\" ng-show=\\\"customizeDoc.useCustomStyle\\\">\\n\" +\n    \"            <form ng-submit=\\\"saveStyleUpdate()\\\" role=\\\"form\\\">\\n\" +\n    \"\\n\" +\n    \"                <div class=\\\"form-group\\\">\\n\" +\n    \"                    <textarea class=\\\"form-control\\\" rows=\\\"6\\\" style=\\\"width:100%\\\" ng-model=\\\"customizeDoc.customCSS\\\"></textarea>\\n\" +\n    \"                </div>\\n\" +\n    \"                <p class=\\\"help-block\\\">\\n\" +\n    \"                    <a target=\\\"_blank\\\" href=\\\"https://wiki.jpl.nasa.gov/display/opencae/View+Editor+User+Guide%3A+8+PDF+Customization\\\">Example CSS customizations</a>\\n\" +\n    \"                </p>\\n\" +\n    \"                <button class=\\\"btn btn-default\\\" type=\\\"submit\\\"><i class=\\\"fa fa-save\\\"></i>Save CSS for document<span ng-if=\\\"elementSaving\\\"><i class=\\\"fa fa-spinner fa-spin\\\"></i></span></button>\\n\" +\n    \"                <button class=\\\"btn btn-default\\\" type=\\\"button\\\" ng-click=\\\"preview()\\\">Preview</button>\\n\" +\n    \"            </form>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-footer\\\">\\n\" +\n    \"    <button ng-if=\\\"type == 'VIEW' && docOption\\\" class=\\\"btn btn-primary\\\" ng-click=\\\"fulldoc()\\\">Go to full document</button>\\n\" +\n    \"    <button class=\\\"btn btn-primary\\\" ng-click=\\\"print()\\\">{{action | uppercase}}</button>\\n\" +\n    \"    <button class=\\\"btn btn-default\\\" ng-click=\\\"cancel()\\\">Cancel</button>\\n\" +\n    \"</div>\\n\" +\n    \"\");\n}]);\n\nangular.module(\"partials/mms/redirect.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"partials/mms/redirect.html\",\n    \"<div id=\\\"ve-origin-select\\\" class=\\\"row\\\">\\n\" +\n    \"    <div class=\\\"account-wall-lg\\\" ng-if=\\\"redirect_from_old_site\\\">\\n\" +\n    \"            <div ng-if=\\\"!redirect_element && !redirect_noResults && !redirect_relatedDocs.length\\\">\\n\" +\n    \"                <h2>This link is not valid</h2>\\n\" +\n    \"                <h4><i class=\\\"fa fa-spinner fa-spin\\\" aria-hidden=\\\"true\\\"></i> We are searching for your content</h4>\\n\" +\n    \"            </div>\\n\" +\n    \"            <!-- Content moved and results found -->\\n\" +\n    \"            <div ng-if=\\\"!redirect_noResults && redirect_element.link\\\">\\n\" +\n    \"                <h2>This content has moved</h2>\\n\" +\n    \"                <h4>You will be redirected to the new location at \\n\" +\n    \"                    <a style=\\\"text-decoration:underline;\\\" ng-if=\\\"redirect_element.link\\\" ui-sref=\\\"{{ redirect_element.link }}\\\">\\n\" +\n    \"                    <!-- <i ng-class=\\\"{'fa fa-folder': redirect_element.type === 'group', 'fa fa-file': $last && redirect_element.type === 'doc'}\\\"></i> -->\\n\" +\n    \"                    {{ redirect_element.name }}</a> in 10 seconds.\\n\" +\n    \"                </h4>\\n\" +\n    \"                <!-- <button class=\\\"btn btn-primary\\\"><i class=\\\"fa fa-bookmark\\\" aria-hidden=\\\"true\\\" style=\\\"padding-right:10px;\\\"></i>Bookmark New Link</button> -->\\n\" +\n    \"                <button style=\\\"margin-top:60px;\\\" class=\\\"btn btn-primary\\\" ng-click=\\\"resetSelectPage()\\\">View Editor Home</button>\\n\" +\n    \"            </div>\\n\" +\n    \"            <!-- no content found -->\\n\" +\n    \"            <div ng-if=\\\"redirect_noResults\\\">\\n\" +\n    \"                <h2>This link is not valid</h2>\\n\" +\n    \"                <h4>Related content not found for this link. If you believe your content was not moved or deleted, please navigate to it in View Editor and rebookmark.</h4>\\n\" +\n    \"                <button style=\\\"margin-top:60px;\\\" class=\\\"btn btn-primary\\\" ng-click=\\\"resetSelectPage()\\\">View Editor Home</button>\\n\" +\n    \"            </div>\\n\" +\n    \"            <!-- views found in docs - allow user to select -->\\n\" +\n    \"            <div ng-if=\\\"redirect_relatedDocs.length\\\">\\n\" +\n    \"                <h2>This link is not valid</h2>\\n\" +\n    \"                <h4>Here are documents related to the content you are looking for:</h4>\\n\" +\n    \"                <div ng-repeat=\\\"relatedDocument in redirect_relatedDocs\\\" class=\\\"elem-documentation\\\">\\n\" +\n    \"                    <a style=\\\"text-decoration:underline;\\\" ng-repeat=\\\"relatedView in relatedDocument._parentViews\\\" ui-sref=\\\"project.ref.document.view({documentId: relatedDocument.id, viewId: relatedView.id, projectId: relatedDocument._projectId, refId: relatedDocument._refId, search: undefined})\\\" ng-click=\\\"userRelatedClick($event, relatedDocument, relatedView, elem)\\\">\\n\" +\n    \"                        <i class=\\\"fa fa-file\\\" aria-hidden=\\\"true\\\"></i>\\n\" +\n    \"                        <mms-view-link mms-project-id=\\\"{{elem._projectId}}\\\" mms-ref-id=\\\"{{elem._refId}}\\\" mms-doc-id=\\\"{{relatedDocument.id}}\\\" mms-element-id=\\\"{{relatedDocument.id}}\\\"></mms-view-link> > <mms-view-link mms-project-id=\\\"{{elem._projectId}}\\\" mms-ref-id=\\\"{{elem._refId}}\\\" mms-doc-id=\\\"{{relatedDocument.id}}\\\" mms-element-id=\\\"{{relatedView.id}}\\\"></mms-view-link><br/>\\n\" +\n    \"                    </a>\\n\" +\n    \"                </div>\\n\" +\n    \"                <button style=\\\"margin-top:60px;\\\" class=\\\"btn btn-primary\\\" ng-click=\\\"resetSelectPage()\\\">View Editor Home</button>\\n\" +\n    \"                <!-- <h4 style=\\\"margin-top:60px;\\\"><a style=\\\"text-decoration:underline;\\\" ng-click=\\\"resetSelectPage()\\\">View Editor home</a></h4> -->\\n\" +\n    \"            </div>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\");\n}]);\n\nangular.module(\"partials/mms/reorder-groups.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"partials/mms/reorder-groups.html\",\n    \"<!-- Nested node template -->\\n\" +\n    \"<div class=\\\"group-reorder-container\\\">\\n\" +\n    \"    <script type=\\\"text/ng-template\\\" id=\\\"nodes_renderer_group.html\\\">\\n\" +\n    \"        <div ng-class=\\\"targetId === node.id ? 'highlighted' : ''\\\" ui-tree-handle>\\n\" +\n    \"            <i ng-class=\\\"node.type === 'view' ? 'fa fa-file' : node.type === 'group' ? 'fa fa-folder' : 'fa fa-home'\\\"></i> {{node.name}}\\n\" +\n    \"        </div>\\n\" +\n    \"        <ol ui-tree-nodes=\\\"\\\" ng-model=\\\"node.children\\\">\\n\" +\n    \"            <li ng-repeat=\\\"node in node.children\\\" ui-tree-node ng-include=\\\"'nodes_renderer_group.html'\\\">\\n\" +\n    \"            </li>\\n\" +\n    \"        </ol>\\n\" +\n    \"    </script>\\n\" +\n    \"\\n\" +\n    \"    <div class=\\\"container-tree-reorder container-fluid\\\">\\n\" +\n    \"        <button class=\\\"btn-tree-reorder-save btn btn-primary\\\" ng-click=\\\"saveReorder()\\\">Save <i ng-If=\\\"isSaving\\\" class='fa fa-spin fa-spinner'></i></button>\\n\" +\n    \"        <button class=\\\"btn-tree-reorder-save btn btn-default\\\" ng-click=\\\"cancelReorder()\\\">Cancel</button>\\n\" +\n    \"        <br>\\n\" +\n    \"        <p>Move group/document to/from a group. Only Grouping is preserved. Ordering is not.</p>\\n\" +\n    \"        <div class=\\\"well\\\" ui-tree=\\\"treeOptions\\\">\\n\" +\n    \"            <ol ui-tree-nodes=\\\"\\\" class=\\\"root\\\" ng-model=\\\"tree\\\">\\n\" +\n    \"                <li ng-repeat=\\\"node in tree\\\" ui-tree-node ng-include=\\\"'nodes_renderer_group.html'\\\"></li>\\n\" +\n    \"            </ol>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\\n\" +\n    \"\");\n}]);\n\nangular.module(\"partials/mms/reorder-views.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"partials/mms/reorder-views.html\",\n    \"<!-- Nested node template -->\\n\" +\n    \"<script type=\\\"text/ng-template\\\" id=\\\"nodes_renderer.html\\\">\\n\" +\n    \"    <div ui-tree-handle>\\n\" +\n    \"        {{node.old}} &rarr; {{node.new}} {{node.name}} ({{node.aggr}})\\n\" +\n    \"    </div>\\n\" +\n    \"    <ol ui-tree-nodes=\\\"\\\" ng-model=\\\"node.children\\\">\\n\" +\n    \"        <li ng-repeat=\\\"node in node.children\\\" ui-tree-node ng-include=\\\"'nodes_renderer.html'\\\">\\n\" +\n    \"        </li>\\n\" +\n    \"    </ol>\\n\" +\n    \"</script>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"container-tree-reorder container-fluid\\\">\\n\" +\n    \"    <button class=\\\"btn-tree-reorder-save btn btn-primary\\\" ng-click=\\\"save()\\\">Save <i class=\\\"{{saveClass}}\\\"></i></button>\\n\" +\n    \"    <button class=\\\"btn-tree-reorder-save btn btn-default\\\" ng-click=\\\"cancel()\\\">Cancel</button>\\n\" +\n    \"    <br>\\n\" +\n    \"    <!--<p>Note: you cannot reorder views under a view that's labeled (none) - these views may have children but are not shown and is not part of this document</p>-->\\n\" +\n    \"    <p>To reorder text, tables, images, equations, and sections, use the <i class=\\\"fa fa-arrows-v\\\"></i> in the right pane.</p>\\n\" +\n    \"    <div class=\\\"well\\\" ui-tree=\\\"treeOptions\\\">\\n\" +\n    \"        <ol ui-tree-nodes=\\\"\\\" class=\\\"root\\\" ng-model=\\\"tree\\\">\\n\" +\n    \"            <li ng-repeat=\\\"node in tree\\\" ui-tree-node ng-include=\\\"'nodes_renderer.html'\\\"></li>\\n\" +\n    \"        </ol>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\");\n}]);\n\nangular.module(\"partials/mms/select.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"partials/mms/select.html\",\n    \"<div id=\\\"ve-origin-select\\\" class=\\\"row\\\">\\n\" +\n    \"    <div class=\\\"account-wall-lg\\\" ng-if=\\\"redirect_from_old_site\\\">\\n\" +\n    \"        <h2>This is not a valid link</h2>\\n\" +\n    \"        <div class=\\\"flex\\\">\\n\" +\n    \"            <div class=\\\"two-thirds-flex\\\">\\n\" +\n    \"                <h4>Please navigate to your document by selecting the corresponding organization and project to continue.</h4>\\n\" +\n    \"            </div>\\n\" +\n    \"            <div class=\\\"one-third-flex\\\">\\n\" +\n    \"                <form name=\\\"loginForm\\\" ng-submit=\\\"continue()\\\">\\n\" +\n    \"                    <div class=\\\"btn-group ve-dark-dropdown-wide\\\" uib-dropdown>\\n\" +\n    \"                        <span class=\\\"label-dropdown\\\">Org:</span>\\n\" +\n    \"                        <button type=\\\"button\\\" class=\\\"dropdown-toggle\\\" uib-dropdown-toggle>\\n\" +\n    \"                            <span>{{ selectedOrg }}<i class=\\\"fa fa-caret-down\\\" aria-hidden=\\\"true\\\"></i></span>\\n\" +\n    \"                        </button>\\n\" +\n    \"                        <ul class=\\\"dropdown-menu list-with-selected-item\\\" uib-dropdown-menu role=\\\"menu\\\">\\n\" +\n    \"                            <li ng-model=\\\"selectedOrg\\\" ng-repeat=\\\"org in orgs | orderBy: 'name'\\\" ng-click=\\\"selectOrg(org)\\\"\\n\" +\n    \"                            ng-class=\\\"{'checked-list-item': org.name === selectedOrg}\\\">{{ org.name }}</li>\\n\" +\n    \"                        </ul>\\n\" +\n    \"                    </div>\\n\" +\n    \"                    <div class=\\\"btn-group ve-dark-dropdown-wide\\\" uib-dropdown>\\n\" +\n    \"                        <span class=\\\"label-dropdown\\\">Project:</span>\\n\" +\n    \"                        <button type=\\\"button\\\" class=\\\"dropdown-toggle\\\" uib-dropdown-toggle ng-disabled=\\\"!selectedOrg || !projects.length\\\">\\n\" +\n    \"                            <span ng-hide=\\\"projects.length || !selectedOrg\\\">No Projects for selected Org</span>\\n\" +\n    \"                            <span ng-show=\\\"projects.length\\\">{{ selectedProject }}<i class=\\\"fa fa-caret-down\\\" aria-hidden=\\\"true\\\"></i></span>\\n\" +\n    \"                        </button>\\n\" +\n    \"                        <ul class=\\\"dropdown-menu list-with-selected-item\\\" uib-dropdown-menu role=\\\"menu\\\">\\n\" +\n    \"                            <li ng-model=\\\"selectedProject\\\" ng-repeat=\\\"project in projects | orderBy: 'name'\\\"\\n\" +\n    \"                                ng-class=\\\"{'checked-list-item': project.name === selectedProject}\\\"\\n\" +\n    \"                                ng-click=\\\"selectProject(project)\\\">{{ project.name }}\\n\" +\n    \"                            </li>\\n\" +\n    \"                        </ul>\\n\" +\n    \"                    </div>\\n\" +\n    \"                    <button class=\\\"btn btn-block btn-primary\\\" type=\\\"submit\\\"  ng-disabled=\\\"!selectedProject || !selectedOrg\\\">Continue\\n\" +\n    \"                        <span ng-if=\\\"spin\\\"><i class=\\\"fa fa-spin fa-spinner\\\"></i></span>\\n\" +\n    \"                    </button>\\n\" +\n    \"                </form>\\n\" +\n    \"            </div>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"    <div class=\\\"account-wall\\\" ng-if=\\\"!redirect_from_old_site\\\">\\n\" +\n    \"        <div ng-class=\\\"{'fade-in': fromLogin}\\\">\\n\" +\n    \"            <a class=\\\"select-logout-button\\\" ng-click=\\\"logout()\\\"><i class=\\\"fa fa-arrow-left back-to-account\\\" aria-hidden=\\\"true\\\"></i></a>\\n\" +\n    \"            <h2>{{ pageTitle }}</h2>\\n\" +\n    \"        </div>\\n\" +\n    \"        <div ng-class=\\\"{'animated-fade-in-slide': fromLogin}\\\">\\n\" +\n    \"            <form name=\\\"loginForm\\\" ng-submit=\\\"continue()\\\">\\n\" +\n    \"                <div class=\\\"btn-group ve-dark-dropdown-wide\\\" uib-dropdown>\\n\" +\n    \"                    <span class=\\\"label-dropdown\\\">Org:</span>\\n\" +\n    \"                    <button type=\\\"button\\\" class=\\\"dropdown-toggle\\\" uib-dropdown-toggle>\\n\" +\n    \"                        <span>{{ selectedOrg }}<i class=\\\"fa fa-caret-down\\\" aria-hidden=\\\"true\\\"></i></span>\\n\" +\n    \"                    </button>\\n\" +\n    \"                    <ul class=\\\"dropdown-menu list-with-selected-item\\\" uib-dropdown-menu role=\\\"menu\\\">\\n\" +\n    \"                        <li ng-model=\\\"selectedOrg\\\" ng-repeat=\\\"org in orgs | orderBy: 'name'\\\" ng-click=\\\"selectOrg(org)\\\"\\n\" +\n    \"                        ng-class=\\\"{'checked-list-item': org.name === selectedOrg}\\\">{{ org.name }}</li>\\n\" +\n    \"                    </ul>\\n\" +\n    \"                </div>\\n\" +\n    \"                <div class=\\\"btn-group ve-dark-dropdown-wide\\\" uib-dropdown>\\n\" +\n    \"                    <span class=\\\"label-dropdown\\\">Project:</span>\\n\" +\n    \"                    <button type=\\\"button\\\" class=\\\"dropdown-toggle\\\" uib-dropdown-toggle ng-disabled=\\\"!selectedOrg || !projects.length\\\">\\n\" +\n    \"                        <span ng-hide=\\\"projects.length || !selectedOrg\\\">No Projects for selected Org</span>\\n\" +\n    \"                        <span ng-show=\\\"projects.length\\\">{{ selectedProject }}<i class=\\\"fa fa-caret-down\\\" aria-hidden=\\\"true\\\"></i></span>\\n\" +\n    \"                    </button>\\n\" +\n    \"                    <ul class=\\\"dropdown-menu list-with-selected-item\\\" uib-dropdown-menu role=\\\"menu\\\">\\n\" +\n    \"                        <li ng-model=\\\"selectedProject\\\" ng-repeat=\\\"project in projects | orderBy: 'name'\\\"\\n\" +\n    \"                            ng-class=\\\"{'checked-list-item': project.name === selectedProject}\\\"\\n\" +\n    \"                            ng-click=\\\"selectProject(project)\\\">{{ project.name }}\\n\" +\n    \"                        </li>\\n\" +\n    \"                    </ul>\\n\" +\n    \"                </div>\\n\" +\n    \"                <button class=\\\"btn btn-block btn-primary\\\" type=\\\"submit\\\" ng-disabled=\\\"!selectedProject || !selectedOrg\\\">Continue\\n\" +\n    \"                    <span ng-if=\\\"spin\\\"><i class=\\\"fa fa-spin fa-spinner\\\"></i></span>\\n\" +\n    \"                </button>\\n\" +\n    \"            </form>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\");\n}]);\n\nangular.module(\"partials/mms/selectModal.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"partials/mms/selectModal.html\",\n    \"<div id=\\\"modal-window\\\" class=\\\"ve-dark-modal\\\">\\n\" +\n    \"    <div class=\\\"modal-header\\\">\\n\" +\n    \"        <h4 class=\\\"modal-title\\\">Switch Org</h4>\\n\" +\n    \"    </div>\\n\" +\n    \"    <div class=\\\"modal-body\\\" id=\\\"modal-body\\\">\\n\" +\n    \"        <div class=\\\"btn-group ve-dark-dropdown-wide\\\" uib-dropdown>\\n\" +\n    \"            <span class=\\\"label-dropdown\\\">Org:</span>\\n\" +\n    \"            <button id=\\\"project-btn-keyboard-nav\\\" type=\\\"button\\\" class=\\\"dropdown-toggle\\\" uib-dropdown-toggle>\\n\" +\n    \"                <span>{{ selectedOrg }}<i class=\\\"fa fa-caret-down\\\" aria-hidden=\\\"true\\\"></i></span>\\n\" +\n    \"            </button>\\n\" +\n    \"            <ul class=\\\"dropdown-menu list-with-selected-item\\\" uib-dropdown-menu role=\\\"menu\\\"\\n\" +\n    \"                aria-labelledby=\\\"project-btn-keyboard-nav\\\">\\n\" +\n    \"                <li ng-repeat=\\\"org in orgs | orderBy: 'name'\\\" ng-click=\\\"selectOrg(org)\\\"\\n\" +\n    \"                    ng-class=\\\"{'checked-list-item': org.name === selectedOrg}\\\">{{ org.name }}\\n\" +\n    \"                </li>\\n\" +\n    \"            </ul>\\n\" +\n    \"        </div>\\n\" +\n    \"        <div class=\\\"btn-group ve-dark-dropdown-wide\\\" uib-dropdown keyboard-nav>\\n\" +\n    \"            <span class=\\\"label-dropdown\\\">Project:</span>\\n\" +\n    \"            <button id=\\\"module-btn-keyboard-nav\\\" type=\\\"button\\\" class=\\\"dropdown-toggle\\\" uib-dropdown-toggle\\n\" +\n    \"                    ng-disabled=\\\"!selectedOrg || !projects.length\\\">\\n\" +\n    \"                <span ng-hide=\\\"projects.length\\\">No Projects for selected Org</span>\\n\" +\n    \"                <span ng-show=\\\"projects.length\\\">{{ selectedProject }}<i class=\\\"fa fa-caret-down\\\" aria-hidden=\\\"true\\\"></i></span>\\n\" +\n    \"            </button>\\n\" +\n    \"            <ul class=\\\"dropdown-menu list-with-selected-item\\\" uib-dropdown-menu role=\\\"menu\\\"\\n\" +\n    \"                aria-labelledby=\\\"module-btn-keyboard-nav\\\">\\n\" +\n    \"                <li ng-repeat=\\\"project in projects | orderBy: 'name'\\\" ng-click=\\\"selectProject(project)\\\"\\n\" +\n    \"                    ng-class=\\\"{'checked-list-item': project.name === selectedProject}\\\">{{ project.name }}\\n\" +\n    \"                </li>\\n\" +\n    \"            </ul>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"    <div class=\\\"modal-footer ng-scope\\\">\\n\" +\n    \"        <button class=\\\"btn btn-primary\\\" type=\\\"button\\\" ng-click=\\\"continue()\\\" ng-disabled=\\\"!selectedProject || !selectedOrg\\\">\\n\" +\n    \"            Continue<span ng-if=\\\"spin\\\"><i class=\\\"fa fa-spin fa-spinner\\\"></i></span>\\n\" +\n    \"        </button>\\n\" +\n    \"        <button class=\\\"btn btn-default\\\" type=\\\"button\\\" ng-click=\\\"cancel()\\\">Cancel</button>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\");\n}]);\n\nangular.module(\"partials/mms/tableExport.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"partials/mms/tableExport.html\",\n    \"<div class=\\\"modal-header\\\">\\n\" +\n    \"    <h4>Export table(s) to CSV in {{type | lowercase}}</h4>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-body\\\">\\n\" +\n    \"    <p ng-if=\\\"type == 'DOCUMENT'\\\">\\n\" +\n    \"      This will bring up a popup where you can copy/paste the table contents of this document as CSV, please disable any popup blockers if you don't \\n\" +\n    \"      see the popup. \\n\" +\n    \"      <br/><br/>If you don't see certain content appearing in the popup, please wait until the full document appears in this pane before clicking export.\\n\" +\n    \"    </p>\\n\" +\n    \"    <p ng-if=\\\"type == 'VIEW'\\\">\\n\" +\n    \"        This will bring up a popup where you can copy/paste the table contents of this view as CSV, please disable any popup blockers if you don't \\n\" +\n    \"      see the popup. \\n\" +\n    \"      <br/><br/>\\n\" +\n    \"      If you don't see certain content appearing in the popup, please wait until the full document appears in this pane before clicking export.\\n\" +\n    \"      <!--<br/><br/>If you would like all the tables in the entire document instead, please click on 'GO TO FULL DOCUMENT' and click export again when it finishes loading. -->\\n\" +\n    \"    </p>\\n\" +\n    \"</div>\\n\" +\n    \"\\n\" +\n    \"<div class=\\\"modal-footer\\\">\\n\" +\n    \"    <button class=\\\"btn btn-primary\\\" ng-click=\\\"export()\\\">Export to CSV</button>\\n\" +\n    \"    <!--<button ng-if=\\\"type == 'VIEW'\\\" class=\\\"btn btn-sm btn-primary\\\" ng-click=\\\"fulldoc()\\\">GO TO FULL DOCUMENT</button>-->\\n\" +\n    \"    <button class=\\\"btn btn-default\\\" ng-click=\\\"cancel()\\\">Cancel</button>\\n\" +\n    \"</div>\\n\" +\n    \"\");\n}]);\n\nangular.module(\"partials/mms/veFooter.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"partials/mms/veFooter.html\",\n    \"<div class=\\\"footer\\\" ng-transclude></div>\");\n}]);\n\nangular.module(\"partials/mms/veMenu.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"partials/mms/veMenu.html\",\n    \"<nav class=\\\"project-level-header navbar navbar-inverse navbar-fixed-top block\\\" role=\\\"navigation\\\">\\n\" +\n    \"    <div class=\\\"btn-group ve-dark-dropdown-nav pull-left\\\" uib-dropdown keyboard-nav>\\n\" +\n    \"        <button type=\\\"button\\\" class=\\\"dropdown-toggle\\\" ng-click=\\\"updateProjectChecked()\\\" uib-dropdown-toggle>\\n\" +\n    \"            <span class=\\\"label-dropdown\\\">Project:&nbsp;</span><span class=\\\"selected-dropdown\\\">{{ currentProject }}</span>\\n\" +\n    \"            <span><i class=\\\"fa fa-caret-down\\\" aria-hidden=\\\"true\\\"></i></span>\\n\" +\n    \"        </button>\\n\" +\n    \"        <ul class=\\\"dropdown-menu list-with-selected-item\\\" uib-dropdown-menu role=\\\"menu\\\">\\n\" +\n    \"            <li ng-repeat=\\\"project in projects | orderBy: 'name'\\\" ng-click=\\\"updateProject(project)\\\"\\n\" +\n    \"                ng-class=\\\"{'checked-list-item': project.name === currentProject}\\\">\\n\" +\n    \"                <a ng-href=\\\"{{getHrefForProject(project);}}\\\"> {{ project.name }} </a>\\n\" +\n    \"            </li>\\n\" +\n    \"        </ul>\\n\" +\n    \"    </div>\\n\" +\n    \"    <div class=\\\"breadcrumbs\\\">\\n\" +\n    \"        <ul>\\n\" +\n    \"            <li ng-style=\\\"truncateStyle\\\">\\n\" +\n    \"                <a class=\\\"back-to-proj\\\" ui-sref=\\\"project.ref({refId: branch.id? branch.id : 'master', search: undefined})\\\" ui-sref-opts=\\\"{reload:true}\\\"\\n\" +\n    \"                    uib-tooltip=\\\"{{ currentProject }}\\\" tooltip-trigger=\\\"mouseenter\\\" tooltip-popup-delay=\\\"100\\\" tooltip-placement=\\\"bottom\\\">\\n\" +\n    \"                    <i class=\\\"fa fa-home\\\" aria-hidden=\\\"true\\\"></i>\\n\" +\n    \"                </a>\\n\" +\n    \"            </li>\\n\" +\n    \"            <li ng-style=\\\"truncateStyle\\\" ng-show=\\\"!isRefsView()\\\" ng-repeat=\\\"breadcrumb in breadcrumbs track by $index\\\">\\n\" +\n    \"                <span> &#8250;</span>\\n\" +\n    \"                <a ui-sref=\\\"{{ breadcrumb.link }}\\\" uib-tooltip=\\\"{{ breadcrumb.name }}\\\" tooltip-trigger=\\\"mouseenter\\\" tooltip-popup-delay=\\\"100\\\" tooltip-placement=\\\"bottom\\\">\\n\" +\n    \"                    <i ng-class=\\\"{'fa fa-file': $last && breadcrumb.type === 'doc'}\\\" aria-hidden=\\\"true\\\"></i>{{ breadcrumb.name }}\\n\" +\n    \"                </a>\\n\" +\n    \"            </li>\\n\" +\n    \"        </ul>\\n\" +\n    \"    </div>\\n\" +\n    \"\\n\" +\n    \"    <div ng-show=\\\"!isRefsView()\\\" class=\\\"nav navbar-nav navbar-right\\\" style=\\\"padding-right: 15px\\\">\\n\" +\n    \"        <div class=\\\"btn-group ve-dark-dropdown-nav\\\" uib-dropdown keyboard-nav auto-close=\\\"outsideClick\\\">\\n\" +\n    \"            <button id=\\\"task-selection-button\\\" type=\\\"button\\\" class=\\\"dropdown-toggle\\\" uib-dropdown-toggle>\\n\" +\n    \"                <span class=\\\"label-dropdown\\\">{{ currentRef.type }}:</span>\\n\" +\n    \"                <span class=\\\"selected-dropdown\\\">{{ currentRef.name }}</span>\\n\" +\n    \"                <i class=\\\"fa fa-caret-down\\\" aria-hidden=\\\"true\\\"></i>\\n\" +\n    \"            </button>\\n\" +\n    \"            <ul class=\\\"dropdown-menu pull-right list-with-selected-item list-with-button list-with-tabs\\\" uib-dropdown-menu role=\\\"menu\\\"\\n\" +\n    \"                aria-labelledby=\\\"task-selection-button\\\">\\n\" +\n    \"                <li class=\\\"button-item\\\">\\n\" +\n    \"                    <button class=\\\"btn btn-large btn-block btn-primary\\\" ng-click=\\\"refsView()\\\">Manage Branches/Tags\\n\" +\n    \"                    </button>\\n\" +\n    \"                </li>\\n\" +\n    \"                <li class=\\\"button-item\\\">\\n\" +\n    \"                    <form class=\\\"ve-dark-minor-search\\\">\\n\" +\n    \"                        <input placeholder=\\\"Filter branches/tags\\\" ng-model=\\\"refFilter\\\">\\n\" +\n    \"                    </form>\\n\" +\n    \"                </li>\\n\" +\n    \"                <uib-tabset active=\\\"active\\\" type=\\\"tabs\\\" justified=\\\"false\\\">\\n\" +\n    \"                    <uib-tab index=\\\"0\\\" classes=\\\"tab-item\\\" heading=\\\"Branches\\\">\\n\" +\n    \"                        <li ng-repeat=\\\"branch in branches | orderBy:'name' | filter:{name:refFilter} \\\" ng-click=\\\"updateBranch(branch)\\\"\\n\" +\n    \"                            ng-class=\\\"{'checked-list-item': branch.name === currentBranch, 'branch-disabled': branch.status == 'creating'}\\\"\\n\" +\n    \"                            is-open=\\\"false\\\" tooltip-placement=\\\"left\\\" uib-tooltip-html=\\\"htmlTooltip\\\"\\n\" +\n    \"                            tooltip-append-to-body=\\\"branch.status == 'creating'\\\" tooltip-enable=\\\"branch.status == 'creating'\\\">\\n\" +\n    \"                            <a ng-href=\\\"{{getHrefForBranch(branch);}}\\\" ng-style=\\\"{display: 'block'}\\\"> {{ branch.name }} </a>\\n\" +\n    \"                        </li>\\n\" +\n    \"                    </uib-tab>\\n\" +\n    \"                    <uib-tab index=\\\"1\\\" classes=\\\"tab-item\\\" heading=\\\"Tags\\\">\\n\" +\n    \"                        <li ng-if=\\\"tags.length\\\" ng-repeat=\\\"tag in tags | orderBy:'name' | filter:{name:refFilter}\\\" ng-click=\\\"updateTag(tag)\\\"\\n\" +\n    \"                            ng-class=\\\"{'checked-list-item': tag.name === currentTag, 'branch-disabled': tag.status == 'creating'}\\\"\\n\" +\n    \"                            is-open=\\\"false\\\" tooltip-placement=\\\"left\\\" uib-tooltip-html=\\\"htmlTooltip\\\"\\n\" +\n    \"                            tooltip-append-to-body=\\\"tag.status == 'creating'\\\" tooltip-enable=\\\"tag.status == 'creating'\\\">\\n\" +\n    \"                            <a ng-href=\\\"{{getHrefForTag(tag);}}\\\" ng-style=\\\"{display: 'block'}\\\"> {{ tag.name }} </a>\\n\" +\n    \"                        </li>\\n\" +\n    \"                        <li ng-if=\\\"!tags.length\\\" class=\\\"ve-secondary\\\">No Tags</li>\\n\" +\n    \"                    </uib-tab>\\n\" +\n    \"                </uib-tabset>\\n\" +\n    \"            </ul>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"</nav>\\n\" +\n    \"\");\n}]);\n\nangular.module(\"partials/mms/veNav.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"partials/mms/veNav.html\",\n    \"<nav class=\\\"navbar navbar-inverse navbar-fixed-top\\\" role=\\\"navigation\\\">\\n\" +\n    \"    <div class=\\\"block\\\">\\n\" +\n    \"        <div class=\\\"navbar-header\\\">\\n\" +\n    \"            <button type=\\\"button\\\" class=\\\"navbar-toggle main-nav-toggle\\\" ng-click=\\\"isNavCollapsed = !isNavCollapsed\\\">\\n\" +\n    \"                <span class=\\\"sr-only\\\">Toggle navigation</span>\\n\" +\n    \"                <i class=\\\"fa fa-bars\\\" aria-hidden=\\\"true\\\"></i>\\n\" +\n    \"            </button>\\n\" +\n    \"            <span>\\n\" +\n    \"            <a class=\\\"navbar-brand\\\" ui-sref=\\\"login.select\\\">\\n\" +\n    \"                <img src=\\\"assets/logo.svg\\\" alt=\\\"View Editor Logo\\\">\\n\" +\n    \"            </a>\\n\" +\n    \"            <a ng-if=\\\"!org.homeLink\\\" class=\\\"org-title\\\" ui-sref=\\\"project.ref({projectId: project.id, refId: ref.id})\\\">{{ org.name }}</a>\\n\" +\n    \"            <a ng-if=\\\"org.homeLink\\\" class=\\\"org-title\\\" ng-href=\\\"{{org.homeLink}}\\\">{{ org.name }}</a>\\n\" +\n    \"            <a class=\\\"switch-org\\\" ng-click=\\\"updateOrg()\\\">Switch Org</a>\\n\" +\n    \"            </span>\\n\" +\n    \"        </div>\\n\" +\n    \"        <div class=\\\"collapse navbar-collapse\\\" uib-collapse=\\\"isNavCollapsed\\\" id=\\\"global-navigation\\\">\\n\" +\n    \"            <form id=\\\"global-search\\\" ng-submit=\\\"search(searchText)\\\" class=\\\"navbar-form navbar-left\\\" role=\\\"search\\\">\\n\" +\n    \"                <div class=\\\"form-group\\\">\\n\" +\n    \"                    <input placeholder=\\\"Search selected project\\\" ng-model=\\\"searchText\\\"/>\\n\" +\n    \"                    <button ng-click=\\\"search(searchText)\\\">\\n\" +\n    \"                        <i class=\\\"fa fa-search\\\" aria-hidden=\\\"true\\\"></i>\\n\" +\n    \"                    </button>\\n\" +\n    \"                </div>\\n\" +\n    \"            </form>\\n\" +\n    \"            <ul class=\\\"nav navbar-nav global-menu\\\">\\n\" +\n    \"                <!--<li><span><a ng-click=\\\"stagingView()\\\">UAT</a></span></li>-->\\n\" +\n    \"                <li class=\\\"dropdown\\\">\\n\" +\n    \"                    <span class=\\\"dropdown ve-dark-dropdown-nav fixed-content-dropdown\\\" uib-dropdown on-toggle=\\\"toggled(open)\\\">\\n\" +\n    \"                        <a href id=\\\"help-dropdown\\\" class=\\\"dropdown-toggle\\\" uib-dropdown-toggle>\\n\" +\n    \"                        Help <i class=\\\"fa fa-caret-down\\\" aria-hidden=\\\"true\\\"></i>\\n\" +\n    \"                        </a>\\n\" +\n    \"                        <ul class=\\\"dropdown-menu pull-right\\\" uib-dropdown-menu aria-labelledby=\\\"help-dropdown\\\">\\n\" +\n    \"                            <li>\\n\" +\n    \"                                <a href=\\\"\\\" ng-click=\\\"toggleHelp()\\\">Keyboard Shortcuts</a>\\n\" +\n    \"                            </li>\\n\" +\n    \"                            <li class=\\\"divider\\\"></li>\\n\" +\n    \"                            <li>\\n\" +\n    \"                                <a href=\\\"https://wiki.jpl.nasa.gov/display/opencae/View+Editor+User+Guide\\\" target=\\\"_blank\\\">View Editor User Guide</a>\\n\" +\n    \"                            </li>\\n\" +\n    \"                            <li>\\n\" +\n    \"                                <a href=\\\"https://jira.jpl.nasa.gov/servicedesk/customer/portal/5\\\" target=\\\"_blank\\\">Report Issue</a>\\n\" +\n    \"                            </li>\\n\" +\n    \"                            <li class=\\\"divider\\\"></li>\\n\" +\n    \"                            <li class=\\\"list-section-bottom\\\">\\n\" +\n    \"                                <a ng-click=\\\"toggleAbout()\\\" href=\\\"\\\">About View Editor</a>\\n\" +\n    \"                            </li>\\n\" +\n    \"                         </ul>\\n\" +\n    \"                    </span>\\n\" +\n    \"                </li>\\n\" +\n    \"                <li class=\\\"dropdown\\\">\\n\" +\n    \"                    <span class=\\\"dropdown ve-dark-dropdown-nav fixed-content-dropdown user-profile\\\" uib-dropdown on-toggle=\\\"toggled(open)\\\">\\n\" +\n    \"                        <a href id=\\\"login-dropdown\\\" class=\\\"dropdown-toggle\\\" uib-dropdown-toggle>\\n\" +\n    \"                            {{ username | limitTo:1 | uppercase }}\\n\" +\n    \"                        </a>\\n\" +\n    \"                        <ul class=\\\"dropdown-menu pull-right\\\" uib-dropdown-menu aria-labelledby=\\\"login-dropdown\\\" style=\\\"white-space: nowrap\\\" role=\\\"login-menu\\\">\\n\" +\n    \"                            <li ng-if=\\\"username\\\" class=\\\"ve-secondary\\\">\\n\" +\n    \"                                <span>Logged in as <b>{{ username }}</b></span>\\n\" +\n    \"                            </li>\\n\" +\n    \"                            <li class=\\\"divider\\\"></li>\\n\" +\n    \"                            <li>\\n\" +\n    \"                                <a ng-click=\\\"logout()\\\">Log Out</a>\\n\" +\n    \"                            </li>\\n\" +\n    \"                         </ul>\\n\" +\n    \"                    </span>\\n\" +\n    \"                </li>\\n\" +\n    \"            </ul>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"</nav>\\n\" +\n    \"\");\n}]);\n","'use strict';\n\nangular.module('mmsApp', ['mms', 'mms.directives', 'app.tpls', 'fa.directive.borderLayout', 'ui.bootstrap', 'ui.router', 'ui.tree', 'angular-growl', 'cfp.hotkeys', 'angulartics', 'angulartics.piwik', 'ngStorage', 'ngAnimate', 'ngPromiseExtras', 'ngCookies'])\n.config(['$stateProvider', '$urlRouterProvider', '$httpProvider', '$provide', 'URLServiceProvider', '$locationProvider', function($stateProvider, $urlRouterProvider, $httpProvider, $provide, URLServiceProvider, $locationProvider) {\n    // override uibTypeaheadPopup functionality\n    $provide.decorator('uibTypeaheadPopupDirective', ['$delegate', function($delegate) {\n        var originalLinkFn = $delegate[0].link;\n        $delegate[0].compile = function(tElem, tAttr) {\n            return function newLinkFn(scope, elem, attr) {\n                // fire the originalLinkFn\n                originalLinkFn.apply($delegate[0], arguments);\n                scope.selectActive = function(matchIdx) {\n                    // added behavior\n                    elem.children().removeClass('active');\n                    // default behavior\n                    scope.active = matchIdx;\n                };\n            };\n        };\n        // get rid of the old link function since we return a link function in compile\n        delete $delegate[0].link;\n        return $delegate;\n    }]);\n\n    $locationProvider.hashPrefix('');\n  \n    $urlRouterProvider.rule(function ($injector, $location) {\n        var $state = $injector.get('$state');\n        var locationPath = $location.url();\n        if (locationPath.indexOf('full%23') > 0)\n            locationPath = locationPath.replace('full%23', 'full#');\n        if (locationPath[0] !== '/')\n            locationPath = '/' + locationPath;\n        if (locationPath[locationPath.length-1] == '/')\n            locationPath = locationPath.substring(0, locationPath.length-1);\n\n        // if loading 'full' route with an anchor id, switch to views route instead\n        if ( $state.current.name === '' || $state.current.name === 'login.redirect' ) {\n            var string = '/full#';\n            var hash = $location.hash();\n            var index = locationPath.indexOf(string);\n            if ( index !== -1 && hash && !hash.endsWith('_pei')) {\n                locationPath = locationPath.substr(0, index) + '/views/' + hash;\n            }\n        }\n        if (locationPath !== $location.url())\n            $location.url(locationPath);\n    });\n\n    var mmsHost = window.location.protocol + '//' + window.location.host;\n    URLServiceProvider.setMmsUrl(mmsHost);\n    //URLServiceProvider.setMmsUrl('https://opencae-uat.jpl.nasa.gov');\n\n    $httpProvider.defaults.withCredentials = true;\n// Check if user is logged in, if so redirect to select page otherwise go to login if the url isn't mapped\n    $urlRouterProvider.otherwise(function($injector, $location) {\n        var $rootScope = $injector.get('$rootScope');\n        var $state = $injector.get('$state');\n        var checkLogin = $injector.get('AuthService').checkLogin();\n        if (checkLogin) {\n            if ($location.url().includes('workspace')) {\n                $rootScope.redirect_from_old_site = true;\n                $rootScope.crush_url = $location.path();\n                $state.go('login.redirect');\n            } else {\n                $rootScope.redirect_from_old_site = false;\n                $state.go('login.select');\n            }\n        } else {\n            $state.go('login');\n        }\n    });\n\n\n    $stateProvider\n    .state('login', {\n        url: '/login',\n        resolve: { },\n        views: {\n            'login@': {\n                templateUrl: 'partials/mms/login.html',\n                controller: ['$scope', '$rootScope', '$state', 'AuthService', 'growl', function ($scope, $rootScope, $state, AuthService, growl) {\n                    $scope.credentials = {\n                      username: '',\n                      password: ''\n                    };\n                    $rootScope.ve_title = 'Login';\n                    $scope.pageTitle = 'View Editor';\n                    $scope.spin = false;\n                    $scope.login = function (credentials) {\n                        $scope.spin = true;\n                        var credentialsJSON = {\"username\":credentials.username, \"password\":credentials.password};\n                        AuthService.getAuthorized(credentialsJSON)\n                        .then(function(user) {\n                            if ($rootScope.ve_redirect) {\n                                var toState = $rootScope.ve_redirect.toState;\n                                var toParams = $rootScope.ve_redirect.toParams;\n                                $state.go(toState, toParams);\n                            } else {\n                                $state.go('login.select', {fromLogin: true});\n                            }\n                        }, function (reason) {\n                            $scope.spin = false;\n                            growl.error(reason.message);\n                        });\n                    };\n                }]\n            }\n        }\n    })\n    .state('login.redirect', {\n        url: '/redirect',\n        resolve: {\n            ticket: ['$window', 'URLService', 'AuthService', '$q', '$cookies', 'ApplicationService', function($window, URLService, AuthService, $q, $cookies, ApplicationService) {\n                var deferred = $q.defer();\n                AuthService.checkLogin().then(function(data) {\n                    ApplicationService.setUserName(data);\n                    URLService.setTicket($window.localStorage.getItem('ticket'));\n                    deferred.resolve($window.localStorage.getItem('ticket'));\n                    $cookies.put('com.tomsawyer.web.license.user', data, {path: '/'});\n                }, function(rejection) {\n                    deferred.reject(rejection);\n                });\n                return deferred.promise;\n            }]\n        },\n        views: {\n            'login@': {\n                templateUrl: 'partials/mms/redirect.html',\n                controller: 'RedirectCtrl'\n            }\n        }\n    })\n    .state('login.select', {\n        url: '/select?fromLogin',\n        resolve: {\n            ticket: ['$window', 'URLService', 'AuthService', '$q', 'ApplicationService', function($window, URLService, AuthService, $q, ApplicationService) {\n                var deferred = $q.defer();\n                AuthService.checkLogin().then(function(data) {\n                    ApplicationService.setUserName(data);\n                    URLService.setTicket($window.localStorage.getItem('ticket'));\n                    deferred.resolve($window.localStorage.getItem('ticket'));\n                }, function(rejection) {\n                    deferred.reject(rejection);\n                });\n                return deferred.promise;\n            }],\n            orgObs: ['$stateParams', 'ProjectService', 'ticket', function($stateParams, ProjectService, ticket) {\n                return ProjectService.getOrgs();\n            }]\n        },\n        views: {\n            'login@': {\n                templateUrl: 'partials/mms/select.html',\n                controller: ['$scope', '$rootScope', '$state', '$stateParams', 'orgObs', 'ProjectService', 'AuthService', 'growl', '$localStorage', function($scope, $rootScope, $state, $stateParams, orgObs, ProjectService, AuthService, growl, $localStorage) {\n                    $rootScope.ve_title = 'Projects';\n                    $scope.pageTitle = 'View Editor';\n                    $scope.fromLogin = $stateParams.fromLogin;\n                    $localStorage.$default({org: orgObs[0]});\n                    $scope.spin = false;\n                    $scope.orgs = orgObs;\n                    var orgId, projectId;\n                    $scope.selectOrg = function(org) {\n                        if (org) {\n                            $localStorage.org = org;\n                            orgId = org.id;\n                            $localStorage.org.orgName = org.name;\n                            $scope.selectedOrg = $localStorage.org.name;\n                            $scope.selectedProject = \"\"; // default here?\n                            ProjectService.getProjects(orgId).then(function(data){\n                                $scope.projects = data;\n                                if (data.length > 0) {\n                                    if($localStorage.project && checkForProject(data, $localStorage.project) === 1){\n                                        $scope.selectedProject = $localStorage.project.name;\n                                        projectId = $localStorage.project.id;\n                                    }else{\n                                        $scope.selectProject(data[0]);\n                                    }\n                                }\n                            });\n                        }\n                    };\n                    $scope.selectProject = function(project) {\n                        if (project) {\n                            $localStorage.project = project;\n                            $scope.selectedProject = $localStorage.project.name;\n                            projectId = $localStorage.project.id;\n                        }\n                    };\n                    if ($localStorage.org) {\n                        $scope.selectOrg($localStorage.org);\n                    }\n                    var checkForProject = function(projectArray, project) {\n                        for (var i = 0; i < projectArray.length; i++) {\n                            if(projectArray[i].id === project.id){\n                                return 1;\n                            }\n                        }\n                        return 0;\n                    };\n\n                    $scope.continue = function() {\n                        if (orgId && projectId) {\n                            $scope.spin = true;\n                            $rootScope.redirect_from_old_site = false;\n                            $state.go('project.ref', {orgId: orgId, projectId: projectId, refId: 'master'}).then(function(data) {\n                            }, function(reject) {\n                                $scope.spin = false;\n                            });\n                        }\n                    };\n                    $scope.logout = function() {\n                        AuthService.logout().then(function() {\n                            $state.go('login');\n                        }, function() {\n                            growl.error('You were not logged out');\n                        });\n                    };\n                }]\n            }\n        }\n    })\n    .state('project', { //TODO this will be the ui to diff and merge and manage refs\n        url: '/projects/:projectId',\n        resolve: {\n            ticket: ['$window', 'URLService', 'AuthService', '$q', 'ApplicationService', '$cookies', function($window, URLService, AuthService, $q, ApplicationService, $cookies) {\n                var deferred = $q.defer();\n                AuthService.checkLogin().then(function(data) {\n                    ApplicationService.setUserName(data);\n                    URLService.setTicket($window.localStorage.getItem('ticket'));\n                    deferred.resolve($window.localStorage.getItem('ticket'));\n                    $cookies.put('com.tomsawyer.web.license.user', data, {path: '/'});\n                }, function(rejection) {\n                    deferred.reject(rejection);\n                });\n                return deferred.promise;\n            }],\n            //orgObs: ['$stateParams', 'ProjectService', 'ticket', function($stateParams, ProjectService, ticket) {\n            //    return ProjectService.getOrgs();\n            //}],\n            projectOb: ['$stateParams', 'ProjectService', 'ticket', function($stateParams, ProjectService, ticket) {\n                return ProjectService.getProject($stateParams.projectId);\n            }],\n            projectObs: ['$stateParams', 'ProjectService', 'ticket', 'projectOb', function($stateParams, ProjectService, ticket, projectOb) {\n                return ProjectService.getProjects(projectOb.orgId);\n            }],\n            orgOb: ['ProjectService', 'projectOb', 'ticket', function(ProjectService, projectOb, ticket) {\n                return ProjectService.getOrg(projectOb.orgId);\n            }],\n            refObs: ['$stateParams', 'ProjectService', 'ticket', function($stateParams, ProjectService, ticket) {\n                return ProjectService.getRefs($stateParams.projectId);\n            }],\n            tagObs: ['refObs', function(refObs) {\n                var ret = [];\n                for (var i = 0; i < refObs.length; i++) {\n                    if (refObs[i].type === \"Tag\")\n                        ret.push(refObs[i]);\n                }\n                return ret;\n            }],\n            branchObs: ['refObs', function(refObs) {\n                var ret = [];\n                for (var i = 0; i < refObs.length; i++) {\n                    if (refObs[i].type === \"Branch\")\n                        ret.push(refObs[i]);\n                }\n                return ret;\n            }],\n            refOb: function() { return null;},\n            tagOb: function() { return null;},\n            branchOb: function() { return null;},\n            documentOb: function(){ return null;},\n            viewOb: function(){ return null;},\n            search: function(){ return null;}\n        },\n        views: {\n            'nav@': {\n                template: '<ve-nav mms-title=\"ve_title\" mms-org=\"org\" mms-project=\"project\" mms-projects=\"projects\" mms-ref=\"ref\" mms-branch=\"branch\" mms-branches=\"branches\" mms-tag=\"tag\" mms-tags=\"tags\" mms-search=\"search\"></ve-nav>',\n                controller: ['$scope', '$rootScope', 'orgOb', 'projectOb', 'projectObs', 'refOb', 'branchOb', 'branchObs', 'tagOb', 'tagObs', 'search', function ($scope, $rootScope, orgOb, projectOb, projectObs, refOb, branchOb, branchObs, tagOb, tagObs, search) {\n                    $rootScope.ve_title = orgOb.name;\n                    $scope.org = orgOb;\n                    //$scope.orgs = orgObs;\n                    $scope.project = projectOb;\n                    $scope.projects = projectObs;\n                    $scope.ref = refOb;\n                    $scope.branch = branchOb;\n                    $scope.branches = branchObs;\n                    $scope.tag = tagOb;\n                    $scope.tags = tagObs;\n                    $scope.search = search;\n                }]\n            },\n            'menu@': {\n                template: '<ve-menu mms-org=\"org\" mms-project=\"project\" mms-projects=\"projects\" mms-ref=\"ref\" mms-refs=\"refs\" mms-branch=\"branch\" mms-branches=\"branches\" mms-tag=\"tag\" mms-tags=\"tags\"></ve-menu>',\n                controller:['$scope', '$rootScope', 'orgOb', 'projectOb', 'projectObs', 'refOb', 'refObs', 'branchOb', 'branchObs', 'tagOb', 'tagObs', function ($scope, $rootScope, orgOb, projectOb, projectObs, refOb, refObs, branchOb, branchObs, tagOb, tagObs) {\n                    $rootScope.ve_title = projectOb.name;\n                    $scope.org = orgOb;\n                    $scope.project = projectOb;\n                    $scope.projects = projectObs;\n                    $scope.ref = refOb;\n                    $scope.refs = refObs;\n                    $scope.branch = branchOb;\n                    $scope.branches = branchObs;\n                    $scope.tag = tagOb;\n                    $scope.tags = tagObs;\n                }]\n            },\n            'manageRefs@': {\n                templateUrl: 'partials/mms/manage-refs.html',\n                controller: 'RefsCtrl'\n            }\n        }\n    })\n    .state('project.ref', { // equivalent to old sites and documents page\n        url: '/:refId?search',\n        resolve: {\n            projectOb: ['$stateParams', 'ProjectService', 'ticket', function($stateParams, ProjectService, ticket) {\n                return ProjectService.getProjectMounts($stateParams.projectId, $stateParams.refId);\n            }],\n            refOb: ['$stateParams', 'ProjectService', 'ticket', function($stateParams, ProjectService, ticket) {\n                return ProjectService.getRef($stateParams.refId, $stateParams.projectId);\n            }],\n            tagOb: ['refOb', function(refOb) {\n                if(refOb.type === \"Tag\")\n                    return refOb;\n                else {\n                    return [];\n                }\n            }],\n            branchOb: ['refOb', function(refOb) {\n                if(refOb.type === \"Branch\")\n                    return refOb;\n                else {\n                    return [];\n                }\n            }],\n            groupObs: ['$stateParams', 'ProjectService', 'ticket', function($stateParams, ProjectService, ticket) {\n                return ProjectService.getGroups($stateParams.projectId, $stateParams.refId);\n            }],\n            groupOb: function(){ return null;},\n            documentOb: ['$stateParams', '$q', 'ElementService', 'ViewService', 'refOb', 'projectOb', 'ticket', function($stateParams, $q, ElementService, ViewService, refOb, projectOb, ticket) {\n                var deferred = $q.defer();\n                var eid = $stateParams.projectId + '_cover';\n                ElementService.getElement({\n                    projectId: $stateParams.projectId,\n                    refId: $stateParams.refId,\n                    extended: true,\n                    elementId: eid\n                }, 2).then(function(data) {\n                    deferred.resolve(data);\n                }, function(reason) {\n                    if (reason.status === 404) {\n                        if (refOb.type === 'Tag') {\n                            deferred.resolve(null);\n                        } else {\n                            ViewService.createView({\n                                _projectId: $stateParams.projectId,\n                                _refId: $stateParams.refId,\n                                id: 'holding_bin_' + $stateParams.projectId\n                            },{\n                                viewName: projectOb.name + ' Cover Page',\n                                viewId: eid\n                            }, 2).then(function(data) {\n                                deferred.resolve(data);\n                            }, function(reason2) {\n                                deferred.resolve(null);\n                            });\n                        }\n                    } else if (reason.status === 410) { //resurrect\n                        var name = projectOb.name + ' Cover Page ';\n                        try {\n                            name = reason.data.deleted[0].name + ' ';\n                        } catch(e) {}\n                        ElementService.updateElements([\n                            {\n                                _projectId: $stateParams.projectId,\n                                _refId: $stateParams.refId,\n                                id: eid,\n                                name: name\n                            },\n                            {\n                                _projectId: $stateParams.projectId,\n                                _refId: $stateParams.refId,\n                                id: eid + \"_asi\",\n                                name: ' '\n                            }\n                        ]).then(function(data) {\n                            var resolved = false;\n                            if (data.length > 0) {\n                                data.forEach(function(e) {\n                                    if (e.id == eid) {\n                                        deferred.resolve(e);\n                                        resolved = true;\n                                    }\n                                });\n                            }\n                            if (!resolved) {\n                                deferred.resolve(null);\n                            }\n                        }, function(reason2) {\n                            deferred.resolve(null);\n                        });\n                    } else {\n                        deferred.resolve(null); //let user get into project\n                    }\n                });\n                return deferred.promise;\n            }],\n            viewOb: ['documentOb', function(documentOb) {\n                return documentOb;\n            }],\n            search: ['$stateParams', 'ElementService', 'ticket', function($stateParams, ElementService, ticket) {\n                if ($stateParams.search === undefined) {\n                    return null;\n                }\n                return $stateParams.search;\n            }],\n            docMeta: [function(){\n                return {};\n            }]\n        },\n        views: {\n            'nav@': {\n                template: '<ve-nav mms-title=\"ve_title\" mms-org=\"org\" mms-project=\"project\" mms-projects=\"projects\" mms-ref=\"ref\" mms-branch=\"branch\" mms-branches=\"branches\" mms-tag=\"tag\" mms-tags=\"tags\" mms-search=\"search\"></ve-nav>',\n                controller: ['$scope', '$rootScope', 'orgOb', 'projectOb', 'projectObs', 'refOb', 'branchOb', 'branchObs', 'tagOb', 'tagObs', 'search', function ($scope, $rootScope, orgOb, projectOb, projectObs, refOb, branchOb, branchObs, tagOb, tagObs, search) {\n                    $rootScope.ve_title = orgOb.name;\n                    $scope.org = orgOb;\n                    //$scope.orgs = orgObs;\n                    $scope.project = projectOb;\n                    $scope.projects = projectObs;\n                    $scope.ref = refOb;\n                    $scope.branch = branchOb;\n                    $scope.branches = branchObs;\n                    $scope.tag = tagOb;\n                    $scope.tags = tagObs;\n                    $scope.search = search;\n                }]\n            },\n            'menu@': {\n                template: '<ve-menu mms-org=\"org\" mms-ref=\"ref\" mms-refs=\"refs\" mms-groups=\"groups\" mms-project=\"project\" mms-projects=\"projects\" mms-branch=\"branch\" mms-branches=\"branches\" mms-tag=\"tag\" mms-tags=\"tags\"></ve-menu>',\n                controller: ['$scope', '$rootScope', 'orgOb', 'groupObs', 'projectOb', 'projectObs', 'refOb', 'refObs', 'branchOb', 'branchObs', 'tagOb', 'tagObs', function ($scope, $rootScope, orgOb, groupObs, projectOb, projectObs, refOb, refObs, branchOb, branchObs, tagOb, tagObs) {\n                    $rootScope.ve_title = projectOb.name;\n                    $scope.org = orgOb;\n                    $scope.groups = groupObs;\n                    $scope.project = projectOb;\n                    $scope.projects = projectObs;\n                    $scope.ref = refOb;\n                    $scope.refs = refObs;\n                    $scope.branch = branchOb;\n                    $scope.branches = branchObs;\n                    $scope.tag = tagOb;\n                    $scope.tags = tagObs;\n                }]\n            },\n            'pane-left@': {\n                templateUrl: 'partials/mms/pane-left.html',\n                controller: 'TreeCtrl'\n            },\n            'pane-center@': {\n                templateUrl: 'partials/mms/pane-center.html',\n                controller: 'ViewCtrl'\n            },\n            'pane-right@': {\n                templateUrl: 'partials/mms/pane-right.html',\n                controller: 'ToolCtrl'\n            },\n            'toolbar-right@': {\n                template: '<mms-toolbar buttons=\"buttons\" on-click=\"onClick(button)\" mms-tb-api=\"tbApi\"></mms-toolbar>',\n                controller: 'ToolbarCtrl'\n            }\n        }\n    })\n    .state('project.ref.groupReorder', {\n        url: '/group-reorder',\n        resolve: {\n            documentObs: ['ViewService', '$stateParams', 'ticket', function(ViewService, $stateParams, ticket) {\n                return ViewService.getProjectDocuments({\n                    projectId: $stateParams.projectId,\n                    refId: $stateParams.refId\n                });\n            }]\n        },\n        views: {\n            'pane-center@': {\n                templateUrl: 'partials/mms/reorder-groups.html',\n                controller: 'ReorderGroupCtrl'\n            }\n        }\n    })\n    .state('project.ref.manage', { //not needed right now, for managing mounts\n        url: '/manage'\n    })\n    .state('project.ref.preview', {\n        url: '/document/:documentId',\n        resolve: {\n            documentOb: ['$stateParams', '$q', 'ElementService', 'ViewService', 'refOb', 'ticket', function($stateParams, $q, ElementService, ViewService, refOb, ticket) {\n                var deferred = $q.defer();\n                var eid = $stateParams.documentId;\n                var coverIndex = eid.indexOf('_cover');\n                if (coverIndex > 0) {\n                    var groupId = eid.substring(5, coverIndex);\n                    ElementService.getElement({\n                        projectId: $stateParams.projectId,\n                        refId: $stateParams.refId,\n                        extended: true,\n                        elementId: eid\n                    }, 2).then(function(data) {\n                        deferred.resolve(data);\n                    }, function(reason) {\n                        if (reason.status === 404) {\n                            if (refOb.type === 'Tag') {\n                                deferred.resolve(null);\n                            } else {\n                                var viewDoc = '<mms-group-docs mms-group-id=\"' + groupId + '\">[cf:group docs]</mms-group-docs>';\n                                ElementService.getElement({projectId: $stateParams.projectId, refId: $stateParams.refId, elementId: groupId})\n                                .then(function(groupElement) {\n                                    ViewService.createView({\n                                        _projectId: $stateParams.projectId,\n                                        _refId: $stateParams.refId,\n                                        id: groupId\n                                    },{\n                                        viewName: groupElement.name + ' Cover Page',\n                                        viewId: eid\n                                    }, viewDoc)\n                                    .then(function(data) {\n                                        deferred.resolve(data);\n                                    }, function(reason3) {\n                                        deferred.resolve(null);\n                                    });\n                                }, function(reason2) {\n                                    deferred.resolve(null);\n                                });\n                            }\n                        } else {\n                            deferred.reject(reason);\n                        }\n                    });\n                } else {\n                    ElementService.getElement({\n                        projectId: $stateParams.projectId,\n                        refId: $stateParams.refId,\n                        extended: true,\n                        elementId: $stateParams.documentId\n                    }, 2).then(function(data){\n                        deferred.resolve(data);\n                    }, function(reason) {\n                        deferred.reject(reason);\n                    });\n                }\n                return deferred.promise;\n            }],\n            viewOb: ['documentOb', function(documentOb) {\n                return documentOb;\n            }],\n            groupOb: ['groupObs', 'documentOb', 'ProjectService', 'ticket', function(groupObs, documentOb, ProjectService, ticket) {\n                var group = null;\n                if (documentOb) {\n                    for (var i = 0; i < groupObs.length; i++) {\n                        if (groupObs[i].id == documentOb._groupId) {\n                            group = groupObs[i];\n                            break;\n                        }\n                    }\n                }\n                return group;\n            }]\n        },\n        views: {\n            'menu@': {\n                template: '<ve-menu mms-org=\"org\" mms-ref=\"ref\" mms-refs=\"refs\" mms-group=\"group\" mms-groups=\"groups\" mms-project=\"project\" mms-projects=\"projects\" mms-branch=\"branch\" mms-branches=\"branches\" mms-tag=\"tag\" mms-tags=\"tags\"></ve-menu>',\n                controller: ['$scope', '$rootScope', 'orgOb', 'groupOb', 'groupObs', 'projectOb', 'projectObs', 'refOb', 'refObs', 'branchOb', 'branchObs', 'tagOb', 'tagObs', 'documentOb', function ($scope, $rootScope, orgOb, groupOb, groupObs, projectOb, projectObs, refOb, refObs, branchOb, branchObs, tagOb, tagObs, documentOb) {\n                    $rootScope.ve_title = documentOb.name;\n                    $scope.org = orgOb;\n                    $scope.ref = refOb;\n                    $scope.group = groupOb;\n                    $scope.groups = groupObs;\n                    $scope.project = projectOb;\n                    $scope.projects = projectObs;\n                    $scope.ref = refOb;\n                    $scope.refs = refObs;\n                    $scope.branch = branchOb;\n                    $scope.branches = branchObs;\n                    $scope.tag = tagOb;\n                    $scope.tags = tagObs;\n                }]\n            },\n            'pane-center@': {\n                templateUrl: 'partials/mms/pane-center.html',\n                controller: 'ViewCtrl'\n            },\n            'pane-right@': {\n                templateUrl: 'partials/mms/pane-right.html',\n                controller: 'ToolCtrl'\n            }\n        }\n    })\n    .state('project.ref.document', {\n        url: '/documents/:documentId',\n        resolve: {\n            documentOb: ['$stateParams', 'ElementService', 'ticket', function($stateParams, ElementService, ticket) {\n                return ElementService.getElement({\n                    projectId: $stateParams.projectId,\n                    refId: $stateParams.refId,\n                    extended: true,\n                    elementId: $stateParams.documentId\n                }, 2);\n            }],\n            viewOb: ['documentOb', function(documentOb) {\n                return documentOb;\n            }],\n            groupOb: ['groupObs', 'documentOb', function(groupObs, documentOb) {\n                var group = null;\n                if (documentOb) {\n                    for (var i = 0; i < groupObs.length; i++) {\n                        if (groupObs[i].id == documentOb._groupId) {\n                            group = groupObs[i];\n                            break;\n                        }\n                    }\n                }\n                return group;\n            }],\n            docMeta: ['ViewService', 'documentOb', function(ViewService, documentOb) {\n                return ViewService.getDocMetadata({\n                    projectId: documentOb._projectId,\n                    refId: documentOb._refId,\n                    elementId: documentOb.id\n                });\n            }]\n        },\n        views: {\n            'menu@': {\n                template: '<ve-menu mms-org=\"org\" mms-ref=\"ref\" mms-refs=\"refs\" mms-group=\"group\" mms-groups=\"groups\" mms-project=\"project\" mms-projects=\"projects\" mms-branch=\"branch\" mms-branches=\"branches\" mms-tag=\"tag\" mms-tags=\"tags\" mms-document=\"document\"></ve-menu>',\n                controller: ['$scope', '$rootScope', 'orgOb', 'groupOb', 'groupObs', 'projectOb', 'projectObs', 'refOb', 'refObs', 'branchOb', 'branchObs', 'tagOb', 'tagObs', 'documentOb', function ($scope, $rootScope, orgOb, groupOb, groupObs, projectOb, projectObs, refOb, refObs, branchOb, branchObs, tagOb, tagObs, documentOb) {\n                    $rootScope.ve_title = documentOb.name;\n                    $scope.org = orgOb;\n                    $scope.group = groupOb;\n                    $scope.groups = groupObs;\n                    $scope.project = projectOb;\n                    $scope.projects = projectObs;\n                    $scope.ref = refOb;\n                    $scope.refs = refObs;\n                    $scope.branch = branchOb;\n                    $scope.branches = branchObs;\n                    $scope.tag = tagOb;\n                    $scope.tags = tagObs;\n                    $scope.document = documentOb;\n                }]\n            },\n            'pane-left@': {\n                templateUrl: 'partials/mms/pane-left.html',\n                controller: 'TreeCtrl'\n            },\n            'pane-center@': {\n                templateUrl: 'partials/mms/pane-center.html',\n                controller: 'ViewCtrl'\n            },\n            'pane-right@': {\n                templateUrl: 'partials/mms/pane-right.html',\n                controller: 'ToolCtrl'\n            },\n            'toolbar-right@': {\n                template: '<mms-toolbar buttons=\"buttons\" on-click=\"onClick(button)\" mms-tb-api=\"tbApi\"></mms-toolbar>',\n                controller: 'ToolbarCtrl'\n            }\n        }\n    })\n    .state('project.ref.document.view', {\n        url: '/views/:viewId',\n        resolve: {\n            viewOb: ['$stateParams', 'ElementService', 'ticket', function($stateParams, ElementService, ticket) {\n                return ElementService.getElement({\n                    projectId: $stateParams.projectId,\n                    refId: $stateParams.refId,\n                    elementId: $stateParams.viewId\n                }, 2);\n            }],\n            groupOb: ['groupObs', 'documentOb', function(groupObs, documentOb) {\n                var group = null;\n                if (documentOb) {\n                    for (var i = 0; i < groupObs.length; i++) {\n                        if (groupObs[i].id == documentOb._groupId) {\n                            group = groupObs[i];\n                            break;\n                        }\n                    }\n                }\n                return group;\n            }]\n        },\n        views: {\n            'menu@': {\n                template: '<ve-menu mms-org=\"org\" mms-group=\"group\" mms-groups=\"groups\" mms-project=\"project\" mms-projects=\"projects\" mms-ref=\"ref\" mms-refs=\"refs\" mms-branch=\"branch\" mms-branches=\"branches\" mms-tag=\"tag\" mms-tags=\"tags\" mms-document=\"document\" mms-view=\"view\"></ve-menu>',\n                controller: ['$scope', '$rootScope', 'orgOb', 'groupOb', 'groupObs', 'projectOb', 'projectObs', 'refOb', 'refObs', 'branchOb', 'branchObs', 'tagOb', 'tagObs', 'documentOb', 'viewOb', function ($scope, $rootScope, orgOb, groupOb, groupObs, projectOb, projectObs, refOb, refObs, branchOb, branchObs, tagOb, tagObs, documentOb, viewOb) {\n                    $rootScope.ve_title = documentOb.name;\n                    $scope.org = orgOb;\n                    $scope.group = groupOb;\n                    $scope.groups = groupObs;\n                    $scope.project = projectOb;\n                    $scope.projects = projectObs;\n                    $scope.ref = refOb;\n                    $scope.refs = refObs;\n                    $scope.branch = branchOb;\n                    $scope.branches = branchObs;\n                    $scope.tag = tagOb;\n                    $scope.tags = tagObs;\n                    $scope.document = documentOb;\n                    $scope.view = viewOb;\n                }]\n            },\n            'pane-center@': {\n                templateUrl: 'partials/mms/pane-center.html',\n                controller: 'ViewCtrl'\n            }\n        }\n    })\n    .state('project.ref.document.order', {\n        url: '/order',\n        views: {\n            'pane-center@': {\n                templateUrl: 'partials/mms/reorder-views.html',\n                controller: 'ReorderCtrl'\n            }\n        }\n    })\n    .state('project.ref.document.full', {\n        url: '/full',\n        views: {\n            'pane-center@': {\n                templateUrl: 'partials/mms/full-doc.html',\n                controller: 'FullDocCtrl'\n            }\n        }\n    });\n\n    // anonymous factory intercepts requests\n    $httpProvider.interceptors.push(['$q', '$location', '$rootScope', '$injector', function($q, $location, $rootScope, $injector) {\n        return {\n            'responseError': function(rejection) {\n                if(rejection.status === 401){ //rejection.config.url\n                    $rootScope.$broadcast(\"mms.unauthorized\", rejection);\n                }\n                return $q.reject(rejection);\n            },\n            response: function(response) {\n                if (response.status === 202) {\n                    $rootScope.$broadcast(\"mms.working\", response);\n                }\n                response.status = 501;\n                return response;\n            }\n        };\n    }]);\n\n    $httpProvider.useApplyAsync(true);\n}]);\n","'use strict';\n\n/* Controllers */\n\nangular.module('mmsApp')\n.controller('FullDocCtrl', ['$scope', '$rootScope', '$state', '$anchorScroll', '$location', '$timeout', '$http', 'FullDocumentService', 'ShortenUrlService',\n    'hotkeys', 'growl', '_', 'MmsAppUtils', 'Utils', 'UxService', 'URLService', 'UtilsService', 'search', 'orgOb', 'projectOb', 'refOb', 'groupOb', 'documentOb',\nfunction($scope, $rootScope, $state, $anchorScroll, $location, $timeout, $http, FullDocumentService, ShortenUrlService, hotkeys, growl, _,\n    MmsAppUtils, Utils, UxService, URLService, UtilsService, search, orgOb, projectOb, refOb, groupOb, documentOb) {\n\n    $rootScope.ve_fullDocMode = true;\n    if (!$rootScope.veCommentsOn)\n        $rootScope.veCommentsOn = false;\n    if (!$rootScope.veElementsOn)\n        $rootScope.veElementsOn = false;\n    if (!$rootScope.ve_editmode)\n        $rootScope.ve_editmode = false;\n\n    $scope.search = search;\n    Utils.toggleLeftPane(search);\n    $scope.buttons = [];\n    $scope.refOb = refOb;\n    $scope.projectOb = projectOb;\n    $scope.latestElement = '';\n    $scope.docLibLink = '';\n    $scope.bbApi = {\n        init: function() {\n            if (documentOb && documentOb._editable && refOb.type === 'Branch') {\n                $scope.bbApi.addButton(UxService.getButtonBarButton('show-edits'));\n                $scope.bbApi.setToggleState('show-edits', $rootScope.ve_editmode);\n                hotkeys.bindTo($scope)\n                .add({\n                    combo: 'alt+d',\n                    description: 'toggle edit mode',\n                    callback: function() {$scope.$broadcast('show-edits');}\n                });\n            }\n\n            $scope.bbApi.addButton(UxService.getButtonBarButton('show-elements'));\n            $scope.bbApi.addButton(UxService.getButtonBarButton('show-comments'));\n            $scope.bbApi.addButton(UxService.getButtonBarButton('refresh-numbering'));\n            // $scope.bbApi.addButton(UxService.getButtonBarButton('share-url'));\n            $scope.bbApi.addButton(UxService.getButtonBarButton('print'));\n            var exportButtons = UxService.getButtonBarButton('export');\n            exportButtons.dropdown_buttons.push(UxService.getButtonBarButton(\"convert-pdf\"));\n            $scope.bbApi.addButton(exportButtons);\n            $scope.bbApi.setToggleState('show-comments', $rootScope.veCommentsOn);\n            $scope.bbApi.setToggleState('show-elements', $rootScope.veElementsOn);\n            hotkeys.bindTo($scope)\n            .add({\n                combo: 'alt+c',\n                description: 'toggle show comments',\n                callback: function() {$scope.$broadcast('show-comments');}\n            }).add({\n                combo: 'alt+e',\n                description: 'toggle show elements',\n                callback: function() {$scope.$broadcast('show-elements');}\n            });\n        }\n    };\n    $scope.searchOptions = {\n        emptyDocTxt: 'This field is empty.',\n        searchInput: search,\n        getProperties: true,\n        closeable: true,\n        callback: function(elementOb) {\n            $rootScope.$broadcast('elementSelected', elementOb, 'latest');\n            if ($rootScope.ve_togglePane && $rootScope.ve_togglePane.closed)\n                $rootScope.ve_togglePane.toggle();\n        },\n        relatedCallback: function (doc, view, elem) {//siteId, documentId, viewId) {\n            $state.go('project.ref.document.view', {projectId: doc._projectId, documentId: doc.id, viewId: view.id, refId: doc._refId, search: undefined});\n        }\n    };\n    $scope.views = [];\n    // api to communicate with borderlayout library\n    $scope.scrollApi = {\n        notifyOnScroll: notifyOnScroll,\n        isScrollVisible: function(){}, // pane's directive (in borderlayout) resets this to the right function\n        throttleRate: 500, // how often should the wheel event triggered\n        threshold : 3000, // how far from the bottom of the page before adding more views\n        frequency: 100 // how fast to add more views\n    };\n\n\n    var views = [];\n    var view2children = {};\n    var num = 1;\n    var seenViewIds = {};\n    view2children[documentOb.id] = [];\n    var fullDocumentService;\n    _createViews().then(function() {\n        // The Controller codes get executed before all the directives'\n        // code in its template ( full-doc.html ). As a result, use $timeout here\n        // to let them finish first because in this case\n        // we rely on fa-pane directive to setup isScrollVisible\n        $timeout(function() {\n            fullDocumentService = new FullDocumentService(views);\n            fullDocumentService.addInitialViews($scope.scrollApi.isScrollVisible);\n            $scope.views = fullDocumentService.viewsBuffer;\n        });\n    });\n\n    _initializeDocLibLink();\n\n    $scope.$on('mms-tree-click', function(e, branch) {\n        fullDocumentService.handleClickOnBranch(branch, function() {\n            $location.hash(branch.data.id);\n            $anchorScroll();\n        });\n    });\n\n    $scope.$on('mms-full-doc-view-deleted', function(event, deletedBranch) {\n       fullDocumentService.handleViewDelete(deletedBranch);\n    });\n\n    $scope.$on('mms-new-view-added', function(event, vId, curSec, prevSibId) {\n        fullDocumentService.handleViewAdd(_buildViewElement(vId, curSec), prevSibId);\n    });\n\n    $scope.$on('show-comments', function() {\n        for (var i = 0; i < $scope.views.length; i++) {\n            $scope.views[i].api.toggleShowComments();\n        }\n        $scope.bbApi.toggleButtonState('show-comments');\n        $rootScope.veCommentsOn = !$rootScope.veCommentsOn;\n    });\n\n    $scope.$on('show-elements', function() {\n        for (var i = 0; i < $scope.views.length; i++) {\n            $scope.views[i].api.toggleShowElements();\n        }\n        $scope.bbApi.toggleButtonState('show-elements');\n        $rootScope.veElementsOn = !$rootScope.veElementsOn;\n    });\n\n    $scope.$on('show-edits', function() {\n        var i = 0;\n        if (($rootScope.veElementsOn && $rootScope.ve_editmode) || (!$rootScope.veElementsOn && !$rootScope.ve_editmode) ){\n            for (i = 0; i < $scope.views.length; i++) {\n                $scope.views[i].api.toggleShowElements();\n            }\n            $scope.bbApi.toggleButtonState('show-elements');\n            $rootScope.veElementsOn = !$rootScope.veElementsOn;\n        }\n        $scope.bbApi.toggleButtonState('show-edits');\n        $rootScope.ve_editmode = !$rootScope.ve_editmode;\n        for (i = 0; i < $scope.views.length; i++) {\n            $scope.views[i].api.toggleShowEdits();\n        }\n    });\n\n    $scope.$on('convert-pdf', function() {\n        fullDocumentService.loadRemainingViews(function() {\n            MmsAppUtils.printModal(documentOb, refOb, true, 3)\n            .then(function(ob) {\n                growl.info('Exporting as PDF file. Please wait for a completion email.',{ttl: -1});\n            }, function(reason){\n                growl.error(\"Exporting as PDF file Failed: \" + reason.message);\n            });\n        });\n    });\n\n    $scope.$on('print', function() {\n        fullDocumentService.loadRemainingViews(function() {\n            MmsAppUtils.printModal(documentOb, refOb, true, 1);\n        });\n    });\n\n    $scope.$on('word', function() {\n        fullDocumentService.loadRemainingViews(function() {\n            MmsAppUtils.printModal(documentOb, refOb, true, 2)\n            .then(function(ob) {\n                growl.info('Exporting as Word file. Please wait for a completion email.',{ttl: -1});\n            }, function(reason){\n                growl.error(\"Exporting as Word file Failed: \" + reason.message);\n            });\n        });\n    });\n\n    $scope.$on('tabletocsv', function() {\n        fullDocumentService.loadRemainingViews(function() {\n            MmsAppUtils.tableToCsv(true);\n        });\n    });\n\n    $scope.$on('refresh-numbering', function() {\n        fullDocumentService.loadRemainingViews(function() {\n            MmsAppUtils.refreshNumbering($rootScope.ve_treeApi.get_rows(), angular.element(\"#print-div\"));\n        });\n    });\n\n    // Share URL button settings\n    $scope.dynamicPopover = ShortenUrlService.dynamicPopover;\n    $scope.copyToClipboard = ShortenUrlService.copyToClipboard;\n    $scope.handleShareURL = ShortenUrlService.getShortUrl.bind(null, $location.absUrl(), $scope);\n\n    function _createViews() {\n        var loadingViewsFromServer = growl.info('Loading data from server!', {ttl: -1});\n        views.push({id: documentOb.id, api: {\n            init: function(dis) {\n                if ($rootScope.veCommentsOn) {\n                    dis.toggleShowComments();\n                }\n                if ($rootScope.veElementsOn) {\n                    dis.toggleShowElements();\n                }\n                if ($rootScope.ve_editmode) {\n                    dis.toggleShowEdits();\n                }\n            },\n            elementTranscluded: _elementTranscluded,\n            elementClicked: _elementClicked\n        }});\n        if (!documentOb._childViews) {\n            documentOb._childViews = [];\n        }\n        return MmsAppUtils.handleChildViews(documentOb, 'composite', undefined, projectOb.id, refOb.id, _handleSingleView, _handleChildren)\n            .then(function(childIds) {\n                for (var i = 0; i < childIds.length; i++) {\n                    _constructViews(childIds[i], num);\n                    num = num + 1;\n                }\n            }).finally(loadingViewsFromServer.destroy);\n    }\n\n    function _initializeDocLibLink() {\n        if (groupOb !== null) {\n            $scope.docLibLink = groupOb._link;\n        } else if (documentOb !== null && documentOb._groupId !== undefined && documentOb._groupId !== null) {\n            $scope.docLibLink = '/share/page/repository#filter=path|/Sites/' + orgOb.id + '/documentLibrary/' +\n                projectOb.id + '/' + documentOb._groupId;\n        } else {\n            $scope.docLibLink = '/share/page/repository#filter=path|/Sites/' + orgOb.id + '/documentLibrary/' +\n                projectOb.id;\n        }\n    }\n\n    function _elementTranscluded(elementOb, type) {\n        if (elementOb && type !== 'Comment') {\n            if (elementOb._modified > $scope.latestElement)\n                $scope.latestElement = elementOb._modified;\n        }\n    }\n\n    function _elementClicked(elementOb) {\n        $rootScope.$broadcast('elementSelected', elementOb, 'latest');\n    }\n\n    function _buildViewElement(vId, curSec) {\n        return {id: vId, api: {\n            init: function(dis) {\n                if ($rootScope.veCommentsOn) {\n                    dis.toggleShowComments();\n                }\n                if ($rootScope.veElementsOn) {\n                    dis.toggleShowElements();\n                }\n                if ($rootScope.ve_editmode) {\n                    dis.toggleShowEdits();\n                }\n            },\n            elementTranscluded: _elementTranscluded,\n            elementClicked: _elementClicked\n        }, number: curSec, topLevel: (curSec ? (curSec.toString().indexOf('.') === -1) : false), first: curSec == 1};\n    }\n\n    function _constructViews(viewId, curSection) {\n        views.push(_buildViewElement(viewId, curSection));\n\n        if (view2children[viewId]) {\n            var num = 1;\n            for (var i = 0; i < view2children[viewId].length; i++) {\n                _constructViews(view2children[viewId][i], curSection + '.' + num);\n                num = num + 1;\n            }\n        }\n    }\n\n    function _handleSingleView(v, aggr) {\n        var childIds = view2children[v.id];\n        if (!childIds) {\n            childIds = [];\n        }\n        view2children[v.id] = childIds;\n        if (!v._childViews || v._childViews.length === 0 || aggr === 'none') {\n            return childIds;\n        }\n        for (var i = 0; i < v._childViews.length; i++) {\n            if (seenViewIds[v._childViews[i].id]) {\n                continue;\n            }\n            seenViewIds[v._childViews[i].id] = true;\n            childIds.push(v._childViews[i].id);\n        }\n        return childIds;\n    }\n\n    function _handleChildren(childIds, childNodes) {\n        return childIds;\n    }\n\n    function notifyOnScroll() {\n        return fullDocumentService.handleDocumentScrolling();\n    }\n}]);\n","'use strict';\n\n/* Controllers */\n\nangular.module('mmsApp')\n.controller('MainCtrl', ['$scope', '$timeout', '$location', '$rootScope', '$state', '_', '$window', '$uibModal', 'growl', '$http', 'URLService', 'hotkeys', 'growlMessages', 'StompService', 'UtilsService', 'HttpService', 'AuthService', 'ElementService', 'CacheService', 'ApplicationService', '$interval',\nfunction($scope, $timeout, $location, $rootScope, $state, _, $window, $uibModal, growl, $http, URLService, hotkeys, growlMessages, StompService, UtilsService, HttpService, AuthService, ElementService, CacheService, ApplicationService, $interval) {\n    $rootScope.ve_viewContentLoading = false;\n    $rootScope.ve_treeInitial = '';\n    $rootScope.ve_title = '';\n    $rootScope.ve_footer = '';\n    $rootScope.ve_fn = false;\n\n    var modalOpen = false;\n    var host = $location.host();\n    // if (host.indexOf('europaems') !== -1 || host.indexOf('arrmems') !== -1 || host.indexOf('msmems') !== -1) {\n    //     $rootScope.ve_footer = 'The technical data in this document is controlled under the U.S. Export Regulations, release to foreign persons may require an export authorization.';\n    // }\n    if (host.indexOf('fn') !== -1){\n        $rootScope.ve_footer = 'JPL/Caltech PROPRIETARY  Not for Public Release or Redistribution. No export controlled documents allowed on this server. <a target=\"_blank\" href=\"https://wiki.jpl.nasa.gov/x/GaByE\">More</a>';\n        $rootScope.ve_fn = true;\n    }\n\n    $window.addEventListener('beforeunload', function(event) {\n        if ($rootScope.ve_edits && !_.isEmpty($rootScope.ve_edits)) {\n            var message = 'You may have unsaved changes, are you sure you want to leave?';\n            event.returnValue = message;\n            return message;\n        }\n    });\n\n    hotkeys.bindTo($scope)\n        .add({\n            combo: 'alt+m',\n            description: 'close all messages',\n            callback: function() {growlMessages.destroyAllMessages();}\n        }).add({\n            combo: '@',\n            description: 'fast cf in editor',\n            callback: function() {}\n        });\n\n    $scope.$on('$stateChangeError', function(event, toState, toParams, fromState, fromParams, error) {\n        $rootScope.ve_stateChanging = false;\n        $rootScope.ve_viewContentLoading = false;\n        //check if error is ticket error\n        if (!error || error.status === 401 || \n                (error.status === 404 && error.config && error.config.url && \n                error.config.url.indexOf('/login/ticket') !== -1)) { //check if 404 if checking valid ticket\n            event.preventDefault();\n            $rootScope.ve_redirect = {toState: toState, toParams: toParams};\n            $state.go('login', {notify: false});\n            return;\n        }\n        growl.error('Error: ' + error.message);\n    });\n\n    $rootScope.$on('$stateChangeStart', function(event, toState, toParams, fromState, fromParams){ \n        $rootScope.ve_viewContentLoading = true;\n        HttpService.transformQueue();\n        $rootScope.ve_stateChanging = true;\n    });\n\n    $rootScope.$on(\"mms.unauthorized\", function(event, response) {\n        // add a boolean to the 'or' statement to check for modal window\n        if ($state.$current.name === 'login' || $rootScope.ve_stateChanging || modalOpen)\n            return;\n        AuthService.checkLogin().then(function(){}, function() {\n            if ($state.$current.name === 'login' || modalOpen)\n                return;\n            modalOpen = true;\n            $uibModal.open({\n                template: '<div class=\"modal-header\"><h4>You have been logged out, please login again.</h4></div><div class=\"modal-body\"><form name=\"loginForm\" ng-submit=\"login(credentials)\">' + \n                                '<input type=\"text\" class=\"form-control\" ng-model=\"credentials.username\" placeholder=\"Username\" style=\"margin-bottom: 1.5em;\" autofocus>' + \n                                '<input type=\"password\" class=\"form-control\" ng-model=\"credentials.password\" placeholder=\"Password\" style=\"margin-bottom: 1.5em;\">' + \n                                '<button class=\"btn btn-block btn-primary\" type=\"submit\">LOG IN <span ng-if=\"spin\" ><i class=\"fa fa-spin fa-spinner\"></i>' + \n                            '</span></button></form></div>',\n                scope: $scope,\n                backdrop: 'static',\n                controller: ['$scope', '$uibModalInstance', function ($scope, $uibModalInstance) {\n                    $scope.credentials = {\n                        username: '',\n                        password: ''\n                    };\n                    $scope.spin = false;\n                    $scope.login = function (credentials) {\n                        $scope.spin = true;\n                        var credentialsJSON = {\"username\":credentials.username, \"password\":credentials.password};\n                        AuthService.getAuthorized(credentialsJSON).then(function (user) {\n                            growl.success(\"Logged in\");\n                            $uibModalInstance.dismiss();\n                            // Check if user had changes queued before refreshing page data\n                            // add edits to cache\n                            var edits = $rootScope.ve_edits;\n                            _.map(edits, function(element, key) {\n                                var cacheKey = UtilsService.makeElementKey(element, true);\n                                CacheService.put(cacheKey, element);\n                            });\n                            $state.go($state.current, {}, {reload: true});\n                        }, function (reason) {\n                            $scope.spin = false;\n                            $scope.credentials.password = '';\n                            growl.error(reason.message);\n                        });\n                    };\n                }],\n                size: 'md'\n            }).result.finally(function(){\n                modalOpen = false;\n            });\n        });\n    });\n    // broadcast mms.unauthorized every 10 minutes with interval service\n    $interval(function() {\n        $rootScope.$broadcast(\"mms.unauthorized\");\n    }, 600000, 0, false);\n\n    $rootScope.$on('$stateChangeSuccess', \n        function(event, toState, toParams, fromState, fromParams) {\n            $rootScope.ve_stateChanging = false;\n            $rootScope.hidePanes = false;\n            $rootScope.showManageRefs = false;\n            $rootScope.showLogin = false;\n            if ($state.current.name === 'login' || $state.current.name === 'login.select' || $state.current.name === 'login.redirect') {\n                $rootScope.hidePanes = true;\n                $rootScope.showLogin = true;\n            } else if ( $state.includes('project') && !($state.includes('project.ref')) ) {\n                $rootScope.hidePanes = true;\n                $rootScope.showManageRefs = true;\n                $rootScope.$broadcast('fromParamChange', fromParams);\n            }\n            if ($state.current.name === 'project.ref') {\n                $rootScope.ve_treeInitial = toParams.refId;\n            } else if ($state.current.name === 'project.ref.preview') {\n                var index = toParams.documentId.indexOf('_cover');\n                if (index > 0)\n                    $rootScope.ve_treeInitial = toParams.documentId.substring(5, index);\n                else\n                    $rootScope.ve_treeInitial = toParams.documentId;\n            } else if ($state.includes('project.ref.document') && ($state.current.name !== 'project.ref.document.order')) {\n                if (toParams.viewId !== undefined)\n                    $rootScope.ve_treeInitial = toParams.viewId;\n                else\n                    $rootScope.ve_treeInitial = toParams.documentId;\n            }\n            if ($state.includes('project.ref.document')) {\n                ApplicationService.getState().inDoc = true;\n                ApplicationService.getState().currentDoc = toParams.documentId;\n                if ($state.includes('project.ref.document.full')) {\n                    ApplicationService.getState().fullDoc = true;\n                } else {\n                    ApplicationService.getState().fullDoc = false;\n                }\n            } else {\n                ApplicationService.getState().inDoc = false;\n                ApplicationService.getState().fullDoc = false;\n            }\n            $rootScope.ve_viewContentLoading = false;\n            if ($state.includes('project.ref') && (fromState.name === 'login' || fromState.name === 'login.select' || fromState.name === 'project' || fromState.name === 'login.redirect')) {\n                $timeout(function() {\n                    $rootScope.ve_tree_pane.toggle();\n                    $rootScope.ve_tree_pane.toggle();\n                }, 1, false);\n            }\n        }\n    );\n\n    var workingModalOpen = false;\n    $rootScope.$on('mms.working', function(event, response) {\n        $rootScope.ve_viewContentLoading = false;\n        if (workingModalOpen) {\n            return;\n        }\n        $scope.mmsWorkingTime = response.data;\n        workingModalOpen = true;\n        $uibModal.open({\n            template: \"<div class=\\\"modal-header\\\">Please come back later</div><div class=\\\"modal-body\\\">The document you're requesting has been requested already at {{mmsWorkingTime.startTime | date:'M/d/yy h:mm a'}} and is currently being cached, please try again later.</div>\",\n            scope: $scope,\n            backdrop: true,\n            controller: ['$scope', '$uibModalInstance', function ($scope, $uibModalInstance) {\n                }],\n            size: 'md'\n        }).result.finally(function(){\n            workingModalOpen = false;\n        });\n    });\n\n    $rootScope.$on('element.updated', function(event, element) {\n        //if element is not being edited and there's a cached edit object, update the edit object also\n        //so next time edit forms will show updated data (mainly for stomp updates)\n        var editKey = UtilsService.makeElementKey(element, true);\n        var veEditsKey = element.id + '|' + element._projectId + '|' + element._refId;\n        if ($rootScope.ve_edits && !$rootScope.ve_edits[veEditsKey] && CacheService.exists(editKey)) {\n            ElementService.cacheElement({projectId: element._projectId, refId: element._refId, elementId: element.id, commitId: 'latest'}, JSON.parse(JSON.stringify(element)), true);\n        }\n    });\n}]);\n","'use strict';\n\n/* Controllers */\n    // /workspaces/master/sites/{siteid}                    {siteid}_cover      /projects/{projectid}/master/document/{siteid}_cover\n    // /workspaces/master/sites/{siteid}/document/{docid}   {docid}             /projects/{projectid}/master/document/{docid}\n    // /workspaces/master/sites/{siteid}/documents/{docid}  {docid}             /projects/{projectid}/master/documents/{docid}\n    // /workspaces/master/sites/{siteid}/documents/{docid}/views/{viewid} \n    // (view id might be the same as doc id)\t            {docid},{viewid}\t/projects/{projectid of doc}/master/documents/{docid}/views/{viewid}\n    // if {viewid} not found, go to doc\n    // if {docid} not found but view is found, it might be under a different doc \n    // (see _relatedDocuments of element in search result)\n    // /workspaces/master/sites/{siteid}/documents/{docid}/full\t{docid}\t/projects/{projectid}/master/documents/{docid}/full\n\nangular.module('mmsApp')\n.controller('RedirectCtrl', ['$scope', '$rootScope', '$state', '$location', '$timeout',\n        'ProjectService', 'ElementService', 'growl', \n    function($scope, $rootScope, $state, $location, $timeout, ProjectService, ElementService, growl) {\n        $rootScope.ve_title = 'View Editor'; //what to name this?\n        $scope.redirect_noResults = false;\n        $scope.redirect_element = null;\n        $scope.spin = false;\n\n        $scope.resetSelectPage = function() {\n            $state.go('login.select');\n        };\n\n        var buildQuery = function(idList, projectList) {\n            var queryOb = { 'query': { 'bool':{ \"filter\": [] } } };\n            //Fitler master ref\n            queryOb.query.bool.filter.push({ 'terms' : { 'id' : idList } });\n            //Fitler project id\n            queryOb.query.bool.filter.push({ 'terms' : { '_projectId' : projectList } });\n            //Fitler master ref\n            queryOb.query.bool.filter.push({ 'term' : { '_inRefIds' : 'master' } });\n            return queryOb;\n        };\n\n        var errorHandler = function(reason) {\n            $state.go('login.select');\n        };\n\n        var oldUrlTest = function(location) {\n            var segments = location.split('/');\n            var searchTermList = [], successRedirectFnc = errorHandler;\n            var noResultFnc = function() {\n                // TODO - Search for document was unsucessful. Please select from the following or contact admin to verify that document exists.\n                $scope.redirect_noResults = true;\n            };\n\n            if (segments.length === 5) {\n                if (location.includes('sites')) { //Search for site\n                    searchTermList.push(segments[4]+'_cover');\n                    successRedirectFnc = function(data) {\n                        if ( data.length > 0 ) {\n                            $scope.redirect_element = {name: data[0].name,\n                                type: 'group',\n                                link: \"project.ref.preview({projectId:'\" +data[0]._projectId+ \"',refId:'master',documentId:'\" +data[0].id+ \"'})\"\n                            };\n                            var redirectFnc = function() {\n                                $state.go('project.ref.preview', {projectId: data[0]._projectId, refId: 'master', documentId: data[0].id});\n                            };\n                            $timeout(redirectFnc, 10000);\n                        } else {\n                            noResultFnc();\n                        }\n                    };\n                }\n            } else if (segments.length === 7) { //Search for document\n                if (location.includes('documents')) {\n                    // [\"\", \"workspaces\", \"master\", \"sites\", \"site__18_0_6_eda034b_1489006578377_52061_121780\", \"document\", \"_18_0_6_bec02f9_1489697812908_180368_252005\"]\n                    searchTermList.push(segments[6]);\n                    successRedirectFnc = function(data) {\n                        if ( data.length > 0 ) {\n                            $scope.redirect_element = {name: data[0].name,\n                                type: 'doc',\n                                link: \"project.ref.document({projectId:'\" +data[0]._projectId+ \"',refId:'master',documentId:'\" +data[0].id+ \"'})\"\n                            };\n                            var redirectFnc = function() {\n                                $state.go('project.ref.document', {projectId: data[0]._projectId, refId: 'master', documentId: data[0].id});\n                            };\n                            $timeout(redirectFnc, 10000);\n                        } else {\n                            noResultFnc();\n                        }\n                    };\n                } else if (location.includes('document')) {\n                    searchTermList.push(segments[6]);\n                    successRedirectFnc = function(data) {\n                        if ( data.length > 0 ) {\n                            $scope.redirect_element = {name: data[0].name,\n                                type: 'doc',\n                                link: \"project.ref.preview({projectId:'\" +data[0]._projectId+ \"',refId:'master',documentId:'\" +data[0].id+ \"'})\"\n                            };\n                            var redirectFnc = function() {\n                                $state.go('project.ref.preview', {projectId: data[0]._projectId, refId: 'master', documentId: data[0].id});\n                            };\n                            $timeout(redirectFnc, 10000);\n                        } else {\n                            noResultFnc();\n                        }\n                    };\n                }\n            } else if (segments.length === 9) { //Search for view\n                if (location.includes('views')) {\n                    // [\"\", \"workspaces\", \"master\", \"sites\", \"site__18_0_6_eda034b_1489006578377_52061_121780\", \"documents\", \"_18_0_6_bec02f9_1489697812908_180368_252005\", \"views\", \"MMS_1474405796233_0887698d-1fc7-47ac-87ac-b0f6e7b69d35\"]\n                    if (segments[6] == segments[8]) {\n                        searchTermList.push(segments[6]);\n                        successRedirectFnc = function(data) {\n                            if ( data.length > 0 ) {\n                                $scope.redirect_element = {name: data[0].name,\n                                    type: 'doc',\n                                    link: \"project.ref.document.view({projectId:'\" +data[0]._projectId+ \"',refId:'master',documentId:'\" +data[0].id+ \"',viewId:'\" +data[0].id+ \"'})\"\n                                };\n                                var redirectFnc = function() {\n                                    $state.go('project.ref.document.view', {projectId: data[0]._projectId, refId: 'master', documentId: data[0].id, viewId: data[0].id});\n                                };\n                                $timeout(redirectFnc, 10000);\n                            } else {\n                                noResultFnc();\n                            }\n                        };\n                    } else {\n                        searchTermList.push(segments[6]);\n                        searchTermList.push(segments[8]);\n                        successRedirectFnc = function(data) {\n                            var redirectFnc;\n                            if (data.length > 1) {\n                                if ( data[0].id === segments[6] && data[1].id === segments[8] ) {\n                                    //should check case if data[1] is segent[6] also\n                                    $scope.redirect_element = {name: data[0].name,\n                                        type: 'doc',\n                                        link: \"project.ref.document.view({projectId:'\" +data[0]._projectId+ \"',refId:'master',documentId:'\" +data[0].id+ \"',viewId:'\" +data[1].id+ \"'})\"\n                                    };\n                                    redirectFnc = function() {\n                                        $state.go('project.ref.document.view', {projectId: data[0]._projectId, refId: 'master', documentId: data[0].id, viewId: data[1].id});\n                                    };\n                                } else if ( data[0].id === segments[8] && data[1].id === segments[6] ) {\n                                    //should check case if data[1] is segent[6] also\n                                    $scope.redirect_element = {name: data[0].name,\n                                        type: 'doc',\n                                        link: \"project.ref.document.view({projectId:'\" +data[0]._projectId+ \"',refId:'master',documentId:'\" +data[1].id+ \"',viewId:'\" +data[0].id+ \"'})\"\n                                    };\n                                    redirectFnc = function() {\n                                        $state.go('project.ref.document.view', {projectId: data[0]._projectId, refId: 'master', documentId: data[1].id, viewId: data[0].id});\n                                    };\n                                }\n                                $timeout(redirectFnc, 10000);\n                            } else if (data.length > 0) {\n                                if ( data[0].id === segments[8] ) {\n                                    $scope.elem = data[0];\n                                    $scope.redirect_relatedDocs = data[0]._relatedDocuments;\n                                } else if ( data[0].id === segments[6] ) {\n                                    $scope.redirect_element = {name: data[0].name,\n                                        type: 'doc',\n                                        link: \"project.ref.document({projectId:'\" +data[0]._projectId+ \"',refId:'master',documentId:'\" +data[0].id+ \"'})\"\n                                    };\n                                    redirectFnc = function() {\n                                        $state.go('project.ref.document', {projectId: data[0]._projectId, refId: 'master', documentId: data[0].id});\n                                    };\n                                    $timeout(redirectFnc, 10000);\n                                }\n                            } else {\n                                noResultFnc();\n                            }\n                        };\n                    }\n                }\n            } else if (segments.length === 8) { //Search for full doc\n                if (location.includes('full')) {\n                    searchTermList.push(segments[6]);\n                    successRedirectFnc = function(data) {\n                        if ( data.length > 0 ) {\n                            $scope.redirect_element = {name: data[0].name,\n                                type: 'doc',\n                                link: \"project.ref.document.full({projectId:'\" +data[0]._projectId+ \"',refId:'master',documentId:'\" +data[0].id+ \"'})\"\n                            };\n                            var redirectFnc = function() {\n                                $state.go('project.ref.document.full', {projectId: data[0]._projectId, refId: 'master', documentId: data[0].id});\n                            };\n                            $timeout(redirectFnc, 10000);\n                        } else {\n                            noResultFnc();\n                        }\n                    };\n                }\n            }\n            // console.log(segments);\n            var queryOb = buildQuery(searchTermList, projectList);\n            ElementService.search(reqOb, queryOb)\n            .then(successRedirectFnc, errorHandler);\n        };\n\n        var projectList = [];\n        var reqOb = {};\n        ProjectService.getProjects().then(function(projectObs) {\n            projectList = projectObs.map(function(a) {return a.id;});\n            reqOb = {projectId: projectList[0], refId: 'master'};\n            oldUrlTest($scope.crush_url);\n        });\n}]);","'use strict';\n\n/* Controllers */\n\nangular.module('mmsApp')\n.controller('RefsCtrl', ['$sce', '$q', '$filter', '$location', '$uibModal', '$scope', '$rootScope', '$state', '$timeout', '$window', 'growl', '_', 'flatpickr',\n                         'ElementService', 'ProjectService', 'MmsAppUtils', 'ApplicationService',\n                         'orgOb', 'projectOb', 'refOb', 'refObs', 'tagObs', 'branchObs',\nfunction($sce, $q, $filter, $location, $uibModal, $scope, $rootScope, $state, $timeout, $window, growl, _, flatpickr,\n    ElementService, ProjectService, MmsAppUtils, ApplicationService,\n    orgOb, projectOb, refOb, refObs, tagObs, branchObs) {\n\n    $rootScope.mms_refOb = refOb;\n    $scope.refManageView = true;\n    $scope.refData = [];\n    $scope.bbApi = {};\n    $scope.buttons = [];\n    $scope.branches = branchObs;\n    $scope.tags = tagObs;\n    $scope.activeTab = 0;\n    $scope.refSelected = null;\n    $scope.search = null;\n    $scope.view = null;\n    $scope.fromParams = {};\n\n\n    var selectMasterDefault = function() {\n        var masterIndex = _.findIndex(refObs, {name: 'master'});\n        if (masterIndex > -1) {\n            $scope.fromParams = refObs[masterIndex];\n            $scope.refSelected = refObs[masterIndex];\n        }\n    };\n\n    if (_.isEmpty(refOb)) {\n        selectMasterDefault();\n    } else {\n        $scope.fromParams = refOb;\n        $scope.refSelected = refOb;\n    }\n\n    $scope.htmlTooltip = $sce.trustAsHtml('Branch temporarily unavailable during duplication.');\n    // $scope.htmlTooltip = $sce.trustAsHtml('Branch temporarily unavailable during duplication.<br>Branch author will be notified by email upon completion.');\n    // var refPerm = projectOb && projectOb._editable;\n\n    $scope.addBranch = function(e) {\n        addItem('Branch');\n    };\n    $scope.addTag = function(e) {\n        addItem('Tag');\n    };\n    $scope.deleteRef = function(e) {\n        deleteItem();\n    };\n    $scope.$on('fromParamChange', function(event, fromParams) {\n        var index = _.findIndex(refObs, {name: fromParams.refId});\n        if ( index > -1 ) {\n            $scope.fromParams = refObs[index];\n        }\n    });\n    $scope.$on(\"stomp.branchCreated\", function(event, updateRef, projectId) {\n        growl.success(updateRef.name + \" \" + updateRef.type + \" Created\");\n    });\n\n    $scope.refClickHandler = function(ref) {\n        ProjectService.getRef(ref.id, projectOb.id).then(\n            function(data) {\n                $scope.refSelected = data;\n            },\n            function(error){\n                growl.error(\"Ref click handler error: \" + error );\n                return;\n            }\n        );\n    };\n\n    var addItem = function(itemType) {\n        $scope.itemType = itemType;\n        var branch = $scope.refSelected;\n        var templateUrlStr = \"\";\n\n        // Item specific setup:\n        if (itemType === 'Branch') {\n            if (!branch) {\n                growl.warning(\"Add Branch Error: Select a branch or tag first\");\n                return;\n            }\n            if (branch.type === 'Tag') {\n                $scope.from = 'Tag ' + branch.name;\n            } else {\n                $scope.from = 'Branch ' + branch.name;\n            }\n            $scope.createParentRefId = branch.id;\n            templateUrlStr = 'partials/mms/new-branch.html';\n        } else if (itemType === 'Tag') {\n            if (!branch) {\n                growl.warning(\"Add Tag Error: Select a branch or tag first\");\n                return;\n            }\n            $scope.createParentRefId = branch.id;\n            templateUrlStr = 'partials/mms/new-tag.html';\n        } else {\n            growl.error(\"Add Item of Type \" + itemType + \" is not supported\");\n            return;\n        }\n        // Adds the branch:\n        var instance = $uibModal.open({\n            templateUrl: templateUrlStr,\n            scope: $scope,\n            controller: ['$scope', '$uibModalInstance', '$filter', addItemCtrl]\n        });\n        instance.result.then(function(data) {\n            //TODO add load handling once mms returns status\n            var tag = [];\n            for (var i = 0; i < refObs.length; i++) {\n                if (refObs[i].type === \"Tag\")\n                    tag.push(refObs[i]);\n            }\n            $scope.tags = tag;\n\n            var branches = [];\n            for (var j = 0; j < refObs.length; j++) {\n                if (refObs[j].type === \"Branch\")\n                    branches.push(refObs[j]);\n            }\n            $scope.branches = branches;\n            if (data.type === 'Branch') {\n                //data.loading = true;\n                //$scope.branches.push(data);\n                $scope.refSelected = data;\n                $scope.activeTab = 0;\n            } else {\n                //data.loading = true;\n                //$scope.tags.push(data);\n                $scope.refSelected = data;\n                $scope.activeTab = 1;\n            }\n        });\n    };\n\n    var addItemCtrl = function($scope, $uibModalInstance, $filter) {\n        $scope.createForm = true;\n        $scope.oking = false;\n        var displayName = \"\";\n        // Item specific setup:\n        var now = new Date();\n        if ($scope.itemType === 'Branch') {\n            $scope.branch = {};\n            $scope.branch.name = \"\";\n            $scope.branch.description = \"\";\n            $scope.branch.permission = \"read\";\n            $scope.branch.lastCommit = true;\n            $scope.branch.timestamp = now;\n            displayName = \"Branch\";\n            $scope.updateTimeOpt = function () {\n                $scope.branch.lastCommit = false;\n            };\n        } else if ($scope.itemType === 'Tag') {\n            $scope.tag = {};\n            $scope.tag.name = \"\";\n            $scope.tag.description = \"\";\n            $scope.tag.lastCommit = true;\n            $scope.tag.timestamp = now;\n            displayName = \"Tag\";\n            $scope.updateTimeOpt = function () {\n                $scope.tag.lastCommit = false;\n            };\n        }\n\n        $timeout(function() {\n            flatpickr('.datetimepicker', {\n                enableTime: true,\n                enableSeconds: true,\n                defaultDate: now,\n                dateFormat: 'Y-m-dTH:i:S',\n                time_24hr: true,\n                maxDate: new Date(),\n                onClose: function(selectedDates) {\n                    $scope.$apply(function() {\n                        $scope.updateTimeOpt();\n                        if ($('.datetimepicker#branch').length ) {\n                            $scope.branch.timestamp = selectedDates[0];\n                        } else if($('.datetimepicker#tag').length ) {\n                            $scope.tag.timestamp = selectedDates[0];\n                        }\n                    });\n                }\n            });\n        });\n\n        var handlePromise = function(promise) {\n            promise.then(function(data) {\n                growl.success(displayName + \" is being created.\");\n                // growl.info('Please wait for a completion email prior to viewing of the '+$scope.itemType+'.', {ttl: -1});\n                // refArr.push(refJson);\n                // var storeArr = refArr.toString();\n                // $window.localStorage.setItem('refArr', storeArr); \n                $uibModalInstance.close(data); //need to figure out a way to cache this stuff\n            }, function(reason) {\n                growl.error(\"Create \" + displayName + \" : \" + reason.message);\n            }).finally(function() {\n                $scope.oking = false;\n            });\n        };\n\n        $scope.ok = function() {\n            if ($scope.oking) {\n                growl.info(\"Please wait...\");\n                return;\n            }\n            $scope.oking = true;\n            var promise, ts;\n            // Item specific promise:\n            if ($scope.itemType === 'Branch' && $scope.branch.name !== '') {\n                var branchObj = {\"name\": $scope.branch.name, \"type\": \"Branch\",\n                                \"description\": $scope.branch.description};\n                branchObj.parentRefId = $scope.createParentRefId;\n                branchObj.permission = $scope.branch.permission;\n                branchObj.id = ApplicationService.createUniqueId();\n                if (!$scope.branch.lastCommit) {\n                    // Make call to history?maxTimestamp to get closest commit id to branch off\n                    ts = $filter('date')($scope.branch.timestamp, 'yyyy-MM-ddTHH:mm:ss.sssZ');\n                    ProjectService.getRefHistory(branchObj.parentRefId, projectOb.id, ts)\n                    .then(function(commits) {\n                        branchObj.parentCommitId = commits[0].id;\n                        promise = ProjectService.createRef( branchObj, projectOb.id );\n                        handlePromise(promise);\n                    });\n                } else {\n                    promise = ProjectService.createRef( branchObj, projectOb.id );\n                    handlePromise(promise);\n                }\n            } else if ($scope.itemType === 'Tag' && $scope.tag.name !== '') {\n                var tagObj = {\"name\": $scope.tag.name, \"type\": \"Tag\",\n                                \"description\": $scope.tag.description};\n                tagObj.parentRefId =  $scope.createParentRefId;\n                tagObj.id = ApplicationService.createUniqueId();\n                if (!$scope.tag.lastCommit) {\n                    ts = $filter('date')($scope.tag.timestamp, 'yyyy-MM-ddTHH:mm:ss.sssZ');\n                    ProjectService.getRefHistory(tagObj.parentRefId, projectOb.id, ts)\n                    .then(function(commits) {\n                        tagObj.parentCommitId = commits[0].id;\n                        promise = ProjectService.createRef( tagObj, projectOb.id );\n                        handlePromise(promise);\n                    });\n                } else {\n                    promise = ProjectService.createRef( tagObj, projectOb.id );\n                    handlePromise(promise);\n                }\n            } else {\n                growl.error(\"Add Item of Type \" + $scope.itemType + \" is not supported\");\n                $scope.oking = false;\n                return;\n            }\n        };\n\n        $scope.cancel = function() {\n            $uibModalInstance.dismiss();\n        };\n    };\n\n    var deleteItem = function() {\n        var branch = $scope.refSelected;\n        if (!branch) {\n            growl.warning(\"Select item to delete.\");\n            return;\n        }\n        $scope.deleteBranch = branch;\n        var instance = $uibModal.open({\n            templateUrl: 'partials/mms/confirmDelete.html',\n            scope: $scope,\n            controller: ['$scope', '$uibModalInstance', deleteCtrl]\n        });\n        instance.result.then(function(data) {\n            //TODO $state project with no selected ref\n            var index;\n            if ($scope.refSelected.type === 'Branch') {\n                index = $scope.branches.indexOf($scope.refSelected);\n                $scope.branches.splice(index, 1);\n                selectMasterDefault();\n            } else if ($scope.refSelected.type === 'Tag') {\n                index = $scope.tags.indexOf($scope.refSelected);\n                $scope.tags.splice(index, 1);\n            }\n            $scope.refSelected = null;\n        });\n    };\n\n    var deleteCtrl = function($scope, $uibModalInstance) {\n        $scope.oking = false;\n        var branch = $scope.deleteBranch;\n        if (branch.type === 'Tag') {\n            $scope.type = 'Tag';\n        } else if (branch.type === 'Branch') {\n            $scope.type = 'Branch';\n        }\n        $scope.name = branch.name;\n        $scope.ok = function() {\n            if ($scope.oking) {\n                growl.info(\"Please wait...\");\n                return;\n            }\n            $scope.oking = true;\n            var promise = ProjectService.deleteRef(branch.id, projectOb.id);\n            promise.then(function(data) {\n                growl.success($scope.type + \" Deleted\");\n                $uibModalInstance.close('ok');\n            }, function(reason) {\n                growl.error($scope.type + ' Delete Error: ' + reason.message);\n            }).finally(function() {\n                $scope.oking = false;\n            });\n        };\n\n        $scope.cancel = function() {\n            $uibModalInstance.dismiss();\n        };\n    };\n\n\n}]);\n","'use strict';\n\n/* Controllers */\n\nangular.module('mmsApp')\n.controller('ReorderCtrl', ['$scope', '$rootScope', 'documentOb', 'ElementService', 'ViewService', 'MmsAppUtils', '$state', 'growl', '$q', '_',\nfunction($scope, $rootScope, documentOb, ElementService, ViewService, MmsAppUtils, $state, growl, $q, _) {\n    $scope.doc = documentOb;\n\n    var viewIds2node = {};\n    var origViews = {};\n    viewIds2node[documentOb.id] = {\n        name: documentOb.name,\n        id: documentOb.id,\n        aggr: 'composite',\n        children: []\n    };\n\n    var updateNumber = function(node, curSection, key) {\n        node[key] = curSection;\n        var num = 1;\n        for (var i = 0; i < node.children.length; i++) {\n            updateNumber(node.children[i], curSection + '.' + num, key);\n            num++;\n        }\n    };\n\n    $scope.treeOptions = {\n        dropped : function() {\n            for (var i = 0; i < $scope.tree.length; i++) {\n                var root = $scope.tree[i];\n                root.new = '';\n                var num = 1;\n                for (var j = 0; j < root.children.length; j++) {\n                    updateNumber(root.children[j], num + '', 'new');\n                    num++;\n                }\n            }\n        },\n        accept: function(sourceNodeScope, destNodeScope, destIndex) {\n            if (destNodeScope.$element.hasClass('root'))\n                return false; //don't allow moving to outside doc\n            if (destNodeScope.node.aggr == 'none')\n                return false;\n            return true;\n        }\n    };\n\n    var seenViewIds = {};\n    function handleSingleView(v, aggr, propId) {\n        var curNode = viewIds2node[v.id];\n        if (!curNode) {\n            curNode = {\n                name: v.name,\n                id: v.id,\n                aggr: aggr,\n                propertyId: propId,\n                children: []\n            };\n            viewIds2node[v.id] = curNode;\n        }\n        origViews[v.id] = v;\n        return curNode;\n    }\n\n    function handleChildren(curNode, childNodes) {\n        var newChildNodes = [];\n        for (var i = 0; i < childNodes.length; i++) {\n            var node = childNodes[i];\n            if (seenViewIds[node.id]) {\n                return;\n            }\n            seenViewIds[node.id] = node;\n            newChildNodes.push(node);\n        }\n        curNode.children.push.apply(curNode.children, newChildNodes);\n    }\n\n    MmsAppUtils.handleChildViews(documentOb, 'composite', undefined, documentOb._projectId, \n        documentOb._refId, handleSingleView, handleChildren)\n    .then(function(docNode) {\n        var num = 1;\n        docNode.children.forEach(function(node) {\n            updateNumber(node, num + '', 'old');\n            updateNumber(node, num + '', 'new');\n            num++;\n        });\n        $scope.tree = [docNode];\n    });\n\n    $scope.saveClass = \"\";\n    var saving = false;\n    $scope.save = function() {\n        if (saving) {\n            growl.info(\"please wait\");\n            return;\n        }\n        if ($scope.tree.length > 1 || $scope.tree[0].id !== documentOb.id) {\n            growl.error('Views cannot be re-ordered outside the context of the current document.');\n            return;\n        }\n        saving = true;\n        $scope.saveClass = \"fa fa-spin fa-spinner\";\n        var toSave = [];\n        angular.forEach(viewIds2node, function(node, id) {\n            if (node.aggr == 'none') {//cannot process views whose aggr is none since their children are not shown\n                return;\n            }\n            var childViews = [];\n            for (var i = 0; i < node.children.length; i++) {\n                childViews.push({\n                    id: node.children[i].id, \n                    aggregation: node.children[i].aggr,\n                    propertyId: node.children[i].propertyId\n                });\n            }\n            var orig = origViews[id];\n            if (((!orig._childViews || orig._childViews.length === 0) && childViews.length > 0) ||\n                (orig._childViews && !angular.equals(orig._childViews, childViews))) {\n                toSave.push({\n                    id: id,\n                    //name: orig.name,\n                    _childViews: childViews,\n                    _projectId: orig._projectId,\n                    _refId: orig._refId,\n                    type: orig.type\n                });\n            }\n        });\n        if (toSave.length === 0) {\n            growl.info(\"No changes to save!\");\n            saving = false;\n            $scope.saveClass = \"\";\n            return;\n        }\n        ElementService.updateElements(toSave, true)\n        .then(function() {\n            growl.success('Reorder Successful');\n            navigate(true);\n        }, function(response) {\n            var reason = response.failedRequests[0];\n            var errorMessage = reason.message;\n            if (reason.status === 409) {\n                growl.error(\"There's a conflict in the views you're trying to change!\");\n            } else {\n                growl.error(errorMessage);\n            }\n        }).finally(function() {\n            $scope.saveClass = \"\";\n            saving = false;\n        });\n    };\n    \n    $scope.cancel = function() {\n        navigate(false);\n    };\n\n    function navigate(reload) {\n        var curBranch = $rootScope.ve_treeApi.get_selected_branch();\n        if (!curBranch) {\n            $state.go('project.ref.document', {}, {reload:true});\n        } else {\n            var goToId = curBranch.data.id;\n            if (curBranch.type !== 'section' && curBranch.type !== 'view') {\n                goToId = curBranch.viewId;\n            }\n            $state.go('project.ref.document.view', {viewId: goToId}, {reload: reload});\n        }\n    }\n}]);\n","'use strict';\n\nangular.module('mmsApp')\n.controller('ReorderGroupCtrl', ['$scope', '$rootScope', '$stateParams', '$state', 'growl', '_', 'ElementService', 'CacheService', 'projectOb', 'refOb', 'groupObs', 'documentObs',\n\nfunction ($scope, $rootScope, $stateParams, $state, growl, _, ElementService, CacheService, projectOb, refOb, groupObs, documentObs) {\n    $scope.isSaving = false;\n    $scope.targetId = '';\n    $scope.treeOptions = {\n        dropped: function (change) {\n            sortRecursively(children);\n            $scope.targetId = '';\n        },\n        accept: function (sourceNodeScope, destNodeScope, destIndex) {\n            // allow moving to the root or to a group\n            var accept = destNodeScope.node && ( destNodeScope.node.type === 'group' || destNodeScope.node.type === 'root' );\n            if (accept) {\n                if(destNodeScope.$nodeScope && destNodeScope.$nodeScope.$modelValue && destNodeScope.$nodeScope.$modelValue.id) {\n                    $scope.targetId = destNodeScope.$nodeScope.$modelValue.id;\n                }\n            }\n            return accept;\n        },\n        dragStart: function(data) {\n            $scope.targetId = data.dest.nodesScope.$nodeScope.$modelValue.id;\n        }\n    };\n    $scope.saveReorder = saveReorder;\n    $scope.cancelReorder = cancelReorder;\n\n    var children = generateTree();\n    sortRecursively(children);\n    var root = createNode('Top Level', 'root', children, {id: 'root'});\n    $scope.tree = [root];\n\n    function generateTree() {\n        // create a node for each groupOb\n        var tree = groupObs.map(function (groupOb) {\n            return createNode(groupOb.name, 'group', [], groupOb);\n        });\n\n        // add document to its group\n        documentObs\n            .filter(function (documentOb) {\n                return documentOb._groupId;\n            })\n            .forEach(function (documentOb) {\n                var parent = _.find(tree, function (node) {\n                    return node.data.id === documentOb._groupId;\n                });\n                if (parent) {\n                    parent.children.push(createNode(documentOb.name, 'view', [], documentOb));\n                }\n            });\n\n        // for any group that has a parent group, establish that connection\n        tree.forEach(function (groupNode) {\n            var foundParent = _.find(tree, function (node) {\n                return node.data.id === groupNode.data._parentId;\n            });\n            if (foundParent) {\n                groupNode.isChild = true;\n                foundParent.children.push(groupNode);\n            }\n            return groupNode;\n        });\n\n        // only groups that don't have parents show up at root level\n        tree = tree.filter(function (groupNode) {\n            return !groupNode.isChild;\n        });\n\n        // add all the documents that don't belong to any group\n        documentObs\n            .filter(function (documentOb) {\n                return !documentOb._groupId;\n            })\n            .forEach(function (documentOb) {\n                tree.push(createNode(documentOb.name, 'view', [], documentOb));\n            });\n        return tree;\n    }\n\n    function createNode(name, type, children, data) {\n        return {name: name, type: type, children: children, data: data, id: data.id};\n    }\n\n    function cancelReorder() {\n        navigateAway(false);\n    }\n\n    function saveReorder() {\n        if(!$scope.isSaving) {\n            $scope.isSaving = true;\n            var results = []; findNodesToUpdate(results);\n            var elementsToUpdate = results.map(function(result) {\n               return {\n                   id: result.node.data.id,\n                   ownerId: result.newOwnerId,\n                   _projectId: projectOb.id,\n                   _refId: refOb.id\n               };\n            });\n            ElementService\n                .updateElements(elementsToUpdate, false)\n                .then(function() { cleanupCache(results); navigateAway(true); })\n                .catch(function() { growl.error('Failed to save the grouping!'); })\n                .finally(function() { $scope.isSaving = false; });\n        } else {\n            growl.info(\"please wait\");\n        }\n    }\n\n    function findNodesToUpdate(result) {\n        // ignore root\n        var root = $scope.tree[0];\n        root.children.forEach(function(node) {\n            // handle node change at the root level\n            if ( (node.type === 'group' && node.data._parentId) || (node.type === 'view' && node.data._groupId) ) {\n                result.push({node: node, newOwnerId: 'holding_bin_' + projectOb.id });\n            }\n\n            // handle change at lower level\n            helper(node, result);\n        });\n\n        function helper(node, result) {\n            node.children.forEach(function (childNode) {\n                if ((childNode.type === 'group' && childNode.data._parentId !== node.data.id) || (childNode.type === 'view' && childNode.data._groupId !== node.data.id)) {\n                    result.push({node: childNode, newOwnerId: node.data.id});\n                }\n                helper(childNode, result);\n            });\n        }\n    }\n\n    function cleanupCache(results) {\n        // update cache for documents list and groups list\n        var listOfDocInCache = CacheService.get(['documents', projectOb.id, refOb.id]);\n        var listOfGroupInCache = CacheService.get(['groups', projectOb.id, refOb.id]);\n        results.forEach(function(result) {\n            // for group or document that is moved to the root, _parentId for \"group\" and _groupId for \"document\" need to be set to undefined\n            var newOwnerId = result.newOwnerId.indexOf(projectOb.id) !== -1 ? undefined : result.newOwnerId;\n\n            if (result.node.type === 'group') {\n                var cacheGroupOb =_.find(listOfGroupInCache, function(groupOb) {\n                    return groupOb.id === result.node.data.id;\n                });\n                if (cacheGroupOb) {\n                    cacheGroupOb._parentId = newOwnerId;\n                }\n            } else if (result.node.type === 'view') {\n                var cacheDocument =_.find(listOfDocInCache, function(documentOb) {\n                    return documentOb.id === result.node.data.id;\n                });\n                if(cacheDocument) {\n                    cacheDocument._groupId = newOwnerId;\n                }\n            }\n        });\n    }\n\n    function comparator(a, b) {\n        if (a.type === b.type) {\n            return a.name.localeCompare(b.name);\n        } else {\n            if (a.type === 'group') {\n                return -1;\n            } else {\n                return 1;\n            }\n        }\n    }\n\n    function sortRecursively(nodes) {\n        nodes.sort(comparator);\n        nodes.forEach(function (node) {\n            sortRecursively(node.children);\n        });\n    }\n\n    function navigateAway(reload) {\n        var curBranch = $rootScope.ve_treeApi.get_selected_branch();\n        if (curBranch) {\n            var documentId = curBranch.type === 'group' ? 'site_' + curBranch.data.id + '_cover' : curBranch.data.id;\n            $state.go('project.ref.preview', {documentId: documentId}, {reload: reload});\n        } else {\n            $state.go('project.ref', {}, {reload: reload});\n        }\n    }\n}]);\n","'use strict';\n\n/* Controllers */\n\nangular.module('mmsApp')\n.controller('ToolCtrl', ['$scope', '$rootScope', '$state', '$uibModal', '$q', '$timeout', 'hotkeys',\n            'ElementService', 'JobService', 'ProjectService', 'growl', 'projectOb', 'refOb', 'tagObs', 'branchObs', 'documentOb', 'viewOb', 'Utils',\nfunction($scope, $rootScope, $state, $uibModal, $q, $timeout, hotkeys,\n    ElementService, JobService, ProjectService, growl, projectOb, refOb, tagObs, branchObs, documentOb, viewOb, Utils) {\n\n    $scope.specInfo = {\n        refId: refOb.id,\n        commitId: 'latest',\n        projectId: projectOb.id,\n        id: null\n    };\n    $scope.projectOb = projectOb;\n    $scope.editable = documentOb && documentOb._editable && refOb.type === 'Branch';\n    $scope.viewOb = viewOb;\n    $scope.documentOb = documentOb;\n    $scope.refOb = refOb;\n    $scope.tagObs = tagObs;\n    $scope.branchObs = branchObs;\n\n    if (viewOb) {\n        $scope.specInfo.id = viewOb.id;\n        $scope.viewId = viewOb.id;\n    } else if (documentOb) {\n        $scope.specInfo.id = documentOb.id;\n        $scope.viewId = documentOb.id;\n    }\n\n    $scope.specApi = {};\n    $scope.viewContentsOrderApi = {};\n    $rootScope.ve_togglePane = $scope.$pane;\n\n    $scope.show = {\n        element: true,\n        history: false,\n        tags: false,\n        reorder: false,\n        jobs: false\n    };\n    $scope.tracker = {};\n    if (!$rootScope.ve_edits)\n        $rootScope.ve_edits = {};\n\n    // Set edit count for tracker view\n    $scope.veEditsLength = function() {\n        return Object.keys($rootScope.ve_edits).length;\n    };\n\n    $scope.etrackerChange = function() {\n        $scope.specApi.keepMode();\n        var id = $scope.tracker.etrackerSelected;\n        if (!id)\n            return;\n        var info = id.split('|');\n        $scope.specInfo.id = info[0];\n        $scope.specInfo.projectId = info[1];\n        $scope.specInfo.refId = info[2];\n        $scope.specInfo.commitId = 'latest';\n        $rootScope.ve_tbApi.setPermission('element-editor', true);\n    };\n\n    var showPane = function(pane) {\n        angular.forEach($scope.show, function(value, key) {\n            if (key === pane)\n                $scope.show[key] = true;\n            else\n                $scope.show[key] = false;\n        });\n    };\n\n    // Check edit count and toggle appropriate save all and edit/edit-asterisk buttons\n    var cleanUpSaveAll = function() {\n        if ($scope.veEditsLength() > 0) {\n            $rootScope.ve_tbApi.setPermission('element-editor-saveall', true);\n            $rootScope.ve_tbApi.setIcon('element-editor', 'fa-edit-asterisk');\n        } else {\n            $rootScope.ve_tbApi.setPermission('element-editor-saveall', false);\n            $rootScope.ve_tbApi.setIcon('element-editor', 'fa-edit');\n        }\n    };\n\n    $scope.$on('jobs', function() {\n        showPane('jobs');\n    });\n\n    $scope.$on('element-history', function() {\n        showPane('history');\n    });\n\n    $scope.$on('tags', function() {\n        showPane('tags');\n    });\n\n    $scope.$on('gotoTagsBranches', function(){\n        $rootScope.ve_tbApi.select('tags');\n        showPane('tags');\n    });\n\n    var cleanUpEdit = function(editOb, cleanAll) {\n        if (!Utils.hasEdits(editOb) || cleanAll) {\n            var key = editOb.id + '|' + editOb._projectId + '|' + editOb._refId;\n            delete $rootScope.ve_edits[key];\n            cleanUpSaveAll();\n        }\n    };\n\n    $scope.$on('presentationElem.edit', function(event, editOb) {\n        var key = editOb.id + '|' + editOb._projectId + '|' + editOb._refId;\n        $rootScope.ve_edits[key] = editOb;\n        cleanUpSaveAll();\n    });\n\n    $scope.$on('presentationElem.save', function(event, editOb) {\n        cleanUpEdit(editOb, true);\n    });\n\n    $scope.$on('presentationElem.cancel', function(event, editOb) {\n        cleanUpEdit(editOb);\n    });\n\n    var elementSelected = function(event, elementOb, commitId, displayOldContent) {\n        $scope.specInfo.id = elementOb.id;\n        $scope.specInfo.projectId = elementOb._projectId;\n        $scope.specInfo.refId = elementOb._refId;\n        $scope.specInfo.commitId = commitId ? commitId : elementOb._commitId;\n        $scope.specInfo.mmsDisplayOldContent = displayOldContent;\n        if($scope.show.element) {\n            $rootScope.ve_tbApi.select('element-viewer');\n        }\n        if ($scope.specApi.setEditing) {\n            $scope.specApi.setEditing(false);\n        }\n        var editable = elementOb._editable && $scope.refOb.type === 'Branch' && commitId === 'latest' ;\n        $rootScope.ve_tbApi.setPermission('element-editor', editable);\n        $rootScope.$digest();\n    };\n    $scope.$on('elementSelected', elementSelected);\n    $scope.$on('element-viewer', function() {\n        $scope.specApi.setEditing(false);\n        cleanUpSaveAll();\n        showPane('element');\n    });\n    $scope.$on('element-editor', function() {\n        $scope.specApi.setEditing(true);\n        showPane('element');\n        var editOb = $scope.specApi.getEdits();\n        if (editOb) {\n            var key = editOb.id + '|' + editOb._projectId + '|' + editOb._refId;\n            $scope.tracker.etrackerSelected = key;\n            $rootScope.ve_edits[key] = editOb;\n            cleanUpSaveAll();\n        }\n        ElementService.isCacheOutdated(editOb)\n        .then(function(data) {\n            if (data.status && data.server._modified > data.cache._modified)\n                growl.error('This element has been updated on the server. Please refresh the page to get the latest version.');\n        });\n    });\n    $scope.$on('viewSelected', function(event, elementOb, commitId) {\n        elementSelected(event, elementOb, commitId);\n        $scope.viewOb = elementOb;\n        var editable = elementOb._editable && $scope.refOb.type === 'Branch' && commitId === 'latest';\n        $scope.viewCommitId = commitId ? commitId : elementOb._commitId;\n        $rootScope.ve_tbApi.setPermission('view-reorder', editable);\n    });\n\n    $scope.$on('view-reorder.refresh', function() {\n        $scope.viewContentsOrderApi.refresh();\n    });\n\n    $scope.$on('view-reorder', function() {\n        $scope.viewContentsOrderApi.setEditing(true);\n        showPane('reorder');\n    });\n\n    var elementSaving = false;\n    $scope.$on('element-editor-save', function() {\n        save(false);\n    });\n    $scope.$on('element-editor-saveC', function() {\n        save(true);\n    });\n    var save = function(continueEdit) {\n        if (elementSaving) {\n            growl.info('Please Wait...');\n            return;\n        }\n        var edit = $scope.specApi.getEdits();\n        Utils.clearAutosaveContent(edit._projectId + edit._refId + edit.id, edit.type);\n        elementSaving = true;\n        if (!continueEdit)\n            $rootScope.ve_tbApi.toggleButtonSpinner('element-editor-save');\n        else\n            $rootScope.ve_tbApi.toggleButtonSpinner('element-editor-saveC');\n        $timeout(function() {\n        $scope.specApi.save().then(function(data) {\n            elementSaving = false;\n            growl.success('Save Successful');\n            if (continueEdit)\n                return;\n            var edit = $scope.specApi.getEdits();\n            var key = edit.id + '|' + edit._projectId + '|' + edit._refId;\n            delete $rootScope.ve_edits[key];\n            if (Object.keys($rootScope.ve_edits).length > 0) {\n                var next = Object.keys($rootScope.ve_edits)[0];\n                var id = next.split('|');\n                $scope.tracker.etrackerSelected = next;\n                $scope.specApi.keepMode();\n                $scope.specInfo.id = id[0];\n                $scope.specInfo.projectId = id[1];\n                $scope.specInfo.refId = id[2];\n                $scope.specInfo.commitId = 'latest';\n            } else {\n                $scope.specApi.setEditing(false);\n                $rootScope.ve_tbApi.select('element-viewer');\n                cleanUpSaveAll();\n            }\n        }, function(reason) {\n            elementSaving = false;\n            if (reason.type === 'info')\n                growl.info(reason.message);\n            else if (reason.type === 'warning')\n                growl.warning(reason.message);\n            else if (reason.type === 'error')\n                growl.error(reason.message);\n        }).finally(function() {\n            if (!continueEdit)\n                $rootScope.ve_tbApi.toggleButtonSpinner('element-editor-save');\n            else\n                $rootScope.ve_tbApi.toggleButtonSpinner('element-editor-saveC');\n        });\n        }, 1000, false);\n        $rootScope.ve_tbApi.select('element-editor');\n    };\n\n    hotkeys.bindTo($scope)\n    .add({\n        combo: 'alt+a',\n        description: 'save all',\n        callback: function() {$scope.$broadcast('element-editor-saveall');}\n    });\n    var savingAll = false;\n    $scope.$on('element-editor-saveall', function() {\n        if (savingAll) {\n            growl.info('Please wait...');\n            return;\n        }\n        var ve_edits = $rootScope.ve_edits;\n        if (Object.keys(ve_edits).length === 0) {\n            growl.info('Nothing to save');\n            return;\n        }\n\n        Object.values(ve_edits).forEach(function(ve_edit) {\n           Utils.clearAutosaveContent(ve_edit._projectId + ve_edit._refId + ve_edit.id, ve_edit.type);\n        });\n\n        if ($scope.specApi && $scope.specApi.editorSave)\n            $scope.specApi.editorSave();\n        savingAll = true;\n        $rootScope.ve_tbApi.toggleButtonSpinner('element-editor-saveall');\n        ElementService.updateElements(Object.values($rootScope.ve_edits))\n            .then(function(responses) {\n                responses.forEach(function(elementOb) {\n                    delete $rootScope.ve_edits[elementOb.id + '|' + elementOb._projectId + '|' + elementOb._refId];\n                    $rootScope.$broadcast('element.updated', elementOb, false);\n                    $rootScope.ve_tbApi.select('element-viewer');\n                    $scope.specApi.setEditing(false);\n                });\n                growl.success(\"Save All Successful\");\n\n            }, function(responses) {\n                // reset the last edit elementOb to one of the existing element\n                var elementToSelect = Object.values($rootScope.ve_edits)[0];\n                $scope.tracker.etrackerSelected = elementToSelect.id + '|' + elementToSelect._projectId + '|' + elementToSelect._refId;\n                $scope.specApi.keepMode();\n                $scope.specInfo.id = elementToSelect.id;\n                $scope.specInfo.projectId = elementToSelect._projectId;\n                $scope.specInfo.refId = elementToSelect._refId;\n                $scope.specInfo.commitId = 'latest';\n                growl.error(\"Some elements failed to save, resolve individually in edit pane\");\n\n            }).finally(function() {\n                $rootScope.ve_tbApi.toggleButtonSpinner('element-editor-saveall');\n                savingAll = false;\n                cleanUpSaveAll();\n                if (Object.keys($rootScope.ve_edits).length === 0) {\n                    $rootScope.ve_tbApi.setIcon('element-editor', 'fa-edit');\n                }\n            });\n    });\n    $scope.$on('element-editor-cancel', function() {\n        var go = function() {\n            var edit = $scope.specApi.getEdits();\n            delete $rootScope.ve_edits[edit.id + '|' + edit._projectId + '|' + edit._refId];\n            $scope.specApi.revertEdits();\n            if (Object.keys($rootScope.ve_edits).length > 0) {\n                var next = Object.keys($rootScope.ve_edits)[0];\n                var id = next.split('|');\n                $scope.tracker.etrackerSelected = next;\n                $scope.specApi.keepMode();\n                $scope.specInfo.id = id[0];\n                $scope.specInfo.projectId = id[1];\n                $scope.specInfo.refId = id[2];\n                $scope.specInfo.commitId = 'latest';\n            } else {\n                $scope.specApi.setEditing(false);\n                $rootScope.ve_tbApi.select('element-viewer');\n                $rootScope.ve_tbApi.setIcon('element-editor', 'fa-edit');\n                cleanUpSaveAll();\n            }\n        };\n        if ($scope.specApi.hasEdits()) {\n            var instance = $uibModal.open({\n                templateUrl: 'partials/mms/cancelConfirm.html',\n                scope: $scope,\n                controller: ['$scope', '$uibModalInstance', function($scope, $uibModalInstance) {\n                    $scope.ok = function() {\n                        var edit = $scope.specApi.getEdits();\n                        Utils.clearAutosaveContent(edit._projectId + edit._refId + edit.id, edit.type);\n\n                        $uibModalInstance.close('ok');\n                    };\n                    $scope.cancel = function() {\n                        $uibModalInstance.dismiss();\n                    };\n                }]\n            });\n            instance.result.then(function() {\n                go();\n            });\n        } else\n            go();\n    });\n    var viewSaving = false;\n    $scope.$on('view-reorder-save', function() {\n        if (viewSaving) {\n            growl.info('Please Wait...');\n            return;\n        }\n        viewSaving = true;\n        $rootScope.ve_tbApi.toggleButtonSpinner('view-reorder-save');\n        $scope.viewContentsOrderApi.save().then(function(data) {\n            viewSaving = false;\n            $scope.viewContentsOrderApi.refresh();\n            growl.success('Save Succesful');\n            $rootScope.ve_tbApi.toggleButtonSpinner('view-reorder-save');\n            $rootScope.$broadcast('view.reorder.saved', $scope.viewOb.id);\n        }, function(response) {\n            $scope.viewContentsOrderApi.refresh();\n            viewSaving = false;\n            var reason = response.failedRequests[0];\n            growl.error(reason.message);\n            $rootScope.ve_tbApi.toggleButtonSpinner('view-reorder-save');\n        });\n        $rootScope.ve_tbApi.select('view-reorder');\n    });\n    $scope.$on('view-reorder-cancel', function() {\n        $scope.specApi.setEditing(false);\n        $scope.viewContentsOrderApi.refresh();\n        $rootScope.ve_tbApi.select('element-viewer');\n        showPane('element');\n    });\n}]);\n","'use strict';\n\n/* Controllers */\n\nangular.module('mmsApp')\n.controller('ToolbarCtrl', ['$scope', '$rootScope', '$state', 'UxService', 'refOb', 'documentOb', \nfunction($scope, $rootScope, $state, UxService, refOb, documentOb) {\n\n    var tbApi = {};\n    $scope.tbApi = tbApi;\n    $scope.buttons = [];\n\n    // TODO: Manage rootScope in controllers, for now set/get in one area of the code\n    // Set MMS $rootScope variables\n    $rootScope.ve_tbApi = tbApi;\n\n    tbApi.init = function()\n    {\n        tbApi.addButton(UxService.getToolbarButton(\"element-viewer\"));\n        tbApi.addButton(UxService.getToolbarButton(\"element-editor\"));\n        if ($rootScope.ve_edits && Object.keys($rootScope.ve_edits).length > 0) {\n            tbApi.setIcon('element-editor', 'fa-edit-asterisk');\n            tbApi.setPermission('element-editor-saveall', true);\n        }\n        var editable = false;\n        tbApi.addButton(UxService.getToolbarButton(\"element-history\"));\n        tbApi.addButton(UxService.getToolbarButton(\"tags\"));\n        // if ($state.includes('project.ref.document')) {\n            tbApi.addButton(UxService.getToolbarButton(\"jobs\"));\n        // }\n        if ($state.includes('project.ref') && !$state.includes('project.ref.document')) {\n            editable = documentOb._editable && refOb.type === 'Branch';\n            tbApi.setPermission('element-editor', editable);\n            if ($state.includes('project.ref.preview')) {\n                tbApi.addButton(UxService.getToolbarButton(\"view-reorder\"));\n                tbApi.setPermission(\"view-reorder\", editable);\n            }\n        } else if ($state.includes('project.ref.document')) {\n            editable = documentOb._editable && refOb.type === 'Branch';\n            tbApi.addButton(UxService.getToolbarButton(\"view-reorder\"));\n            tbApi.setPermission('element-editor', editable);\n            tbApi.setPermission(\"view-reorder\", editable);\n        }\n    };\n}]);","'use strict';\n\n/* Controllers */\n\nangular.module('mmsApp')\n.controller('TreeCtrl', ['$anchorScroll' , '$q', '$filter', '$location', '$uibModal', '$scope', '$rootScope', '$state','$timeout', 'growl',\n                          'UxService', 'ElementService', 'UtilsService', 'ViewService', 'ProjectService', 'MmsAppUtils', 'documentOb', 'viewOb',\n                          'orgOb', 'projectOb', 'refOb', 'refObs', 'groupObs', 'docMeta',\nfunction($anchorScroll, $q, $filter, $location, $uibModal, $scope, $rootScope, $state, $timeout, growl,\n    UxService, ElementService, UtilsService, ViewService, ProjectService, MmsAppUtils, documentOb, viewOb,\n    orgOb, projectOb, refOb, refObs, groupObs, docMeta) {\n\n    $scope.filterInputPlaceholder = 'Filter groups/docs';\n    if ($state.includes('project.ref.document')) {\n        $scope.filterInputPlaceholder = 'Filter table of contents';\n    }\n\n    $rootScope.mms_refOb = refOb;\n    $rootScope.ve_bbApi = $scope.bbApi = {};\n    $scope.tbApi = {};\n    $rootScope.ve_treeApi = $scope.treeApi = {};\n    $rootScope.ve_tree_pane = $scope.$pane;\n    if (!$rootScope.veTreeShowPe) {\n        $rootScope.veTreeShowPe = false;\n    }\n    $scope.buttons = [];\n    $scope.treeButtons = [];\n    $scope.projectOb = projectOb;\n    $scope.refOb = refOb;\n\n    $rootScope.ve_fullDocMode = false;\n    if ($state.includes('project.ref.document.full')) {\n        $rootScope.ve_fullDocMode = true;\n    }\n    var docEditable = documentOb && documentOb._editable && refOb && refOb.type === 'Branch' && UtilsService.isView(documentOb);\n\n    $scope.tbApi.init = function() {\n        if ($state.includes('project.ref.document')) {\n            var viewModeButton = UxService.getButtonBarButton(\"view-mode-dropdown\");\n            $scope.tbApi.addButton(viewModeButton);\n            $scope.tbApi.select(viewModeButton, $rootScope.veTreeShowPe ? UxService.getButtonBarButton('tree-show-pe') : UxService.getButtonBarButton('tree-show-views'));\n        }\n    };\n    \n    $scope.bbApi.init = function() {\n        $scope.bbApi.addButton(UxService.getButtonBarButton(\"tree-expand\"));\n        $scope.bbApi.addButton(UxService.getButtonBarButton(\"tree-collapse\"));\n        if ($state.includes('project.ref') && !$state.includes('project.ref.document')) {\n            $scope.bbApi.addButton(UxService.getButtonBarButton(\"tree-reorder-group\"));\n            $scope.bbApi.setPermission(\"tree-reorder-group\", projectOb && projectOb._editable);\n            $scope.bbApi.addButton(UxService.getButtonBarButton(\"tree-add-document-or-group\"));\n            $scope.bbApi.addButton(UxService.getButtonBarButton(\"tree-delete-document\"));\n            $scope.bbApi.setPermission( \"tree-add-document-or-group\", documentOb._editable && (refOb.type === 'Tag' ? false : true) );\n            $scope.bbApi.setPermission( \"tree-delete-document\", documentOb._editable &&  (refOb.type === 'Tag' ? false : true) );\n        } else if ($state.includes('project.ref.document')) {\n            // $scope.tbApi.addButton(UxService.getButtonBarButton(\"view-mode-dropdown\"));\n            //$scope.bbApi.setToggleState('tree-show-pe', $rootScope.veTreeShowPe);\n            $scope.bbApi.addButton(UxService.getButtonBarButton(\"tree-reorder-view\"));\n            $scope.bbApi.addButton(UxService.getButtonBarButton(\"tree-full-document\"));\n            $scope.bbApi.addButton(UxService.getButtonBarButton(\"tree-add-view\"));\n            $scope.bbApi.addButton(UxService.getButtonBarButton(\"tree-delete-view\"));\n            $scope.bbApi.setPermission(\"tree-add-view\", docEditable);\n            $scope.bbApi.setPermission(\"tree-reorder-view\", docEditable);\n            $scope.bbApi.setPermission(\"tree-delete-view\", docEditable);\n            if ($rootScope.ve_fullDocMode) {\n                $scope.bbApi.setToggleState('tree-full-document', true);\n            }\n        }\n    };\n\n    $scope.$on('tree-expand', function() {\n        $scope.treeApi.expand_all();\n    });\n\n    $scope.$on('tree-collapse', function() {\n        $scope.treeApi.collapse_all();\n    });\n\n    $scope.$on('tree-add-document', function() {\n        addItem('Document');\n    });\n\n    $scope.$on('tree-delete-document', function() {\n        $scope.deleteItem();\n    });\n\n    $scope.$on('tree-add-view', function() {\n        addItem('View');\n    });\n\n    $scope.$on('tree-delete', function() {\n        $scope.deleteItem();\n    });\n\n    $scope.$on('tree-delete-view', function() {\n        $scope.deleteItem(function(deleteBranch) {\n            $rootScope.$broadcast('mms-full-doc-view-deleted', deleteBranch);\n        });\n    });\n\n    $scope.$on('tree-reorder-view', function() {\n        $rootScope.ve_fullDocMode = false;\n        $scope.bbApi.setToggleState(\"tree-full-document\", false);\n        $state.go('project.ref.document.order', {search: undefined});\n    });\n\n    $scope.$on('tree-reorder-group', function() {\n        $state.go('project.ref.groupReorder');\n    });\n\n    $scope.$on('tree-add-group', function() {\n        addItem('Group');\n    });\n\n    $scope.$on('tree-show-pe', function() {\n        toggle('showTree');\n        $rootScope.veTreeShowPe = true;\n        setPeVisibility(viewId2node[documentOb.id]);\n        $scope.treeApi.refresh();\n    });\n\n    $scope.$on('tree-show-views', function() {\n        toggle('showTree');\n        $rootScope.veTreeShowPe = false;\n        setPeVisibility(viewId2node[documentOb.id]);\n        $scope.treeApi.refresh();\n    });\n\n    $scope.tableList = [];\n    $scope.figureList = [];\n    $scope.equationList = [];\n    $scope.treeViewModes = [{\n        id: 'table',\n        title: 'Tables',\n        icon: 'fa-table',\n        branchList: $scope.tableList\n    }, {\n        id: 'figure',\n        title: 'Figures',\n        icon: 'fa-image',\n        branchList: $scope.figureList\n    }, {\n        id: 'equation',\n        title: 'Equations',\n        icon: 'fa-superscript',\n        branchList: $scope.equationList\n    }];\n\n    var toggle = function (id) {\n        $scope.activeMenu = id;\n    };\n    // Set active tree view to tree\n    toggle('showTree');\n\n    $scope.$on('tree-show-tables', function() {\n        toggle('table');\n    });\n    $scope.$on('tree-show-figures', function() {\n        toggle('figure');\n    });\n    $scope.$on('tree-show-equations', function() {\n        toggle('equation');\n    });\n\n    // Get a list of specific PE type from branch\n    function getPeTreeList(branch, type, list) {\n        if ( branch.type === type) {\n            list.push(branch);\n        }\n        for (var i = 0; i < branch.children.length; i++) {\n            getPeTreeList(branch.children[i], type, list);\n        }\n    }\n\n    // Function to refresh table and figure list when new item added, deleted or reordered\n    function resetPeTreeList(elemType) {\n        if (elemType == 'table' || elemType == 'all') {\n            $scope.tableList.length = 0;\n            getPeTreeList(viewId2node[documentOb.id], 'table', $scope.tableList);\n        }\n        if (elemType == 'figure' || elemType == 'image' || elemType == 'all') {\n            $scope.figureList.length = 0;\n            getPeTreeList(viewId2node[documentOb.id], 'figure', $scope.figureList);\n        }\n        if (elemType == 'equation' || elemType == 'all') {\n            $scope.equationList.length = 0;\n            getPeTreeList(viewId2node[documentOb.id], 'equation', $scope.equationList);\n        }\n    }\n\n    $scope.$on('tree-full-document', function() {\n        $scope.fullDocMode();\n    });\n\n    var groupLevel2Func = function(groupOb, groupNode) {\n        groupNode.loading = true;\n        ViewService.getProjectDocuments({\n                    projectId: projectOb.id,\n                    refId: refOb.id\n        }, 2).then(function(documentObs) {\n            var docs = [];\n            var docOb, i;\n            for (i = 0; i < documentObs.length; i++) {\n                docOb = documentObs[i];\n                if (docOb._groupId === groupOb.id) {\n                    docs.push(docOb);\n                }\n            }\n            for (i = 0; i < docs.length; i++) {\n                docOb = docs[i];\n                groupNode.children.unshift({\n                    label: docOb.name,\n                    type: refOb.type === 'Branch' ? 'view' : 'snapshot',\n                    data: docOb,\n                    group: groupOb,\n                    children: []\n                });\n            }\n            groupNode.loading = false;\n            if ($scope.treeApi.initialSelect) {\n                $scope.treeApi.initialSelect();\n            }\n        });\n    };\n    \n    var viewId2node = {};\n    var seenViewIds = {};\n    var handleSingleView = function(v, aggr) {\n        var curNode = viewId2node[v.id];\n        if (!curNode) {\n            curNode = {\n                label: v.name,\n                type: 'view',\n                data: v,\n                children: [],\n                loading: true,\n                aggr: aggr\n            };\n            viewId2node[v.id] = curNode;\n        }\n        return curNode;\n    };\n    var handleChildren = function(curNode, childNodes) {\n        var newChildNodes = [];\n        var node;\n        for (var i = 0; i < childNodes.length; i++) {\n            node = childNodes[i];\n            if (seenViewIds[node.data.id]) {\n                growl.error(\"Warning: View \" + node.data.name + \" have multiple parents! Duplicates not shown.\");\n                continue;\n            }\n            seenViewIds[node.data.id] = node;\n            newChildNodes.push(node);\n        }\n        curNode.children.push.apply(curNode.children, newChildNodes);\n        curNode.loading = false;\n        if ($scope.treeApi.refresh) {\n            $scope.treeApi.refresh();\n        }\n    };\n    var processDeletedViewBranch = function(branch) {\n        var id = branch.data.id;\n        if (seenViewIds[id]) {\n            delete seenViewIds[id];\n        }\n        if (viewId2node[id]) {\n            delete viewId2node[id];\n        }\n        for (var i = 0; i < branch.children.length; i++) {\n            processDeletedViewBranch(branch.children[i]);\n        }\n    };\n    if ($state.includes('project.ref') && !$state.includes('project.ref.document')) {\n        $scope.treeData = UtilsService.buildTreeHierarchy(groupObs, \"id\", \"group\", \"_parentId\", groupLevel2Func);\n        ViewService.getProjectDocuments({\n                    projectId: projectOb.id,\n                    refId: refOb.id\n        }, 2).then(function(documentObs) {\n            for (var i = 0; i < documentObs.length; i++) {\n                if (!documentObs[i]._groupId || documentObs[i]._groupId == projectOb.id) {\n                    $scope.treeData.push({\n                        label: documentObs[i].name,\n                        type: 'view',\n                        data: documentObs[i],\n                        children: []\n                    });\n                }\n            }\n            if ($scope.treeApi.initialSelect) {\n                $scope.treeApi.initialSelect();\n            }\n        });\n    } else {\n        if (!documentOb._childViews) {\n            documentOb._childViews = [];\n        }\n        MmsAppUtils.handleChildViews(documentOb, 'composite', undefined, projectOb.id, refOb.id, handleSingleView, handleChildren)\n        .then(function(node) {\n            var bulkGet = [];\n            for (var i in viewId2node) {\n                var view = viewId2node[i].data;\n                if (view._contents && view._contents.operand) {\n                    for (var j = 0; j < view._contents.operand.length; j++) {\n                        bulkGet.push(view._contents.operand[j].instanceId);\n                    }\n                }\n            }\n            ElementService.getElements({\n                elementIds: bulkGet,\n                projectId: projectOb.id,\n                refId: refOb.id\n            }, 0).finally(function() {\n                for (var i in viewId2node) {\n                    addSectionElements(viewId2node[i].data, viewId2node[i], viewId2node[i], true);\n                }\n                $scope.treeApi.refresh();\n            });\n        }, function(reason) {\n            console.log(reason);\n        });\n        $scope.treeData = [viewId2node[documentOb.id]];\n    }\n\n    function addSectionElements(element, viewNode, parentNode, initial) {\n        var contents = null;\n\n        var addContentsSectionTreeNode = function(operand) {\n            var bulkGet = [];\n            var i = 0;\n            for (i = 0; i < operand.length; i++) {\n                bulkGet.push(operand[i].instanceId);\n            }\n            ElementService.getElements({\n                elementIds: bulkGet, \n                projectId: projectOb.id,\n                refId: refOb.id,\n            }, 0).then(function(ignore) {\n                var instances = [];\n                for (var i = 0; i < operand.length; i++) {\n                    instances.push(ElementService.getElement({\n                        projectId: projectOb.id,\n                        refId: refOb.id,\n                        elementId: operand[i].instanceId, \n                    }, 0));\n                }\n                $q.all(instances).then(function(results) {\n                    var k = results.length - 1;\n                    for (; k >= 0; k--) {\n                        var instance = results[k];\n                        var hide = !$rootScope.veTreeShowPe;\n                        if (ViewService.isSection(instance)) {\n                            var sectionTreeNode = {\n                                label : instance.name,\n                                type : \"section\",\n                                viewId : viewNode.data.id,\n                                data : instance,\n                                children: []\n                            };\n                            viewId2node[instance.id] = sectionTreeNode;\n                            parentNode.children.unshift(sectionTreeNode);\n                            addSectionElements(instance, viewNode, sectionTreeNode, initial);\n                        } else if (ViewService.getTreeType(instance)) {\n                            var otherTreeNode = {\n                                label : instance.name,\n                                type : ViewService.getTreeType(instance),\n                                viewId : viewNode.data.id,\n                                data : instance,\n                                hide: hide,\n                                children: []\n                            };\n                            parentNode.children.unshift(otherTreeNode);\n                        }\n                    }\n                    $scope.treeApi.refresh();\n                    if (initial) {\n                        $scope.treeApi.initialSelect();\n                    }\n                    resetPeTreeList('all');\n                }, function(reason) {\n                    //view is bad\n                });\n            }, function(reason) {\n            });\n        };\n\n        if (element._contents) {\n            contents = element._contents;\n        } else if (ViewService.isSection(element) && element.specification) {\n            contents = element.specification; // For Sections, the contents expression is the specification\n        } else {\n            //bad?\n        }\n        if (contents && contents.operand) {\n            addContentsSectionTreeNode(contents.operand);\n        }\n    }\n\n    var treeClickHandler = function(branch) {\n        if ($state.includes('project.ref') && !$state.includes('project.ref.document')) {\n            if (branch.type === 'group') {\n                $state.go('project.ref.preview', {documentId: 'site_' + branch.data.id + '_cover', search: undefined});\n            } else if (branch.type === 'view' || branch.type === 'snapshot') {\n                $state.go('project.ref.preview', {documentId: branch.data.id, search: undefined});\n            }\n        } else if ($state.includes('project.ref.document')) {\n            var viewId = (branch.type !== 'view') ? branch.viewId : branch.data.id;\n            // var sectionId = branch.type === 'section' ? branch.data.id : null;\n            var hash = branch.data.id;\n            if ($rootScope.ve_fullDocMode) {\n                $rootScope.$broadcast('mms-tree-click', branch);\n            } else if (branch.type === 'view' || branch.type === 'section') {\n                $state.go('project.ref.document.view', {viewId: branch.data.id, search: undefined});\n            } else {\n                $state.go('project.ref.document.view', {viewId: viewId, search: undefined});\n                $timeout(function() {\n                    $location.hash(hash);\n                    $anchorScroll();\n                }, 1000, false);\n            }\n        }\n        //$rootScope.ve_tbApi.select('element-viewer');\n    };\n\n    var treeDblclickHandler = function(branch) {\n        if ($state.includes('project.ref') && !$state.includes('project.ref.document')) {\n            if (branch.type === 'group')\n                $rootScope.ve_treeApi.expand_branch(branch);\n            else if (branch.type === 'view' || branch.type === 'snapshot') {\n                $state.go('project.ref.document', {documentId: branch.data.id, search: undefined});\n            }\n        } else if ($state.includes('project.ref.document')) {\n            $rootScope.ve_treeApi.expand_branch(branch);\n        }\n    };\n\n    // TODO: Update sort function to handle all cases\n    var treeSortFunction = function(a, b) {\n\n        a.priority = 100;\n        if (a.type === 'tag') {\n            a.priority = 0 ;\n        } else if (a.type === 'group') {\n            a.priority = 1;\n        } else if (a.type === 'view') {\n            a.priority = 2;\n        }\n        b.priority = 100;\n        if (b.type === 'tag') {\n            b.priority = 0 ;\n        } else if (b.type === 'group') {\n            b.priority = 1;\n        } else if (b.type === 'view') {\n            b.priority = 2;\n        }\n\n        if (a.priority < b.priority)\n            return -1;\n        if (a.priority > b.priority)\n            return 1;\n        if (!a.label) {\n            a.label = '';\n        }\n        if (!b.label) {\n            b.label = '';\n        }\n        if (a.label.toLowerCase() < b.label.toLowerCase())\n            return -1;\n        if (a.label.toLowerCase() > b.label.toLowerCase())\n            return 1;\n        return 0;\n    };\n\n    $scope.treeOptions = {\n        types: UxService.getTreeTypes(),\n        sectionNumbering: $state.includes('project.ref.document') ? true : false,\n        numberingDepth: 0,\n        numberingSeparator: '.',\n        expandLevel: $state.includes('project.ref.document') ? 3 : ($state.includes('project.ref') ? 0 : 1),\n        search: '',\n        onSelect: treeClickHandler,\n        onDblclick: treeDblclickHandler,\n        sort: $state.includes('project.ref.document') ? null : treeSortFunction\n    };\n    if (documentOb && docMeta) {\n        $scope.treeOptions.numberingDepth = docMeta.numberingDepth;\n        $scope.treeOptions.numberingSeparator = docMeta.numberingSeparator;\n        $scope.treeOptions.startChapter = documentOb._startChapter;\n    }\n\n    $scope.fullDocMode = function() {\n        if ($rootScope.ve_fullDocMode) {\n            $rootScope.ve_fullDocMode = false;\n            $scope.bbApi.setToggleState(\"tree-full-document\", false);\n            var curBranch = $scope.treeApi.get_selected_branch();\n            if (curBranch) {\n                var viewId;\n                if (curBranch.type !== 'view') {\n                    if (curBranch.type === 'section' && curBranch.data.type === 'InstanceSpecification') {\n                        viewId = curBranch.data.id;\n                    } else {\n                        viewId = curBranch.viewId;\n                    }\n                } else {\n                    viewId = curBranch.data.id;\n                }\n                $state.go('project.ref.document.view', {viewId: viewId, search: undefined});\n            }\n        } else {\n            $rootScope.ve_fullDocMode = true;\n            $scope.bbApi.setToggleState(\"tree-full-document\", true);\n            $state.go('project.ref.document.full', {search: undefined}); \n        }\n    };\n\n    var addItem = function(itemType) {\n        $scope.itemType = itemType;\n        $scope.newViewAggr = {type: 'shared'};\n        var branch = $scope.treeApi.get_selected_branch();\n        var templateUrlStr = \"\";\n        var newBranchType = \"\";\n        \n        if (itemType === 'Document') {\n            if (!branch) {\n                $scope.parentBranchData = {id: \"holding_bin_\" + projectOb.id};\n            } else if (branch.type !== 'group') {\n                growl.warning(\"Select a group to add document under\");\n                return;\n            } else {\n                $scope.parentBranchData = branch.data;\n            }\n            templateUrlStr = 'partials/mms/new-doc-or-group.html';\n            newBranchType = 'view';\n        } else if (itemType === 'Group') {\n            if (branch && branch.type === 'group') {\n                $scope.parentBranchData = branch.data;\n            } else {\n                $scope.parentBranchData = {id: \"holding_bin_\" + projectOb.id};\n                // Always create group at root level if the selected branch is not a group branch\n                branch = null;\n            }\n            templateUrlStr = 'partials/mms/new-doc-or-group.html';\n            newBranchType = 'group';\n        } else if (itemType === 'View') {\n            if (!branch) {\n                growl.warning(\"Add View Error: Select parent view first\");\n                return;\n            } else if (branch.type === \"section\") {\n                growl.warning(\"Add View Error: Cannot add a child view to a section\");\n                return;\n            } else if (branch.aggr === 'none') {\n                growl.warning(\"Add View Error: Cannot add a child view to a non-owned and non-shared view.\");\n                return;\n            }\n            $scope.parentBranchData = branch.data;\n            templateUrlStr = 'partials/mms/new-view.html';\n            newBranchType = 'view';\n        } else {\n            growl.error(\"Add Item of Type \" + itemType + \" is not supported\");\n            return;\n        }\n        // Adds the branch:\n        var instance = $uibModal.open({\n            templateUrl: templateUrlStr,\n            scope: $scope,\n            controller: ['$scope', '$uibModalInstance', '$filter', addItemCtrl]\n        });\n        instance.result.then(function(data) {\n            if (!$rootScope.ve_editmode) {\n                $timeout(function() {\n                    $('.show-edits').click();\n                }, 0, false);\n            }\n            var newbranch = {\n                label: data.name,\n                type: newBranchType,\n                data: data,\n                children: []\n            };\n            var top = itemType === 'Group' ? true : false;\n            $scope.treeApi.add_branch(branch, newbranch, top);\n\n            var addToFullDocView = function(node, curSection, prevSysml) {\n                var lastChild = prevSysml;\n                if (node.children) {\n                    var num = 1;\n                    for (var i = 0; i < node.children.length; i++) {\n                        var cNode = node.children[i];\n                        $rootScope.$broadcast('mms-new-view-added', cNode.data.id, curSection + '.' + num, lastChild);\n                        lastChild = addToFullDocView(cNode, curSection + '.' + num, cNode.data.id);\n                        num = num + 1;\n                    }\n                }\n                return lastChild;\n            };\n\n            if (itemType === 'View') {\n                viewId2node[data.id] = newbranch;\n                seenViewIds[data.id] = newbranch;\n                newbranch.aggr = $scope.newViewAggr.type;\n                var curNum = branch.children[branch.children.length-1].section;\n                var prevBranch = $scope.treeApi.get_prev_branch(newbranch);\n                while (prevBranch.type !== 'view') {\n                    prevBranch = $scope.treeApi.get_prev_branch(prevBranch);\n                }\n                MmsAppUtils.handleChildViews(data, $scope.newViewAggr.type, undefined, projectOb.id, refOb.id, handleSingleView, handleChildren)\n                  .then(function(node) {\n                      // handle full doc mode\n                      if ($rootScope.ve_fullDocMode) {\n                          addToFullDocView(node, curNum, newbranch.data.id);\n                      }\n                      addViewSectionsRecursivelyForNode(node);\n                });\n                if (!$rootScope.ve_fullDocMode) {\n                    $state.go('project.ref.document.view', {viewId: data.id, search: undefined});\n                } else {\n                    if (prevBranch) {\n                        $rootScope.$broadcast('mms-new-view-added', data.id, curNum, prevBranch.data.id);\n                    } else {\n                        $rootScope.$broadcast('mms-new-view-added', data.id, curNum, branch.data.id);\n                    }\n                }\n            }\n        });\n    };\n\n    var addItemCtrl = function($scope, $uibModalInstance) {\n        $scope.createForm = true;\n        $scope.oking = false;\n        $scope.projectOb = projectOb;\n        $scope.refOb = refOb;\n        var displayName = \"\";\n\n        if ($scope.itemType === 'Document') {\n            $scope.newDoc = {name: ''};\n            displayName = \"Document\";\n        } else if ($scope.itemType === 'View') {\n            $scope.newView = {name: ''};\n            displayName = \"View\";\n        } else if ($scope.itemType === 'Group') {\n            $scope.newGroup = {name: ''};\n            displayName = \"Group\";\n        } else {\n            growl.error(\"Add Item of Type \" + $scope.itemType + \" is not supported\");\n            return;\n        }\n       \n        var addExistingView = function(view) {\n            var viewId = view.id;\n            if (seenViewIds[viewId]) {\n                growl.error(\"Error: View \" + view.name + \" is already in this document.\");\n                return;\n            }\n            if ($scope.oking) {\n                growl.info(\"Please wait...\");\n                return;\n            }\n            $scope.oking = true;\n            ViewService.addViewToParentView({\n                parentViewId: $scope.parentBranchData.id,\n                viewId: viewId,\n                projectId: $scope.parentBranchData._projectId,\n                refId: $scope.parentBranchData._refId,\n                aggr: $scope.newViewAggr.type\n            }).then(function(data) {\n                ElementService.getElement({\n                    elementId: viewId,\n                    projectId: view._projectId,\n                    refId: view._refId\n                }, 2, false)\n                .then(function(realView) {\n                    $uibModalInstance.close(realView);\n                }, function() {\n                    $uibModalInstance.close(view);\n                }).finally(function() {\n                    growl.success(\"View Added\");\n                });\n            }, function(reason) {\n                growl.error(\"View Add Error: \" + reason.message);\n            }).finally(function() {\n                $scope.oking = false;\n            }); \n        };\n\n\n        var queryFilter = function() {\n            var obj = {};\n            obj.terms = {'_appliedStereotypeIds': [UtilsService.VIEW_SID, UtilsService.DOCUMENT_SID].concat(UtilsService.OTHER_VIEW_SID)};\n            return obj;\n        };\n\n        $scope.searchOptions = {\n            callback: addExistingView,\n            itemsPerPage: 200,\n            filterQueryList: [queryFilter],\n            hideFilterOptions: true\n        };\n\n        $scope.ok = function() {\n            if ($scope.oking) {\n                growl.info(\"Please wait...\");\n                return;\n            }\n            $scope.oking = true;\n            var promise;\n\n            // Item specific promise: //TODO branch and tags\n            if ($scope.itemType === 'Document') {\n                promise = ViewService.createDocument({\n                    _projectId: projectOb.id,\n                    _refId: refOb.id,\n                    id: $scope.parentBranchData.id\n                },{\n                    viewName: $scope.newDoc.name,\n                    isDoc: true\n                });\n            } else if ($scope.itemType === 'View') {\n                $scope.newViewAggr.type = \"composite\";\n                promise = ViewService.createView($scope.parentBranchData, {\n                    viewName: $scope.newView.name\n                });\n            } else if ($scope.itemType === 'Group') {\n                promise = ViewService.createGroup($scope.newGroup.name,\n                    {\n                        _projectId: projectOb.id,\n                        _refId: refOb.id,\n                        id: $scope.parentBranchData.id\n                    }, orgOb.id\n                );\n            } else {\n                growl.error(\"Add Item of Type \" + $scope.itemType + \" is not supported\");\n                $scope.oking = false;\n                return;\n            }\n\n            promise.then(function(data) {\n                growl.success(displayName+\" Created\");\n                if ($scope.itemType === 'Tag') {\n                    growl.info('Please wait for a completion email prior to viewing of the tag.');\n                }\n                $uibModalInstance.close(data);\n            }, function(reason) {\n                growl.error(\"Create \"+displayName+\" Error: \" + reason.message);\n            }).finally(function() {\n                $scope.oking = false;\n            });\n        };\n\n        $scope.cancel = function() {\n            $uibModalInstance.dismiss();\n        };\n    };\n\n    $scope.deleteItem = function(cb) {\n        var branch = $scope.treeApi.get_selected_branch();\n        if (!branch) {\n            growl.warning(\"Select item to remove.\");\n            return;\n        }\n        var type = ViewService.getElementType(branch.data);\n        if ($state.includes('project.ref.document')) {\n            if (type == 'Document') {\n                growl.warning(\"Cannot remove a document from this view. To remove this item, go to project home.\");\n                return;\n            }\n            if (branch.type !== 'view' || (!UtilsService.isView(branch.data))) {\n                growl.warning(\"Cannot remove non-view item. To remove this item, open it in the center pane.\");\n                return;\n            }\n        }\n\n        // when in project.ref state, allow deletion for view/document/group\n        if ($state.includes('project.ref') && !$state.includes('project.ref.document')) {\n            if (branch.type !== 'view' && !UtilsService.isDocument(branch.data) && (branch.type !== 'group' || branch.children.length > 0) ) {\n                growl.warning(\"Cannot remove group with contents. Empty contents and try again.\");\n                return;\n            }\n        }\n        $scope.deleteBranch = branch;\n        var instance = $uibModal.open({\n            templateUrl: 'partials/mms/confirmRemove.html',\n            scope: $scope,\n            controller: ['$scope', '$uibModalInstance', deleteCtrl]\n        });\n        instance.result.then(function(data) {\n            $scope.treeApi.remove_branch(branch);\n            if ($state.includes('project.ref.document') && branch.type === 'view') {\n                processDeletedViewBranch(branch);\n            }\n            if ($rootScope.ve_fullDocMode) {\n                cb(branch);\n            } else {\n                $scope.treeApi.clear_selected_branch();\n                $state.go('^', {search: undefined});\n            }\n        });\n    };\n\n    // TODO: Make this a generic delete controller\n    var deleteCtrl = function($scope, $uibModalInstance) {\n        var branch = $scope.deleteBranch;\n        $scope.oking = false;\n        $scope.type = branch.type;\n        if (UtilsService.isDocument(branch.data)) {\n            $scope.type = 'Document';\n        }\n        $scope.name = branch.data.name;\n        $scope.ok = function() {\n            if ($scope.oking) {\n                growl.info(\"Please wait...\");\n                return;\n            }\n            $scope.oking = true;\n            var promise = null;\n            if (branch.type === 'view') {\n                var parentBranch = $scope.treeApi.get_parent_branch(branch);\n                if (!$state.includes('project.ref.document')) {\n                    promise = ViewService.downgradeDocument(branch.data);\n                } else {\n                    promise = ViewService.removeViewFromParentView({\n                        projectId: parentBranch.data._projectId,\n                        refId: parentBranch.data._refId,\n                        parentViewId: parentBranch.data.id,\n                        viewId: branch.data.id\n                    });\n                }\n            } else if (branch.type === 'group') {\n                promise = ViewService.removeGroup(branch.data);\n            }\n\n            if (promise) {\n                promise.then(function (data) {\n                    growl.success($scope.type + \" Removed\");\n                    $uibModalInstance.close('ok');\n                }, function (reason) {\n                    growl.error($scope.type + ' Removal Error: ' + reason.message);\n                }).finally(function () {\n                    $scope.oking = false;\n                });\n            } else {\n                $scope.oking = false;\n                $uibModalInstance.dismiss();\n            }\n        };\n        $scope.cancel = function() {\n            $uibModalInstance.dismiss();\n        };\n    };\n\n    function addViewSections(view) {\n        var node = viewId2node[view.id];\n        addSectionElements(view, node, node);\n    }\n\n    function addViewSectionsRecursivelyForNode(node) {\n        addViewSections(node.data);\n        for (var i = 0; i < node.children.length; i++) {\n            if (node.children[i].type === 'view') {\n                addViewSectionsRecursivelyForNode(node.children[i]);\n            }\n        }\n    }\n\n    function setPeVisibility(branch) {\n        if (branch.type === 'figure' || branch.type === 'table' || branch.type === 'equation') {\n            branch.hide = !$rootScope.veTreeShowPe;\n        }\n        for (var i = 0; i < branch.children.length; i++) {\n            setPeVisibility(branch.children[i]);\n        }\n    }\n\n    // MmsAppUtils.addElementCtrl creates this event when adding sections, table and figures to the view\n    $scope.$on('viewctrl.add.element', function(event, instanceSpec, elemType, parentBranchData) {\n        if (elemType === 'paragraph' || elemType === 'list' || elemType === 'comment')\n            return;\n        var branch = $scope.treeApi.get_branch(parentBranchData);\n        var viewId = null;\n        if (branch.type === 'section') {\n            viewId = branch.viewId;\n        } else {\n            viewId = branch.data.id;\n        }\n        var viewNode = viewId2node[viewId];\n        var newbranch = {\n            label: instanceSpec.name,\n            type: (elemType === 'image' ? 'figure' : elemType),\n            viewId: viewId,\n            data: instanceSpec,\n            hide: !$rootScope.veTreeShowPe && elemType !== 'section',\n            children: []\n        };\n        var i = 0;\n        var lastSection = -1;\n        var childViewFound = false;\n        for (i = 0; i < branch.children.length; i++) {\n            if (branch.children[i].type === 'view') {\n                lastSection = i-1;\n                childViewFound = true;\n                break;\n            }\n        }\n        if (lastSection === -1 && !childViewFound) {//case when first child is view\n            lastSection = branch.children.length-1;\n        }\n        branch.children.splice(lastSection+1, 0, newbranch);\n        if (elemType === 'section') {\n            addSectionElements(instanceSpec, viewNode, newbranch);\n        }\n        $scope.treeApi.refresh();\n        resetPeTreeList(elemType);\n    });\n\n    // Utils creates this event when deleting instances from the view\n    $scope.$on('viewctrl.delete.element', function(event, elementData) {\n        var branch = $scope.treeApi.get_branch(elementData);\n        if (branch) {\n            $scope.treeApi.remove_single_branch(branch);\n        }\n        resetPeTreeList(branch.type);\n    });\n\n    $scope.$on('view.reorder.saved', function(event, vid) {\n        var node = viewId2node[vid];\n        var viewNode = node;\n        var newChildren = [];\n        for (var i = 0; i < node.children.length; i++) {\n            var child = node.children[i];\n            if (child.type === 'view') {\n                newChildren.push(child);\n            }\n        }\n        node.children = newChildren;\n        if (node.type === 'section') {\n            viewNode = viewId2node[node.view];\n            if (!viewNode) {\n                viewNode = node;\n            }\n        }\n        addSectionElements(node.data, viewNode, node);\n    });\n\n    //TODO refresh table and fig list when new item added, deleted or reordered\n    $scope.user_clicks_branch = function(branch) {\n        $rootScope.ve_treeApi.user_clicks_branch(branch);\n    };\n\n    $scope.searchInputChangeHandler = function () {\n        if ($scope.treeOptions.search === '') {\n            $scope.treeApi.collapse_all();\n            $scope.treeApi.expandPathToSelectedBranch();\n        } else {\n            // expand all branches so that the filter works correctly\n            $scope.treeApi.expand_all();\n        }\n    };\n\n}]);\n","'use strict';\n\n/* Controllers */\n\nangular.module('mmsApp')\n    .controller('ViewCtrl', ['$scope', '$rootScope', '$state', '$timeout', '$window', '$location',\n    '$http', '$element', 'growl', 'hotkeys', 'MmsAppUtils', 'UxService', 'URLService', 'UtilsService', 'ShortenUrlService', 'Utils',\n    'search', 'orgOb', 'projectOb', 'refOb', 'groupOb', 'documentOb', 'viewOb',\n    function($scope, $rootScope, $state, $timeout, $window, $location, $http,\n             $element, growl, hotkeys, MmsAppUtils, UxService, URLService, UtilsService, ShortenUrlService, Utils,\n             search, orgOb, projectOb, refOb, groupOb, documentOb, viewOb) {\n\n    function isPageLoading() {\n        if ($element.find('.isLoading').length > 0) {\n            growl.warning(\"Still loading!\");\n            return true;\n        }\n        return false;\n    }\n\n    $scope.vidLink = false; //whether to have go to document link\n    if ($state.includes('project.ref.preview') && viewOb && viewOb.id.indexOf('_cover') < 0) {\n        $scope.vidLink = true;\n    }\n\n    if (!$rootScope.veCommentsOn)\n        $rootScope.veCommentsOn = false;\n    if (!$rootScope.veElementsOn)\n        $rootScope.veElementsOn = false;\n    if (!$rootScope.ve_editmode)\n        $rootScope.ve_editmode = false;\n\n    $scope.search = search;\n    Utils.toggleLeftPane(search);\n    $scope.viewOb = viewOb;\n    $scope.projectOb = projectOb;\n    $scope.refOb = refOb;\n\n    $scope.buttons = [];\n    $scope.viewApi = {\n        init: function() {\n            if ($rootScope.veCommentsOn) {\n                $scope.viewApi.toggleShowComments();\n            }\n            if ($rootScope.veElementsOn) {\n                $scope.viewApi.toggleShowElements();\n            }\n            if ($rootScope.ve_editmode) {\n                $scope.viewApi.toggleShowEdits();\n            }\n        },\n        elementTranscluded: function(elementOb, type) {\n            if (type === 'Comment' && !$scope.comments.map.hasOwnProperty(elementOb.id)) {\n                $scope.comments.map[elementOb.id] = elementOb;\n                $scope.comments.count++;\n                if (elementOb._modified > $scope.comments.lastCommented) {\n                    $scope.comments.lastCommented = elementOb._modified;\n                    $scope.comments.lastCommentedBy = elementOb._modifier;\n                }\n            }\n        },\n        elementClicked: function(elementOb) {\n            $rootScope.$broadcast('elementSelected', elementOb, 'latest');\n        }\n    };\n    $scope.comments = {\n        count: 0,\n        lastCommented: '',\n        lastCommentedBy: '',\n        map: {}\n    };\n\n    $scope.docLibLink = '';\n    if (groupOb !== null) {\n        $scope.docLibLink = groupOb._link;\n    } else if (documentOb !== null && documentOb._groupId !== undefined && documentOb._groupId !== null) {\n        $scope.docLibLink = '/share/page/repository#filter=path|/Sites/' + orgOb.id + '/documentLibrary/' +\n        projectOb.id + '/' + documentOb._groupId;\n    } else {\n        $scope.docLibLink = '/share/page/repository#filter=path|/Sites/' + orgOb.id + '/documentLibrary/' +\n        projectOb.id;\n    }\n\n    $scope.bbApi = {\n        init: function() {\n            if (viewOb && viewOb._editable && refOb.type === 'Branch') {\n                $scope.bbApi.addButton(UxService.getButtonBarButton('show-edits'));\n                $scope.bbApi.setToggleState('show-edits', $rootScope.ve_editmode);\n                hotkeys.bindTo($scope)\n                .add({\n                    combo: 'alt+d',\n                    description: 'toggle edit mode',\n                    callback: function() {$scope.$broadcast('show-edits');}\n                });\n            }\n            $scope.bbApi.addButton(UxService.getButtonBarButton('show-elements'));\n            $scope.bbApi.setToggleState('show-elements', $rootScope.veElementsOn);\n            $scope.bbApi.addButton(UxService.getButtonBarButton('show-comments'));\n            $scope.bbApi.setToggleState('show-comments', $rootScope.veCommentsOn);\n\n            // Set hotkeys for toolbar\n            hotkeys.bindTo($scope)\n            .add({\n                combo: 'alt+c',\n                description: 'toggle show comments',\n                callback: function() {$scope.$broadcast('show-comments');}\n            }).add({\n                combo: 'alt+e',\n                description: 'toggle show elements',\n                callback: function() {$scope.$broadcast('show-elements');}\n            });\n\n            if ($state.includes('project.ref.preview') || $state.includes('project.ref.document')) {\n                $scope.bbApi.addButton(UxService.getButtonBarButton('refresh-numbering'));\n                // $scope.bbApi.addButton(UxService.getButtonBarButton('share-url'));\n                $scope.bbApi.addButton(UxService.getButtonBarButton('print'));\n                if ($state.includes('project.ref.document')) {\n                    var exportButtons = UxService.getButtonBarButton('export');\n                    exportButtons.dropdown_buttons.push(UxService.getButtonBarButton(\"convert-pdf\"));\n                    $scope.bbApi.addButton(exportButtons);\n                    $scope.bbApi.addButton(UxService.getButtonBarButton('center-previous'));\n                    $scope.bbApi.addButton(UxService.getButtonBarButton('center-next'));\n                    // Set hotkeys for toolbar\n                    hotkeys.bindTo($scope)\n                    .add({\n                        combo: 'alt+.',\n                        description: 'next',\n                        callback: function() {$scope.$broadcast('center-next');}\n                    }).add({\n                        combo: 'alt+,',\n                        description: 'previous',\n                        callback: function() {$scope.$broadcast('center-previous');}\n                    });\n                } else {\n                    $scope.bbApi.addButton(UxService.getButtonBarButton('export'));\n                }\n            }\n        }\n    };\n\n    $scope.$on('show-comments', function() {\n        $scope.viewApi.toggleShowComments();\n        $scope.bbApi.toggleButtonState('show-comments');\n        $rootScope.veCommentsOn = !$rootScope.veCommentsOn;\n    });\n\n    $scope.$on('show-elements', function() {\n        $scope.viewApi.toggleShowElements();\n        $scope.bbApi.toggleButtonState('show-elements');\n        $rootScope.veElementsOn = !$rootScope.veElementsOn;\n    });\n\n    $scope.$on('show-edits', function() {\n        if( ($rootScope.veElementsOn && $rootScope.ve_editmode) || (!$rootScope.veElementsOn && !$rootScope.ve_editmode) ){\n            $scope.viewApi.toggleShowElements();\n            $scope.bbApi.toggleButtonState('show-elements');\n            $rootScope.veElementsOn = !$rootScope.veElementsOn;\n        }\n        $scope.viewApi.toggleShowEdits();\n        $scope.bbApi.toggleButtonState('show-edits');\n        $rootScope.ve_editmode = !$rootScope.ve_editmode;\n    });\n\n    $scope.$on('center-previous', function() {\n        var prev = $rootScope.ve_treeApi.get_prev_branch($rootScope.ve_treeApi.get_selected_branch());\n        if (!prev)\n            return;\n        while (prev.type !== 'view' && prev.type !== 'section') {\n            prev = $rootScope.ve_treeApi.get_prev_branch(prev);\n            if (!prev)\n                return;\n        }\n        $scope.bbApi.toggleButtonSpinner('center-previous');\n        $rootScope.ve_treeApi.select_branch(prev);\n        $scope.bbApi.toggleButtonSpinner('center-previous');\n    });\n\n    $scope.$on('center-next', function() {\n        var next = $rootScope.ve_treeApi.get_next_branch($rootScope.ve_treeApi.get_selected_branch());\n        if (!next)\n            return;\n        while (next.type !== 'view' && next.type !== 'section') {\n            next = $rootScope.ve_treeApi.get_next_branch(next);\n            if (!next)\n                return;\n        }\n        $scope.bbApi.toggleButtonSpinner('center-next');\n        $rootScope.ve_treeApi.select_branch(next);\n        $scope.bbApi.toggleButtonSpinner('center-next');\n    });\n\n    // Share URL button settings\n    $scope.dynamicPopover = ShortenUrlService.dynamicPopover;\n    $scope.copyToClipboard = ShortenUrlService.copyToClipboard;\n    $scope.handleShareURL = ShortenUrlService.getShortUrl.bind(null, $location.absUrl(), $scope);\n\n    if (viewOb && $state.includes('project.ref')) {\n        $timeout(function() {\n            $rootScope.$broadcast('viewSelected', viewOb, 'latest');\n        }, 1000);\n    }\n\n    $scope.searchOptions = {\n        emptyDocTxt: 'This field is empty.',\n        searchInput: search,\n        getProperties: true,\n        closeable: true,\n        callback: function(elementOb) {\n            $rootScope.$broadcast('elementSelected', elementOb, 'latest');\n            if ($rootScope.ve_togglePane && $rootScope.ve_togglePane.closed)\n                $rootScope.ve_togglePane.toggle();\n        },\n        relatedCallback: function (doc, view, elem) {//siteId, documentId, viewId) {\n            $state.go('project.ref.document.view', {projectId: doc._projectId, documentId: doc.id, viewId: view.id, refId: doc._refId, search: undefined});\n        }\n    };\n\n    $scope.$on('convert-pdf', function() {\n        if (isPageLoading())\n            return;\n        MmsAppUtils.printModal(viewOb, refOb, false, 3)\n        .then(function(ob) {\n            growl.info('Exporting as PDF file. Please wait for a completion email.',{ttl: -1});\n        }, function(reason){\n            growl.error(\"Exporting as PDF file Failed: \" + reason.message);\n        });\n    });\n\n    $scope.$on('print', function() {\n        if (isPageLoading())\n            return;\n        MmsAppUtils.printModal(viewOb, refOb, false, 1);\n    });\n\n    $scope.$on('word', function() {\n        if (isPageLoading())\n            return;\n        MmsAppUtils.printModal(viewOb, refOb, false, 2)\n        .then(function(ob) {\n            growl.info('Exporting as Word file. Please wait for a completion email.',{ttl: -1});\n        }, function(reason){\n            growl.error(\"Exporting as Word file Failed: \" + reason.message);\n        });\n    });\n\n    $scope.$on('tabletocsv', function() {\n        if (isPageLoading())\n            return;\n        MmsAppUtils.tableToCsv(false);\n    });\n\n    $scope.$on('refresh-numbering', function() {\n        if (isPageLoading())\n            return;\n        var printElementCopy = angular.element(\"#print-div\");\n        MmsAppUtils.refreshNumbering($rootScope.ve_treeApi.get_rows(), printElementCopy);\n    });\n}]);\n"]}