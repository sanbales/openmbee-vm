/*! mms-ve 2020-02-04 23:21:34 */

!function(exports){"use strict";function ApplicationService(e,n,i){var t,a=o(),r={};function o(){for(var e=[],t="0123456789abcdef",n=0;n<36;n++)e[n]=t.substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]=t.substr(3&e[19]|8,1),e.join("")}return{getSource:function(){return a},createUniqueId:o,getMmsVersion:function(){var t=e.defer();return n.get(i.getMmsVersionURL()).then(function(e){t.resolve(e.data.mmsVersion)},function(e){i.handleHttpStatus(e.data,e.status,e.headers,e.config,t)}),t.promise},setUserName:function(e){t=e},getUserName:function(){return t},getState:function(){return r}}}function ArtifactService(d,m,p,u,f,s,e){var l={},g=function(e,t,n){var i=v(e,t.id),a=t._commitId;if("latest"===e.commmitId){var r=JSON.parse(JSON.stringify(t));t._commitId="latest";var o=u.makeArtifactKey(r);n||f.put(o,r,!0)}var s=u.makeArtifactKey(t,n);return t._commitId=a,t=angular.equals(s,i)?f.put(i,t,!0):(f.put(i,s.join("|")),f.put(s,t,!0))},v=function(e,t,n){var i=e.refId?e.refId:"master",a=e.commitId?e.commitId:"latest",r=t||e.artifactId,o=["artifact",e.projectId,i,r,a];return n&&o.push("edit"),o};return{cacheArtifact:g,getArtifact:function(a,e,t){u.normalize(a);var n=v(a),r=p.getArtifactURL(a);if(l.hasOwnProperty(r))return s.ping(r,e),l[r];var o=d.defer(),i=f.get(n);return i&&!t?o.resolve(i):(l[r]=o.promise,s.get(r,function(e,t,n,i){angular.isArray(e.artifacts)&&0<e.artifacts.length?o.resolve(g(a,e.artifacts[0])):o.reject({status:500,data:"",message:"Server Error: empty response"}),delete l[r]},function(e,t,n,i){p.handleHttpStatus(e,t,n,i,o),delete l[r]},e)),o.promise},getArtifacts:function(i,e,t){var a=d.defer(),n={artifacts:[]},r=[];u.normalize(i);for(var o=0;o<i.artifactIds.length;o++){var s=i.artifactIds[o],l=v(i,s),c=f.get(l);!c||t?n.artifacts.push({id:s}):r.push(c)}return 0===n.artifacts.length?a.resolve(r):m.put(p.getPutArtifactsURL(i),n).then(function(e){for(var t=e.data.artifacts,n=0;n<t.length;n++)r.push(g(i,t[n]));a.resolve(r)},function(e){p.handleHttpStatus(e.data,e.status,e.headers,e.config,a)}),a.promise},getArtifactHistory:function(e,t,n){u.normalize(e);var i=p.getArtifactHistoryURL(e);if(l.hasOwnProperty(i))return l[i];var a=["artifactHistory",e.projectId,e.refId,e.artifactId],r=d.defer();return f.exists(a)&&!n?r.resolve(f.get(a)):(l[i]=r.promise,m.get(p.getArtifactHistoryURL(e)).then(function(e){r.resolve(f.put(a,e.data.commits,!0)),delete l[i]},function(e){p.handleHttpStatus(e.data,e.status,e.headers,e.config,r),delete l[i]})),r.promise},reset:function(){l={}}}}function AuthService(n,i,e,a,t,r,o,s,l,c){var d=l.localStorage.getItem("ticket"),m=function(){l.localStorage.removeItem("ticket"),d=void 0,a.setTicket(null),t.dropAll(),r.reset(),s.reset(),o.reset(),e.reset()},p=function(){var t=n.defer();return d?i.get(a.getCheckTicketURL(d)).then(function(e){t.resolve(e.data.username),c.setUsername(e.data.username)},function(e){t.reject(e),m()}):t.reject(!1),t.promise};return{getAuthorized:function(e){var t=n.defer();return i.post("/alfresco/service/api/login",e).then(function(e){a.setTicket(e.data.data.ticket),d=e.data.data.ticket,l.localStorage.setItem("ticket",d),t.resolve(d)},function(e){a.handleHttpStatus(e.data,e.status,e.header,e.config,t),t.reject(e)}),t.promise},getTicket:function(){return d},removeTicket:m,checkLogin:p,logout:function(){var e=n.defer();return p().then(function(){m()},function(){m(),e.resolve(!0)}),e.promise}}}function CacheService(o){var s={},l=function(e){var t=e;if(angular.isArray(e)&&(t=c(e)),s.hasOwnProperty(t)){var n=s[t];return angular.isString(n)?l(n):n}return null},i=function(e){var t=e;if(angular.isArray(e)&&(t=c(e)),!s.hasOwnProperty(t))return null;var n=s[t];return delete s[t],angular.isString(n)?i(n):n},a=function(e){var t=e;if(angular.isArray(e)&&(t=c(e)),!s.hasOwnProperty(t))return!1;var n=s[t];return!!angular.isObject(n)||!!angular.isString(n)&&a(n)},c=function(e){return e.join("|")};return{get:l,getLatestElements:function(e,t){var n=[];for(var i in s)if(s.hasOwnProperty(i)&&0<=i.indexOf("|latest")&&0<=i.indexOf("element|")&&i.indexOf("|edit")<0&&i.indexOf("deleted")<0&&0<=i.indexOf(t)&&0<=i.indexOf(e)){var a=l(i);a&&n.push(a)}return n},put:function(e,t,n){var i=n||!1,a=e;angular.isArray(e)&&(a=c(e));var r=l(a);if(r&&i&&angular.isObject(t))o.merge(r,t,function(e,t,n){return"_contents"!==n&&"specification"!==n||!t||"Expression"!==t.type?angular.isArray(e)&&angular.isArray(t)&&t.length<e.length?(e.length=0,Array.prototype.push.apply(e,t),e):"_displayedElementIds"===n&&t?t:void 0:t});else{if(!angular.isString(r)||angular.isString(t))s[a]=t;else{for(a=r;angular.isString(s[a]);)a=s[a];s[a]=t}r=t}return r},exists:a,remove:i,getCache:function(){return s},reset:function(){for(var e=Object.keys(s),t=0;t<e.length;t++)delete s[e[t]]}}}function ElementService(p,d,u,f,m,g,c,l){var v={},s=function(a,e,t){f.normalize(a);var n=y(a),i=u.getElementURL(a),r=i;if(v.hasOwnProperty(r))return g.ping(r,e),v[r];var o=p.defer(),s=m.get(n);if(s&&!t&&(!a.extended||a.extended&&s._qualifiedId))return o.resolve(s),o.promise;var l=y(a);l.push("deleted");var c=m.get(l);return c?o.reject({status:410,data:{recentVersionOfElement:c},message:"Deleted"}):(v[r]=o.promise,g.get(i,function(e,t,n,i){angular.isArray(e.elements)&&0<e.elements.length?o.resolve(h(a,e.elements[0])):o.reject({status:500,data:"",message:"Server Error: empty response"}),delete v[r]},function(e,t,n,i){e.deleted&&0<e.deleted.length&&e.deleted[0].id===a.elementId&&(e.recentVersionOfElement=e.deleted[0],b(a,e.deleted[0])),u.handleHttpStatus(e,t,n,i,o),delete v[r]},e)),o.promise},h=function(e,t,n){var i=f.cleanElement(t,n),a=y(e,i.id,n),r=i._commitId;if("latest"===e.commitId){var o=JSON.parse(JSON.stringify(i));i._commitId="latest";var s=f.makeElementKey(o);n||m.put(s,o,!0)}var l=f.makeElementKey(i,n);return i._commitId=r,i=angular.equals(l,a)?m.put(a,i,!0):(m.put(a,l.join("|")),m.put(l,i,!0))},b=function(e,t){var n=y(e,t.id);n.push("deleted");var i=f.makeElementKey(t);m.put(n,i.join("|")),m.put(i,t,!0)},i=function(l,c,d,e,t){if(f.normalize(c),v.hasOwnProperty(l))return g.ping(l,e),v[l];var m=p.defer();return v[l]=m.promise,g.get(l,function(e,t,n,i){for(var a=[],r=e[d],o=0;o<r.length;o++){var s=r[o];s&&a.push(h(c,s))}delete v[l],m.resolve(a)},function(e,t,n,i){u.handleHttpStatus(e,t,n,i,m),delete v[l]},e),m.promise},w=function(e){var t=JSON.parse(JSON.stringify(e));t._commitId="latest";var n=m.get(f.makeElementKey(t,!0));if(n)for(var i in n)e.hasOwnProperty(i)||(t[i]=n[i]);return t._displayedElementIds&&delete t._displayedElementIds,t._allowedElementIds&&delete t._allowedElementIds,t._childViews&&!e._childViews&&delete t._childViews,delete t._commitId,t},o=function(s,a){var l=p.defer();if(!s.hasOwnProperty("id"))return l.reject({status:400,data:"",message:"Element id not found, create element first!"}),l.promise;var r=w(s);return d.post(u.getPostElementsURL({projectId:r._projectId,refId:r._refId,returnChildViews:a}),{elements:[r],source:c.getSource()},{timeout:6e4}).then(function(e){var t=e.data.rejected;t&&0<t.length&&304===t[0].code&&t[0].element?l.resolve(t[0].element):angular.isArray(e.data.elements)&&0!==e.data.elements.length?function(e){var t=null;if(1<e.elements.length&&s.id){for(var n=0;n<e.elements.length;n++)e.elements[n].id===s.id&&(t=e.elements[n]);t||(t=e.elements[0])}else t=e.elements[0];var i={projectId:t._projectId,refId:t._refId,commitId:"latest",elementId:t.id},a=h(i,t),r=JSON.parse(JSON.stringify(t));h(i,r,!0);var o=m.get(["history",i.projectId,i.refId,i.elementId]);o&&o.unshift({_creator:t._modifier,_created:t._modified,id:t._commitId}),l.resolve(a)}(e.data):l.reject({status:500,data:"",message:"Server Error: empty response"})},function(e){if(409===e.status){var t=e.data.elements[0];f.cleanElement(t);var n=s._commitId;s._commitId="latest";var i=m.get(f.makeElementKey(s));if(s._commitId=n,!i)return void u.handleHttpStatus(e.data,e.status,e.headers,e.config,l);f.hasConflict(r,i,t)?u.handleHttpStatus(e.data,e.status,e.headers,e.config,l):(s._read=t._read,s._modified=t._modified,o(s,a).then(function(e){l.resolve(e)},function(e){l.reject(e)}))}else u.handleHttpStatus(e.data,e.status,e.headers,e.config,l)}),l.promise},y=function(e,t,n){return f.makeElementKey({_projectId:e.projectId,id:t||e.elementId,_commitId:e.commitId,_refId:e.refId},n)};return{getElement:s,getElements:function(a,e,t){var r=p.defer(),n={elements:[]},o=[];f.normalize(a);for(var i=0;i<a.elementIds.length;i++){var s=a.elementIds[i],l=y(a,s),c=m.get(l);c&&!t&&(!a.extended||a.extended&&c._qualifiedId)?o.push(c):n.elements.push({id:s})}return 0===n.elements.length?r.resolve(o):d.put(u.getPutElementsURL(a),n).then(function(e){var t,n=e.data.elements;if(n&&0<n.length)for(t=0;t<n.length;t++)o.push(h(a,n[t]));var i=e.data.deleted;if(i&&0<i.length)for(t=0;t<i.length;t++)b(a,i[t]);r.resolve(o)},function(e){u.handleHttpStatus(e.data,e.status,e.headers,e.config,r)}),r.promise},getElementForEdit:function(n,e,t){f.normalize(n);var i=y(n,n.elementId,!0),a=u.getElementURL(n)+"edit";if(v.hasOwnProperty(a))return v[a];var r=p.defer(),o=m.get(i);return o&&!t?r.resolve(o):(v[a]=r.promise,s(n,e,t).then(function(e){var t=JSON.parse(JSON.stringify(e));r.resolve(h(n,t,!0))},function(e){r.reject(e)}).finally(function(){delete v[a]})),r.promise},getOwnedElements:function(e,t,n){return f.normalize(e),e.depth||(e.depth=-1),i(u.getOwnedElementURL(e),e,"elements",t,n)},updateElement:o,updateElements:function(e,n){var t,i,a=p.defer();if(i=e,l.every(i,function(e){return e.hasOwnProperty("id")&&e.hasOwnProperty("_projectId")&&e.hasOwnProperty("_refId")})){var r=e.map(function(e){return w(e)}),o=(t=r,l.groupBy(t,function(e){return e._projectId+"|"+e._refId})),s=[];Object.keys(o).forEach(function(e){var a,t,r;s.push((a=o[e],t=n,r=p.defer(),d.post(u.getPostElementsURL({projectId:a[0]._projectId,refId:a[0]._refId,returnChildViews:t}),{elements:a,source:c.getSource()},{timeout:6e4}).then(function(e){!function(e,t){var r=[];e.data.elements.forEach(function(e){var t,n={projectId:(t=e)._projectId,refId:t._refId,commitId:"latest",elementId:t.id},i=JSON.parse(JSON.stringify(e));r.push(h(n,e)),h(n,i,!0);var a=m.get(["history",n.projectId,n.refId,n.elementId]);a&&a.unshift({_creator:e._modifier,_created:e._modified,id:e._commitId})});var n=e.data.rejected;n&&0<n.length&&n.forEach(function(e){304===e.code&&e.element&&r.push(e.element)}),t.resolve(r)}(e,r)},function(e){var t,n,i;n=r,i=a,(t=e).data=i,u.handleHttpStatus(t.data,t.status,t.headers,t.config,n)}),r.promise))}),p.allSettled(s).then(function(e){var t=e.filter(function(e){return"fulfilled"===e.state}),n=l.flatten(t.map(function(e){return e.value}));if(t.length===s.length)a.resolve(n);else{var i=e.filter(function(e){return"rejected"===e.state}).map(function(e){return e.reason});a.reject({failedRequests:i,successfulRequests:n})}})}else a.reject({failedRequests:[{status:400,data:e,message:"Some of the elements do not have id, _projectId, _refId"}],successfulRequests:[]});return a.promise},createElement:function(i){f.normalize(i);var a=p.defer(),e=u.getPostElementsURL(i);return d.post(e,{elements:[i.element],source:c.getSource()}).then(function(e){if(angular.isArray(e.data.elements)&&0!==e.data.elements.length){var t=null;if(1<e.data.elements.length&&i.element.id){for(var n=0;n<e.data.elements.length;n++)e.data.elements[n].id===i.element.id&&(t=e.data.elements[n]);t||(t=e.data.elements[0])}else t=e.data.elements[0];a.resolve(h(i,t))}else a.reject({status:500,data:"",message:"Server Error: empty response"})},function(e){u.handleHttpStatus(e.data,e.status,e.headers,e.config,a)}),a.promise},createElements:function(a){f.normalize(a);var r=p.defer(),e=u.getPostElementsURL(a);return d.post(e,{elements:a.elements,source:c.getSource()}).then(function(e){if(angular.isArray(e.data.elements)&&0!==e.data.elements.length){for(var t=[],n=0;n<e.data.elements.length;n++){t.push(h(a,e.data.elements[n]));var i=JSON.parse(JSON.stringify(e.data.elements[n]));h(a,i,!0)}r.resolve(t)}else r.reject({status:500,data:"",message:"Server Error: empty response"})},function(e){u.handleHttpStatus(e.data,e.status,e.headers,e.config,r)}),r.promise},fillInElement:w,getGenericElements:i,getElementHistory:function(e,t,n){f.normalize(e);var i=u.getElementHistoryURL(e);if(v.hasOwnProperty(i))return v[i];var a=["history",e.projectId,e.refId,e.elementId],r=p.defer();return m.exists(a)&&!n?r.resolve(m.get(a)):(v[i]=r.promise,d.get(u.getElementHistoryURL(e)).then(function(e){r.resolve(m.put(a,e.data.commits,!0)),delete v[i]},function(e){u.handleHttpStatus(e.data,e.status,e.headers,e.config,r),delete v[i]})),r.promise},isCacheOutdated:function(e){var t=p.defer();return t.resolve({status:!1}),t.promise},cacheElement:h,search:function(e,t,n){f.normalize(e);var i=u.getElementSearchURL(e),a=p.defer();return d.put(i,t).then(function(e){a.resolve(e.data)},function(e){u.handleHttpStatus(e.data,e.status,e.headers,e.config,a)}),a.promise},reset:function(){v={}}}}function FullDocumentService(t,i,a,d,m){return function(e){var r=this;function o(e,t){var n=!0;return e<r._views.length&&t<r._views.length&&(Array.prototype.push.apply(r.viewsBuffer,r._views.slice(e,t+1)),n=!1,t===r._views.length-1&&c(function(){r._isFullDocFullyLoaded=!0})),n}function n(e,t){d.remove(e,function(e){return-1!==t.indexOf(e.id)})}function s(e){return d.findIndex(r.viewsBuffer,{id:e})}function l(e){return d.findIndex(r._views,{id:e})}function c(e){t(function(){0===a.pendingRequests.length?e():c(e)},500)}this.viewsBuffer=[],this.handleClickOnBranch=function(e,t){var n=function(e){var t=!0;if(-1===s(e)){var n=l(e);-1!==n&&o(r.viewsBuffer.length,n),t=!1}return t}("view"===e.type?e.data.id:e.viewId);if(n)t();else{var i=m.info("Loading more views!",{ttl:-1});c(function(){i.destroy(),t()})}return n},this.loadRemainingViews=function(t){if(r._isFullDocFullyLoaded)t();else{var n;r._loadingRemainingViewsMessage||(r._loadingRemainingViewsMessage=m.info("Loading more views!",{ttl:-1,onclose:function(){delete r._loadingRemainingViewsMessage}})),r._isLoadingRemaingViews||(r._isLoadingRemaingViews=!0,n=i(function(){var e=r.viewsBuffer.length+9;e>=r._views.length&&(e=r._views.length-1),o(r.viewsBuffer.length,e),e===r._views.length-1&&(i.cancel(n),c(function(){t(),r._isLoadingRemaingViews=!1,r._loadingRemainingViewsMessage&&(r._loadingRemainingViewsMessage.destroy(),delete r._loadingRemainingViewsMessage)}))},1e3))}},this.handleDocumentScrolling=function(){return o(r.viewsBuffer.length,r.viewsBuffer.length)},this.addInitialViews=function(e){!function t(n,i){var a=o(r.viewsBuffer.length,r.viewsBuffer.length);c(function(){var e=i();e||a?n():t(n,i)})}(m.info("Loading initial view!",{ttl:-1}).destroy,e)},this.handleViewAdd=function(e,t){var n=l(t);r._views.splice(n+1,0,e);var i=s(t);-1===i?o(r.viewsBuffer.length,n+1):(a=i+1,r.viewsBuffer.splice(a,0,r._views[a]));var a},this.handleViewDelete=function(e){var t=[];(function t(e,n){"view"===e.type&&(n.push(e.data.id),e.children.forEach(function(e){t(e,n)}))})(e,t),n(r._views,t),n(r.viewsBuffer,t)},this._views=e,this._isLoadingRemaingViews=!1,this._isFullDocFullyLoaded=!1}}function HttpService(r){var o={0:[],1:[]},s={},l=0,c=20,d=function(t,n,i,e){void 0===e&&(e=1);var a={url:t,successCallback:n,errorCallback:i,weight:e};c<=l?(2===a.weight?r.get(t).then(function(e){n(e.data,e.status,e.headers,e.config)},function(e){i(e.data,e.status,e.headers,e.config)}).finally(function(){s.hasOwnProperty(t)&&delete s[t]}):0===a.weight?o[0].push(a):o[1].push(a),s.hasOwnProperty(t)?s[t].weight<a.weight&&(s[t].weight=a.weight):s[t]=a):(l++,s[t]=a,r.get(t).then(function(e){n(e.data,e.status,e.headers,e.config)},function(e){i(e.data,e.status,e.headers,e.config)}).finally(function(){var e;l--,s.hasOwnProperty(t)&&delete s[t],0<o[1].length?(e=o[1].shift(),d(e.url,e.successCallback,e.errorCallback,e.weight)):0<o[0].length&&(e=o[0].shift(),d(e.url,e.successCallback,e.errorCallback,e.weight))}))};return{get:d,ping:function(e,t){if(void 0===t&&(t=1),s.hasOwnProperty(e)&&t>s[e].weight){var n,i=s[e];n=0===i.weight?o[0].indexOf(i):o[1].indexOf(i),1===t&&-1!==n?(i.weight=1,o[1].push(i),o[0].splice(n,1)):2===t&&-1!==n&&(0===i.weight?o[0].splice(n,1):o[1].splice(n,1),d(i.url,i.successCallback,i.errorCallback,t))}},setOutboundLimit:function(e){c=e},getOutboundLimit:function(){return c},getQueue:function(){return o},transformQueue:function(){if(0<o[1].length){for(var e=0;e<o[1].length;e++)o[1][e].weight=0,o[0].push(o[1][e]);o[1]=[]}},dropAll:function(){o[1].length=0,o[0].length=0,s={},l=0}}}function JobService(d,m,e,p,t,u,o){var f="",n=e.host();if("localhost"!=n&&"0.0.0.0"!=n){var i=n.split("-");if(1===i.length)p.setJobsUrl("https://cae-pma.jpl.nasa.gov");else{var a=i[i.length-1];p.setJobsUrl("https://cae-pma-"+a)}f=n}else p.setJobsUrl("https://cae-pma-test.jpl.nasa.gov"),f="opencae-test.jpl.nasa.gov";return{createJob:function(e,t,n){var i=d.defer(),a=e.id,r=e.jobName,o="docgen",s="";e.jobType&&(o=e.jobType),e.jobSchedule&&(s=e.jobSchedule);var l={jobName:r,type:o,schedule:s,associatedElementID:a,mmsServer:f,alfrescoToken:u.getTicket()},c=p.getCreateJobURL(t,n);return m.post(c,l).then(function(e){i.resolve(e.data.jobs[0])},function(e){i.reject(e)}),i.promise},getJobs:function(i,e,t){var a=d.defer(),n=p.getJobsURL(e,t,f),r=[];return m.get(n).then(function(e){var t;if(e.data.jobs){t=e.data.jobs;for(var n=0;n<t.length;n++)t[n].associatedElementID===i&&r.push(t[n])}a.resolve(r)},function(e){a.reject(e)}),a.promise},getJobInstances:function(e,t,n){var i=d.defer(),a=p.getJobInstancesURL(t,n,e,f);return m.get(a).then(function(e){i.resolve(e.data.jobInstances)},function(e){i.reject(e)}),i.promise},runJob:function(e,t,n){var i=d.defer(),a=p.getRunJobURL(t,n,e.id),r={mmsServer:f,alfrescoToken:u.getTicket()};return e.post&&o.merge(r,e.post),m.post(a,r).then(function(e){i.resolve(e.data.jobInstances)},function(e){i.reject(e)}),i.promise}}}function MentionService(x,T,c,r,n,o,s){var P={},O="mentionPlaceHolder";return{getFastCfListing:d,createMention:m,handleInput:function(e,t,n,i){var r=t._.elementsPath.list[0].$,a=r.getAttribute("id"),o=u(a);if(o){var s=p(t.id,o);s||(m(t,n,i,{mentionId:o,mentionPlaceHolderId:a}),s=p(t.id,o));var l=s.mentionScope;l.$apply(function(){var i,a,e=r.innerText;e=e.substring(1),l.mmsMentionValue=e,i=t,a=s,c(function(){var e=a.mentionElement,t=e.find("ul.dropdown-menu");if(0<t.children().length&&!t.isOnScreen()){var n=A(i).getBoundingClientRect();e.css({top:n.top,left:n.left})}},0,!1)}),function(e,t,n,i,a){switch(e.data.$.which){case 38:g(t,!1);break;case 40:g(t,!0);break;case 13:!function(e,t,n,i){var a=$("#"+t+" .active .mentionMatch");if(0<a.length){var r=a.attr("id"),o=(l=r,d(n,i).find(function(e){return e.id+e.type===l})),s=p(e,t);s.mentionController.selectMentionItem(o)}var l}(n.id,t,i,a);break;case 27:f(n,t,!0)}}(e,o,t,n,i)}},handleMentionSelection:function(e,t){f(e,t)},removeAllMentionForEditor:function(n){Object.keys(P).filter(function(e){var t=e.split("-");return t[0]===n.id}).forEach(function(e){f(n,e.split("-")[1])})},hasMentionResults:function(e){var t=u(e._.elementsPath.list[0].$.getAttribute("id"));if(t)return 0<$("#"+t).find("ul").children().length;return!1}};function d(e,t){return n.getLatestElements(e,t).reduce(function(e,t){var n=o.getElementType(t),i=s.getElementTypeClass(t,n);if(e.push({id:t.id,name:t.name,type:"name",iconClass:i,documentation:t.documentation||"no text",editor:t._modifier,editTime:r(t._modified).fromNow(),elementType:n||t.type}),null!=t.documentation&&e.push({id:t.id,name:t.name,type:"doc",iconClass:i,documentation:t.documentation||"no text",editor:t._modifier,editTime:r(t._modified).fromNow(),elementType:n||t.type}),"Property"===t.type&&t.defaultValue){var a=String(t.defaultValue.value);a&&"undefined"!==a||(a="this field is empty"),e.push({id:t.id,name:t.name,type:"val",iconClass:i,value:a,editor:t._modifier,editTime:r(t._modified).fromNow(),elementType:t.type})}return e},[])}function m(e,t,n,i){var a,r,o,s,l,c,d,m,p,u,f,g,v,h,b,w,y,I,_,S,E,C=i?i.mentionId:function(){function e(){return Math.random().toString(16).slice(-4)}return e()+e()+e()+e()+e()+e()+e()+e()}(),j=i?i.mentionPlaceHolderId:(r=C,o=O+"-"+(a=e).id+"-"+r,s='<span id="'+o+'">@</span>',a.insertHtml(s),o),k=(l=e,c=C,d=t,m=n,p=Object.assign(x.$new(),{mmsEditor:l,mmsMentionValue:"",mmsMentionId:c,mmsProjectId:d,mmsRefId:m}),u=T('<span mms-mention mms-editor="mmsEditor" mms-mention-value="mmsMentionValue" mms-mention-id="mmsMentionId" mms-project-id="mmsProjectId" mms-ref-id="mmsRefId"></span>')(p),{scope:p,controller:u.controller("mms-mention"),element:u});f=k,g=j,v=C,h=R(e.id,v),b={mentionScope:f.scope,mentionController:f.controller,mentionElement:f.element,mentionId:v,mentionPlaceHolderId:g},P[h]=b,w=k.element,y=j,I=A(e),_=I.getBoundingClientRect(),S=I.contentDocument.getElementById(y),E=$(S)[0].getBoundingClientRect(),w.css({position:"absolute",top:_.top+E.top+30,left:_.left+E.left}),$("body").append(w)}function A(e){return e.container.$.getElementsByTagName("iframe")[0]}function p(e,t){return P[R(e,t)]}function R(e,t){return e+"-"+t}function u(e){return e&&-1<e.indexOf(O)?e.split("-")[2]:null}function f(e,t,n){var i=p(e.id,t),a=i.mentionPlaceHolderId,r=e.document.getById(a);if(n){var o=e.createRange();o&&r&&(o.moveToClosestEditablePosition(r,!0),$(r.$).contents().unwrap(),o.select())}else r.remove();i.mentionScope.$destroy(),i.mentionElement.remove(),delete P[R(e.id,t)]}function g(e,t){var n=$("#"+e).find("li"),i=n.length,a=-1;if(n.each(function(e){$(this).hasClass("active")&&(a=e)}),-1!==a){var r;r=t?(a+1)%i:0===a?i-1:(a-1)%i;var o=$(n[r]);o.addClass("active"),$(n[a]).removeClass("active"),o[0].parentNode.scrollTop=o[0].offsetTop}}}function ProjectService(m,p,r,u,f,g,v){var h={},e=function(a){var r=["refs",a],e=g.getRefsURL(a);if(h.hasOwnProperty(e))return h[e];var o=m.defer();return u.exists(r)?o.resolve(u.get(r)):(h[e]=o.promise,p.get(e).then(function(e){if(angular.isArray(e.data.refs)){for(var t=[],n=0;n<e.data.refs.length;n++){var i=e.data.refs[n];"master"===i.id&&(i.type="Branch"),u.put(["ref",a,i.id],i,!0),t.push(u.get(["ref",a,i.id]))}u.put(r,t,!1),o.resolve(u.get(r))}else o.reject({status:500,data:"",message:"Server Error: empty response"})},function(e){g.handleHttpStatus(e.data,e.status,e.headers,e.config,o)}).finally(function(){delete h[e]})),o.promise},t=function(r,o){var s=["groups",r,o=o||"master"],e=g.getGroupsURL(r,o);if(h.hasOwnProperty(e))return h[e];var l=m.defer();return u.exists(s)?l.resolve(u.get(s)):(h[e]=l.promise,p.get(e).then(function(e){if(angular.isArray(e.data.groups)){for(var t=[],n={projectId:r,refId:o,commitId:"latest"},i=0;i<e.data.groups.length;i++){var a=e.data.groups[i];n.elementId=a.id,a=f.cacheElement(n,a,!1),u.put(["group",r,o,a.id],a,!0),t.push(u.get(["group",r,o,a.id]))}u.put(s,t,!1),l.resolve(u.get(s))}else l.reject({status:500,data:"",message:"Server Error: empty response"})},function(e){g.handleHttpStatus(e.data,e.status,e.headers,e.config,l)}).finally(function(){delete h[e]})),l.promise},n=[{terms:{_appliedStereotypeIds:["_17_0_5_407019f_1336584858932_290814_11897","_17_0_2_407019f_1354126823633_971278_12922","_17_0_2_3_407019f_1390932205525_919663_29081","_17_0_1_407019f_1328144768208_151103_11611","_18_5_8bf0285_1486490948776_422870_16475","_17_0_2_3_407019f_1380044908011_537162_29414","_18_0_6_8bf0285_1480702282066_678566_13974","_18_0_5_407019f_1470005595314_374414_14088","_17_0_1_407019f_1320688868391_878682_2122","_17_0_5_407019f_1334873987130_64195_11860","_17_0_1_244d03ea_1319490838789_76536_23321","_17_0_1_244d03ea_1319490696098_585884_23244","_17_0_1_244d03ea_1319490675924_494597_23220","_17_0_2_3_e81034b_1378849795852_475880_29502","_17_0_1_244d03ea_1319490856319_735016_23345","_17_0_5_407019f_1346952773459_128964_11915","_17_0_1_244d03ea_1319492675769_542703_24690","_17_0_1_244d03ea_1319490805237_397889_23292","_17_0_1_244d03ea_1319491813759_405316_23859","_17_0_1_22b603cd_1319577320837_597116_24044","_17_0_1_244d03ea_1319490870282_714178_23369","_17_0_1_244d03ea_1319490921274_829705_23417","_17_0_2_3_e81034b_1378849355455_639118_29417","_17_0_1_244d03ea_1319490658057_783239_23196","_17_0_1_244d03ea_1319490607459_890787_23148","_17_0_1_244d03ea_1319490639053_446661_23172","_17_0_1_24c603f9_1318965749289_636288_15241","_17_0_1_244d03ea_1319490721410_468874_23268","_17_0_1_244d03ea_1319490880431_889010_23393","_17_0_2_3_407019f_1377878750778_198079_29401","_17_0_2_3_407019f_1377881591361_754431_29966","_17_0_5_407019f_1337970852079_693660_12393","_17_0_2_3_407019f_1377878719961_37575_29374","_17_0_1_24c603f9_1318965764947_847626_15265","_17_0_2_1_407019f_1358445062164_196970_12977","_17_0_1_244d03ea_1319496225382_275996_25443","_17_0_1_244d03ea_1319498258297_961829_27083","_17_0_1_244d03ea_1319496302084_771803_25570","_17_0_1_244d03ea_1319496280368_246829_25514","_18_5_2_8bf0285_1506039168690_925234_16001","_17_0_1_407019f_1326235066484_404532_2489","_17_0_1_244d03ea_1319512564304_251824_28229","_18_0_5_ef50357_1480453603002_831462_13966","_17_0_2_3_407019f_1383246724224_41450_29079","_17_0_2_3_407019f_1375477696989_696093_29350","_17_0_2_3_407019f_1375478079564_152907_29404","_17_0_2_3_407019f_1392933505529_270043_29089","_17_0_2_3_e9f034d_1375474838719_217024_29345","_17_0_2_3_eac0346_1374702066208_763130_29330","_17_0_2_3_eac0346_1374701945748_238477_29309","_17_0_2_3_407019f_1383165357327_898985_29071","_9_0_be00301_1108044380615_150487_0","_10_0_622020d_1127207234373_259585_1","_12_1_8f90291_1173963323875_662612_98","_16_0_62a020a_1227788740027_441955_240","_17_0_2_3_ff3038a_1383749269646_31940_44489","_16_5beta1_8ba0276_1232443673758_573873_267","_9_0_be00301_1108044563999_784946_1","_11_5EAPbeta_be00301_1151484491369_618395_1","_15_5EAPbeta1_8f90291_1207743469046_796042_162","_18_0beta_8e8028e_1384177586203_506524_3245","_9_0_be00301_1108044721245_236588_411","_17_0_2beta_903028d_1330931963982_116619_1920","_18_5beta_8ba0279_1468931052415_679497_4210","_17_0_2beta_903028d_1330931963978_770627_1918","_18_1_8760276_1416414449210_764904_3981","_17_0_5beta_f720368_1373961709543_89140_3280","_9_0_be00301_1108044705753_203399_228"]}},{terms:{type:["Dependency","Abstraction","ComponentRealization","InterfaceRealization","Deployment","Manifestation","Realization","Substitution","Usage","ElementImport","Extend","Include","InformationFlow","PackageImport","ProfileApplication","ProtocolConformance","TemplateBinding","Generalization","Association","Connector","ConnectorEnd","ControlFlow","ObjectFlow","Mount","FinalNode","JoinNode","ForkNode","MergeNode","FlowFinalNode","InitialNode","ActivityFinalNode","ActivityPartition","DecisionNode","Transition"]}}],i=function(e,t){return{size:0,aggs:{stereotypedElements:{filter:{bool:{must:[{term:{_projectId:e}},{term:{_inRefIds:t}},{exists:{field:"_appliedStereotypeIds"}}],must_not:n}},aggs:{stereotypeIds:{terms:{field:"_appliedStereotypeIds",size:20}}}},elements:{filter:{bool:{must:[{term:{_projectId:e}},{term:{_inRefIds:t}}],must_not:n}},aggs:{types:{terms:{field:"type",size:20}}}}}}};return{getProjects:function(a){var r=m.defer(),e=g.getProjectsURL(a);if(h.hasOwnProperty(e))return h[e];var o=a?["projects",a]:"projects";return u.exists(o)?r.resolve(u.get(o)):(h[e]=r.promise,p.get(e).then(function(e){if(angular.isArray(e.data.projects)){for(var t=[],n=0;n<e.data.projects.length;n++){var i=e.data.projects[n];a&&(i.orgId=a),u.put(["project",i.id],i,!0),t.push(u.get(["project",i.id]))}u.put(o,t,!1),r.resolve(u.get(o))}else r.reject({status:500,data:"",message:"Server Error: empty response"})},function(e){g.handleHttpStatus(e.data,e.status,e.headers,e.config,r)}).finally(function(){delete h[e]})),r.promise},getProject:function(e){var t=m.defer(),n=g.getProjectURL(e);if(h.hasOwnProperty(n))return h[n];var i=["project",e];return u.exists(i)?t.resolve(u.get(i)):(h[n]=t.promise,p.get(n).then(function(e){angular.isArray(e.data.projects)&&0!==e.data.projects.length?(u.put(i,e.data.projects[0],!0),t.resolve(u.get(i))):t.reject({status:500,data:"",message:"Server Error: empty response"})},function(e){g.handleHttpStatus(e.data,e.status,e.headers,e.config,t)}).finally(function(){delete h[n]})),t.promise},getProjectMounts:function(e,t){var n=m.defer(),i=g.getProjectMountsURL(e,t);if(h.hasOwnProperty(i))return h[i];var a=["project",e,t];return u.exists(a)?n.resolve(u.get(a)):(h[i]=n.promise,p.get(i).then(function(e){angular.isArray(e.data.projects)&&0!==e.data.projects.length?(u.put(a,e.data.projects[0],!0),n.resolve(u.get(a))):n.reject({status:500,data:"",message:"Server Error: empty response"})},function(e){g.handleHttpStatus(e.data,e.status,e.headers,e.config,n)}).finally(function(){delete h[i]})),n.promise},getOrgs:function(){var a="orgs";if(h.hasOwnProperty(a))return h[a];var r=m.defer();return u.exists(a)?r.resolve(u.get(a)):(h[a]=r.promise,p.get(g.getOrgsURL()).then(function(e){for(var t=[],n=0;n<e.data.orgs.length;n++){var i=e.data.orgs[n];u.put(["org",i.id],i,!0),t.push(u.get(["org",i.id]))}u.put(a,t,!1),r.resolve(u.get(a))},function(e){g.handleHttpStatus(e.data,e.status,e.headers,e.config,r)}).finally(function(){delete h[a]})),r.promise},getOrg:function(e){var t=m.defer(),n=["org",e],i=g.getOrgURL(e);return h.hasOwnProperty(i)?h[i]:(u.exists(n)?t.resolve(u.get(n)):(h[i]=t.promise,p.get(i).then(function(e){!e.data.orgs||e.data.orgs.length<1?t.reject({status:404,data:"",message:"Org not found"}):(u.put(n,e.data.orgs[0],!0),t.resolve(u.get(n)))},function(e){g.handleHttpStatus(e.data,e.status,e.headers,e.config,t)}).finally(function(){delete h[i]})),t.promise)},getRefs:e,getRef:function(n,i){var a=m.defer();return e(i).then(function(e){var t=u.get(["ref",i,n]);t?a.resolve(t):a.reject({status:404,data:"",message:"Ref not found"})},function(e){a.reject(e)}),a.promise},getRefHistory:function(e,t,n){var i,a=m.defer();return i=null!==n?g.getRefHistoryURL(t,e,n):g.getRefHistoryURL(t,e),h[i]=a.promise,p.get(i).then(function(e){angular.isArray(e.data.commits)&&0!==e.data.commits.length?a.resolve(e.data.commits):a.reject({status:500,data:"",message:"Error: Project does not exist at specified time."})},function(e){g.handleHttpStatus(e.data,e.status,e.headers,e.config,a)}).finally(function(){delete h[i]}),a.promise},getGroups:t,getGroup:function(n,i,a){var r=m.defer();return t(i,a).then(function(e){var t=u.get(["group",i,a,n]);t?r.resolve(t):r.reject({status:404,data:"",message:"Group not found"})},function(e){r.reject(e)}),r.promise},createRef:function(e,i){var a=m.defer(),t=g.getRefsURL(i);return p.post(t,{refs:[e],source:r.getSource()}).then(function(e){if(angular.isArray(e.data.refs)&&0!==e.data.refs.length){var t=e.data.refs[0],n=u.get(["refs",i]);n&&n.push(t),a.resolve(u.put(["ref",i,t.id],t))}else a.reject({status:500,data:"",message:"Server Error: empty response"})},function(e){g.handleHttpStatus(e.data,e.status,e.headers,e.config,a)}),a.promise},updateRef:function(e,n){var i=m.defer(),t=g.getRefsURL(n);return p.post(t,{refs:[e],source:r.getSource()}).then(function(e){if(angular.isArray(e.data.refs)&&0!==e.data.refs.length){var t=e.data.refs[0];i.resolve(u.put(["ref",n,t.id],t,!0))}else i.reject({status:500,data:"",message:"Server Error: empty response"})},function(e){g.handleHttpStatus(e.data,e.status,e.headers,e.config,i)}),i.promise},deleteRef:function(r,o){var s=m.defer(),e=g.getRefURL(o,r);return p.delete(e).then(function(e){var t=["ref",o,r],n=u.get(t);if(n){u.remove(t);var i=u.get(["refs",o]);if(i)for(var a=0;a<i.length;a++)if(i[a].id===n.id){i.splice(a,1);break}}s.resolve("")},function(e){g.handleHttpStatus(e.data,e.status,e.headers,e.config,s)}),s.promise},getMetatypes:function(s,l){var c=["metatypes",s,l=l||"master"],e=g.getSearchURL(s,l);if(h.hasOwnProperty(e))return h[e];var d=m.defer();if(u.exists(c))d.resolve(u.get(c));else{h[e]=d.promise;var t=i(s,l);p.put(e,t).then(function(e){var t=e.data.aggregations;if(angular.isDefined(t)){var n=[],i=t.elements.types.buckets,a=v.map(i,function(e){return{id:e.key,name:e.key}});n=a;var r=t.stereotypedElements.stereotypeIds.buckets,o={elementIds:v.pluck(r,"key"),projectId:s,refId:l};f.getElements(o,2).then(function(e){var t=v.map(e,function(e){return{id:e.id,name:e.name}});n=n.concat(t),u.put(c,n,!1),d.resolve(u.get(c))})}else d.reject({status:500,data:"",message:"Could not find metatypes"})},function(e){g.handleHttpStatus(e.data,e.status,e.headers,e.config,d)}).finally(function(){delete h[e]})}return d.promise},reset:function(){h={}}}}function ShortenUrlService(n,i,a,t){return{dynamicPopover:{templateUrl:"shareUrlTemplate.html",title:"Share"},copyToClipboard:function(e){t.copyToClipboard($("#ve-short-url"),e)},getShortUrl:function(e,t){return n.post("https://purl-prod.jpl.nasa.gov/create",{url:e},{headers:{Authorization:"Basic Og=="}}).then(function(e){t.shortUrl="https://opencae.jpl.nasa.gov/goto/"+e.data.link},function(e){return a.handleHttpStatus(e.data,e.status,e.headers,e.config,i.defer())})}}}function StompService(l,c,d,e,t,m,p,u){var n,f={};t.get(e.getJMSHostname()).then(function(e){if(e.data.connections[0].hasOwnProperty("uri")){var t=e.data.connections[0].uri.replace(/.*?:\/\//g,"");n="wss://"+t.substring(0,t.length-6)+":61614",r()}else console.log("JSON does not contain the right key.  STOMP failed.")},function(e){console.log("failed to connect to the JMS:  "+e.status)});var i=function(e){var t=angular.fromJson(e.body),n=e.headers.projectId,i=e.headers.refId;if(i=i||"master",t.source!==c.getSource()&&t.refs&&t.refs.updatedElements&&0<t.refs.updatedElements.length&&angular.forEach(t.refs.updatedElements,function(e){var t=m.makeElementKey({_projectId:n,_refId:i,id:e});p.exists(t)&&d.getElement({projectId:n,refId:i,extended:!0,elementId:e},1,!0).then(function(e){l.$broadcast("element.updated",e,null,!0)})}),t.createdRef){var a=t.createdRef,r=p.get(["refs",n]),o=-1;r&&(-1<(o=u.findIndex(r,{id:a.id}))?Object.assign(r[o],a):r.push(a)),p.put(["ref",n,a.id],a),l.$broadcast("stomp.branchCreated",a,n)}if(t.updatedJobs){var s=t.updatedJobs;l.$broadcast("stomp.updateJob",s)}l.$on("$destroy",function(){f.unsubscribe("/topic/master")})},a=function(e){console.log("STOMP: "+e),r(),console.log("STOMP: Reconnecting in 10 seconds")},r=function(){(f=Stomp.client(n)).debug=null,f.connect("guest","guest",function(){f.subscribe("/topic/master",i)},a,"/")};return{}}function TableService(d,e,t,n,i,a,r){function s(e,n){return d(function(t){c(n,e).then(function(e){e.values.shift(),t(e.values)})})}function l(a,r){return d(function(t){var n=[],i=[];r.forEach(function(e){c(e,a).then(function(e){(n.push(e.values),i.push(e.valuesO),n.length===r.length)&&t({c3_data:n,valuesO:i})})})})}function o(e){return e&&"LiteralString"===e.type?isNaN(e.value)?e.value:Number(e.value):!e||"LiteralReal"!==e.type&&"LiteralInteger"!==e.type?void 0:e.value}function m(t,n,a){return d(function(i){if("text"==t.content[0].sourceType){var e=t.content[0].text.replace("<p>","").replace("</p>","").trim();isNaN(e)||(e=Number(e)),i({index:a,value:e,valueO:t})}else"reference"===t.content[0].sourceType&&(n.elementId=t.content[0].source,"name"===t.content[0].sourceProperty?r.getElement(n,1,!1).then(function(e){var t=e.name;isNaN(t)||(t=Number(t)),i({index:a,value:t,valueO:e})}):"documentation"===t.content[0].sourceProperty?r.getElement(n,1,!1).then(function(e){var t=e.documentation.replace("<p>","").replace("</p>","").trim();isNaN(t)||(t=Number(t)),i({index:a,value:t,valueO:e})}):r.getElement(n,1,!1).then(function(e){var t=e,n="";"Property"!==e.type&&"Port"!==e.type||(n=e.defaultValue?o(e.defaultValue):""),"Slot"===e.type&&(n=o(e.value[0])),i({index:a,value:n,valueO:t})}))})}function c(r,o){return d(function(t){var n=[],i=[],a=0;r.forEach(function(e){0===e.content.length?(n[a]=null,i[a]=null,a++):"Paragraph"==e.content[0].type&&m(e,o,a++).then(function(e){(n[e.index]=e.value,i[e.index]=e.valueO,n.length===r.length)&&t({values:n,valuesO:i})})})})}return{toValidId:function(e){return e.replace(/[^a-zA-Z0-9_]/gi,"")},plotConfig:function(e,t){var n=t;return void 0!==e&&(void 0!==e.size&&(null==e.size.width||isNaN(e.size.width)||(n.width=Number(e.size.width)),null==e.size.height||isNaN(e.size.height)||(n.height=Number(e.size.height))),void 0!==e.padding&&(null==e.padding.top||isNaN(e.padding.top)||(n.marginTop=Number(e.padding.top)),null==e.padding.right||isNaN(e.padding.right)||(n.marginRight=Number(e.padding.right)),null==e.padding.left||isNaN(e.padding.left)||(n.marginLeft=Number(e.padding.left)),null==e.padding.bottom||isNaN(e.padding.bottom)||(n.marginBottom=Number(e.padding.bottom)))),n},readvalues:function(e,t,n,i){var a=d.defer(),r={projectId:t,refId:n,commitId:i},o=void 0!==e.table.header&&0<e.table.header.length;return o?s(r,e.table.header[0]).then(function(n){l(r,e.table.body).then(function(e){var t={tableheader:n,tablebody:e,isHeader:o};a.resolve(t)})}):l(r,e.table.body).then(function(e){var t={tablebody:e,isHeader:o};a.resolve(t)}),a.promise},readvalues2:function(t,e,n,i){var a=d.defer(),r={projectId:e,refId:n,commitId:i},o=void 0!==t.table.header&&0<t.table.header.length;return o?s(r,t.table.header[0]).then(function(n){var l,c,e;(l=r,c=t.table.body,e=n,d(function(n){var i=[],a=[],t=e.slice(0);t.splice(0,0,"rowheader"),c.forEach(function(e){var r,o,s;(r=e,o=l,s=t,d(function(n){var i=[],a=[],t=0;r.forEach(function(e){0===e.content.length?(i[s[t]]=null,a[t]=null,t++):"Paragraph"==e.content[0].type&&m(e,o,t++).then(function(e){if(i[s[e.index]]=e.value,a[e.index]=e.valueO,a.length===r.length){var t={valuesx:i,valuesO:a};n(t)}})})})).then(function(e){if(i.push(e.valuesx),a.push(e.valuesO),a.length===c.length){var t={c3_data:i,valuesO:a};n(t)}})})})).then(function(e){var t={tableheader:n,tablebody:e,isHeader:o};a.resolve(t)})}):l(r,t.table.body).then(function(e){var t={tablebody:e,isHeader:o};a.resolve(t)}),a.promise}}}function urlService(e,t){var n,i=e,a=t,r="https://cae-pma-int:8443/",o=function(e){var t=e;return n&&(0<t.indexOf("?")?t+="&alf_ticket="+n:t+="?alf_ticket="+n),t},s=function(e){return!!e&&!!/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}[+]?-\d{4}$/.test(e.trim())},l=function(e,t){return 0<e.indexOf("?")?e+"&mmsServer="+t:e+"?mmsServer="+t},c=function(e,t){return"latest"===t?e:t?0<e.indexOf("?")?e+"&commitId="+t:e+"?commitId="+t:e},d=function(e,t){var n=e;return t&&(0<n.indexOf("?")?n+="&extended=true":n+="?extended=true"),n},m=function(e,t){var n=e;return t&&(0<n.indexOf("?")?n+="&childviews=true":n+="?childviews=true"),n};return{getRoot:function(){return i},setTicket:function(e){n=e},getJMSHostname:function(){return i+"/connection/jms"},getMmsServer:function(){return a},isTimestamp:s,getMmsVersionURL:function(){return o(i+"/mmsversion")},getSiteDashboardURL:function(e){return o("/share/page/site/"+e+"/dashboard")},getOrgURL:function(e){return o(i+"/orgs/"+e)},getOrgsURL:function(){return o(i+"/orgs")},getProjectsURL:function(e){return o(e?i+"/orgs/"+e+"/projects":i+"/projects")},getProjectURL:function(e){return o(i+"/projects/"+e)},getProjectMountsURL:function(e,t){return o(i+"/projects/"+e+"/refs/"+t+"/mounts")},getRefsURL:function(e){return o(i+"/projects/"+e+"/refs")},getRefURL:function(e,t){return o(i+"/projects/"+e+"/refs/"+t)},getRefHistoryURL:function(e,t,n){return""!==n&&s(n)?o(i+"/projects/"+e+"/refs/"+t+"/commits")+"&maxTimestamp="+n+"&limit=1":o(i+"/projects/"+e+"/refs/"+t+"/commits")},getGroupsURL:function(e,t){return o(i+"/projects/"+e+"/refs/"+t+"/groups")},getElementURL:function(e){var t=i+"/projects/"+e.projectId+"/refs/"+e.refId+"/elements/"+e.elementId;return d(o(c(t,e.commitId)),e.extended)},getViewElementIdsURL:function(e){var t=i+"/projects/"+e.projectId+"/refs/"+e.refId+"/elements/"+e.elementId+"/cfids";return o(t)},getPutElementsURL:function(e){var t=i+"/projects/"+e.projectId+"/refs/"+e.refId+"/elements";return d(o(c(t,e.commitId)),e.extended)},getPostElementsURL:function(e){return d(m(o(i+"/projects/"+e.projectId+"/refs/"+e.refId+"/elements"),e.returnChildViews),e.extended)},getOwnedElementURL:function(e){var t="recurse=true";e.depth&&(t="depth="+e.depth);var n=i+"/projects/"+e.projectId+"/refs/"+e.refId+"/elements/"+e.elementId;return 0<(n=c(n,e.commitId)).indexOf("?")?n+="&"+t:n+="?"+t,o(d(n,e.extended))},getElementHistoryURL:function(e){return o(i+"/projects/"+e.projectId+"/refs/"+e.refId+"/elements/"+e.elementId+"/commits")},getElementSearchURL:function(e){var t=i+"/projects/"+e.projectId+"/refs/"+e.refId+"/search"+(e.checkType?"?checkType=true":"");return d(o(t),!0)},getSearchURL:function(e,t,n){return o(null!==n||""!==n?i+"/projects/"+e+"/refs/"+t+"/search?"+n:i+"/projects/"+e+"/refs/"+t+"/search")},getProjectDocumentsURL:function(e){var t=i+"/projects/"+e.projectId+"/refs/"+e.refId+"/documents";return d(o(c(t,e.commitId)),e.extended)},getDocumentViewsURL:function(e){var t=i+"/projects/"+e.projectId+"/refs/"+e.refId+"/documents/"+e.elementId+"/views";return t=c(t,e.commitId),d(o(t),e.extended)},getImageURL:function(e){var t=i+"/projects/"+e.projectId+"/refs/"+e.refId+"/elements/"+e.elementId;return o(c(t,e.commitId))},getExportHtmlUrl:function(e,t){return o(i+"/projects/"+e+"/refs/"+t+"/convert")},getArtifactURL:function(e){var t=i+"/projects/"+e.projectId+"/refs/"+e.refId+"/artifacts/"+e.artifactId;return o(c(t,e.commitId))},getPutArtifactsURL:function(e){var t=i+"/projects/"+e.projectId+"/refs/"+e.refId+"/artifacts";return o(c(t,e.commitId))},getArtifactHistoryURL:function(e){var t=i+"/projects/"+e.projectId+"/refs/"+e.refId+"/artifacts/"+e.artifactId+"/commits";return o(t)},setJobsUrl:function(e){r=e+":8443/"},getJobsURL:function(e,t,n){return o(l(r+"projects/"+e+"/refs/"+t+"/jobs",n))},getJobURL:function(e,t,n,i){return o(l(r+"projects/"+e+"/refs/"+t+"/jobs/"+n,i))},getRunJobURL:function(e,t,n){return r+"projects/"+e+"/refs/"+t+"/jobs/"+n+"/instances"},getCreateJobURL:function(e,t){return r+"projects/"+e+"/refs/"+t+"/jobs"},getJobInstancesURL:function(e,t,n,i){return o(l(r+"projects/"+e+"/refs/"+t+"/jobs/"+n+"/instances",i))},getCheckLoginURL:function(){return i+"/checklogin"},getCheckTicketURL:function(e){return i+"/mms/login/ticket/"+e},getLogoutURL:function(){return o(i+"/api/login/ticket/"+n)},handleHttpStatus:function(e,t,n,i,a){var r={status:t,data:e};404===t?r.message="Not Found":500===t?angular.isString(e)&&0<=e.indexOf("ENOTFOUND")?r.message="Network Error (Please check network)":r.message="Server Error":r.message=401===t||403===t?"Permission Error":409===t?"Conflict":400===t?"Bad Request":410===t?"Deleted":408===t?"Timed Out":501===t?"Cacheing":"Timed Out (Please check network)",a.reject(r)}}}function UtilsService(a,r,e,o,s,l){var n="_11_5EAPbeta_be00301_1147420760998_43940_227",i=["_17_0_1_407019f_1332453225141_893756_11936","_17_0_1_232f03dc_1325612611695_581988_21583","_18_0beta_9150291_1392290067481_33752_4359"],c="_17_0_2_3_87b0275_1371477871400_792964_43374",d=["_project-bundle_mission_PackageableElement-mission_u003aRequirement_PackageableElement","_18_0_5_f560360_1476403587924_687681_736366","_18_0_5_f560360_1476403587924_687681_736366","_11_5EAPbeta_be00301_1147873190330_159934_2220"],m=["name","documentation","defaultValue","value","specification","id","_projectId","_refId","type"],p={_appliedStereotypeIds:[],appliedStereotypeInstanceId:null,classifierBehaviorId:null,clientDependencyIds:[],collaborationUseIds:[],documentation:"",elementImportIds:[],generalizationIds:[],interfaceRealizationIds:[],isAbstract:!1,isActive:!1,isFinalSpecialization:!1,isLeaf:!1,mdExtensionsIds:[],name:"",nameExpression:null,ownedAttributeIds:[],ownedOperationIds:[],ownerId:null,packageImportIds:[],powertypeExtentIds:[],redefinedClassifierIds:[],representationId:null,substitutionIds:[],supplierDependencyIds:[],syncElementId:null,templateBindingIds:[],templateParameterId:null,type:"Class",useCaseIds:[],visibility:"public"},u={appliedStereotypeInstanceId:null,classifierIds:[],clientDependencyIds:[],deploymentIds:[],documentation:"",mdExtensionsIds:[],name:"",nameExpression:null,ownerId:null,slotIds:[],specification:null,stereotypedElementId:null,supplierDependencyIds:[],syncElementId:null,templateParameterId:null,type:"InstanceSpecification",visibility:"public",_appliedStereotypeIds:[]},f={appliedStereotypeInstanceId:null,clientDependencyIds:[],documentation:"",mdExtensionsIds:[],name:"",nameExpression:null,supplierDependencyIds:[],syncElementId:null,templateParameterId:null,typeId:null,visibility:"public",_appliedStereotypeIds:[]},g={_appliedStereotypeIds:[],documentation:"",type:"Package",mdExtensionsIds:[],syncElementId:null,appliedStereotypeInstanceId:null,clientDependencyIds:[],supplierDependencyIds:[],name:"",nameExpression:null,visibility:null,templateParameterId:null,elementImportIds:[],packageImportIds:[],templateBindingIds:[],URI:"",packageMergeIds:[],profileApplicationIds:[]},v={appliedStereotypeInstanceId:null,documentation:"",generalizationSetIds:[],isSubstitutable:!0,mdExtensionsIds:[],syncElementId:null,type:"Generalization",_appliedStereotypeIds:[]},h={_appliedStereotypeIds:[],appliedStereotypeInstanceId:null,clientDependencyIds:[],documentation:"",mdExtensionsIds:[],name:"",nameExpression:null,supplierDependencyIds:[],syncElementId:null,templateParameterId:null,type:"Dependency",visibility:null},b=function(e){if(e.hasOwnProperty("valueExpression")&&delete e.valueExpression,e.operand)for(var t=0;t<e.operand.length;t++)b(e.operand[t])};var w=function(e,t,n,i){var a=['<table class="table-bordered table-condensed '+(e.style?e.style:"")+'">'];if(e.colwidths&&0<e.colwidths.length){a.push("<colgroup>");for(var r=0;r<e.colwidths.length;r++)e.colwidths[r]?a.push('<col style="width: '+e.colwidths[r]+'">'):a.push("<col>");a.push("</colgroup>")}return a.push("<tbody>"),a.push(_(e.body,!1)),a.push("</tbody>"),e.header&&e.header.length&&(t||n?a.push('<thead class="doc-table-header" >'):a.push("<thead>"),a.push(_(e.header,!0,t,n)),a.push("</thead>")),s.getState().inDoc&&!e.excludeFromList?a.push("<caption>Table {{mmsPe._veNumber}}. {{table.title || mmsPe.name}}</caption>"):e.title&&a.push("<caption>"+e.title+"</caption>"),a.push("</table>"),a.join("")},y={sortByColumnFn:"sortByColumnFn",showBindingForSortIcon:"sortColumnNum",filterDebounceRate:200,filterTermColumnPrefixBinding:"filterTermForColumn"},I=function(o){o.forEach(function(e,i){var a=0,r=0;e.forEach(function(e,t){0!==i&&0===t&&1<Number(o[i-1][0].rowspan)&&(a=Number(o[i-1][0].colspan));var n=Number(e.colspan);e.startRow=i,e.endRow=e.startRow+Number(e.rowspan)-1,e.startCol=a+r,e.endCol=e.startCol+n-1,r+=n}),r=a=0})},_=function(e,t,n,i){t&&(n||i)&&I(e);var a,r,o,s,l,c,d=[],m=t?"th":"td";for(a=0;a<e.length;a++){for(d.push("<tr>"),s=e[a],r=0;r<s.length;r++){for(l=s[r],d.push("<"+m+' colspan="'+l.colspan+'" rowspan="'+l.rowspan+'">'),o=0;o<l.content.length;o++){if(c=l.content[o],n||i?d.push("<div ng-style=\"{display: 'inline'}\">"):d.push("<div>"),"Paragraph"===c.type){var p=E(c);(n||i)&&"text"===c.sourceType&&(p=p.replace("<p>","<p ng-style=\"{display: 'inline'}\">")),d.push(p)}else"Table"===c.type?d.push(w(c)):"List"===c.type?d.push(S(c)):"Image"===c.type&&d.push('<mms-cf mms-cf-type="img" mms-element-id="'+c.id+'"></mms-cf>');d.push("</div>"),t&&(i&&1===Number(l.colspan)&&d.push('<span ng-click="'+y.sortByColumnFn+"("+l.startCol+')" ng-class="getSortIconClass('+l.startCol+')"></span>'),n&&d.push('<input class="no-print ve-plain-input filter-input" type="text" placeholder="Filter column" ng-show="showFilter" ng-model-options="{debounce: '+y.filterDebounceRate+'}" ng-model="'+y.filterTermColumnPrefixBinding+l.startCol+l.endCol+'">'))}d.push("</"+m+">")}d.push("</tr>")}return d.join("")},S=function(e){var t,n,i,a,r=[];for(e.ordered?r.push("<ol>"):r.push("<ul>"),t=0;t<e.list.length;t++){for(i=e.list[t],r.push("<li>"),n=0;n<i.length;n++)a=i[n],r.push("<div>"),"Paragraph"===a.type?r.push(E(a)):"Table"===a.type?r.push(w(a)):"List"===a.type?r.push(S(a)):"Image"===a.type&&r.push('<mms-cf mms-cf-type="img" mms-element-id="'+a.id+'"></mms-cf>'),r.push("</div>");r.push("</li>")}return e.ordered?r.push("</ol>"):r.push("</ul>"),r.join("")},E=function(e){if("text"===e.sourceType)return e.text;var t="doc",n="";return"name"===e.sourceProperty&&(t="name"),"value"===e.sourceProperty&&(t="val"),e.nonEditable&&(n=' non-editable="'+e.nonEditable+'"'),'<mms-cf mms-cf-type="'+t+'" mms-element-id="'+e.source+'"'+n+"></mms-cf>"},C=function(e,t){var n,i="";t||(i+="  <li>"+("<a href=#"+e.data.id+">")+e.data._veNumber+" "+e.data.name+"</a>");for(var a=!1,r=0;r<e.children.length;r++)"view"!==(n=e.children[r]).type&&"section"!==n.type||(a||(i+="<ul>",a=!0),i+=C(n));return a&&(i+="</ul>"),t||(i+="</li>"),i},j=function(e,t,n,i,a){var r=e.data,o=r.id,s=r._veNumber,l="",c=t.find("#"+o),d=t.find('mms-view-link[mms-pe-id="'+o+'"], mms-view-link[data-mms-pe-id="'+o+'"]'),m="",p="";if("table"===e.type){l="Table "+s+". ";var u=c.find("table > caption");""!==(p=u.text())&&0===p.indexOf("Table")&&0<p.split(". ").length?p=p.substring(p.indexOf(l)+l.length):""===p&&(p=r.name),m=s+". "+p,n.tables+='<li><a href="#'+o+'">'+m+"</a></li>",u.html("Table "+m),0===u.length&&c.find("table").prepend("<caption>Table "+m+"</caption>"),a||(m=s),i||d.find("a").attr("href","#"+o),d.filter('[suppress-numbering!="true"]').filter(":not([link-text])").find("a").html("Table "+m)}if("figure"===e.type){l="Figure "+s+". ";var f=c.find("figure > figcaption");""!==(p=f.text())&&0===p.indexOf("Figure")&&0<p.split(". ").length?p=p.substring(p.indexOf(l)+l.length):""===p&&(p=r.name),m=s+". "+p,n.figures+='<li><a href="#'+o+'">'+m+"</a></li>",f.html("Figure "+m),0===f.length&&c.find("img").wrap("<figure></figure>").after("<figcaption>Figure "+m+"</figcaption>"),a||(m=s),i||d.find("a").attr("href","#"+o),d.filter('[suppress-numbering!="true"]').filter(":not([link-text])").find("a").html("Fig. "+m)}if("equation"===e.type){m=s+". "+r.name,n.equations+='<li><a href="#'+o+'">'+m+"</a></li>";var g="("+s+")",v=c.find(".mms-equation-caption");v.html(g),0===v.length&&c.find("mms-view-equation > mms-cf > mms-transclude-doc > p").last().append('<span class="mms-equation-caption pull-right">'+g+"</span>"),i||d.find("a").attr("href","#"+o),d.filter('[suppress-numbering!="true"]').filter(":not([link-text])").find("a").html("Eq. "+g)}for(var h=0;h<e.children.length;h++)j(e.children[h],t,n,i,a)},k=function(e){return e+s.createUniqueId()},x=function(e,t,n){var i,a,r,o,s=n.find("table"),l=n.find("figure"),c="",d="";for(e.tableCount=s.length,e.figureCount=l.length,o=0;o<s.length;o++)a=$(s[o]),i=$("caption",a),c=k("tbl_"),a.attr("id",c),d=i&&""!==i.text()?o+1+". "+i.text():o+1+". ",e.tables+='<li><a href="#'+c+'">'+d+"</a></li>",0===i.length&&a.prepend("<caption> </caption>");for(o=0;o<l.length;o++){r=$(l[o]);var m=$("figcaption",r);c=k("fig_"),r.attr("id",c),d=m&&""!==m.text()?o+1+". "+m.text():o+1,e.figures+='<li><a href="#'+c+'">'+d+"</a></li>",0===m.length&&r.append("<figcaption>&nbsp;</figcaption>")}return e};return{VIEW_SID:n,OTHER_VIEW_SID:i,DOCUMENT_SID:c,BLOCK_SID:"_11_5EAPbeta_be00301_1147424179914_458922_958",createClassElement:function(e){var t=JSON.parse(JSON.stringify(p));return Object.assign(t,e),t},createInstanceElement:function(e){var t=JSON.parse(JSON.stringify(u));return Object.assign(t,e),t},createValueSpecElement:function(e){var t=JSON.parse(JSON.stringify(f));return Object.assign(t,e),t},createGeneralizationElement:function(e){var t=JSON.parse(JSON.stringify(v));return Object.assign(t,e),t},createDependencyElement:function(e){var t=JSON.parse(JSON.stringify(h));return Object.assign(t,e),t},createPackageElement:function(e){var t=JSON.parse(JSON.stringify(g));return Object.assign(t,e),t},hasCircularReference:function(e,t,n){for(var i=e;i.$parent;){var a=i.$parent;if(a.mmsElementId===t&&a.cfType===n)return!0;i=a}return!1},cleanElement:function(e,t){var n=0;if("Property"!==e.type&&"Port"!==e.type||e.defaultValue||(e.defaultValue=null),"Slot"===e.type&&(l.isArray(e.value)||(e.value=[])),e.value)for(n=0;n<e.value.length;n++)b(e.value[n]);if(e._contents&&b(e._contents),e.specification&&b(e.specification),"Class"===e.type&&(e._contents&&e.contains&&delete e.contains,Array.isArray(e._displayedElementIds)&&(e._displayedElementIds=JSON.stringify(e._displayedElementIds)),e._allowedElementIds&&delete e._allowedElementIds),e.hasOwnProperty("specialization")&&delete e.specialization,t){var i=Object.keys(e);for(n in i)0<=m.indexOf(i[n])||delete e[i[n]]}return e},normalize:function(e){return e.extended=!!e.extended,e.refId=e.refId?e.refId:"master",e.commitId=e.commitId?e.commitId:"latest",e},makeElementKey:function(e,t){var n=e._refId?e._refId:"master",i=e._commitId?e._commitId:"latest",a=["element",e._projectId,n,e.id,i];return t&&a.push("edit"),a},makeArtifactKey:function(e,t){var n=e._refId?e._refId:"master",i=e._commitId?e._commitId:"latest",a=["artifact",e._projectId,n,e.id,i];return t&&a.push("edit"),a},buildTreeHierarchy:function(e,t,n,i,a){var r=[],o={},s=0,l=null;for(s=0;s<e.length;s++)o[(l=e[s])[t]]={label:l.name,type:n,data:l,children:[]};for(s=0;s<e.length;s++)(l=e[s])[i]&&o[l[i]]?o[l[i]].children.push(o[l[t]]):r.push(o[l[t]]);if(a)for(s=0;s<e.length;s++)a(l=e[s],o[l[t]]);var c=function(e,t){return 1<e.children.length&&e.children.sort(c),1<t.children.length&&t.children.sort(c),e.label.toLowerCase()<t.label.toLowerCase()?-1:e.label.toLowerCase()>t.label.toLowerCase()?1:0};return r.sort(c),r},filterProperties:function(e,t){var n={};for(var i in e)e.hasOwnProperty(i)&&t.hasOwnProperty(i)&&(n[i]=t[i]);return n},mergeElement:function(e,t){},hasConflict:function(e,t,n){for(var i in e)if("_read"!==i&&"_modified"!==i&&"_modifier"!==i&&"_creator"!==i&&"_created"!==i&&"_commitId"!==i&&e.hasOwnProperty(i)&&t.hasOwnProperty(i)&&n.hasOwnProperty(i)&&!angular.equals(t[i],n[i]))return!0;return!1},isRestrictedValue:function(e){return 0<e.length&&"Expression"===e[0].type&&3===e[0].operand.length&&"RestrictedValue"===e[0].operand[0].value&&"Expression"===e[0].operand[2].type&&0<e[0].operand[2].operand.length&&"ElementValue"===e[0].operand[1].type},makeHtmlTable:w,makeHtmlPara:E,makeHtmlList:S,makeHtmlTOC:function(e){var t='<div class="toc"><h1 class="header">Table of Contents</h1>',n=e[0].branch;return t+=C(n,!0),t+="</div>"},makeTablesAndFiguresTOC:function(e,t,n,i){var a={tables:"",figures:"",equations:"",tableCount:0,figureCount:0,equationCount:0},r=e[0].branch;if(i)a=x(a,e,t);else for(var o=0;o<r.children.length;o++)j(r.children[o],t,a,n,!1);return a.tables=a.tables.length?'<div class="tot"><h1 class="header">List of Tables</h1><ul>'+a.tables+"</ul></div>":"",a.figures=a.figures.length?'<div class="tof"><h1 class="header">List of Figures</h1><ul>'+a.figures+"</ul></div>":"",a.equations=a.equations.length?'<div class="tof"><h1 class="header">List of Equations</h1><ul>'+a.equations+"</ul></div>":"",a},addLiveNumbering:function(e,t,n){var i=e._veNumber;if(i){var a="",r="",o="";if("table"===n){a="Table "+i+". ";var s=t.find("table > caption");""!==(r=s.text())&&0===r.indexOf("Table")&&0<r.split(". ").length?r=r.substring(r.indexOf(a)+a.length):""===r&&(r=e.name),o=i+". "+r,s.html("Table "+o),0===s.length&&t.find("table").prepend("<caption>Table "+o+"</caption>")}if("figure"===n){a="Figure "+i+". ";var l=t.find("figure > figcaption");""!==(r=l.text())&&0===r.indexOf("Figure")&&0<r.split(". ").length?r=r.substring(r.indexOf(a)+a.length):""===r&&(r=e.name),o=i+". "+r,l.html("Figure "+o),0===l.length&&t.find("img").wrap("<figure></figure>").after("<figcaption>Figure "+o+"</figcaption>")}if("equation"===n){var c="("+i+")",d=t.find(".mms-equation-caption");d.html(c),0===d.length&&t.find("mms-view-equation > mms-cf > mms-transclude-doc > p").last().append('<span class="mms-equation-caption pull-right">'+c+"</span>")}}},convertViewLinks:function(i){i.find("mms-view-link").each(function(e){var t=$(this),n=t.attr("mms-element-id")||t.attr("data-mms-element-id");n&&(n=n.replace(/[^\w\-]/gi,""),i.find("#"+n).length&&t.find("a").attr("href","#"+n))})},createMmsId:function(){var n=Date.now(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"==e?t:3&t|8).toString(16)});return"MMS_"+Date.now()+"_"+e},getPrintCss:function(e,t,n){for(var i="/*------------------------------------------------------------------\nCustom CSS Table of Contents\n1. Images\n2. Tables\n3. Typography\n   3.1 Diff\n   3.2 Errors\n4. Figure Captions\n5. Table of Contents\n6. Page Layout\n7. Headers and Footers\n8. Signature Box\n9. Bookmark Level\n------------------------------------------------------------------*/\n\n/*------------------------------------------------------------------\n1. Images\n------------------------------------------------------------------*/\nimg {max-width: 100%; page-break-inside: avoid; page-break-before: auto; page-break-after: auto; margin-left: auto; margin-right: auto;}\nimg.image-center {display: block;}\nfigure img {display: block;}\n.pull-right {float: right;}\n\n/*------------------------------------------------------------------\n2. Tables\n------------------------------------------------------------------*/\n tr, td, th { page-break-inside: avoid; } thead {display: table-header-group;}\ntable {width: 100%; border-collapse: collapse;}\ntable, th, td {border: 1px solid black; padding: 4px; font-size: 10pt;}\ntable[border='0'], table[border='0'] th, table[border='0'] td {border: 0px;}\ntable, th > p, td > p {margin: 0px; padding: 0px;}\ntable, th > div > p, td > div > p {margin: 0px; padding: 0px;}\ntable mms-transclude-doc p {margin: 0 0 5px;}\nth {background-color: #f2f3f2;}\n\n/*------------------------------------------------------------------\n3. Typography\n------------------------------------------------------------------*/\nh1, h2, h3, h4, h5, h6 {font-family: 'Arial', sans-serif; margin: 10px 0; page-break-inside: avoid; page-break-after: avoid;}\nh1 {font-size: 18pt;} h2 {font-size: 16pt;} h3 {font-size: 14pt;} h4 {font-size: 13pt;} h5 {font-size: 12pt;} h6 {font-size: 11pt;}\n.ng-hide {display: none;}\n.chapter h1.view-title {font-size: 20pt; }\nbody {font-size: 10pt; font-family: 'Times New Roman', Times, serif; }\n\n/*------------------------------------------------------------------\n   3.1 Diff\n------------------------------------------------------------------*/\nins, .ins {color: black; background: #dafde0;}\ndel, .del{color: black;background: #ffe3e3;text-decoration: line-through;}\n.match,.textdiff span {color: gray;}\n.patcher-replaceIn, .patcher-attribute-replace-in, .patcher-insert, .patcher-text-insertion {background-color: #dafde0;}\n.patcher-replaceIn, .patcher-attribute-replace-in, .patcher-insert {border: 2px dashed #abffb9;}\n.patcher-replaceOut, .patcher-delete, .patcher-attribute-replace-out, .patcher-text-deletion {background-color: #ffe3e3; text-decoration: line-through;}\n.patcher-replaceOut, .patcher-delete, .patcher-attribute-replace-out {border: 2px dashed #ffb6b6;}\n.patcher-text-insertion, .patcher-text-deletion {display: inline !important;}\n[class*=\"patcher-\"]:not(td):not(tr) {display: inline-block;}\n\n/*------------------------------------------------------------------\n   3.2 Errors\n------------------------------------------------------------------*/\n.mms-error {background: repeating-linear-gradient(45deg,#fff,#fff 10px,#fff2e4 10px,#fff2e4 20px);}\n\n/*------------------------------------------------------------------\n4. Figure Captions\n------------------------------------------------------------------*/\ncaption, figcaption, .mms-equation-caption {text-align: center; font-weight: bold;}\ntable, figure {margin-bottom: 10px;}\n.mms-equation-caption {float: right;}\nmms-view-equation, mms-view-figure, mms-view-image {page-break-inside: avoid;}\n\n/*------------------------------------------------------------------\n5. Table of Contents\n------------------------------------------------------------------*/\n.toc, .tof, .tot {page-break-after:always;}\n.toc {page-break-before: always;}\n.toc a, .tof a, .tot a { text-decoration:none; color: #000; font-size:9pt; }\n.toc .header, .tof .header, .tot .header { margin-bottom: 4px; font-weight: bold; font-size:24px; }\n.toc ul, .tof ul, .tot ul {list-style-type:none; margin: 0; }\n.tof ul, .tot ul {padding-left:0;}\n.toc ul {padding-left:4em;}\n.toc > ul {padding-left:0;}\n.toc li > a[href]::after {content: leader('.') target-counter(attr(href), page);}\n.tot li > a[href]::after {content: leader('.') target-counter(attr(href), page);}\n.tof li > a[href]::after {content: leader('.') target-counter(attr(href), page);}\n\n/*------------------------------------------------------------------\n6. Page Layout\n------------------------------------------------------------------*/\n@page {margin: 0.5in;}\n@page landscape {size: 11in 8.5in;}\n.landscape {page: landscape;}\n.chapter {page-break-before: always}\np, div {widows: 2; orphans: 2;}\n\n/*------------------------------------------------------------------\n7. Headers and Footers\n------------------------------------------------------------------*/\n@page:first {@top {content: ''} @bottom {content: ''} @top-left {content: ''} @top-right {content: ''} @bottom-left {content: ''} @bottom-right {content: ''}}\n\n/*------------------------------------------------------------------\n8. Signature Box\n------------------------------------------------------------------*/\n.signature-box td.signature-name-styling {width: 60%;}\n.signature-box td.signature-space-styling {width: 1%;}\n.signature-box td.signature-date-styling {width: 39%;}\n\n/*------------------------------------------------------------------\n9. Bookmark Level\n------------------------------------------------------------------*/\n",a=1;a<10;a++)i+=".h"+a+" {bookmark-level: "+a+";}\n";return e&&(i+='.toc { counter-reset: table-counter figure-counter;}\nfigure { counter-increment: figure-counter; }\nfigcaption::before {content: "Figure " counter(figure-counter) ". "; }\ntable { counter-increment: table-counter; }\ncaption::before {content: "Table " counter(table-counter) ". "; }\n'),Object.keys(n).forEach(function(e){var t;n[e]&&(t="counter(page)"===n[e]?n[e]:'"'+n[e]+'"',i+="@page {@"+e+" {font-size: 10px; content: "+t+";}}\n")}),t&&(i+="@page {size: 11in 8.5in;}"),i},isView:function(e){if(e._appliedStereotypeIds){if(0<=e._appliedStereotypeIds.indexOf(n)||0<=e._appliedStereotypeIds.indexOf(c))return!0;for(var t=0;t<i.length;t++)if(0<=e._appliedStereotypeIds.indexOf(i[t]))return!0}return!1},isDocument:function(e){return!!(e._appliedStereotypeIds&&0<=e._appliedStereotypeIds.indexOf(c))},isRequirement:function(e){if(e._appliedStereotypeIds)for(var t=0;t<d.length;t++)if(0<=e._appliedStereotypeIds.indexOf(d[t]))return!0;return!1},exportHtmlAs:function(e,t){var n;switch(e){case 2:n="application/vnd.openxmlformats-officedocument.wordprocessingml.document";break;case 3:n="application/pdf";break;default:n="application/pdf"}var i=a.defer();return r.post(o.getExportHtmlUrl(t.projectId,t.refId),{"Content-Type":"text/html",Accepts:n,body:t.htmlString,name:t.name,css:t.css}).then(function(){i.resolve("ok")},function(e){o.handleHttpStatus(e.data,e.status,e.headers,e.config,i)}),i.promise},generateTOCHtmlOption:x,generateAnchorId:k,tableConfig:y,_generateRowColNumber:I,PROJECT_URL_PREFIX:"mms.html#/projects/",copyToClipboard:function(e,t){t.stopPropagation();var n=window.document.createRange();n.selectNodeContents(e[0].childNodes[0]),window.getSelection().removeAllRanges(),window.getSelection().addRange(n);try{window.document.execCommand("copy")}catch(e){}window.getSelection().removeAllRanges()},getElementTypeClass:function(e,t){return"InstanceSpecification"===e.type?"pe-type-"+t:"item-type-"+t}}}function UxService(n){var t=function(e){switch(e){case"element-viewer":return{id:e,icon:"fa-eye",selected:!0,active:!0,permission:!0,tooltip:"Preview Element",spinner:!1,onClick:function(){n.$broadcast(e)},dynamic_buttons:[t("element-editor-saveall")]};case"element-history":return{id:e,icon:"fa-history",selected:!1,active:!0,permission:!0,tooltip:"Element History",spinner:!1,onClick:function(){n.$broadcast(e)},dynamic_buttons:[t("element-editor-saveall")]};case"element-editor":return{id:e,icon:"fa-edit",selected:!1,active:!0,permission:!1,tooltip:"Edit Element",spinner:!1,onClick:function(){n.$broadcast(e)},dynamic_buttons:[t("element-editor-save"),t("element-editor-saveC"),t("element-editor-saveall"),t("element-editor-cancel")]};case"view-reorder":return{id:e,icon:"fa-arrows-v",selected:!1,active:!0,permission:!1,tooltip:"Reorder Content",spinner:!1,onClick:function(){n.$broadcast(e)},dynamic_buttons:[t("view-reorder-save"),t("view-reorder-cancel")]};case"document-snapshot":return{id:e,icon:"fa-camera",selected:!1,active:!0,permission:!0,tooltip:"Snapshots",spinner:!1,onClick:function(){n.$broadcast(e)},dynamic_buttons:[t("document-snapshot-create")]};case"tags":return{id:e,icon:"fa-code-fork",selected:!1,active:!0,permission:!0,tooltip:"Branches and Tags",spinner:!1,onClick:function(){n.$broadcast(e)}};case"jobs":return{id:e,icon:"fa-sort-amount-desc",selected:!1,active:!0,permission:!0,tooltip:"Jobs",spinner:!1,onClick:function(){n.$broadcast(e)}};case"element-editor-save":return{id:e,icon:"fa-save",dynamic:!0,selected:!1,active:!1,permission:!0,tooltip:"Save",spinner:!1,onClick:function(){n.$broadcast(e)}};case"element-editor-saveC":return{id:e,icon:"fa-send-o",dynamic:!0,selected:!1,active:!1,permission:!0,tooltip:"Save and Continue",spinner:!1,onClick:function(){n.$broadcast(e)}};case"element-editor-saveall":return{id:e,icon:"fa-save-all",dynamic:!0,selected:!1,active:!1,permission:!1,tooltip:"Save All (alt + a)",spinner:!1,onClick:function(){n.$broadcast(e)}};case"element-editor-cancel":return{id:e,icon:"fa-times",dynamic:!0,selected:!1,active:!1,permission:!0,tooltip:"Cancel",spinner:!1,onClick:function(){n.$broadcast(e)}};case"view-reorder-save":return{id:e,icon:"fa-save",dynamic:!0,selected:!1,active:!1,permission:!0,tooltip:"Save",spinner:!1,onClick:function(){n.$broadcast(e)}};case"view-reorder-cancel":return{id:e,icon:"fa-times",dynamic:!0,selected:!1,active:!1,permission:!0,tooltip:"Cancel",spinner:!1,onClick:function(){n.$broadcast(e)}};case"document-snapshot-refresh":return{id:e,icon:"fa-refresh",dynamic:!0,selected:!1,active:!1,permission:!0,tooltip:"Refresh",spinner:!1,onClick:function(){n.$broadcast(e)}};case"document-snapshot-create":return{id:e,icon:"fa-plus",dynamic:!0,selected:!1,active:!1,permission:!1,tooltip:"Create Tag",spinner:!1,onClick:function(){n.$broadcast(e)}};case"diff-perspective-detail":return{id:e,icon:"fa-info-circle",selected:!0,active:!0,permission:!0,tooltip:"Detail",spinner:!1,onClick:function(){n.diffPerspective="detail"}};case"diff-perspective-tree":return{id:e,icon:"fa-sitemap",selected:!1,active:!0,permission:!0,tooltip:"Context",spinner:!1,onClick:function(){n.diffPerspective="tree"}}}},i=function(e,t){switch(e){case"tree-expand":return{id:e,icon:"fa-caret-square-o-down",selected:!0,active:!0,permission:!0,tooltip:"Expand All",spinner:!1,togglable:!1,placement:"bottom-left",action:function(){n.$broadcast(e)}};case"tree-collapse":return{id:e,icon:"fa-caret-square-o-up",selected:!0,active:!0,permission:!0,tooltip:"Collapse All",spinner:!1,togglable:!1,action:function(){n.$broadcast(e)}};case"tree-filter":return{id:e,icon:"fa-filter",selected:!0,active:!0,permission:!0,tooltip:"Filter",spinner:!1,togglable:!0,action:function(){n.$broadcast(e)}};case"tree-add-document-or-group":return{id:e,icon:"fa-plus",selected:!0,active:!0,permission:!1,tooltip:"Add Group or Document",spinner:!1,togglable:!1,placement:"bottom-right",action:function(){n.$broadcast(e)},dropdown_buttons:[i("tree-add-group"),i("tree-add-document")]};case"tree-delete-document":return{id:e,icon:"fa-trash",selected:!0,active:!0,permission:!1,tooltip:"Remove",spinner:!1,togglable:!1,action:function(){n.$broadcast(e)}};case"tree-add-view":return{id:e,icon:"fa-plus",selected:!0,active:!0,permission:!1,tooltip:"Add View",spinner:!1,togglable:!1,action:function(){n.$broadcast(e)}};case"tree-add-group":return{id:e,icon:"fa-folder",selected:!0,active:!0,permission:!0,tooltip:"Add Group",spinner:!1,togglable:!1,action:function(){n.$broadcast(e)}};case"tree-add-document":return{id:e,icon:"fa-file",selected:!0,active:!0,permission:!0,tooltip:"Add Document",spinner:!1,togglable:!1,action:function(){n.$broadcast(e)}};case"tree-add-tag":return{id:e,icon:"fa-tag",selected:!0,active:!0,permission:!0,tooltip:"Add Tag",spinner:!1,togglable:!1,action:function(){n.$broadcast(e)}};case"tree-add-branch":return{id:e,icon:"fa-plus",selected:!0,active:!0,permission:!0,tooltip:"Add Branch",spinner:!1,togglable:!1,action:function(){n.$broadcast(e)}};case"tree-delete":return{id:e,icon:"fa-trash",selected:!0,active:!0,permission:!0,tooltip:"Remove",spinner:!1,togglable:!1,action:function(){n.$broadcast(e)}};case"tree-delete-view":return{id:e,icon:"fa-trash",selected:!0,active:!0,permission:!1,tooltip:"Remove View",spinner:!1,togglable:!1,action:function(){n.$broadcast(e)}};case"tree-reorder-view":return{id:e,icon:"fa-arrows-v",selected:!0,active:!0,permission:!1,tooltip:"Reorder Views",spinner:!1,togglable:!1,action:function(){n.$broadcast(e)}};case"tree-reorder-group":return{id:e,icon:"fa-arrows-v",selected:!0,active:!0,permission:!1,tooltip:"Organize Groups/Docs",spinner:!1,togglable:!1,action:function(){n.$broadcast(e)}};case"tree-full-document":return{id:e,icon:"fa-file-text-o",selected:!0,active:!0,permission:!0,tooltip:"Full Document",spinner:!1,togglable:!0,toggle_icon:"fa-file-text",toggle_tooltip:"View Mode",action:function(){n.$broadcast(e)}};case"view-mode-dropdown":return{id:e,icon:"fa-filter",selected:!0,active:!0,permission:!0,tooltip:"Filter by type",spinner:!1,togglable:!1,placement:"bottom-left",action:function(){n.$broadcast(e)},dropdown_buttons:[i("tree-show-pe"),i("tree-show-views"),i("tree-show-tables"),i("tree-show-figures"),i("tree-show-equations")]};case"tree-show-views":return{id:e,selected:!0,active:!0,permission:!0,tooltip:"Show Only Views and Sections",spinner:!1,togglable:!1,action:function(){n.$broadcast(e)}};case"tree-show-pe":return{id:e,selected:!1,active:!0,permission:!0,tooltip:"Show All",spinner:!1,togglable:!1,action:function(){n.$broadcast(e)}};case"tree-show-tables":return{id:e,selected:!1,active:!0,permission:!0,tooltip:"Show Only Tables",spinner:!1,togglable:!1,action:function(){n.$broadcast(e)}};case"tree-show-figures":return{id:e,selected:!1,active:!0,permission:!0,tooltip:"Show Only Figures",spinner:!1,togglable:!1,action:function(){n.$broadcast(e)}};case"tree-show-equations":return{id:e,selected:!1,active:!0,permission:!0,tooltip:"Show Only Equations",spinner:!1,togglable:!1,action:function(){n.$broadcast(e)}};case"show-edits":return{id:e,icon:"fa-pencil-square-o",selected:!0,active:!0,permission:!0,tooltip:"Enable Edits (alt + d)",spinner:!1,togglable:!0,toggle_icon:"fa-pencil-square",toggle_tooltip:"Disable Edits (alt + d)",action:function(){n.$broadcast(e)}};case"show-elements":return{id:e,icon:"fa-codepen",selected:!0,active:!0,permission:!0,tooltip:"Show Elements (alt + e)",spinner:!1,togglable:!0,toggle_icon:"fa-cube",toggle_tooltip:"Hide Elements (alt + e)",action:function(){n.$broadcast(e)}};case"show-comments":return{id:e,icon:"fa-comment-o",selected:!0,active:!0,permission:!0,tooltip:"Show Comments (alt + c)",spinner:!1,togglable:!0,toggle_icon:"fa-comment",toggle_tooltip:"Hide Comments (alt + c)",action:function(){n.$broadcast(e)}};case"refresh-numbering":return{id:e,icon:"fa-sort-numeric-asc",selected:!0,active:!0,permission:!0,tooltip:"Refresh Figure Numbering",spinner:!1,togglable:!1,action:function(){n.$broadcast(e)}};case"share-url":return{id:e,icon:"fa-share-alt",selected:!0,active:!0,permission:!0,tooltip:"Share Short URL",spinner:!1,togglable:!1,action:function(){n.$broadcast(e)}};case"center-previous":return{id:e,icon:"fa-chevron-left",selected:!0,active:!0,permission:!0,tooltip:"Previous (alt + ,)",spinner:!1,togglable:!1,action:function(){n.$broadcast(e)}};case"center-next":return{id:e,icon:"fa-chevron-right",selected:!0,active:!0,permission:!0,tooltip:"Next (alt + .)",spinner:!1,togglable:!1,action:function(){n.$broadcast(e)}};case"export":return{id:e,icon:"fa-download",selected:!0,active:!0,permission:!0,tooltip:"Export",button_content:"Export",spinner:!1,togglable:!1,action:function(){n.$broadcast(e)},dropdown_buttons:[i("word"),i("tabletocsv")]};case"print":return{id:e,icon:"fa-print",selected:!0,active:!0,permission:!0,tooltip:"Print",spinner:!1,togglable:!1,action:function(){n.$broadcast(e)}};case"convert-pdf":return{id:e,icon:"fa-file-pdf-o",selected:!0,active:!0,permission:!0,tooltip:"Export to PDF",spinner:!1,togglable:!1,action:function(){n.$broadcast(e)}};case"word":return{id:e,icon:"fa-file-word-o",selected:!0,active:!0,permission:!0,tooltip:"Export to Word",spinner:!1,togglable:!1,action:function(){n.$broadcast(e)}};case"tabletocsv":return{id:e,icon:"fa-table",selected:!0,active:!0,permission:!0,tooltip:"Table to CSV",spinner:!1,togglable:!1,action:function(){n.$broadcast(e)}};case"presentation-element-delete":return{id:e,icon:"fa-trash",selected:!0,active:!0,permission:!0,tooltip:"Remove",spinner:!1,togglable:!1,action:function(e){e.stopPropagation(),t.delete()}};case"presentation-element-save":return{id:e,icon:"fa-save",selected:!0,active:!0,permission:!0,tooltip:"Save",spinner:!1,togglable:!1,action:function(e){e.stopPropagation(),t.save()}};case"presentation-element-saveC":return{id:e,icon:"fa-send-o",selected:!0,active:!0,permission:!0,tooltip:"Save and Continue",spinner:!1,togglable:!1,action:function(e){e.stopPropagation(),t.saveC()}};case"presentation-element-cancel":return{id:e,icon:"fa-times",selected:!0,active:!0,permission:!0,tooltip:"Cancel",spinner:!1,togglable:!1,action:function(e){e.stopPropagation(),t.cancel()}};case"presentation-element-preview":return{id:e,icon:"fa-file-powerpoint-o",selected:!0,active:!0,permission:!0,tooltip:"Preview Changes",spinner:!1,togglable:!1,action:function(e){e.stopPropagation(),t.preview()}}}},e=["tag","connector","dependency","directedrelationship","element","property","generalization","package","section","group","snapshot","view","branch","table","figure","equation","view-composite","view-shared","view-none"],a=function(e){var t=e;switch(t||(t="unknown"),t=t.toLowerCase()){case"tag":return"fa fa-tag";case"connector":return"fa fa-expand";case"dependency":case"directedrelationship":return"fa fa-long-arrow-right";case"element":return"fa fa-square";case"property":return"fa fa-circle";case"generalization":return"fa fa-chevron-right";case"package":return"fa fa-folder";case"section":return"section-icon";case"group":return"fa fa-folder";case"snapshot":return"fa fa-camera";case"view":case"view-composite":return"fa fa-file";case"view-shared":case"view-none":return"fa fa-file-o";case"branch":return"fa fa-tasks";case"table":return"fa fa-table";case"figure":return"fa fa-image";case"equation":return"fa fa-superscript";default:return"fa fa-square"}};return{getButtonBarButton:i,getToolbarButton:t,getTypeIcon:a,getChangeTypeName:function(e){switch(e=e.toLowerCase()){case"added":return"Addition";case"updated":return"Modification";case"removed":return"Removal"}},getTreeTypes:function(){var t={};return e.forEach(function(e){t[e]=a(e)+" fa-fw"}),t}}}function ViewService(g,v,f,h,b,w,y,l){var I={},_={Image:"_17_0_5_1_407019f_1430628206190_469511_11978",List:"_17_0_5_1_407019f_1430628190151_363897_11927",Paragraph:"_17_0_5_1_407019f_1430628197332_560980_11953",Table:"_17_0_5_1_407019f_1430628178633_708586_11903",Section:"_17_0_5_1_407019f_1430628211976_255218_12002",ListT:"_17_0_5_1_407019f_1431903739087_549326_12013",TableT:"_17_0_5_1_407019f_1431903724067_825986_11992",ImageT:"_17_0_5_1_407019f_1431903748021_2367_12034",Equation:"_17_0_5_1_407019f_1431905053808_352752_11992",ParagraphT:"_17_0_5_1_407019f_1431903758416_800749_12055",SectionT:"_18_0_2_407019f_1435683487667_494971_14412",TomSawyerDiagram:"_18_5_2_8bf0285_1506035630029_725905_15942",Figure:"_18_5_2_8bf0285_1506035630979_342273_15944",FigureT:"_18_5_2_8bf0285_1506035630029_725905_15942"},c="_18_5_3_8bf0285_1520469040211_2821_15754",S={Table:"TableT",Paragraph:"ParagraphT",Section:"SectionT",Comment:"ParagraphT",List:"ListT",Image:"ImageT",Equation:"Equation",TomSawyerDiagram:"TomSawyerDiagram"},o=[_.Image,_.List,_.Paragraph,_.Section,_.Table,_.Figure],E=function(e,t){var n,i,a;for(n=0;n<t.length;n++){var r=t[n];for(i=0;i<r.length;i++){var o=r[i];for(a=0;a<o.content.length;a++){var s=o.content[a];"Table"===s.type&&s.body?E(e,s.body):"Paragraph"===s.type&&s.source&&e.push(s.source)}}}},t=function(e,t,n){var i=g.defer(),a=t.viewId?t.viewId:w.createMmsId(),r="_hidden_"+w.createMmsId()+"_pei",o=t.isDoc?"Untitled Document":"Untitled View",s=w.createClassElement({id:a,type:"Class",ownerId:e.id,_allowedElements:[],_displayedElementIds:[a],_childViews:[],_contents:w.createValueSpecElement({operand:[w.createValueSpecElement({type:"InstanceValue",instanceId:r})],type:"Expression",id:a+"_vc_expression",ownerId:a+"_vc"}),name:t.viewName?t.viewName:o,documentation:t.viewDoc?t.viewDoc:"",_appliedStereotypeIds:[t.isDoc?w.DOCUMENT_SID:w.VIEW_SID],appliedStereotypeInstanceId:a+"_asi"}),l=null;e&&(e._childViews||w.isView(e))&&(l={_projectId:e._projectId,_refId:e._refId,id:e.id},e._childViews?l._childViews=JSON.parse(JSON.stringify(e._childViews)):l._childViews=[],l._childViews.push({id:a,aggregation:"composite"}));var c={type:"Paragraph",sourceType:"reference",source:r,sourceProperty:"documentation"},d=[w.createInstanceElement({id:r,ownerId:"view_instances_bin_"+e._projectId,name:"View Paragraph",documentation:n||"",type:"InstanceSpecification",classifierIds:[_.ParagraphT],specification:w.createValueSpecElement({value:JSON.stringify(c),type:"LiteralString",id:w.createMmsId(),ownerId:r}),_appliedStereotypeIds:[]}),s,w.createInstanceElement({id:a+"_asi",ownerId:a,documentation:"",name:"",type:"InstanceSpecification",classifierIds:[t.isDoc?w.DOCUMENT_SID:w.VIEW_SID],_appliedStereotypeIds:[],stereotypedElementId:a})];l&&(l=b.fillInElement(l),d.push(l));var m={projectId:e._projectId,refId:e._refId,elements:d,returnChildViews:!0};return b.createElements(m).then(function(e){e.forEach(function(e){e.id===a&&i.resolve(e)})},function(e){i.reject(e)}),i.promise},s=function(e){var t=e.specification;if(!t)return{status:500,message:"missing specification"};var n=t.type;if("LiteralString"!==n)return"Expression"===n?C(e)?e:t:void 0;var i=t.value;return JSON.parse(i)},d=function(e,t,n){for(var i=[],a=0;a<t.operand.length;a++)i.push(r(e,t.operand[a],n));return g.all(i)},r=function(e,t,n){var i=g.defer(),a={};a.instanceId=t.instanceId,a.instanceVal=t,a.sectionElements=[];var r=JSON.parse(JSON.stringify(e));return r.elementId=t.instanceId,b.getElement(r,n).then(function(e){(a.instanceSpecification=e).classifierIds&&0<e.classifierIds.length&&0<=o.indexOf(e.classifierIds[0])?a.isOpaque=!0:a.isOpaque=!1;var t=s(e);a.presentationElement=t,C(t)?d(r,t.specification).then(function(e){a.sectionElements=e,i.resolve(a)},function(e){i.reject(e)}):i.resolve(a)},function(e){i.reject(e)}),i.promise},C=function(e){return e.classifierIds&&0<e.classifierIds.length&&(e.classifierIds[0]===_.Section||e.classifierIds[0]===_.SectionT)},j=function(e){return e.classifierIds&&0<e.classifierIds.length&&(e.classifierIds[0]===_.Table||e.classifierIds[0]===_.TableT)},n=function(e){return e.classifierIds&&0<e.classifierIds.length&&(e.classifierIds[0]===_.ImageT||e.classifierIds[0]===_.Image||e.classifierIds[0]===_.Figure||e.classifierIds[0]===_.FigureT)},i=function(e){return e.classifierIds&&0<e.classifierIds.length&&e.classifierIds[0]===_.Equation},m=function(e){var t=[];return e&&0!==e.length&&e.forEach(function(e){"LiteralString"===e.type&&e.value&&t.push(e.value)}),t},p=function(e){var n=[];return e&&0!==e.length&&e.forEach(function(e){if(Number.isInteger(e.value))n.push(e.value);else if("string"==typeof e.value){var t=parseInt(e.value);isNaN(t)||n.push(t)}}),n},a=function(e){if("InstanceSpecification"===e.type){if(C(e))return"Section";if(j(e))return"Table";if(n(e))return"Image";if(i(e))return"Equation";if(e.specification&&e.specification.value)return JSON.parse(e.specification.value).type}return!1};return{TYPE_TO_CLASSIFIER_ID:_,getViewElements:function(c,d,m){w.normalize(c);var p=g.defer(),u="viewElements"+c.projectId+c.refId+c.elementId+c.commitId;if(I[u])return I[u];var f=["elements",c.projectId,c.refId,c.elementId,c.commitId],e=y.get(f);return e&&!m?p.resolve(e):(I[u]=p.promise,b.getElement(c,d,m).then(function(e){var n=[],t=[];if(e._displayedElementIds){var i=e._displayedElementIds;angular.isArray(i)||(i=JSON.parse(i)),angular.isArray(i)&&0<i.length&&(n=i)}if(e._contents&&e._contents.operand)for(var a=e._contents.operand,r=0;r<a.length;r++)a[r]&&a[r].instanceId&&n.push(a[r].instanceId);if(e.specification&&e.specification.operand)for(var o=e.specification.operand,s=0;s<o.length;s++)o[s]&&o[s].instanceId&&n.push(o[s].instanceId);if(j(e)&&e.specification&&e.specification.value)try{var l=JSON.parse(e.specification.value);l.body&&E(n,l.body)}catch(e){}v.get(h.getViewElementIdsURL(c)).then(function(e){var t=e.data.elementIds;n=n.concat(t)}).finally(function(){var e=new Set(n);c.elementIds=Array.from(e),b.getElements(c,d,m).then(function(e){t=e}).finally(function(){y.put(f,t),p.resolve(t),delete I[u]})})},function(e){p.reject(e),delete I[u]})),p.promise},createView:t,createDocument:function(n,e){var i=g.defer();return e.isDoc=!0,t(n,e).then(function(e){n&&n.id.indexOf("holding_bin")<0&&(e._groupId=n.id);var t=["documents",n._projectId,n._refId];y.exists(t)&&y.get(t).push(e),i.resolve(e)},function(e){i.reject(e)}),i.promise},createGroup:function(e,i,a){var r=g.defer(),o=w.createMmsId(),t=o+"_asi",n=[w.createPackageElement({id:o,name:e||"Untitled",ownerId:i.id,_isGroup:!0,_appliedStereotypeIds:[c],appliedStereotypeInstanceId:t}),w.createInstanceElement({classifierIds:[c],id:t,ownerId:o,visibility:null,stereotypedElementId:o})],s={projectId:i._projectId,refId:i._refId,elements:n};return b.createElements(s).then(function(e){var t=["groups",i._projectId,i._refId],n=l.find(e,{id:o});n?(n._parentId=-1!=i.id.indexOf("holding")?null:i.id,n._link="/share/page/repository#filter=path|/Sites/"+a+"/documentLibrary/"+n._projectId+"/"+n.id,y.exists(t)&&y.get(t).push(n),y.put(["group",n.projectId,n.refId,n.id],n,!0),r.resolve(n)):r.reject({status:500,message:"Failed to create group"})},function(e){console.log("POST failed:",e),r.reject(e)}),r.promise},removeGroup:function(i){i._isGroup=!1,l.remove(i._appliedStereotypeIds,function(e){return e===c}),i.appliedStereotypeInstanceId=0<i._appliedStereotypeIds.length?i.appliedStereotypeInstanceId:null;var e={id:i.id,_projectId:i._projectId,_refId:i._refId,_appliedStereotypeIds:i._appliedStereotypeIds,appliedStereotypeInstanceId:i.appliedStereotypeInstanceId,_isGroup:i._isGroup},t=[e];return null!==e.appliedStereotypeInstanceId?t.push({id:i.id+"_asi",_refId:i._refId,_projectId:i._projectId,classifierIds:e._appliedStereotypeIds}):v.delete(h.getElementURL({elementId:i.id+"_asi",refId:i._refId,projectId:i._projectId})),b.updateElements(t,!1).then(function(e){var t=["groups",i._projectId,i._refId],n=y.get(t)||[];return l.remove(n,function(e){return e.id===i.id}),e},function(e){return e})},downgradeDocument:function(r){var e=JSON.parse(JSON.stringify(r));e._appliedStereotypeIds=[w.VIEW_SID];var t={id:r.id+"_asi",ownerId:r.id,classifierIds:[w.VIEW_SID],type:"InstanceSpecification",_projectId:r._projectId,_refId:r._refId,stereotypedElementId:r.id};return b.updateElements([e,t]).then(function(e){var t=["documents",r._projectId,r._refId],n=-1,i=y.get(t);if(i){for(var a=0;a<i.length;a++)if(i[a].id===r.id){n=a;break}0<=n&&i.splice(n,1)}return e},function(e){return e})},addViewToParentView:function(n){w.normalize(n);var i=g.defer();return b.getElement({projectId:n.projectId,refId:n.refId,elementId:n.parentViewId},2).then(function(e){var t={_projectId:e._projectId,_refId:e._refId,id:e.id};e._childViews?t._childViews=JSON.parse(JSON.stringify(e._childViews)):t._childViews=[],t._childViews.push({id:n.viewId,aggregation:n.aggr}),b.updateElement(t,!0).then(function(e){i.resolve(e)},function(e){i.reject(e)})},function(e){i.reject(e)}),i.promise},getDocumentViews:function(e,t,n){w.normalize(e);var i=g.defer(),a=h.getDocumentViewsURL(e),r=["views",e.projectId,e.refId,e.elementId];return y.exists(r)&&!n?i.resolve(y.get(r)):b.getGenericElements(a,e,"views",t,n).then(function(e){i.resolve(y.put(r,e,!1))},function(e){i.reject(e)}),i.promise},getProjectDocuments:function(e,t,n){w.normalize(e);var i=g.defer(),a=h.getProjectDocumentsURL(e),r=["documents",e.projectId,e.refId];return y.exists(r)&&!n?i.resolve(y.get(r)):b.getGenericElements(a,e,"documents",t,n).then(function(e){i.resolve(y.put(r,e,!1))},function(e){i.reject(e)}),i.promise},getPresentationElementSpec:s,isSection:C,isFigure:n,isTable:j,isEquation:i,getTreeType:function(e){return C(e)?"section":e.specification&&e.specification.value&&JSON.parse(e.specification.value).excludeFromList?null:j(e)?"table":n(e)?"figure":i(e)?"equation":null},getPresentationElementType:a,getElementType:function(e){var t;return w.isRequirement(e)?"Requirement":w.isDocument(e)?"Document":w.isView(e)?"View":0<(t=e)._appliedStereotypeIds.length&&t._appliedStereotypeIds[0]===c?"Group":a(e)},addElementToViewOrSection:function(e,i,a){w.normalize(e);var r=g.defer();return b.getElement({projectId:e._projectId,refId:e._refId,elementId:e.id},2).then(function(e){var t={_projectId:e._projectId,_refId:e._refId,id:e.id},n="_contents";C(e)&&(n="specification"),e[n]?(t[n]=JSON.parse(JSON.stringify(e[n])),t[n].id&&t[n].ownerId||(t[n].id=C(e)?w.createMmsId():e.id+"_vc_expression",t[n].ownerId=C(e)?e.id:e.id+"_vc")):t[n]=w.createValueSpecElement({operand:[],type:"Expression",id:C(e)?w.createMmsId():e.id+"_vc_expression",ownerId:C(e)?e.id:e.id+"_vc"}),i.ownerId=t[n].id,i.id||(i.id=w.createMmsId()),-1<=a?t[n].operand.splice(a+1,0,w.createValueSpecElement(i)):t[n].operand.push(w.createValueSpecElement(i)),b.updateElement(t).then(function(e){r.resolve(e)},function(e){r.reject(e)})},function(e){r.reject(e)}),r.promise},removeElementFromViewOrSection:function(e,r){w.normalize(e);var o=g.defer();return r&&b.getElement(e,2).then(function(e){var t={_projectId:e._projectId,_refId:e._refId,id:e.id},n="_contents";if(C(e)&&(n="specification"),e[n]?(t[n]=JSON.parse(JSON.stringify(e[n])),t[n].id&&t[n].ownerId||(t[n].id=C(e)?w.createMmsId():e.id+"_vc_expression",t[n].ownerId=C(e)?e.id:e.id+"_vc")):t[n]=w.createValueSpecElement({operand:[],type:"Expression",id:C(e)?w.createMmsId():e.id+"_vc_expression",ownerId:C(e)?e.id:e.id+"_vc"}),t[n]&&t[n].operand)for(var i=e[n].operand,a=0;a<i.length;a++)if(r.instanceId===i[a].instanceId){t[n].operand.splice(a,1);break}b.updateElement(t).then(function(e){o.resolve(e)},function(e){o.reject(e)})},function(e){o.reject(e)}),o.promise},removeViewFromParentView:function(i){w.normalize(i);var a=g.defer();return b.getElement({projectId:i.projectId,refId:i.refId,elementId:i.parentViewId},2).then(function(e){if(e._childViews){for(var t={_projectId:e._projectId,_refId:e._refId,id:e.id,_childViews:JSON.parse(JSON.stringify(e._childViews))},n=0;n<t._childViews.length;n++)if(t._childViews[n].id===i.viewId){t._childViews.splice(n,1);break}b.updateElement(t,!0).then(function(e){a.resolve(e)},function(e){a.reject(e)})}else a.resolve(e)},function(e){a.reject(e)}),a.promise},createInstanceSpecification:function(i,a,e,t){var r=g.defer(),o=w.createMmsId(),n=S[a],s=n;"Comment"!==a&&"Paragraph"!==a||(s=a);var l={type:s,sourceType:"reference",source:o="_hidden_"+o+"_pei",sourceProperty:"documentation"},c={id:o,ownerId:"view_instances_bin_"+i._projectId,name:e||"Untitled "+a,documentation:"",type:"InstanceSpecification",classifierIds:[_[n]],specification:w.createValueSpecElement({value:JSON.stringify(l),type:"LiteralString",ownerId:o,id:w.createMmsId()}),_appliedStereotypeIds:[]};c=w.createInstanceElement(c),"Section"===a&&(c.specification=w.createValueSpecElement({operand:[],type:"Expression",ownerId:o,id:w.createMmsId()}));var d={_projectId:i._projectId,id:i.id,_refId:i._refId},m="_contents";C(i)&&(m="specification"),i[m]?(d[m]=JSON.parse(JSON.stringify(i[m])),d[m].id&&d[m].ownerId||(d[m].id=C(i)?w.createMmsId():i.id+"_vc_expression",d[m].ownerId=C(i)?i.id:i.id+"_vc")):d[m]=w.createValueSpecElement({operand:[],type:"Expression",id:C(i)?w.createMmsId():i.id+"_vc_expression",ownerId:C(i)?i.id:i.id+"_vc"}),-1<=t?d[m].operand.splice(t+1,0,w.createValueSpecElement({instanceId:o,type:"InstanceValue",id:w.createMmsId(),ownerId:d[m].id})):d[m].operand.push(w.createValueSpecElement({instanceId:o,type:"InstanceValue",id:w.createMmsId(),ownerId:d[m].id}));var p=[c,d=b.fillInElement(d)],u={projectId:i._projectId,refId:i._refId,elements:p};return b.createElements(u).then(function(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.id===o)return"Section"===a&&f.$broadcast("viewctrl.add.section",n,i),void r.resolve(n)}},function(e){r.reject(e)}),r.promise},getTypeFromClassifierId:function(t){var n="";return t&&0<t.length&&Object.keys(_).some(function(e){return _[e]===t[0]&&(n=e,!0)}),n},getElementReferenceTree:d,getDocMetadata:function(e,t){var n=g.defer(),o={numberingDepth:0,numberingSeparator:"."};return e.elementIds=[e.elementId+"_asi-slot-_17_0_1_407019f_1326234342817_186479_2256",e.elementId+"_asi-slot-_17_0_1_407019f_1326234349580_411867_2258",e.elementId+"_asi-slot-_18_5_3_8bf0285_1526605771405_96327_15754",e.elementId+"_asi-slot-_18_5_3_8bf0285_1526605817077_688557_15755"],b.getElements(e,t).then(function(e){if(0!==e.length)for(var t=0;t<e.length;t++){var n=e[t],i=n.definingFeatureId?n.definingFeatureId:null,a=n.value?n.value:null;if(i&&a&&0!==a.length){var r=[];"_17_0_1_407019f_1326234342817_186479_2256"===i?(r=m(a),o.top=0<r.length?r[0]:"",o.topl=1<r.length?r[1]:"",o.topr=2<r.length?r[2]:""):"_17_0_1_407019f_1326234349580_411867_2258"==i?(r=m(a),o.bottom=0<r.length?r[0]:"",o.bottoml=1<r.length?r[1]:"",o.bottomr=2<r.length?r[2]:""):"_18_5_3_8bf0285_1526605771405_96327_15754"==i?(r=p(a),o.numberingDepth=0<r.length?r[0]:0):"_18_5_3_8bf0285_1526605817077_688557_15755"==i&&(r=m(a),o.numberingSeparator=0<r.length?r[0]:".")}}},function(e){}).finally(function(){n.resolve(o)}),n.promise},reset:function(){I={}},AnnotationType:{mmsTranscludeName:1,mmsTranscludeDoc:2,mmsTranscludeCom:3,mmsTranscludeVal:4,mmsViewLink:5,mmsPresentationElement:6}}}function VizService(i,a,r,o,e,s){var l=function(e){var t=r.getRoot(),n="";if(-1<t.indexOf("http")){var i=t.split("/");3<=i.length&&(n=i[0]+"/"+i[1]+"/"+i[2])}return n+"/alfresco"+e.url+"?alf_ticket="+s.getTicket()},c=function(e){var t=e.refId?e.refId:"master",n=e.commitId?e.commitId:"latest";return["image",e.projectId,t,e.elementId,n,e.accept]};return{getImageURL:function(e){var t=i.defer(),n=c(e);return o.exists(n)?t.resolve(l(o.get(n))):a.get(r.getImageURL(e),{headers:{Accept:e.accept}}).then(function(e){o.put(n,e.data.artifacts[0],!1),t.resolve(l(e.data.artifacts[0]))},function(e){r.handleHttpStatus(e.data,e.status,e.headers,e.config,t)}),t.promise}}}function partialMatch(e){var i=e("uibTypeaheadHighlight");return function(e,t){var n=i(e,t);return n=n.replace("<strong>","<u>").replace("</strong>","</u>")}}function mmsC3Plot(TableService,$window,_){var mmsChartLink=function(scope,element,attrs,mmsViewCtrl){var c3=$window.c3,d3=$window.d3,divchart=d3.select(element[0]).append("div"),projectId,refId,commitId;if(mmsViewCtrl){var viewVersion=mmsViewCtrl.getElementOrigin();projectId=viewVersion.projectId,refId=viewVersion.refId,commitId=viewVersion.commitId}function simplifyFunctions(object){_.forOwn(object,function(value,key,ob){_.isPlainObject(value)?simplifyFunctions(value):ob[key]=eval("("+value+")")})}function vf_pplot(e,t){t&&_.isPlainObject(t)&&(simplifyFunctions(t),_.merge(e,t)),c3.generate(e)}scope.render=function(){TableService.readvalues(scope.plot,projectId,refId,commitId).then(function(e){var t,n;(scope.valuesO=e.tablebody.valuesO,0!==e.tablebody.c3_data.length)&&(t=void 0===scope.plot.config.options||0===scope.plot.config.options.length?e.isHeader?{data:{x:"x",type:"line"},axis:{x:{type:"category",tick:{centered:!0}}}}:{data:{}}:scope.plot.config.options,e.tablebody.c3_data.length===scope.plot.table.body.length&&void 0===t.data.xs&&e.isHeader&&e.tablebody.c3_data.unshift(["x"].concat(e.tableheader)),t.data.columns=e.tablebody.c3_data,scope.plot.config.functions&&(n=scope.plot.config.functions),divchart.selectAll("*").remove(),divchart.attr("id","c3chart"+scope.$id),t.bindto="#c3chart"+scope.$id,vf_pplot(t,n))})},scope.$watch("valuesO",function(e,t){return scope.render()},!0)};return{restrict:"EA",require:"?^mmsView",scope:{plot:"<"},link:mmsChartLink}}function mmsD3GroupedHorizontalBarPlot(A,c){return{restrict:"EA",require:"?^mmsView",scope:{plot:"<"},link:function(p,e,t,E){var C,j=c.d3,k=j.select(e[0]).append("div"),x=A.plotConfig(p.plot.config.options,{width:960,marginTop:20,marginRight:40,marginBottom:30,marginLeft:40});e.click(function(e){e.stopPropagation()});var n,i,a,r=j.scaleOrdinal(j.schemeCategory10).range();function T(e,t){return void 0!==e.colors?r[e.colors[t]]:r[t]}if(E){var o=E.getElementOrigin();n=o.projectId,i=o.refId,a=o.commitId}var P=1,s=1,l=.3;function O(){j.selectAll(".ghbbar").transition(200).style("fill-opacity",P),j.selectAll(".legendRect").transition(200).style("fill-opacity",P),j.selectAll(".legentFilter").transition(200).style("opacity",P)}function $(e){j.selectAll(".ghbbar").transition(200).style("fill-opacity",l),j.selectAll(".legendRect").transition(200).style("fill-opacity",l),j.selectAll(".legentFilter").transition(200).style("opacity",l),j.selectAll(e).transition(200).style("fill-opacity",s),j.selectAll(e).transition(200).style("opacity",s)}function u(n){k.selectAll("*").remove(),k.attr("class",C.id).attr("style","border:1px solid #ddd");for(var e=k.append("svg:svg").attr("class","ghbchart "+n.id),t=[],i=[],a=[],r=[],o=[],s=n.legendsFilter,l=n.labelsFilter,c=-1,d=0;d<n.labels.length;d++)if(l[A.toValidId(n.labels[d])]){o.push(n.labels[d]);for(var m=0;m<n.values.length;m++)c++,s[A.toValidId(n.legends[m])]&&(t.push(Number(n.values[m][d])),i.push(n.valueIds[m][d]),a.push(T(n,c%n.legends.length)),r.push(A.toValidId(n.legends[m])))}var p=r.length/o.length,u=x.width-260,f=20*p,g=x.marginLeft,v=20*t.length+10*o.length,h=j.scaleLinear().domain([0,j.max(t)]).range([0,u]),b=j.scaleLinear().range([v+10,0]),w=j.axisLeft(b).tickFormat("").tickSize(0),y=e.attr("width",x.width).attr("height",v+50),I=y.selectAll("g").data(t).enter().append("g").attr("transform",function(e,t){return"translate("+g+","+(20*t+10*(.5+Math.floor(t/p)))+")"}),_=r.length/o.length;I.append("rect").attr("id",function(e,t){return i[t]}).attr("fill",function(e,t){return a[t]}).style("fill-opacity",P).attr("class",function(e,t){return"ghbbar "+n.id+" "+r[t]+" "+A.toValidId(o[Math.floor(t/_)])}).attr("width",h).attr("height",19).on("click",function(e,t){E&&E.transcludeClicked(this.id)}).on("mouseover",function(e,t){$("."+n.id+"."+r[t])}).on("mouseout",function(e,t){O()}),I.append("text").attr("class",function(e,t){return"ghbbar "+n.id+" "+r[t]}).attr("x",function(e){return h(e)-3}).attr("y",10).attr("dy",".35em").text(function(e){return e}),I.each(function(e,t){t%p==0&&j.select(this).append("text").attr("class","label").attr("x",function(e){return-10}).attr("y",f/2).attr("dy",".35em").text(o[Math.floor(t/p)])}),y.append("g").attr("class","y axis").attr("id","ghbaxis").attr("transform","translate("+g+", "+-5+")").call(w);var S=y.selectAll(".legend").data(n.legends).enter().append("g").attr("transform",function(e,t){return"translate("+(g+u+60+18)+","+(22*t- -5)+")"}).on("mouseover",function(e,t){$("."+n.id+"."+A.toValidId(e))}).on("mouseout",function(e,t){O()});S.append("rect").attr("class",function(e,t){return"legendRect "+n.id+" "+A.toValidId(e)}).attr("width",18).attr("height",18).style("fill-opacity",P).style("fill",function(e,t){return T(n,t)}).style("stroke",function(e,t){return T(n,t)}),S.append("text").attr("class","legend").attr("x",22).attr("y",14).text(function(e,t){return e})}p.render=function(){A.readvalues(p.plot,n,i,a).then(function(e){var t=e.tablebody,n=e.tableheader;if(p.valuesO=e.tablebody.valuesO,0!==t.c3_data.length){var i;void 0!==p.plot.config.colors&&(i=p.plot.config.colors);var a,r,o=[],s=[],l=[],c=[],d=0;t.c3_data.forEach(function(e){l.push(e[0]),c[e[0]]=!0,a=[],r=[];for(var t=1;t<e.length;t++)a.push(e[t]),r.push(d++);s.push(r),o.push(a)});var m=[];n.forEach(function(e){m[e]=!0}),u(C={id:"_"+p.$id,labels:n,legends:l,colors:i,values:o,valueIds:s,legendsFilter:c,labelsFilter:m}),function n(i){var e=k.append("div").attr("class","graphFilter "+i.id).style("margin-left",x.marginLeft+"px");e.append("div").append("label").style("border","1px solid #ddd").text("Filter by Legends").selectAll("div").data(i.legends).enter().append("div").attr("class",function(e,t){return"legentFilter "+i.id+" "+A.toValidId(e)}).attr("style",function(e,t){return"opacity: "+P+";background-color:"+T(i,t)+";"}).on("mouseover",function(e,t){$("."+i.id+"."+A.toValidId(e))}).on("mouseout",function(e,t){O()}).append("label").each(function(e,t){j.select(this).append("input").attr("type","checkbox").attr("checked",function(e,t){return!0===i.legendsFilter[A.toValidId(e)]||null}).attr("style",function(e,t){var n=T(i,t);return"color: "+n+";background-color:"+n+";"}).on("click",function(e){i.legendsFilter[A.toValidId(e)]=this.checked,u(C),n(C)}),j.select(this).append("span").text(function(e){return e})}),e.append("div").append("label").style("border","1px solid #ddd").text("Filter by Columns").selectAll("div").data(i.labels).enter().append("div").attr("class",function(e,t){return"columnfilter "+i.id+" "+A.toValidId(e)}).on("mouseover",function(e,t){$("."+i.id+"."+A.toValidId(e))}).on("mouseout",function(e,t){O()}).append("label").each(function(e,t){j.select(this).append("input").attr("type","checkbox").attr("checked",function(e,t){return!0===i.labelsFilter[A.toValidId(e)]||null}).on("click",function(e){i.labelsFilter[A.toValidId(e)]=this.checked,u(C),n(C)}),j.select(this).append("span").text(function(e){return e})})}(C)}})},p.$watch("valuesO",function(e,t){return p.render()},!0),p.$on("elementSelected",function(e,t,n){j.selectAll("rect").transition(200).style("fill-opacity",l)})}}}function mmsD3NormalizedStackedBarPlot(_,l){return{restrict:"EA",require:"?^mmsView",scope:{plot:"<"},link:function(h,e,t,n){var i,a,r,b=l.d3,w=b.select(e[0]).append("div"),y={width:960,height:500,marginTop:20,marginRight:60,marginBottom:30,marginLeft:40},I="d3nbplot"+h.$id;if(n){var o=n.getElementOrigin();i=o.projectId,a=o.refId,r=o.commitId}function s(){w.selectAll("*").remove(),w.attr("id",I);var e=w.append("svg:svg"),t=_.plotConfig(h.plot.config.options,y);e.attr("width",t.width),e.attr("height",t.height);var n,i=t.marginTop,a=t.marginRight,r=t.marginBottom,o=t.marginLeft,s=+e.attr("width")-o-a,l=+e.attr("height")-i-r,c=e.append("g").attr("transform","translate("+o+","+i+")"),d=b.scaleBand().rangeRound([0,s]).padding(.1).align(.1),m=b.scaleLinear().rangeRound([l,0]),p=b.scaleOrdinal(b.schemeCategory10),u=b.stack().offset(b.stackOffsetExpand),f=h.tablebody.c3_data;(n=f).forEach(function(e){for(var t=e.total=0;t<h.tablecolumnheader.length;t++)e.total+=Number(e[h.tablecolumnheader[t]])}),(f=n).sort(function(e,t){return t[h.tablecolumnheader[0]]/t.total-e[h.tablecolumnheader[0]]/e.total}),d.domain(f.map(function(e){return e.rowheader})),p.domain(h.tablecolumnheader);var g=c.selectAll(".serie").data(u.keys(h.tablecolumnheader)(f)).enter().append("g").attr("class","serie").attr("fill",function(e){return p(e.key)});g.selectAll("rect").data(function(e){return e}).enter().append("rect").attr("x",function(e){return d(e.data.rowheader)}).attr("y",function(e){return m(e[1])}).attr("height",function(e){return m(e[0])-m(e[1])}).attr("width",d.bandwidth()),c.append("g").attr("class","axis axis--x").attr("transform","translate(0,"+l+")").call(b.axisBottom(d)),c.append("g").attr("class","axis axis--y").call(b.axisLeft(m).ticks(10,"%"));var v=g.append("g").attr("class","legend").attr("transform",function(e){return e=e[e.length-1],"translate("+(d(e.data.rowheader)+d.bandwidth())+","+(m(e[0])+m(e[1]))/2+")"});v.append("line").attr("x1",-6).attr("x2",6).attr("stroke","#000"),v.append("text").attr("x",9).attr("dy","0.35em").attr("fill","#000").style("font","10px sans-serif").text(function(e){return e.key})}h.render=function(){_.readvalues2(h.plot,i,a,r).then(function(e){h.tablebody=e.tablebody,h.tablecolumnheader=e.tableheader,h.valuesO=e.tablebody.valuesO,0!==h.tablebody.c3_data.length&&s()})},h.$watch("valuesO",function(e,t){return h.render()},!0)}}}function mmsD3ParallelAxisPlot(x,l){return{restrict:"EA",require:"?^mmsView",scope:{plot:"<"},link:function(E,e,t,n){E.rowHeaders=[];var i,a,r,C=l.d3,j=C.select(e[0]).append("div"),k={width:900,marginTop:0,marginRight:0,marginBottom:25,marginLeft:60};if(n){var o=n.getElementOrigin();i=o.projectId,a=o.refId,r=o.commitId}function s(e){if(void 0!==E.plot.config.ticks)for(var t=0;t<E.plot.config.ticks.length;t++)if(E.plot.config.ticks[t].name===e)return E.plot.config.ticks[t].color}E.render=function(){x.readvalues(E.plot,i,a,r).then(function(e){if(E.tablebody=e.tablebody,E.tableheader=e.tableheader,E.isHeader=e.isHeader,E.valuesO=e.tablebody.valuesO,0!==E.tablebody.c3_data.length){var i,a=[];E.tablebody.c3_data.forEach(function(e){for(var t=[],n=1;n<e.length;n++)t[E.tableheader[n-1]]=e[n],i=s(e[0]);a.push({row:e[0],tickColor:i,values:t})}),function(e){for(var t=x.plotConfig(E.plot.config.options,k),r=e,n=t.width,i=.37*t.width,a=[t.marginTop,t.marginRight,t.marginBottom,t.marginLeft],o=0,s=0,l=s=o=0;l<r.variables.length;l++)o<(s=r.variables[l].length)&&(o=s);a[0]=4.5*o*.707+50,a[1]=4.5*o*.707+10;var c=n-a[1]-a[3],d=i-a[0]-a[2],m=C.scaleOrdinal(C.schemeCategory10),p=C.scalePoint(C.schemeCategory10).domain(r.variables).range([0,c]),u={},f=C.line();j.selectAll("*").remove();var g=j.append("svg:svg").attr("class","papchart"+E.$id+" papchart").attr("style","border:1px solid #ddd").attr("width",c+a[1]+a[3]).attr("height",d+a[0]+a[2]).append("svg:g").attr("transform","translate("+a[3]+","+a[0]+")"),v={};r.variables.forEach(function(e,t){v[e]={};for(var n=r.table[0].values[e],i=r.table[0].values[e],a=0;a<r.table.length;a++)n>r.table[a].values[e]&&(n=r.table[a].values[e]),i<r.table[a].values[e]&&(i=r.table[a].values[e]);v[e].min=n,v[e].max=i});var h={},b={},w={};r.variables.forEach(function(e,t){h[e]=Math.abs(v[e].max-v[e].min),b[e]=v[e].min-.07*h[e],w[e]=v[e].max+.07*h[e],v[e].max==v[e].min&&(w[e]=1.07*v[e].max,b[e]=v[e].max*(1-.07)),0===v[e].max&&0===v[e].min&&(w[e]=.07,b[e]=-.07)}),r.variables.forEach(function(e){u[e]=C.scaleLinear().domain([b[e],w[e]]).range([d,0])});var y=g.append("text").style("opacity",0).style("font-family","sans-serif").style("font-size","13px"),I=[],_=[];r.table.forEach(function(e){void 0===e.tickColor?I.push(e):_.push(e)}),g.append("svg:g").attr("class","foreground").selectAll("path").data(I).enter().append("svg:path").attr("d",function(t){return t=t.values,f(r.variables.map(function(e){return[p(e),u[e](t[e])]}))}).on("mouseover",function(e){y.attr("x",C.mouse(this)[0]).attr("y",C.mouse(this)[1]).text(e.row).transition(200).style("opacity",1)}).on("mouseout",function(){y.transition(200).style("opacity",0)}).attr("stroke",function(e,t){return m(t)}).attr("fill","none").style("stroke-width","1px").attr("cid",function(e,t){return e.cid}).attr("config",function(e,t){return e.design}).attr("class",function(e,t){return"design "+e.cid+" selected"}).append("svg:title").text(function(e){return e.row});var S=g.selectAll(".variables").data(r.variables).enter().append("svg:g").attr("class","variables").attr("transform",function(e,t){return"translate("+p(e)+")"});S.append("svg:g").attr("class","axis").each(function(e){C.select(this).call(C.axisLeft(u[e]).ticks(5))}).append("svg:text").data(r.variables).attr("y",-12).attr("transform","rotate(-45 0 0)").attr("x",0).attr("class","axislabel").attr("fill","black").text(function(e){return e}),_.forEach(function(t){S.select("g.axis").append("g").attr("transform",function(e){return"translate(0,"+u[e](t.values[e])+")"}).attr("class","objectivetick").append("line").attr("stroke",t.tickColor).style("stroke-width","3px").attr("fill","none").attr("x1",-5).attr("x2",6).attr("y2",0).on("mouseover",function(e){y.attr("x",C.mouse(this)[0]+p(e)).attr("y",C.mouse(this)[1]+u[e](t.values[e])).text(t.row).transition(200).style("opacity",1)}).on("mouseout",function(e){y.transition(200).style("opacity",0)})})}({variables:E.tableheader,table:a})}})},E.$watch("valuesO",function(e,t){return E.render()},!0)}}}function mmsD3RadarPlot(l,c){return{restrict:"EA",require:"?^mmsView",scope:{plot:"<"},link:function(w,e,t,n){var i,a,r,y=c.d3,I=y.scaleOrdinal(y.schemeCategory10),_=y.select(e[0]).append("div");if(n){var o=n.getElementOrigin();i=o.projectId,a=o.refId,r=o.commitId}w.render=function(){l.readvalues(w.plot,i,a,r).then(function(e){if(w.tablebody=e.tablebody,w.tableheader=e.tableheader,w.isHeader=e.isHeader,w.valuesO=e.tablebody.valuesO,0!==w.tablebody.c3_data.length){var i=[];w.tablebody.c3_data.forEach(function(e){for(var t=[],n=1;n<e.length;n++)t.push({axis:w.tableheader[n-1],value:e[n]});i.push(t)}),_.selectAll("*").remove(),_.attr("class","radar"+w.$id).attr("style","border:1px solid #ddd"),s.draw("radar"+w.$id,i);var t,n,a,r=[];w.tablebody.c3_data.forEach(function(e){r.push(e[0])}),t=r,n="radar"+w.$id,(a=y.select("."+n).selectAll("svg").append("svg").attr("width",S.w+300).attr("height",S.h).append("g").attr("class","legend").attr("height",100).attr("width",200).attr("transform","translate(50,50)")).selectAll("rect").data(t).enter().append("rect").attr("x",S.w-65).attr("y",function(e,t){return 20*t}).attr("width",10).attr("height",10).style("fill",function(e,t){return I(t)}).attr("fill-opacity",1).attr("rid",function(e){return e}).on("mouseover",function(e,t){y.select("."+n).selectAll("svg").selectAll("polygon").transition(200).style("fill-opacity",.1),y.select(".radar-chart-serie"+t+"."+n).transition(200).style("fill-opacity",.7)}).on("mouseout",function(e,t){y.select("."+n).selectAll("svg").selectAll("polygon").transition(200).style("fill-opacity",S.opacityArea)}),a.selectAll("text").data(t).enter().append("text").attr("x",S.w-52).attr("y",function(e,t){return 20*t+9}).attr("font-size","11px").attr("fill","#737373").text(function(e){return e}).on("mouseover",function(e,t){y.select("."+n).selectAll("svg").selectAll("polygon").transition(200).style("fill-opacity",.1),y.select(".radar-chart-serie"+t+"."+n).transition(200).style("fill-opacity",.7)}).on("mouseout",function(e,t){y.select("."+n).selectAll("svg").selectAll("polygon").transition(200).style("fill-opacity",.1)})}})},w.$watch("valuesO",function(e,t){return w.render()},!0);var S,E=l.plotConfig(w.plot.config.options,{width:700,height:700,marginTop:0,marginRight:0,marginBottom:0,marginLeft:0}),s={draw:function(n,e){(S={radius:5,factor:1,w:E.width-200,h:E.height-200,factorLegend:.85,levels:3,maxValue:0,radians:2*Math.PI,opacityArea:.5,ToRight:5,TranslateX:80,TranslateY:80,ExtraWidthX:100,ExtraWidthY:0,color:I}).maxValue=Math.max(S.maxValue,y.max(e,function(e){return y.max(e.map(function(e){return Number(e.value)}))}));var t=e[0].map(function(e,t){return e.axis}),a=t.length,i=S.factor*Math.min(S.w/2,S.h/2),r=_.append("svg:svg").attr("class","rdchart "+w.$id);r.attr("width",E.width),r.attr("height",E.height);for(var o,s=r.append("g").attr("transform","translate("+S.TranslateX+","+S.TranslateY+")"),l=0;l<S.levels;l++){var c=S.factor*i*((l+1)/S.levels);s.selectAll(".levels").data([1]).enter().append("svg:text").attr("x",c*(1-S.factor*Math.sin(0))).attr("y",c*(1-S.factor*Math.cos(0))).attr("class","legend").style("font-family","sans-serif").style("font-size","10px").attr("transform","translate("+(S.w/2-c+S.ToRight)+", "+(S.h/2-c)+")").attr("fill","#737373").text(y.format(".3g")((l+1)*S.maxValue/S.levels))}function d(e,t,n,i){return t*(1-(n=void 0!==n?n:1)*i(e*S.radians/a))}function m(e,t,n){return d(e,t,n,Math.sin)}function p(e,t,n){return d(e,t,n,Math.cos)}var u=y.range(0,S.levels).map(function(e){return i*((e+1)/S.levels)}),f=s.selectAll(".levels").data(u);f.enter().append("g"),f.exit().remove(),f.attr("class",function(e,t){return"level-group level-group-"+t});var g=f.selectAll(".level").data(function(e){return y.range(0,a).map(function(){return e})});g.enter().append("line"),g.exit().remove(),g.attr("class","level").attr("x1",function(e,t){return m(t,e)}).attr("y1",function(e,t){return p(t,e)}).attr("x2",function(e,t){return m(t+1,e)}).attr("y2",function(e,t){return p(t+1,e)}).style("stroke","grey").style("stroke-opacity","0.75").style("stroke-width","0.3px").attr("transform",function(e){return"translate("+(S.w/2-e)+", "+(S.h/2-e)+")"});var v=0,h=s.selectAll(".axis").data(t).enter().append("g").attr("class","axis");h.append("line").attr("x1",S.w/2).attr("y1",S.h/2).attr("x2",function(e,t){return S.w/2*(1-S.factor*Math.sin(t*S.radians/a))}).attr("y2",function(e,t){return S.h/2*(1-S.factor*Math.cos(t*S.radians/a))}).attr("class","line").style("stroke","grey").style("stroke-width","1px"),h.append("text").attr("class","legend").text(function(e){return e}).style("font-family","sans-serif").style("font-size","12px").attr("text-anchor","middle").attr("dy","1.5em").attr("transform",function(e,t){return"translate(0, -8)"}).attr("x",function(e,t){return S.w/2*(1-S.factorLegend*Math.sin(t*S.radians/a))-60*Math.sin(t*S.radians/a)}).attr("y",function(e,t){return S.h/2*(1-Math.cos(t*S.radians/a))-20*Math.cos(t*S.radians/a)});var b=[];e.forEach(function(e,t){b=[],s.selectAll(".nodes").data(e,function(e,t){b.push([S.w/2*(1-parseFloat(Math.max(e.value,0))/S.maxValue*S.factor*Math.sin(t*S.radians/a)),S.h/2*(1-parseFloat(Math.max(e.value,0))/S.maxValue*S.factor*Math.cos(t*S.radians/a))])}),b.push(b[0]),s.selectAll(".area").data([b]).enter().append("polygon").attr("class","radar-chart-serie"+v+" "+n).style("stroke-width","2px").style("stroke",S.color(v)).attr("points",function(e){for(var t="",n=0;n<e.length;n++)t=t+e[n][0]+","+e[n][1]+" ";return t}).style("fill",function(e,t){return S.color(v)}).style("fill-opacity",.1).on("mouseover",function(e,t){y.select(this).transition(200).style("fill-opacity",.7)}).on("mouseout",function(e,t){y.select(this).transition(200).style("fill-opacity",.1)}),v++}),v=0,e.forEach(function(e,t){s.selectAll(".nodes").data(e).enter().append("svg:circle").attr("class","radar-chart-serie"+v+" "+n).attr("r",S.radius).attr("alt",function(e){return Math.max(e.value,0)}).attr("cx",function(e,t){return b.push([S.w/2*(1-parseFloat(Math.max(e.value,0))/S.maxValue*S.factor*Math.sin(t*S.radians/a)),S.h/2*(1-parseFloat(Math.max(e.value,0))/S.maxValue*S.factor*Math.cos(t*S.radians/a))]),S.w/2*(1-Math.max(e.value,0)/S.maxValue*S.factor*Math.sin(t*S.radians/a))}).attr("cy",function(e,t){return S.h/2*(1-Math.max(e.value,0)/S.maxValue*S.factor*Math.cos(t*S.radians/a))}).attr("data-id",function(e){return e.axis}).style("fill",S.color(v)).style("fill-opacity",.9).on("mouseover",function(e){var t=parseFloat(y.select(this).attr("cx"))-10,n=parseFloat(y.select(this).attr("cy"))-5;o.attr("x",t).attr("y",n).text(e.value.toString()).transition(200).style("opacity",1)}).on("mouseout",function(){o.transition(200).style("opacity",0)}).append("svg:title").text(function(e){return Math.max(e.value,0)}),v++}),o=s.append("text").style("opacity",0).style("font-family","sans-serif").style("font-size","13px")}}}}}function mmsAnnotation(e,i,s,a){return{restrict:"A",template:e.get("mms/templates/mmsAnnotation.html"),scope:{mmsReqOb:"<",mmsRecentElement:"<",mmsType:"<",mmsCfLabel:"<"},controller:["$scope",function(e){var t;t=e.mmsRecentElement?function(e,t){var n,i,a=s.AnnotationType,r="",o=s.getTypeFromClassifierId(t.classifierIds);switch(o){case"ListT":case"TableT":case"ImageT":case"ParagraphT":case"SectionT":case"FigureT":o=o.substring(0,o.length-1)}switch(e){case a.mmsTranscludeName:r=t.name,n="Referenced element not found",i="Displaying last found name as placeholder.";break;case a.mmsTranscludeDoc:r=t.documentation,n="Referenced element not found",i="Displaying last found documentation as placeholder.";break;case a.mmsTranscludeCom:r=t.documentation,n="Referenced comment not found.",i="Displaying last found comment content as a placeholder.";break;case a.mmsViewLink:r=t.name,n="Referenced view link not found",i="Displaying last found view link as placeholder.";break;case a.mmsTranscludeVal:r=function(e){var t="";"Property"!==e.type&&"Port"!==e.type&&"Slot"!==e.type||(e.defaultValue?t=e.defaultValue.value:e.value&&(t=e.value[0].value));"Constraint"===e.type&&e.specification&&(t=e.specification.value);return t}(t),n="Referenced element not found",i="Displaying last found value as placeholder.";break;case a.mmsPresentationElement:r=t.documentation||"<span>(no text)</span>",n="Referenced "+o+" not found.",i="Displaying last found content as placeholder."}return{inlineContent:r,toolTipTitle:n,toolTipContent:i,id:t.id}}(e.mmsType,e.mmsRecentElement):function(e,t,n){var i=s.AnnotationType,a="",r=n?"("+n+")":"";switch(e){case i.mmsTranscludeName:a="cf name"+r+" does not exist";break;case i.mmsTranscludeDoc:a="cf documentation"+r+" does not exist";break;case i.mmsTranscludeCom:a="cf com"+r+" does not exist";break;case i.mmsTranscludeVal:a="cf value"+r+" does not exist";break;case i.mmsViewLink:a="view link does not exist";break;case i.mmsPresentationElement:a="presentation element does not exist"}return{inlineContent:a,toolTipTitle:"Element not found",toolTipContent:"",id:t.elementId}}(e.mmsType,e.mmsReqOb,e.mmsCfLabel);e.displayContent=t}],link:function(e,t,n){t.on("click",function(){e.mmsRecentElement&&i.$broadcast("elementSelected",e.mmsRecentElement,e.mmsRecentElement._commitId,!0)}),e.copyToClipboard=function(e){a.copyToClipboard(t.find("#tooltipElementId"),e)}}}}function mmsButtonBar(e){return{restrict:"E",template:e.get("mms/templates/mmsButtonBar.html"),link:function(e,t,n){},controller:["$scope",function(a){if(a.mmsBbApi){var r=a.mmsBbApi;r.select=function(e,t){e&&t&&e.dropdown_buttons.forEach(function(e){e.selected=e.id===t.id})},r.setPermission=function(t,n){a.buttons.forEach(function(e){e.id===t&&(e.permission=n)})},r.setTooltip=function(t,n){a.buttons.forEach(function(e){e.id===t&&(e.tooltip=n)})},r.setIcon=function(t,n){a.buttons.forEach(function(e){e.id===t&&(e.icon=n)})},r.setToggleState=function(n,i){a.buttons.forEach(function(e){if(e.id===n&&e.togglable){var t=e.toggle_state;(!t&&i||t&&!i)&&r.toggleButtonState(n)}})},r.getToggleState=function(t){var n={toggle_state:!1};return a.buttons.forEach(function(e){e.id===t&&((n=e).togglable||(e.toggle_state=!1),e.toggle_state||(e.toggle_state=!1))}),n.toggle_state},r.addButton=function(e){0===a.buttons.count?e.placement="bottom-left":e.placement||(e.placement="bottom"),e.togglable&&(e.toggle_state=!1,e.tooltip_orginal=e.tooltip),e.icon_original=e.icon,a.buttons.push(e)},r.toggleButtonSpinner=function(t){a.buttons.forEach(function(e){e.id===t&&(e.spinner?e.icon=e.icon_original:(e.icon_original=e.icon,e.icon="fa fa-spinner fa-spin"),e.spinner=!e.spinner)})},r.toggleButtonState=function(t){a.buttons.forEach(function(e){e.id===t&&e.togglable&&(e.toggle_state=!e.toggle_state,e.toggle_state&&e.toggle_icon&&e.toggle_tooltip?(e.icon=e.toggle_icon,e.tooltip=e.toggle_tooltip):(e.icon=e.icon_original,e.tooltip=e.tooltip_orginal))})},r.init&&r.init()}}],scope:{buttons:"<",mmsBbApi:"<",direction:"@"}}}function mmsCf(u){return{restrict:"E",scope:{mmsElementId:"@",mmsProjectId:"@",mmsRefId:"@",mmsCommitId:"@",mmsCfType:"@",mmsWatchId:"@",nonEditable:"<",mmsGenerateForDiff:"<"},require:["?^^mmsCf","?^^mmsView"],controller:["$scope",function(e){this.getElementOrigin=function(){return{projectId:e.projectId,refId:e.refId,commitId:e.commitId}}}],link:function(s,l,e,t){var c=t[0],d=t[1],n=function(e,t){if(e){s.mmsWatchId||(m(),p());var n=s.mmsProjectId,i=s.mmsRefId,a=s.mmsCommitId;if(c){var r=c.getElementOrigin();n||(n=r.projectId),i||(i=r.refId),a||(a=r.commitId)}if(d){var o=d.getElementOrigin();n||(n=o.projectId),i||(i=o.refId),a||(a=o.commitId)}n&&(s.projectId=n,s.refId=i||"master",s.commitId=a||"latest",s.templateElementHtml=l[0].innerHTML,s.mmsCfType&&(l[0].innerHTML="<mms-transclude-"+s.mmsCfType+(s.mmsGenerateForDiff?' mms-generate-for-diff="mmsGenerateForDiff" ':"")+' mms-element-id="{{mmsElementId}}" mms-project-id="{{projectId}}" mms-ref-id="{{refId}}" mms-commit-id="{{commitId}}" non-editable="nonEditable" mms-cf-label="{{templateElementHtml}}"></mms-transclude-'+s.mmsCfType+">",u(l.contents())(s)))}},m=s.$watch("mmsElementId",n),p=s.$watch("mmsCommitId",n)}}}function mmsCkeditor(A,R,V,D,L,B,M,F,N,U,H,q,J){var z=0;return{priority:10,restrict:"A",require:"ngModel",scope:{mmsProjectId:"@",mmsRefId:"@",autosaveKey:"@",mmsEditorType:"@",mmsEditorApi:"<?"},link:function(l,t,n,i){n.id||n.$set("id","mmsCkEditor"+z++);var a=null,e=R.get("mms/templates/mmsCfModal.html"),r=R.get("mms/templates/mmsCommentModal.html"),o=function(i,a){i.title="Insert cross reference",i.description="Begin by searching for an element, then click a field to cross-reference.",i.searchExisting=!0,i.newE={name:"",documentation:""},i.requestName=!1,i.requestDocumentation=!1,i.showProposeLink=!0,i.nonEditableCheckbox=!1,i.showEditableOp=!0,i.choose=function(e,t){var n='<mms-cf mms-cf-type="'+t+'" mms-element-id="'+e.id+'" non-editable="'+i.nonEditableCheckbox+'">[cf:'+e.name+"."+t+"]</mms-cf>";a.close(n)},i.cancel=function(){a.dismiss()},i.searchOptions={},i.searchOptions.getProperties=!0,i.searchOptions.callback=i.choose,i.searchOptions.emptyDocTxt="This field is empty, but you can still click here to cross-reference a placeholder.",i.makeNewAndChoose=function(){if(i.newE.name)if(i.requestName||i.requestDocumentation){i.proposeClass="fa fa-spin fa-spinner";var e={id:N.createMmsId(),ownerId:"holding_bin_"+l.mmsProjectId,name:i.newE.name,documentation:i.newE.documentation,type:"Class",_appliedStereotypeIds:[]},t={element:e=N.createClassElement(e),projectId:l.mmsProjectId,refId:l.mmsRefId};F.createElement(t).then(function(e){i.requestName?i.choose(e,"name"):i.requestDocumentation&&i.choose(e,"doc"),i.proposeClass=""},function(e){D.error("Propose Error: "+e.message),i.proposeClass=""})}else D.error("Error: Selection of a property to cross-reference is required.");else D.error("Error: A name for your new element is required.")},i.toggleRadio=function(e){"name"===e?(i.requestName=!0,i.requestDocumentation=!1):"documentation"===e&&(i.requestName=!1,i.requestDocumentation=!0)}},s=function(t){A.open({template:e,scope:l,controller:["$scope","$uibModalInstance",o],size:"lg"}).result.then(function(e){k(t,e)},function(){new L.focusManager(t).focus()})},c=function(r,s,l){r.title="Insert cross reference as link",r.description="Search for a view or content element, click on its name or its document/section to insert link.",r.showProposeLink=!1,r.searchExisting=!0,r.suppressNumbering=!1,r.linkType=1,r.linkText="";var c=function(e,t,n,i){var a="<mms-view-link";return t&&(a+=' mms-doc-id="'+t+'"'),n&&(a+=' mms-element-id="'+n+'"'),i&&(a+=' mms-pe-id="'+i+'"'),2==r.linkType&&(a+=' suppress-numbering="true"'),3==r.linkType&&r.linkText&&(a+=' link-text="'+r.linkText+'"'),a+=">[cf:"+e.name+".vlink]</mms-view-link>"};r.choose=function(e){var t=null,n=null,i=null,a=l.getState().currentDoc;if(e._relatedDocuments&&0<e._relatedDocuments.length){var r=B.find(e._relatedDocuments,{id:a});r?(t=a,0<r._parentViews.length&&(n=r._parentViews[0].id)):(t=e._relatedDocuments[0].id,0<e._relatedDocuments[0]._parentViews.length&&(n=e._relatedDocuments[0]._parentViews[0].id))}"InstanceSpecification"===e.type?U.isSection(e)?n=e.id:i=e.id:n=e.id;var o=c(e,t,n,i);s.close(o)},r.chooseDoc=function(e,t,n){var i=e.id,a=t.id,r=null;U.isSection(n)?a=n.id:U.getPresentationElementType(n)&&(r=n.id);var o=c(n,i,a,r);s.close(o)},r.cancel=function(){s.dismiss()},r.searchOptions={callback:r.choose,relatedCallback:r.chooseDoc,filterQueryList:[function(){var e={};e.terms={_appliedStereotypeIds:[N.VIEW_SID,N.DOCUMENT_SID].concat(N.OTHER_VIEW_SID)};var t=[],n=U.TYPE_TO_CLASSIFIER_ID;for(var i in n)n.hasOwnProperty(i)&&t.push(n[i]);var a={};return a.terms={classifierIds:t},{bool:{should:[e,a]}}}],itemsPerPage:200}},d=function(t){A.open({template:e,scope:l,controller:["$scope","$uibModalInstance","ApplicationService",c],size:"lg"}).result.then(function(e){k(t,e)})},m=function(t,n){var e=N.createMmsId();t.comment=N.createClassElement({id:e,name:"Comment "+(new Date).toISOString(),documentation:"",type:"Class",ownerId:"holding_bin_"+l.mmsProjectId,_appliedStereotypeIds:[]}),t.oking=!1,t.ok=function(){if(t.oking)D.info("Please wait...");else{t.oking=!0;var e={element:t.comment,projectId:l.mmsProjectId,refId:l.mmsRefId};F.createElement(e).then(function(e){var t='<mms-cf mms-cf-type="com" mms-element-id="'+e.id+'">comment:'+e._creator+"</mms-cf>";n.close(t)},function(e){D.error("Comment Error: "+e.message)}).finally(function(){t.oking=!1})}},t.cancel=function(){n.dismiss()}},p=function(t){A.open({template:r,scope:l,controller:["$scope","$uibModalInstance",m]}).result.then(function(e){k(t,e)})},u=function(e,s){angular.forEach(e,function(e,t){var n=angular.element(e),i=n.attr("mms-element-id"),a=N.makeElementKey({id:i,_projectId:l.mmsProjectId,_refId:l.mmsRefId}),r=M.get(a);if(r)n.html("[cf:"+r.name+s);else{var o={elementId:i,projectId:l.mmsProjectId,refId:l.mmsRefId};F.getElement(o,2).then(function(e){n.html("[cf:"+e.name+s)},function(e){var t;410===e.status&&(t="deleted"),404===e.status&&(t="not found"),n.html("[cf:"+t+s)})}})},f=function(e){var t=e.document.getBody();u(t.find("mms-cf[mms-cf-type='name']").$,".name]"),u(t.find("mms-cf[mms-cf-type='doc']").$,".doc]"),u(t.find("mms-cf[mms-cf-type='val']").$,".val]"),u(t.find("mms-view-link").$,".vlink]"),g()},g=function(){angular.isDefined(a)&&null!==a&&i.$setViewValue(a.getData())},v={name:"styles",items:["Format","FontSize","TextColor","BGColor"]},h={name:"basicstyles",items:["Bold","Italic","Underline","mmsExtraFormat"]},b={name:"clipboard",items:["Undo","Redo"]},w={name:"paragraph",items:["JustifyLeft","JustifyCenter","JustifyRight"]},y={name:"editing",items:["Find","Replace"]},I={name:"links",items:["Link","Unlink","-"]},_={name:"list",items:["NumberedList","BulletedList","Outdent","Indent"]},S={name:"equation",items:["Mathjax","SpecialChar"]},E={name:"source",items:["Maximize","Source"]},C=[v,h,w,_,I,{name:"combined",items:[{name:"Mmscf",label:"Cross Reference",command:"mmscf"},{name:"Mmsvlink",label:"View/Element Link",command:"mmsvlink"},"Table","Image","Iframe","Mathjax","SpecialChar",{name:"Mmscomment",label:"Comment",command:"mmscomment"},"mmsExtraFeature"]},b,y,E];switch(l.mmsEditorType){case"TableT":break;case"ListT":C=[v,h,w,_,I,S,"mmsExtraFeature",b,y,E];break;case"Equation":C=[w,S,E];break;case"Figure":case"ImageT":C=[w,{name:"image",items:["Image","Iframe"]},E]}var j=B.debounce(function(e){g()},1e3);function k(e,t){e.insertHtml(t),J.focusOnEditorAfterAddingWidgetTag(e)}function x(e){if(P(e.data.domEvent.$))return!1;var t,n=T(e)||(13===(t=e.data.domEvent.$.which)||38===t||40===t)&&q.hasMentionResults(a);n&&(e.cancel(),e.stop()),T(e)&&!O(e.data.domEvent.$)&&a.insertHtml("&nbsp;&nbsp;&nbsp;&nbsp;"),n||j(e)}function T(e){return 9===e.data.domEvent.$.which}function P(e){return O(e)&&"@"===e.key}function O(e){return e.shiftKey}V(function(){var e;$(t).val(i.$modelValue),a=L.replace(n.id,{mmscf:{callbackModalFnc:s},mmscomment:{callbackModalFnc:p},mmsvlink:{callbackModalFnc:d},mmsreset:{callback:f},contentsCss:L.basePath+"contents.css",toolbar:C}),n.autosaveKey?a.config.autosave={SaveKey:n.autosaveKey,delay:5,NotOlderThen:7200,enableAutosave:!0}:a.config.autosave={enableAutosave:!1},a.on("instanceReady",function(){var e,t,n;a.dataProcessor.htmlFilter.addRules({elements:{$:function(t){if("script"!==t.name)if(t.name.startsWith("mms-")&&"mms-view-link"!==t.name&&"mms-cf"!==t.name&&"mms-group-docs"!==t.name&&"mms-diff-attr"!==t.name&&"mms-value-link"!==t.name)t.replaceWithChildren();else{var e=Object.keys(t.attributes).filter(function(e){return e.startsWith("ng-")});e.forEach(function(e){delete t.attributes[e]})}else t.remove()}}}),(e=a).addCommand("formatAsCode",{exec:function(e){var t=e.getSelection().getSelectedText(),n=new L.dom.element("code");n.addClass("inlineCode"),n.setText(t),e.insertElement(n)}}),e.addMenuGroup("veGroup"),e.addMenuItem("formatAsCode",{label:"Format as inline code",command:"formatAsCode",group:"veGroup",icon:"codeSnippet"}),e.contextMenu.addListener(function(e){return{formatAsCode:L.TRISTATE_OFF}}),e.setKeystroke(L.CTRL+75,"formatAsCode"),t=a,n="active-editor",$("mms-transclude-doc").children("div").removeClass(n),$(t.element.$).closest("mms-transclude-doc").children("div").addClass(n),t.on("focus",function(){$("mms-transclude-doc").children("div").removeClass(n),$(t.element.$).closest("mms-transclude-doc").children("div").addClass(n)})}),a.on("init",function(e){i.$setPristine()}),a.on("change",j),a.on("afterCommandExec",j),a.on("resize",j),a.on("destroy",j),a.on("blur",function(e){a.focusManager.blur()}),a.on("key",x,null,null,31),L.instances[n.id].on("contentDom",function(){e=L.instances[a.name].document.on("keyup",function(e){P(e.data.$)?q.createMention(a,l.mmsProjectId,l.mmsRefId):q.handleInput(e,a,l.mmsProjectId,l.mmsRefId)})}),L.instances[n.id].on("contentDomUnload",function(){e&&e.removeListener()}),l.mmsEditorApi&&(l.mmsEditorApi.save=function(){g()}),a.on("fileUploadRequest",function(e){var t=e.data.fileLoader,n=new FormData;t.xhr.open("POST",H.getPutArtifactsURL({projectId:l.mmsProjectId,refId:l.mmsRefId}),!0),n.append("id",N.createMmsId().replace("MMS","VE")),n.append("file",t.file,t.fileName),t.fileName&&n.append("name",t.fileName),t.xhr.send(n),e.stop()}),a.on("fileUploadResponse",function(e){e.stop();var t=e.data,n=t.fileLoader.xhr,i=JSON.parse(n.response);i.artifacts&&0!=i.artifacts.length?t.url="/alfresco"+i.artifacts[0].artifactLocation:e.cancel()})},0,!1),i.$render=function(){},l.$on("$destroy",function(){a=a?(q.removeAllMentionForEditor(a),a.destroy(),null):L.instances[n.id]})}}}function mmsDiagramBlock(y,t,n){return{restrict:"E",template:"<div></div>",replace:!0,scope:{mmsDid:"@"},controller:["ElementService",function(e){}],link:function(b,w,e){n.getOwnedElements(b.mmsDid,!1,"master","latest").then(function(e){for(var t={},n=0;n<e.length;n++)t[e[n].id]=e[n];var i,a={};for(n=0;n<e.length;n++)if("Element"===(i=e[n]).type){var r={key:i.id,iskey:!0,figure:"Decision",label:i.name,children:[]};i.hasOwnProperty("ownerId")&&t[i.ownerId]&&(r.parent=i.ownerId),a[r.key]=r}var o=[];for(var s in a){var l=a[s];o.push(l),l.parent&&a[l.parent].children.push(l)}var c=[];for(n=0;n<e.length;n++)if("Dependency"===(i=e[n]).type){var d={from:i._sourceIds[0],to:i._targetIds[0]};c.push(d)}var m={nodes:o,edges:c},p=[];for(n=0;n<m.nodes.length;n++){var u={key:(i=m.nodes[n]).key,text:i.label,color:"lightblue"};0<i.children.length&&(u.isGroup=!0),i.parent&&(u.group=i.parent),p.push(u)}var f=y.GraphObject.make,g=f(y.Diagram,w[0],{allowDrop:!0,mouseDrop:function(e){g.commandHandler.addTopLevelParts(g.selection,!0)||g.currentTool.doCancel()},layout:f(y.GridLayout,{wrappingWidth:1/0,alignment:y.GridLayout.Position,cellSize:new y.Size(1,1)}),initialContentAlignment:y.Spot.Center,groupSelectionAdornmentTemplate:f(y.Adornment,y.Panel.Auto,f(y.Shape,"Rectangle",{fill:null,stroke:"dodgerblue",strokeWidth:3}),f(y.Placeholder)),"commandHandler.archetypeGroupData":{isGroup:!0,category:"OfNodes"},"undoManager.isEnabled":!0});function v(e,t,n){if(t){if(e.handled=!0,n){var i=t.diagram.toolManager.draggingTool,a=i.draggedParts||i.copiedParts;if(t.canAddMembers(a.toKeySet()))return void(t.isHighlighted=!0)}t.isHighlighted=!1}}g.addDiagramListener("ChangedSelection",function(e){var t=g.selection.first();g.model.selectedNodeData=t instanceof y.Node?t.data:null,b.$apply()}),g.groupTemplate=f(y.Group,"Auto",{layout:f(y.TreeLayout,{angle:90,arrangement:y.TreeLayout.ArrangementHorizontal,isRealtime:!1}),isSubGraphExpanded:!1,subGraphExpandedChanged:function(e){e.memberParts.count}},f(y.Shape,"RoundedRectangle",{fill:null,stroke:"gray",strokeWidth:2}),f(y.Panel,"Vertical",{defaultAlignment:y.Spot.Left,margin:4},f(y.Panel,"Horizontal",{defaultAlignment:y.Spot.Top},f("SubGraphExpanderButton"),f(y.TextBlock,{font:"Bold 18px Sans-Serif",margin:4},new y.Binding("text","text"))),f(y.Placeholder,{padding:new y.Margin(0,10)})));var h=f(y.Panel,"Horizontal",f(y.Shape,{desiredSize:new y.Size(5,5)},new y.Binding("figure","figure"),new y.Binding("fill","color")),f(y.TextBlock,{stroke:"$black",font:"bold 11px sans-serif"},new y.Binding("text","",y.Binding.toString)));g.nodeTemplate=f(y.Node,y.Panel.Auto,{selectionAdorned:!0,resizable:!0,layoutConditions:y.Part.LayoutStandard&~y.Part.LayoutNodeSized,fromSpot:y.Spot.Right,toSpot:y.Spot.Left,isShadowed:!0,mouseDragEnter:function(e,t,n){v(e,t.containingGroup,!0)},mouseDragLeave:function(e,t,n){v(e,t.containingGroup,!1)},mouseDrop:function(e,t){var n;null!==(n=t.containingGroup)&&n.addMembers(n.diagram.selection,!0)||n.diagram.currentTool.doCancel()}},f(y.Shape,"RoundedRectangle",{isPanelMain:!0,fill:"#ACE600",stroke:"#558000",strokeWidth:2},new y.Binding("fill","color")),f(y.Panel,"Table",{margin:4,maxSize:new y.Size(150,NaN)},f(y.RowColumnDefinition,{column:0,stretch:y.GraphObject.Horizontal,alignment:y.Spot.Left}),f(y.TextBlock,{row:0,column:0,maxSize:new y.Size(120,NaN),margin:2,font:"bold 10pt sans-serif",alignment:y.Spot.Top},new y.Binding("text","text")),f(y.Panel,"Vertical",{row:1,padding:3,alignment:y.Spot.TopLeft,defaultAlignment:y.Spot.Left,stretch:y.GraphObject.Horizontal,itemTemplate:h},new y.Binding("itemArray","items")))),g.linkTemplate=f(y.Link,{routing:y.Link.AvoidsNodes,corner:5,curve:y.Link.JumpGap},f(y.Shape),f(y.Shape,{toArrow:"Standard"})),g.model=new y.GraphLinksModel(p,m.edges),g.model.selectedNodeData=null},function(e){t.error("Block Diagram Error: "+e.message)})}}}function mmsDiffAttr(s,l,r,e,w,o){return{restrict:"E",scope:{mmsAttr:"@",mmsBaseProjectId:"@",mmsCompareProjectId:"@",mmsBaseRefId:"@",mmsCompareRefId:"@",mmsBaseCommitId:"@",mmsCompareCommitId:"@",mmsBaseElementId:"@",mmsCompareElementId:"@"},template:e.get("mms/templates/mmsDiffAttr.html"),link:function(m,e,t,n){var p=n?n.getElementOrigin():null;m.diffFinish=function(){m.diffLoading=!1},m.$watch("mmsBaseCommitId",a),m.$watch("mmsCompareCommitId",a);var u=!1,f=!1,g=!1,v=!1;function i(){m.diffLoading=!0;var e=m.mmsBaseProjectId||(p?p.projectId:null),t=m.mmsCompareProjectId||e,n=m.mmsBaseRefId||(p?p.refId:"master"),i=m.mmsCompareRefId||n,a=m.mmsBaseCommitId||"latest",r=m.mmsCompareCommitId||"latest",o=m.mmsBaseElementId,s=m.mmsCompareElementId||o,l=function(e){if("latest"!==e.baseCommitId&&e.baseCommitId===e.compareCommitId||"latest"===e.baseCommitId&&e.baseCommitId===e.compareCommitId&&e.baseElementId===e.compareElementId&&e.baseProjectId===e.compareProjectId&&e.baseRefId===e.compareRefId)return m.message=" Comparing same version.",!(m.diffLoading=!1)}({baseElementId:o,compareElementId:s,baseCommitId:a,compareCommitId:r,baseRefId:n,compareRefId:i,baseProjectId:e,compareProjectId:t});if(!l){var c=h(e,n,a,o),d=h(t,i,r,s);w.allSettled([c,d]).then(function(e){var t,n=e[0];"fulfilled"===n.state?b(n.value,function(e){m.baseElementHtml=e}):((t=n.reason.message)&&t.toLowerCase().includes("deleted")?g=!0:u=!0,m.baseElementHtml="");var i=e[1];"fulfilled"===i.state?b(i.value,function(e){m.comparedElementHtml=e}):((t=i.reason.message)&&t.toLowerCase().includes("deleted")?v=!0:f=!0,m.comparedElementHtml=""),m.message=function(){var e="";u&&f?e=" Both base and compare elements do not exist.":u?e=" This is a new element.":f&&(e=" Comparison element does not exist.");g&&v?e=" This element has been deleted.":g?e=" Base element has been deleted.":v&&(e=" Comparison element has been deleted.");return e}()})}}function a(e,t){e!==t&&i()}function h(e,t,n,i){return o.getElement({projectId:e,elementId:i,refId:t,commitId:n})}function b(e,t){var n=function(e,t,n,i,a){var r;r="<mms-cf "+("doc"===e||"val"===e||"com"===e?'mms-generate-for-diff="mmsGenerateForDiff" ':"")+'mms-cf-type="{{type}}" mms-element-id="{{mmsElementId}}" mms-project-id="{{mmsProjectId}}" mms-ref-id="{{mmsRefId}}" mms-commit-id="{{mmsCommitId}}"></mms-cf>';var o=l.$new();return o=Object.assign(o,{type:e,mmsElementId:t,mmsProjectId:n,mmsRefId:i,mmsCommitId:a,mmsGenerateForDiff:!0}),s(r)(o)}(m.mmsAttr,e.id,e._projectId,e._refId,e._commitId),i=r(function(){var e=n.html();e.includes("(loading...)")||(r.cancel(i),t(e))},10)}i()},require:"?^^mmsView"}}function mmsGroupDocs(e,m,t,n,i,a){return{restrict:"E",template:i.get("mms/templates/mmsGroupDocs.html"),scope:{mmsRefId:"@",mmsProjectId:"@",mmsGroupId:"@"},require:["?^^mmsCf","?^^mmsView"],link:function(a,e,t,n){var i=n[0],r=n[1],o=function(e){for(var t=[],n=""===a.mmsGroupId?void 0:a.mmsGroupId,i=0;i<e.length;i++)void 0!==n&&n!==a.projectId||e[i]._groupId?e[i]._groupId==a.mmsGroupId&&t.push(e[i]):t.push(e[i]);a.docs=t},s=a.mmsProjectId,l=a.mmsRefId;if(i){var c=i.getElementOrigin();s||(s=c.projectId),l||(l=c.refId)}if(r){var d=r.getElementOrigin();s||(s=d.projectId),l||(l=d.refId)}s&&(a.projectId=s,a.refId=l||"master",m.getProjectDocuments({projectId:a.projectId,refId:a.refId},2).then(function(e){o(e),a.documents=e,a.$watchCollection("documents",function(e,t){o(e)})}))}}}function mmsHistory(l,c,d,e,t,n,i,m){return{restrict:"E",template:e.get("mms/templates/mmsHistory.html"),scope:{mmsElementId:"@",mmsProjectId:"@",mmsRefId:"@"},link:function(i,e,t){var a=!1,r=null;i.historyVer="latest",i.compareCommit={ref:{id:i.mmsRefId},compareHistory:null,commitSelected:null,isopen:!1},i.refList=[],i.baseCommit={refSelected:{id:i.mmsRefId},baseHistory:null,commitSelected:null,isopen:!1,refisopen:!1};var n={elementId:i.mmsElementId,projectId:i.mmsProjectId,refId:i.mmsRefId};c.getElement(n,2,!1).then(function(e){i.element=e});var o=function(t,e){if(t&&(t!=e||!a)){a=!0,r=t,i.gettingHistory=!0;var n={elementId:i.mmsElementId,projectId:i.mmsProjectId,refId:i.mmsRefId};c.getElementHistory(n,2).then(function(e){t===r&&(i.historyVer="latest",i.compareCommit.compareHistory=e,i.compareCommit.commitSelected=i.compareCommit.compareHistory[0],s(),1<(i.baseCommit.baseHistory=e).length?i.baseCommit.commitSelected=i.compareCommit.compareHistory[1]:0<e.length?i.baseCommit.commitSelected=i.compareCommit.compareHistory[0]:i.baseCommit.commitSelected="--- none ---")}).finally(function(){i.gettingHistory=!1})}},s=function(){d.getRefs(i.mmsProjectId).then(function(e){i.refList=e,i.compareCommit.ref=m.find(e,function(e){return e.id==i.mmsRefId}),i.baseCommit.refSelected=i.compareCommit.ref})};i.commitClicked=function(e){i.compareCommit.commitSelected=e,i.historyVer=i.compareCommit.commitSelected.id,i.compareCommit.isopen=!i.compareCommit.isopen},i.getElementHistoryByRef=function(e){if(e){i.disableRevert=!1,i.baseCommit.refSelected=e;var t={elementId:i.mmsElementId,projectId:i.mmsProjectId,refId:e.id};c.getElementHistory(t,2).then(function(e){0<(i.baseCommit.baseHistory=e).length&&(i.baseCommit.commitSelected=i.baseCommit.baseHistory[0])},function(e){i.baseCommit.baseHistory=[],i.baseCommit.commitSelected="",i.disableRevert=!0}).finally(function(){i.baseCommit.refisopen=!i.baseCommit.refisopen})}},i.baseCommitClicked=function(e){i.baseCommit.commitSelected=e,i.baseCommit.isopen=!i.baseCommit.isopen},i.changeElement=o,i.$watch("mmsElementId",o),i.$watch("mmsRefId",o),i.revert=function(){l.revertAction(i,o,e)}}}}function mmsHtmlDiff(e,i,t,a){var n=e.get("mms/templates/mmsHtmlDiff.html");return{restrict:"E",scope:{mmsBaseHtml:"<",mmsComparedHtml:"<",mmsDiffFinish:"<"},template:n,controller:["$scope",function(e){r(e,e.mmsBaseHtml,e.mmsComparedHtml)}],link:function(n,e,t){n.htmlDiffId="htmlDiff-"+n.$id,n.$watch("mmsBaseHtml",function(e,t){e!==t&&r(n,n.mmsBaseHtml,n.mmsComparedHtml)}),n.$watch("mmsComparedHtml",function(e,t){e!==t&&r(n,n.mmsBaseHtml,n.mmsComparedHtml)})}};function r(t,e,n){t.diffResult=a.generateDiff(o(e),o(n)),i(function(){var e=$("#"+t.htmlDiffId);e.find("img").each(function(){var e=$(this),t=e.hasClass("patcher-insert")?"patcher-insert":e.hasClass("patcher-delete")?"patcher-delete":null;t&&e.wrap('<span class="'+t+'">')}),e.find("tr").each(function(){var e=$(this),t=e.hasClass("patcher-insert")?"patcher-insert":e.hasClass("patcher-delete")?"patcher-delete":null;t&&(e.removeClass(t),e.children().each(function(){$(this).addClass(t)}))}),t.mmsDiffFinish()})}function o(e){return e.replace(/\r?\n|\r|\t/g,"").replace('<p class="ng-scope">&nbsp;</p>',"")}}function mmsJobs(e,t,n,i,c,a,d,m,r,p,u,f,g){return{restrict:"E",template:e.get("mms/templates/mmsJobs.html"),scope:{mmsProjectId:"@",mmsRefId:"@",mmsDocId:"@"},link:function(r,e,t){var o;r.jobs=[],r.jobInstances={},r.loadingJobs=!1,r.createJobCleared=!0,r.runCleared=!0,r.jobInput={jobName:""},r.hasRefArr=!1,r.docEditable=!1,r.docgenExists=!1;var s=function(){u.getRefs(r.mmsProjectId).then(function(e){r.refList=e.filter(function(e){if("creating"===e.status)return!0})})},l=function(t){r.loading=!0,g.getJobInstances(t,r.mmsProjectId,r.mmsRefId).then(function(e){r.jobInstances[t]=e},function(e){r.jobInstances[t]={jobStatus:"error getting job"}}).finally(function(){r.loading=!1})};r.$watch("mmsDocId",function(n,e){if(n&&(n!=e||!o)){o=!0;var i=n,a=null;s(),u.getRef(r.mmsRefId,r.mmsProjectId).then(function(e){a=e,r.mmsRefType=a.type;var t={elementId:r.mmsDocId,projectId:r.mmsProjectId,refId:r.mmsRefId};p.getElement(t,2,!1).then(function(e){n===i&&(f.isDocument(e)?(r.isDoc=!0,r.doc=e,r.docName=e.name,r.docEditable=e._editable&&"Tag"!=r.mmsRefType,r.createJobCleared=r.docEditable,r.runCleared=r.docEditable,r.jobs=[],r.loadingJobs=!0,g.getJobs(r.mmsDocId,r.mmsProjectId,r.mmsRefId).then(function(e){for(var t=0;t<e.length;t++)r.jobs.push(e[t]),l(e[t].id),"docgen"===e[t].type&&(r.docgenExists=!0)},function(e){c.error("There was a error in retrieving your job: "+e.status)}).finally(function(){r.loadingJobs=!1})):r.isDoc=!1)})})}});var n=function(e){r.runCleared=!1;var t={id:e};g.runJob(t,r.mmsProjectId,r.mmsRefId).then(function(e){c.success("Your job is running!")},function(e){c.error("Your job failed to run: "+e.data.message)}).finally(function(){r.runCleared=!0})};r.createJobandRun=function(e){e?n(e):i().then(function(e){r.jobs.push(e),n(e.id)})};var i=function(){var t=d.defer(),e=r.jobInput.jobName;r.createJobCleared=!1,r.jobInput.jobName||(e=r.docName+"_DocGen_job");var n={id:r.mmsDocId,jobName:e,jobType:"docgen",jobSchedule:""};return g.createJob(n,r.mmsProjectId,r.mmsRefId).then(function(e){c.success("Your job has posted"),r.docgenExists=!0,t.resolve(e)},function(e){c.error("Your job failed to post: "+e.data.message)}).finally(function(){r.createJobCleared=!0}),t.promise};r.disableJob=function(e){},r.changePane=function(e){m.$broadcast(e)},r.$on("stomp.updateJob",function(e,t){var n=t.jobId;r.jobInstances[n]&&(r.jobInstances[n]=[t])}),r.$on("stomp.branchCreated",function(e,t,n){s()})}}}function mmsMaturityBar(r){return{restrict:"E",template:"",scope:{state:"@"},link:function(e,t,n){var i,a=r.d3.select(t[0]).append("svg").attr("width",520).attr("height",70);i="Identified"==e.state?["brown","#B0B0B0","#B0B0B0","#B0B0B0","#B0B0B0"]:"Draft"==e.state?["#FF7519","#FF7519","#B0B0B0","#B0B0B0","#B0B0B0"]:"Prelim"==e.state?["#FFAA00","#FFAA00","#FFAA00","#B0B0B0","#B0B0B0"]:"Baseline"==e.state?["#04859E","#04859E","#04859E","#04859E","#B0B0B0"]:"Final"==e.state?["#00BD39","#00BD39","#00BD39","#00BD39","#00BD39"]:["#B0B0B0","#B0B0B0","#B0B0B0","#B0B0B0","#B0B0B0"],a.append("rect").attr("x",10).attr("y",10).attr("width",100).attr("height",50).style("fill",i[0]).style("stroke","#fff").style("stroke-width",3),a.append("text").text("Identified").attr("x",60).attr("y",35).attr("dy",".35em").attr("fill","#fff").attr("font-family","sans-serif").style("text-anchor","middle"),a.append("rect").attr("x",110).attr("y",10).attr("width",100).attr("height",50).style("fill",i[1]).style("stroke","#fff").style("stroke-width",3),a.append("text").text("Draft").attr("x",160).attr("y",35).attr("dy",".35em").attr("fill","#fff").attr("font-family","sans-serif").style("text-anchor","middle"),a.append("rect").attr("x",210).attr("y",10).attr("width",100).attr("height",50).style("fill",i[2]).style("stroke","#fff").style("stroke-width",3),a.append("text").text("Prelim").attr("x",260).attr("y",35).attr("dy",".35em").attr("fill","#fff").attr("font-family","sans-serif").style("text-anchor","middle"),a.append("rect").attr("x",310).attr("y",10).attr("width",100).attr("height",50).style("fill",i[3]).style("stroke","#fff").style("stroke-width",3),a.append("text").text("Baseline").attr("x",360).attr("y",35).attr("dy",".35em").attr("fill","#fff").attr("font-family","sans-serif").style("text-anchor","middle"),a.append("rect").attr("x",410).attr("y",10).attr("width",100).attr("height",50).style("fill",i[4]).style("stroke","#fff").style("stroke-width",3),a.append("text").text("Final").attr("x",460).attr("y",35).attr("dy",".35em").attr("fill","#fff").attr("font-family","sans-serif").style("text-anchor","middle")}}}function mmsMention(e,a,r){return{template:e.get("mms/templates/mmsMention.html"),scope:{mmsEditor:"<",mmsMentionValue:"<",mmsMentionId:"<",mmsProjectId:"<",mmsRefId:"<"},controller:["$scope",function(i){function e(e){var t,n;n='<mms-cf mms-cf-type="'+(t=e).type+'" mms-element-id="'+t.id+'">[cf:'+t.name+"."+t.type+"]</mms-cf>",i.mmsEditor.insertHtml(n),r.focusOnEditorAfterAddingWidgetTag(i.mmsEditor),a.handleMentionSelection(i.mmsEditor,i.mmsMentionId)}i.fastCfListing=a.getFastCfListing(i.mmsProjectId,i.mmsRefId),this.selectMentionItem=e,i.selectMentionItem=e}],link:function(e,t,n,i){}}}function mmsMentionIntercept(){return{scope:{mmsMentionInterceptValue:"<"},controller:["$scope",function(e){}],require:["ngModel"],link:function(e,t,n,i){e.$watch("mmsMentionInterceptValue",function(e,t){var n=i[0];n.$setViewValue(e),n.$render()})}}}function mmsRefList(e,t,p,a,u,r,o,f,s,l){return{restrict:"E",template:e.get("mms/templates/mmsRefList.html"),scope:{mmsProjectId:"@",mmsRefId:"@",mmsRefType:"@",mmsDocId:"@",mmsBranches:"<",mmsTags:"<"},link:function(d,e,t){var i;d.showMerge=-1==l.getMmsServer().indexOf("opencae.jpl.nasa.gov"),d.runCleared=!0,d.docEditable=!1,d.currentRefOb=a.find(d.mmsBranches,{id:d.mmsRefId}),null==d.currentRefOb&&(d.currentRefOb=a.find(d.mmsTags,{id:d.mmsRefId}));var m=function(e,t,n){d.runCleared=!1;var i={id:e,post:{fromRefId:t,comment:n}};f.runJob(i,d.mmsProjectId,d.mmsRefId).then(function(e){},function(e){p.error("Your job failed to run: "+e.data.message)})};d.createJobandRun=function(s,l){var c=u.defer();return f.getJobs(d.mmsDocId,d.mmsProjectId,d.mmsRefId).then(function(e){for(var t,n,i,a,r=!1,o=0;o<e.length;o++)if(e[o].associatedElementID===d.mmsDocId&&"docmerge"===e[o].type){t=e[o].id,r=!0;break}r?m(t,s,l):(n=u.defer(),i="DocMerge_on_"+d.docName,a={id:d.mmsDocId,jobName:i,jobType:"docmerge"},f.createJob(a,d.mmsProjectId,d.mmsRefId).then(function(e){n.resolve(e),p.success("Creating your job")},function(e){p.error("Your job failed to post: "+e.data.message)}),n.promise).then(function(e){m(e.id,s,l)}),c.resolve("ok")},function(e){p.error("There was a error in retrieving your job: "+e.status)}),c.promise};d.$watch("mmsDocId",function(e,t){if(e&&(e!=t||!i)){i=!0;var n={elementId:d.mmsDocId,projectId:d.mmsProjectId,refId:d.mmsRefId};s.getElement(n,2,!1).then(function(e){o.isDocument(e)?(d.isDoc=!0,d.doc=e,d.docName=e.name,d.docEditable=e._editable&&"Tag"!=d.mmsRefType):d.isDoc=!1})}}),d.docMergeAction=function(e){d.srcRefOb=e,r.open({templateUrl:"mms/templates/mergeConfirm.html",scope:d,controller:["$scope","$uibModalInstance","$filter",n]}).result.then(function(e){})};var n=function(e,t,n){e.oking=!1,e.commitMessage="",e.createForm=!0,e.ok=function(){e.oking?p.info("Please wait..."):(e.oking=!0,e.createJobandRun(e.srcRefOb.id,e.commitMessage).then(function(e){p.success("Creating job to merge documents... please see the jobs pane for status updates"),t.close(e)},function(e){p.error("Could not merge document: "+e.message)}).finally(function(){e.oking=!1}))},e.cancel=function(){t.dismiss()}};d.$on("stomp.updateJob",function(e,t){"docmerge"===t.type&&t.associatedElementId===d.mmsDocId&&t.refId===d.mmsRefId&&"completed"===t.jobStatus&&(p.success(d.docName+" has been merged"),d.runCleared=!0)})}}}function mmsSearch(a,c,v,d,m,h,b,w,y,e,I){return{restrict:"E",template:e.get("mms/templates/mmsSearch.html"),link:function(p,e,t){var r=[];p.showFilterOptions=!p.mmsOptions.hideFilterOptions,p.searchLoading=!1,p.mainSearch={searchText:"",searchType:{id:"all",label:"All Fields"},selectedSearchMetatypes:[]},p.docsviews={selected:!1},p.refId=p.mmsRefId?p.mmsRefId:"master",p.qualifiedNameFormatter=function(e){if(e){var t=e.split("/"),n=e;return 7<t.length&&(n=t.slice(0,4).join("/")+"/.../"+t.slice(t.length-3,t.length).join("/")),n}},p.expandQualifiedName=function(e,t){e.currentTarget.innerHTML=t},p.showMoreRelatedViews=function(e){e.remainingRelatedDocuments=e.allRelatedDocuments.slice(3,e.allRelatedDocuments.length)},p.activeFilter=[],p.totalResults=0,p.paginationCache=[],p.currentPage=0,p.itemsPerPage=100,p.advanceSearch=!1,p.advanceSearchRows=[],p.stringQuery=p.mainSearch.searchText,p.showSearchResultProps=!1,p.switchText="More",p.limitForProps=6,p.closeSearch=function(){a.history.back()},m.getProjectMounts(p.mmsProjectId,p.refId);var n=function(e){var t=angular.element(e);return t.find("div").attr("value")};p.metatypeSearch="fa fa-spin fa-spinner",m.getMetatypes(p.mmsProjectId,p.refId).then(function(e){p.metatypeList=e},function(e){y.error("Search Error: "+e.message)}).finally(function(){p.metatypeSearch=""}),p.getTypeClass=function(e){return h.getElementTypeClass(e,b.getElementType(e))},p.fieldTypeList=[{id:"all",label:"All Fields"},{id:"name",label:"Name"},{id:"documentation",label:"Documentation"},{id:"value",label:"Value"},{id:"id",label:"ID"},{id:"metatype",label:"Metatype"}],p.operatorList=["And","Or","And Not"],p.metatypeSettings={scrollableHeight:"300px",scrollable:!0,enableSearch:!0,displayProp:"name",showCheckAll:!1,smartButtonMaxItems:10,buttonClasses:""},p.multiselectEvent={onItemSelect:function(e){I(function(){p.stringQueryUpdate()},500)},onItemDeselect:function(e){I(function(){p.stringQueryUpdate()},500)},onDeselectAll:function(e){I(function(){p.stringQueryUpdate()},500)}},p.getActiveFilterClass=function(e){return p.activeFilter.length?w.includes(p.activeFilter,e):""},p.filterSearchResults=function(e){w.clone(p.activeFilter);w.includes(p.activeFilter,e)?w.pull(p.activeFilter,e):p.activeFilter.push(e),o()};var o=function(){p.activeFilter.length?p.searchResults=w.filter(r,function(e){return w.includes(p.activeFilter,b.getElementType(e))}):p.searchResults=r};p.filterOptions=[{display:"Documents",icon:null,type:"Document"},{display:"Text",icon:"pe-type-Paragraph",type:"Paragraph"},{display:"Tables",icon:"pe-type-Table",type:"Table"},{display:"Images",icon:"pe-type-Image",type:"Image"},{display:"Equations",icon:"pe-type-Equation",type:"Equation"},{display:"Comments",icon:"pe-type-Comment",type:"Comment"},{display:"Sections",icon:"pe-type-Section",type:"Section"},{display:"Views",icon:"pe-type-View",type:"View"},{display:"Requirements",icon:"pe-type-Req",type:"Requirement"}],p.$watch("searchResults",function(e){e&&p.mmsOptions.getProperties&&e.forEach(function(n){if(!n._properties&&("Class"===n.type||"Component"===n.type)){var e={elementId:n.id,projectId:n._projectId,refId:n._refId,depth:2};d.getOwnedElements(e,2).then(function(e){var t=[];angular.forEach(e,function(e){"Property"===e.type&&e.ownerId==n.id?t.push(e):"Slot"===e.type&&t.push(e)}),n._properties=t})}})}),p.stringQueryUpdate=function(){var e=p.advanceSearchRows.length;p.stringQuery=Array(e+1).join("("),p.stringQuery+=p.mainSearch.searchType.label+":","metatype"===p.mainSearch.searchType.id?p.stringQuery+=n("#searchMetatypeSelectAdvance"):p.stringQuery+=p.mainSearch.searchText;for(var t=0;t<e;t++)p.stringQuery+=" "+p.advanceSearchRows[t].operator.toUpperCase()+" "+p.advanceSearchRows[t].searchType.label+":","metatype"===p.advanceSearchRows[t].searchType.id?p.stringQuery+=n("#searchMetatypeSelect-"+t)+")":p.stringQuery+=p.advanceSearchRows[t].searchText+")"},p.addAdvanceSearchRow=function(){p.advanceSearchRows.push({operator:"And",searchType:{id:"all",label:"All Fields"},searchText:"",selectedSearchMetatypes:[]}),p.stringQueryUpdate()},p.addAdvanceSearchRow(),p.removeRowAdvanceSearch=function(e){p.advanceSearchRows=w.without(p.advanceSearchRows,e),p.stringQueryUpdate()},p.modifyAdvanceSearch=function(){p.advanceSearch=!p.advanceSearch,p.advancedSearchResults=!p.advancedSearchResults},p.nextPage=function(){p.paginationCache[p.currentPage+1]?(r=p.paginationCache[p.currentPage+1],p.currentPage+=1,o()):p.search(p.mainSearch,p.currentPage+1,p.itemsPerPage),c("ve-search-results")},p.prevPage=function(){p.paginationCache[p.currentPage-1]?(r=p.paginationCache[p.currentPage-1],p.currentPage-=1,o()):p.search(p.mainSearch,p.currentPage-1,p.itemsPerPage)},p.search=function(e,n,t){p.searchLoading=!0;var i=s(e);i.from=n*t+n,i.size=t;var a={projectId:p.mmsProjectId,refId:p.refId,checkType:!0};d.search(a,i,2).then(function(e){var t=e.elements;r=p.mmsOptions.filterCallback?(p.searchResults=p.mmsOptions.filterCallback(t),p.searchResults):p.searchResults=t,l(p),p.totalResults=e.total,p.maxPages=Math.ceil(p.totalResults/p.itemsPerPage),p.currentPage=n,p.paginationCache.push(p.searchResults),p.advanceSearch&&(p.advancedSearchResults=!0),o()},function(e){y.error("Search Error: "+e.message)}).finally(function(){p.searchLoading=!1})},p.newSearch=function(e){p.paginationCache=[],p.search(e,0,p.itemsPerPage)};var u=function(e,t){t.push({bool:{must:[{term:{_projectId:e.id}},{term:{_inRefIds:e._refId}}]}});var n=e._mounts;if(angular.isArray(n)&&0!==n.length)for(var i=0;i<n.length;i++)n[i]._mounts&&u(n[i],t)},f=function(e){var t={},n={},i=["defaultValue.value^3","value.value^3","specification.value^3"];if("all"===e.searchType.id){var a={};a.term={id:{value:e.searchText,boost:10}};var r={};n.query=e.searchText,n.fields=i.slice(),n.fields.push("name^5","documentation"),n.fuzziness="AUTO",r.multi_match=n,t={bool:{should:[a,r]}}}else if("name"===e.searchType.id||"documentation"===e.searchType.id){var o=e.searchType.id;n[o]={query:e.searchText,fuzziness:"AUTO"},t.match=n}else if("id"===e.searchType.id)t.term={id:e.searchText};else if("value"===e.searchType.id)n.query=e.searchText,n.fields=i,n.fuzziness="AUTO",t.multi_match=n;else if("metatype"===e.searchType.id){for(var s=w.pluck(e.selectedSearchMetatypes,"id"),l=[],c=[],d=0;d<s.length;d++)s[d].includes("_")?(console.log(s[d]),l.push(s[d])):c.push(s[d]);t={bool:{should:[{terms:{_appliedStereotypeIds:l}},{terms:{type:c}}],minimum_should_match:1}}}return t},s=function(e){var t=function(){var e=[],t={},n=["project-mounts",p.mmsProjectId,p.refId];if(v.exists(n))e=v.get(n);else{var i=["project",p.mmsProjectId,p.refId],a=v.get(i);if(a)u(a,e);else{var r={id:p.mmsProjectId,_refId:p.refId};u(r,e)}v.put(n,e,!1)}return t.bool={should:e},t}(),n=[t];if(p.mmsOptions.filterQueryList&&angular.forEach(p.mmsOptions.filterQueryList,function(e){n.push(e())}),p.docsviews.selected){var i={terms:{_appliedStereotypeIds:[h.VIEW_SID,h.DOCUMENT_SID].concat(h.OTHER_VIEW_SID)}};n.push(i)}n.push({type:{value:"element"}});var a={},r={},o=p.advanceSearchRows.length;if(p.advanceSearch&&0!==o){for(var s,l=f(p.mainSearch),c=0;c<o;c++){var d=p.advanceSearchRows[c],m=d.operator;s=f(d),"And"===m?l={bool:{must:[l,s]}}:"Or"===m?l={bool:{should:[l,s],minimum_should_match:1}}:"And Not"===m&&(l={bool:{must:[l,{bool:{must_not:s}}]}})}a=l}else a={bool:{must:a=f(e)}};return(r={sort:["_score",{_modified:{order:"desc"}}],query:{},indices_boost:[{}]}).query=a,r.query.bool.filter=n,r.indices_boost[0][p.mmsProjectId.toLowerCase()]=2,r.aggs=g(),r},g=function(){return{elements:{filter:{bool:{must:[{term:{_projectId:"PROJECT-5d574aa8-bc06-4e95-bf71-3f2151833e09"}},{term:{_inRefIds:"master"}}]}},aggs:{types:{terms:{field:"type",size:20}}}}}},l=function(e){e.searchResults.forEach(function(e){var n=[];e._relatedDocuments&&e._relatedDocuments.forEach(function(t){t._parentViews.forEach(function(e){n.push({relatedDocument:t,relatedView:e})})}),e.allRelatedDocuments=n,e.someRelatedDocuments=n.slice(0,3)})};if(p.mmsOptions.searchResult){var i=p.mmsOptions.searchResult;p.searchResults=i,p.paginationCache.push(i)}p.mmsOptions.searchInput&&(p.mainSearch.searchText=p.mmsOptions.searchInput,p.newSearch(p.mainSearch));p.mmsOptions.itemsPerPage&&(p.itemsPerPage=p.mmsOptions.itemsPerPage);p.emptyDocTxt=p.mmsOptions.emptyDocTxt,p.userResultClick=function(e,t){p.mmsOptions.callback&&p.mmsOptions.callback(e,t)},p.userRelatedClick=function(e,t,n,i){e.preventDefault(),e.stopPropagation(),p.mmsOptions.relatedCallback&&p.mmsOptions.relatedCallback(t,n,i)}},scope:{mmsOptions:"<",mmsProjectId:"@",mmsRefId:"@"}}}function mmsSpec(c,d,m,p,u,e,f,t){return{restrict:"E",template:e.get("mms/templates/mmsSpec.html"),scope:{mmsElementId:"@",mmsProjectId:"@",mmsRefId:"@",mmsCommitId:"@",mmsElement:"<?",mmsSpecApi:"<?",noEdit:"@",mmsDisplayOldContent:"<?"},link:function(r,n,e){var o=!1,s=null,l=!1;if(r.editing=!1,r.editable=!0,r.gettingSpec=!1,r.isEnumeration=!1,r.propertyTypeClicked=function(e){var t={id:e,_projectId:r.mmsProjectId,_refId:r.mmsRefId};r.$emit("elementSelected",t)},r.mmsElement)return r.element=r.mmsElement,c.setupValCf(r),void(r.editable=!1);r.addHtml=function(e){e.value="<p>"+e.value+"</p>"},r.editorApi={};var t=function(i,e){if(i&&(i!==e||!o)&&r.mmsProjectId){r.relatedDocuments=null,o=!0,s=i,r.edit&&r.editorApi.save&&r.editorApi.save(),r.isEnumeration=!1,r.isSlot=!1;var t=r.gettingSpec=!0;r.mmsCommitId&&"latest"!==r.mmsCommitId&&(t=!1);var a={elementId:r.mmsElementId,projectId:r.mmsProjectId,refId:r.mmsRefId,commitId:r.mmsCommitId,extended:t};m.getElement(a,2,!1).then(function(n){var e;i===s&&(r.element=n,c.setupValCf(r),r.mmsCommitId&&"latest"!==r.mmsCommitId||m.search(a,{size:1,sort:[{_modified:{order:"desc"}}],query:{bool:{filter:[{term:{id:n.id}},{term:{_projectId:n._projectId}}]}}},2).then(function(e){if(i===s){var t=e.elements;t&&1==t.length&&t[0].id===n.id&&0<t[0]._relatedDocuments.length&&(r.relatedDocuments=t[0]._relatedDocuments)}}),!r.element._editable||"latest"!==r.mmsCommitId&&r.mmsCommitId?(r.editable=!1,r.edit=null,r.editing=!1):m.getElementForEdit(a).then(function(e){i===s&&(r.edit=e,r.editable=!0,l||(r.editing=!1),l=!1,"Property"!==r.edit.type&&"Port"!==r.edit.type&&"Slot"!==r.edit.type||(r.edit.defaultValue?r.editValues=[r.edit.defaultValue]:r.edit.value?r.editValues=r.edit.value:r.editValues=[],c.getPropertySpec(r.element).then(function(e){r.isEnumeration=e.isEnumeration,r.isSlot=e.isSlot,r.options=e.options},function(e){f.error("Failed to get property spec: "+e.message)})),"Constraint"===r.edit.type&&r.edit.specification&&(r.editValues=[r.edit.specification]))}),e=r.element,r.elementTypeClass=p.getElementTypeClass(e,u.getElementType(e)),r.elementDataLink="/alfresco/service/projects/"+r.element._projectId+"/refs/"+r.element._refId+"/elements/"+r.element.id+"?commitId="+r.element._commitId+"&alf_ticket="+d.getTicket(),r.gettingSpec=!1)},function(e){r.gettingSpec=!1})}};if(r.changeElement=t,r.$watch("mmsElementId",t),r.$watch("mmsProjectId",t),r.$watch("mmsCommitId",t),r.$watch("mmsRefId",t),r.copyToClipboard=function(e,t){p.copyToClipboard(n.find(t),e)},r.cleanupVal=function(e){e.value=parseInt(e.value)},r.revertEdits=function(){c.revertEdits(r,r.edit,r.editorApi)},r.save=function(){return c.save(r.edit,r.editorApi,r,!1)},r.hasHtml=function(e){return c.hasHtml(e)},r.hasEdits=function(){return c.hasEdits(r.edit)},c.setupValEditFunctions(r),angular.isObject(r.mmsSpecApi)){var i=r.mmsSpecApi;i.toggleEditing=function(){if(r.editing)r.editing=!1;else{if(!r.editable)return!1;r.editing=!0}return!0},i.setEditing=function(e){if(e){if(!r.editable)return!1;r.editing=!0}else r.editing=!1;return!0},i.getEditing=function(){return r.editing},i.save=r.save,i.revertEdits=r.revertEdits,i.changeElement=r.changeElement,i.hasEdits=r.hasEdits,i.getEdits=function(){return r.edit},i.setEdit=function(e){r.mmsElementId=e},i.keepMode=function(){l=!0},i.editorSave=function(){r.edit&&r.editorApi.save&&r.editorApi.save()}}}}}function mmsToolbar(e,i){return{restrict:"E",template:e.get("mms/templates/mmsToolbar.html"),controller:["$scope",function(i){if(i.mmsTbApi){var e=i.mmsTbApi;e.select=function(e){i.buttons.forEach(function(t){t.id===e&&t.active&&(t.dynamic||(i.buttons.forEach(function(e){e.selected=e===t}),i.buttons.forEach(function(e){e.dynamic&&(e.active=!1)}),t.dynamic_buttons&&t.dynamic_buttons.forEach(function(e){e.active=!0})))})},e.deactivate=function(t){i.buttons.forEach(function(e){e.id===t&&e.dynamic_buttons&&e.dynamic_buttons.forEach(function(e){e.active=!1})})},e.setPermission=function(t,n){i.buttons.forEach(function(e){e.id===t&&(e.permission=n)})},e.setSelected=function(t,n){i.buttons.forEach(function(e){e.id===t&&(e.selected=n)})},e.setIcon=function(t,n){i.buttons.forEach(function(e){e.id===t&&(e.icon=n)})},e.addButton=function(e){if(e.priority=i.buttons.length,i.buttons.push(e),e.dynamic_buttons){var t=!0;e.dynamic_buttons.forEach(function(e){t&&(e.pullDown=!0,t=!1),e.priority=i.buttons.length+1e3,i.buttons.push(e)})}},e.toggleButtonSpinner=function(t){i.buttons.forEach(function(e){e.id===t&&(e.spinner?e.icon=e.icon_original:(e.icon_original=e.icon,e.icon="fa fa-spinner fa-spin"),e.spinner=!e.spinner)})},e.setOptions=function(t,n){i.buttons.forEach(function(e){e.id===t&&(null!==n.active&&(e.active=n.active),null!==n.icon&&(e.icon=n.icon),null!==n.id&&(e.id=n.id),null!==n.permission&&(e.permission=n.permission),null!==n.priority&&(e.priority=n.priority),null!==n.selected&&(e.selected=n.selected),null!==n.spinner&&(e.spinner=n.spinner),null!==n.tooltip&&(e.tooltip=n.tooltip))})},e.init&&e.init()}}],link:function(n,e,t){n.clicked=function(e){if(e.permission&&e.active){var t=!1;this.$root.ve_togglePane&&!1!==i.mms_pane_toggleable&&(e.selected||this.$root.ve_togglePane.closed)&&(e.selected&&!this.$root.ve_togglePane.closed&&(t=!0),this.$root.ve_togglePane.toggle()),this.$root.ve_tbApi&&this.$root.ve_tbApi.select(e.id),e.onClick?e.onClick():n.onClick&&n.onClick({button:e}),t&&this.$root.ve_tbApi.deactivate(e.id)}}},scope:{buttons:"<",mmsTbApi:"<",onClick:"&",direction:"@"}}}function mmsTranscludeArt(l,c,d){return{restrict:"E",template:'<img ng-if="image" ng-src="{{url}}"></img><a ng-if="!image" ng-href="{{url}}">{{artifact.name}}</a>',scope:{mmsElementId:"@",mmsProjectId:"@",mmsRefId:"@",mmsCommitId:"@",mmsCfLabel:"@"},require:["?^^mmsView"],link:function(r,o,e,t){var s=!1;r.$watch("mmsElementId",function(e,t){if(e&&(e!==t||!s)&&r.mmsProjectId){s=!0,r.projectId=r.mmsProjectId,r.refId=r.mmsRefId?r.mmsRefId:"master",r.commitId=r.mmsCommitId?r.mmsCommitId:"latest";var n={artifactId:r.mmsElementId,projectId:r.projectId,refId:r.refId,commitId:r.commitId},i=d.getMmsServer(),a="?alf_ticket="+c.getTicket();o.addClass("isLoading"),l.getArtifact(n).then(function(e){r.artifact=e,r.url=i+"/alfresco"+e.artifactLocation+a,-1<e.contentType.indexOf("image")&&(r.image=!0)},function(e){console.log("Error getting artifact "+r.mmsElementId)}).finally(function(){o.removeClass("isLoading")})}})}}}function mmsTranscludeCom(l,c,d,m,t,e,p,u,f){var g=e.get("mms/templates/mmsTranscludeDoc.html");return{restrict:"E",scope:{mmsElementId:"@",mmsProjectId:"@",mmsRefId:"@",mmsCommitId:"@",nonEditable:"<",mmsCfLabel:"@",mmsGenerateForDiff:"<"},require:["?^mmsView","?^mmsViewPresentationElem"],controller:["$scope",function(e){e.bbApi={},e.buttons=[],e.buttonsInit=!1,e.bbApi.init=function(){e.buttonsInit||(e.buttonsInit=!0,e.bbApi.addButton(t.getButtonBarButton("presentation-element-preview",e)),e.bbApi.addButton(t.getButtonBarButton("presentation-element-save",e)),e.bbApi.addButton(t.getButtonBarButton("presentation-element-saveC",e)),e.bbApi.addButton(t.getButtonBarButton("presentation-element-cancel",e)),e.bbApi.addButton(t.getButtonBarButton("presentation-element-delete",e)),e.bbApi.setPermission("presentation-element-delete",e.isDirectChildOfPresentationElement))}}],link:function(i,a,e,t){var n=t[0],r=t[1];i.recompileScope=null,i.cfType="doc",a.click(function(e){i.startEdit&&!i.nonEditable&&i.startEdit(),n&&n.transcludeClicked(i.element),i.nonEditable&&n&&n.isEditable()&&u.warning("Comment is not editable."),e.stopPropagation()});var o=function(e){i.recompileScope&&i.recompileScope.$destroy(),i.isEditing=!1,a.empty();var t=(e?i.edit.documentation:i.element.documentation)||"(No comment)";t+=' - <span class="mms-commenter"> Comment by <b>'+i.element._creator+"</b></span>",a[0].innerHTML=e?'<div class="panel panel-info">'+t+"</div>":t,f&&!i.mmsGenerateForDiff&&f.Hub.Queue(["Typeset",f.Hub,a[0]]),i.recompileScope=i.$new(),p(a.contents())(i.recompileScope),n&&n.elementTranscluded(i.element,"Comment")},s=i.$watch("mmsElementId",function(e,t){if(e&&i.mmsProjectId)if(s(),d.hasCircularReference(i,i.mmsElementId,"doc"))a.html('<span class="mms-error">Circular Reference!</span>');else{i.projectId=i.mmsProjectId,i.refId=i.mmsRefId?i.mmsRefId:"master",i.commitId=i.mmsCommitId?i.mmsCommitId:"latest";var n={elementId:i.mmsElementId,projectId:i.projectId,refId:i.refId,commitId:i.commitId,includeRecentVersionElement:!0};c.getElement(n,1,!1).then(function(e){i.element=e,o(),i.panelType="Comment","latest"===i.commitId&&i.$on("element.updated",function(e,t,n){t.id!==i.element.id||t._projectId!==i.element._projectId||t._refId!==i.element._refId||n||o()})},function(e){a.html('<span mms-annotation mms-req-ob="::reqOb" mms-recent-element="::recentElement" mms-type="::type" mms-cf-label="::cfLabel"></span>'),p(a.contents())(Object.assign(i.$new(),{reqOb:n,recentElement:e.data.recentVersionOfElement,type:m.AnnotationType.mmsTranscludeCom,cfLabel:i.mmsCfLabel}))})}});n&&(i.isEditing=!1,i.elementSaving=!1,i.view=n.getView(),i.isDirectChildOfPresentationElement=l.isDirectChildOfPresentationElementFunc(a,n),i.save=function(){l.saveAction(i,a,!1)},i.saveC=function(){l.saveAction(i,a,!0)},i.cancel=function(){l.cancelAction(i,o,a)},i.startEdit=function(){l.startEdit(i,n,a,g,!1)},i.preview=function(){l.previewAction(i,o,a)}),r&&(i.delete=function(){l.deleteAction(i,i.bbApi,r.getParentSection())},i.instanceSpec=r.getInstanceSpec(),i.instanceVal=r.getInstanceVal(),i.presentationElem=r.getPresentationElement(),0<=[m.TYPE_TO_CLASSIFIER_ID.Image,m.TYPE_TO_CLASSIFIER_ID.Paragraph,m.TYPE_TO_CLASSIFIER_ID.List,m.TYPE_TO_CLASSIFIER_ID.Table].indexOf(i.instanceSpec.classifierIds[0])&&(i.isDirectChildOfPresentationElement=!1),i.isDirectChildOfPresentationElement&&(i.panelTitle=i.instanceSpec.name),i.panelType="Comment")}}}function mmsTranscludeDoc(c,i,d,m,t,e,p,n,u,a,f){var g=n.get("mms/templates/mmsTranscludeDoc.html"),v=/<\/span>\s*<mms-cf/g,h=/<\/mms-cf>\s*<span[^>]*>/g,b=/^\s*$/;return{restrict:"E",scope:{mmsElementId:"@",mmsProjectId:"@",mmsRefId:"@",mmsCommitId:"@",mmsWatchId:"@",nonEditable:"<",mmsCfLabel:"@",mmsGenerateForDiff:"<"},require:["?^^mmsView","?^^mmsViewPresentationElem"],controller:["$scope",function(e){e.bbApi={},e.buttons=[],e.buttonsInit=!1,e.bbApi.init=function(){e.buttonsInit||(e.buttonsInit=!0,e.bbApi.addButton(t.getButtonBarButton("presentation-element-preview",e)),e.bbApi.addButton(t.getButtonBarButton("presentation-element-save",e)),e.bbApi.addButton(t.getButtonBarButton("presentation-element-saveC",e)),e.bbApi.addButton(t.getButtonBarButton("presentation-element-cancel",e)),e.bbApi.addButton(t.getButtonBarButton("presentation-element-delete",e)),e.bbApi.setPermission("presentation-element-delete",e.isDirectChildOfPresentationElement))}}],link:function(r,o,e,t){var s=t[0],l=t[1];r.recompileScope=null,r.cfType="doc",r.editorApi={},o.click(function(e){r.startEdit&&!r.nonEditable&&r.startEdit(),s&&s.transcludeClicked(r.element),r.nonEditable&&s&&s.isEditable()&&u.warning("Cross Reference is not editable."),e.stopPropagation()});var a=function(e){r.recompileScope&&r.recompileScope.$destroy(),o.empty();var t=e?r.edit.documentation:r.element.documentation;if(t&&!b.test(t)||(t='<p class="no-print placeholder">(no '+r.panelType+")</p>"),t=(t=t.replace(v,"<mms-cf")).replace(h,"</mms-cf>"),e?o[0].innerHTML='<div class="panel panel-info">'+t+"</div>":(r.isEditing=!1,o[0].innerHTML=t),$(o[0]).find("img").each(function(e){c.fixImgSrc($(this))}),l){var n=l.getPresentationElement(),i=l.getInstanceSpec();if(i&&i._veNumber&&n&&("TableT"===n.type||"Figure"===n.type||"Equation"===n.type||"ImageT"===n.type)){var a="TableT"===n.type?"table":n.type.toLowerCase();"imaget"===a&&(a="figure"),d.addLiveNumbering(i,$("#"+i.id),a)}}f&&!r.mmsGenerateForDiff&&f.Hub.Queue(["Typeset",f.Hub,o[0]]),r.recompileScope=r.$new(),p(o.contents())(r.recompileScope),s&&s.elementTranscluded(r.element)},n=r.$watch("mmsElementId",function(e){if(e&&r.mmsProjectId)if(r.mmsWatchId||n(),d.hasCircularReference(r,r.mmsElementId,"doc"))o.html('<span class="mms-error">Circular Reference!</span>');else{r.projectId=r.mmsProjectId,r.refId=r.mmsRefId?r.mmsRefId:"master",r.commitId=r.mmsCommitId?r.mmsCommitId:"latest",o.html("(loading...)"),o.addClass("isLoading");var t={elementId:r.mmsElementId,projectId:r.projectId,refId:r.refId,commitId:r.commitId,includeRecentVersionElement:!0};i.getElement(t,1,!1).then(function(e){r.element=e,r.panelTitle||(r.panelTitle=r.element.name+" Documentation",r.panelType="Text"),a(),c.reopenUnsavedElts(r,"documentation"),"latest"===r.commitId&&r.$on("element.updated",function(e,t,n,i){t.id!==r.element.id||t._projectId!==r.element._projectId||t._refId!==r.element._refId||n||(i&&!0===r.isEditing?u.warning("This value has been changed: "+t.name+" modified by: "+t._modifier,{ttl:-1}):a())})},function(e){o.html('<span mms-annotation mms-req-ob="::reqOb" mms-recent-element="::recentElement" mms-type="::type" mms-cf-label="::cfLabel"></span>'),p(o.contents())(Object.assign(r.$new(),{reqOb:t,recentElement:e.data.recentVersionOfElement,type:m.AnnotationType.mmsTranscludeDoc,cfLabel:r.mmsCfLabel}))}).finally(function(){o.removeClass("isLoading")})}});s&&(r.isEditing=!1,r.elementSaving=!1,r.view=s.getView(),r.isDirectChildOfPresentationElement=c.isDirectChildOfPresentationElementFunc(o,s),r.save=function(){c.saveAction(r,o,!1)},r.saveC=function(){c.saveAction(r,o,!0)},r.cancel=function(){c.cancelAction(r,a,o)},r.startEdit=function(){c.startEdit(r,s,o,g,!1)},r.preview=function(){c.previewAction(r,a,o)}),l&&(r.delete=function(){c.deleteAction(r,r.bbApi,l.getParentSection())},r.instanceSpec=l.getInstanceSpec(),r.instanceVal=l.getInstanceVal(),r.presentationElem=l.getPresentationElement(),0<=[m.TYPE_TO_CLASSIFIER_ID.Image,m.TYPE_TO_CLASSIFIER_ID.Paragraph,m.TYPE_TO_CLASSIFIER_ID.List,m.TYPE_TO_CLASSIFIER_ID.Table].indexOf(r.instanceSpec.classifierIds[0])&&(r.isDirectChildOfPresentationElement=!1),r.isDirectChildOfPresentationElement&&(r.panelTitle=r.instanceSpec.name,r.panelType=r.presentationElem.type,"T"===r.panelType.charAt(r.panelType.length-1)&&(r.panelType=r.panelType.substring(0,r.panelType.length-1)),"Paragraph"===r.panelType&&(r.panelType="Text"),"Figure"!==r.panelType&&"ImageT"!==r.panelType||(r.panelType="Image")),r.presentationElem&&(r.editorType=r.presentationElem.type))}}}function mmsTranscludeImg(l,c,d,m,e){return{restrict:"E",template:'<img class="mms-svg" ng-src="{{svgImgUrl}}"></img><img class="mms-png" ng-src="{{pngImgUrl}}"></img>',scope:{mmsElementId:"@",mmsProjectId:"@",mmsRefId:"@",mmsCommitId:"@",mmsCfLabel:"@"},require:["?^^mmsView"],link:function(r,o,e,t){var n=t[0],s=!1;o.click(function(e){return n&&n.transcludeClicked(r.element),!1});var i=function(e,t){if(e&&(e!==t||!s)&&r.mmsProjectId){s=!0,r.projectId=r.mmsProjectId,r.refId=r.mmsRefId?r.mmsRefId:"master",r.commitId=r.mmsCommitId?r.mmsCommitId:"latest";var n={elementId:r.mmsElementId,projectId:r.projectId,refId:r.refId,commitId:r.commitId},i=m.getMmsServer(),a="?alf_ticket="+c.getTicket();o.addClass("isLoading"),d.getElement(n,1,!1).then(function(e){var t={projectId:(r.element=e)._projectId,refId:e._refId,artifactIds:e._artifactIds,commitId:"latest"===r.commitId?"latest":e._commitId};l.getArtifacts(t).then(function(e){r.artifacts=e;for(var t=0;t<e.length;t++){var n=e[t];"image/svg+xml"==n.contentType?r.svgImgUrl=i+"/alfresco"+n.artifactLocation+a:"image/png"==n.contentType&&(r.pngImgUrl=i+"/alfresco"+n.artifactLocation+a)}},function(e){console.log("Artifacts Error: "+e.message+": "+r.mmsElementId)})},function(e){console.log("Cf Artifacts Error: "+e.message+": "+r.mmsElementId)}).finally(function(){o.removeClass("isLoading")})}};r.$watch("mmsElementId",i),r.$watch("mmsRefId",i),r.$watch("mmsCommitId",i)}}}function mmsTranscludeName(l,e,c,d,t,m,p){var n=t.get("mms/templates/mmsTranscludeName.html");return{restrict:"E",scope:{mmsElementId:"@",mmsProjectId:"@",mmsRefId:"@",mmsCommitId:"@",mmsWatchId:"@",noClick:"@",nonEditable:"<",clickHandler:"&?",mmsCfLabel:"@"},require:["?^^mmsView"],link:function(a,i,e,t){var r=t[0];a.recompileScope=null,i.click(function(e){if(!a.noClick)if(a.clickHandler)a.clickHandler();else{if(a.startEdit&&!a.nonEditable&&a.startEdit(),!r)return!1;a.nonEditable&&r&&r.isEditable()&&d.warning("Cross Reference is not editable."),r.transcludeClicked(a.element),e.stopPropagation()}});var o=function(e){a.recompileScope&&a.recompileScope.$destroy(),i.empty(),e?i[0].innerHTML='<div class="panel panel-info"><span ng-if="edit.name">{{edit.name}}</span><span ng-if="!edit.name" class="no-print placeholder">(no name)</span></div>':(a.isEditing=!1,i[0].innerHTML='<span ng-if="element.name">{{element.name}}</span><span ng-if="!element.name" class="no-print placeholder">(no name)</span>'),a.recompileScope=a.$new(),c(i.contents())(a.recompileScope),r&&r.elementTranscluded(a.element)},s=a.$watch("mmsElementId",function(e,t){if(e&&a.mmsProjectId){a.mmsWatchId||s(),a.projectId=a.mmsProjectId,a.refId=a.mmsRefId?a.mmsRefId:"master",a.commitId=a.mmsCommitId?a.mmsCommitId:"latest",i.html("(loading...)"),i.addClass("isLoading");var n={elementId:a.mmsElementId,projectId:a.projectId,refId:a.refId,commitId:a.commitId,includeRecentVersionElement:!0};l.getElement(n,1,!1).then(function(e){a.element=e,o(),m.reopenUnsavedElts(a,"name"),r&&r.elementTranscluded(a.element),"latest"===a.commitId&&a.$on("element.updated",function(e,t,n,i){t.id!==a.element.id||t._projectId!==a.element._projectId||t._refId!==a.element._refId||n||(i&&!0===a.isEditing?d.warning("This value has been changed: "+t.name+" modified by: "+t._modifier,{ttl:-1}):o())})},function(e){i.html('<span mms-annotation mms-req-ob="::reqOb" mms-recent-element="::recentElement" mms-type="::type" mms-cf-label="::cfLabel"></span>'),c(i.contents())(Object.assign(a.$new(),{reqOb:n,recentElement:e.data.recentVersionOfElement,type:p.AnnotationType.mmsTranscludeName,cfLabel:a.mmsCfLabel}))}).finally(function(){i.removeClass("isLoading")})}});r&&(a.isEditing=!1,a.elementSaving=!1,a.view=r.getView(),a.save=function(e){e.stopPropagation(),m.saveAction(a,i,!1)},a.cancel=function(e){e.stopPropagation(),m.cancelAction(a,o,i)},a.startEdit=function(){m.startEdit(a,r,i,n,!1)})}}}function mmsTranscludeVal(r,o,n,d,e,t,i,a,m,s,p,u,f){var g=s.get("mms/templates/mmsTranscludeVal.html"),v=s.get("mms/templates/mmsTranscludeValFrame.html"),h=s.get("mms/templates/mmsTranscludeValEdit.html"),b=/^\s*$/;return{restrict:"E",scope:{mmsElementId:"@",mmsProjectId:"@",mmsRefId:"@",mmsCommitId:"@",nonEditable:"<",mmsCfLabel:"@",mmsGenerateForDiff:"<"},require:["?^^mmsView","?^^mmsViewPresentationElem"],controller:["$scope",function(e,t){e.bbApi={},e.buttons=[],e.buttonsInit=!1,e.bbApi.init=function(){e.buttonsInit||(e.buttonsInit=!0,e.bbApi.addButton(n.getButtonBarButton("presentation-element-preview",e)),e.bbApi.addButton(n.getButtonBarButton("presentation-element-save",e)),e.bbApi.addButton(n.getButtonBarButton("presentation-element-saveC",e)),e.bbApi.addButton(n.getButtonBarButton("presentation-element-cancel",e)),e.bbApi.addButton(n.getButtonBarButton("presentation-element-delete",e)),e.bbApi.setPermission("presentation-element-delete",e.isDirectChildOfPresentationElement))}}],link:function(s,l,e,t){var c=t[0],n=t[1];s.recompileScope=null,s.cfType="val",l.click(function(e){s.startEdit&&!s.nonEditable&&s.startEdit(),c&&c.transcludeClicked(s.element),s.nonEditable&&c&&c.isEditable()&&p.warning("Cross Reference is not editable."),e.stopPropagation()}),s.addHtml=function(e){e.value="<p>"+e.value+"</p>"},s.cleanupVal=function(e){e.value=parseInt(e.value)};var a=function(e){s.recompileScope&&s.recompileScope.$destroy();var t=[],n=!1,i=s.values;e?i=s.editValues:s.isEditing=!1;for(var a=0;a<i.length&&"LiteralString"===i[a].type;a++){n=!0;var r=i[a].value;-1===r.indexOf("<p>")&&(r=r.replace("<","&lt;")),t.push(r)}if(l.empty(),s.recompileScope=s.$new(),0===i.length||Object.keys(i[0]).length<2)l[0].innerHTML='<span class="no-print placeholder">(no value)</span>';else if(n){var o=t.join(" ");if(""===o||b.test(o))return void(l[0].innerHTML='<span class="no-print placeholder">(no value)</span>');l[0].innerHTML=e?'<div class="panel panel-info">'+o+"</div>":o,$(l[0]).find("img").each(function(e){d.fixImgSrc($(this))}),u&&!s.mmsGenerateForDiff&&u.Hub.Queue(["Typeset",u.Hub,l[0]]),m(l.contents())(s.recompileScope)}else l[0].innerHTML=e?h:g,m(l.contents())(s.recompileScope);c&&c.elementTranscluded(s.element)},i=s.$watch("mmsElementId",function(e,t){if(e&&s.mmsProjectId)if(i(),o.hasCircularReference(s,s.mmsElementId,"val"))l.html('<span class="mms-error">Circular Reference!</span>');else{l.html("(loading...)"),l.addClass("isLoading"),s.projectId=s.mmsProjectId,s.refId=s.mmsRefId?s.mmsRefId:"master",s.commitId=s.mmsCommitId?s.mmsCommitId:"latest";var n={elementId:s.mmsElementId,projectId:s.projectId,refId:s.refId,commitId:s.commitId,includeRecentVersionElement:!0};r.getElement(n,1).then(function(e){s.element=e,d.setupValCf(s),a(),d.reopenUnsavedElts(s,"value"),"latest"===s.commitId&&s.$on("element.updated",function(e,t,n,i){t.id!==s.element.id||t._projectId!==s.element._projectId||t._refId!==s.element._refId||n||(i&&!0===s.isEditing?p.warning("This value has been changed: "+t.name+" modified by: "+t._modifier,{ttl:-1}):(d.setupValCf(s),a()))})},function(e){l.html('<span mms-annotation mms-req-ob="::reqOb" mms-recent-element="::recentElement" mms-type="::type" mms-cf-label="::cfLabel"></span>'),m(l.contents())(Object.assign(s.$new(),{reqOb:n,recentElement:e.data.recentVersionOfElement,type:f.AnnotationType.mmsTranscludeVal,cfLabel:s.mmsCfLabel}))}).finally(function(){l.removeClass("isLoading")})}});s.hasHtml=function(e){return d.hasHtml(e)},d.setupValEditFunctions(s),c&&(s.isEditing=!1,s.elementSaving=!1,s.isDirectChildOfPresentationElement=d.isDirectChildOfPresentationElementFunc(l,c),s.view=c.getView(),s.save=function(){d.saveAction(s,l,!1)},s.saveC=function(){d.saveAction(s,l,!0)},s.cancel=function(){d.cancelAction(s,a,l)},s.startEdit=function(){var e=s.element.typeId;"Slot"===s.element.type&&(e=s.element.definingFeatureId),!e||s.isEnumeration&&s.options?d.startEdit(s,c,l,v,!1):d.getPropertySpec(s.element).then(function(e){s.isEnumeration=e.isEnumeration,s.isSlot=e.isSlot,s.options=e.options,d.startEdit(s,c,l,v,!1)},function(e){d.startEdit(s,c,l,v,!1),p.error("Failed to get property spec: "+e.message)})},s.preview=function(){d.previewAction(s,a,l)}),n&&(s.delete=function(){d.deleteAction(s,s.bbApi,n.getParentSection())},s.instanceSpec=n.getInstanceSpec(),s.instanceVal=n.getInstanceVal(),s.presentationElem=n.getPresentationElement())}}}function mmsTree(p,u,f,e,g,b){return{restrict:"E",template:e.get("mms/templates/mmsTree.html"),scope:{treeData:"<",initialSelection:"@",treeControl:"<",options:"<"},link:function(v,e,h){v.getHref=function(e){var t=e.branch.data;if("group"!==e.branch.type&&b.isDocument(t)&&!p.getState().fullDoc){var n=t._refId?t._refId:"master";return b.PROJECT_URL_PREFIX+t._projectId+"/"+n+"/documents/"+t.id+"/views/"+t.id}},v.options||(v.options={expandLevel:1,search:""}),h.iconExpand||(h.iconExpand="fa fa-caret-right fa-lg fa-fw"),h.iconCollapse||(h.iconCollapse="fa fa-caret-down fa-lg fa-fw"),h.iconDefault||(h.iconDefault="fa fa-file fa-fw"),v.options.expandLevel||0===v.options.expandLevel||(v.options.expandLevel=1);var n=v.options.expandLevel;if(angular.isArray(v.treeData)){var i=function(i,t){var a=function(e,t){if(i(e,t),e.children)for(var n=0;n<e.children.length;n++)a(e.children[n],t+1)};(t?v.treeData.filter(function(e){return e!==t}):v.treeData).forEach(function(e){a(e,1)})},t=function(e,t){var n=r(e);if(n)for(var i=0;i<n.children.length&&(n.children[i].uid!==e.uid||(n.children.splice(i,1),!t));i++);else for(var a=0;a<v.treeData.length;a++)if(v.treeData[a].uid===e.uid){v.treeData.splice(a,1);break}},r=function(t){var n=null;return t.parent_uid&&i(function(e){e.uid===t.parent_uid&&(n=e)}),n},a=function(e,t){var n=r(e);n&&(t(n),a(n,t))},o=function(e){a(e,function(e){!0===e.expandable&&v.expandCallback({branch:e}),e.expanded=!0})},s=null,l=function(t,e){if(!t)return s&&(s.selected=!1),void(s=null);t!==s?(s&&(s.selected=!1),t.selected=!0,o(s=t),e||(t.onSelect?u(function(){t.onSelect(t)}):v.options.onSelect&&u(function(){v.options.onSelect(t)})),t.data.id&&u(function(){var e=angular.element("#tree-branch-"+t.data.id);e.isOnScreen()||e.get(0).scrollIntoView()},500,!1)):o(t)},c=function(){v.initialSelection&&(i(function(e){e.data.id===v.initialSelection&&l(e,!0)}),d())},d=function(){i(function(e,t){e.uid||(e.uid=""+Math.random())}),i(function(e){if(angular.isArray(e.children))for(var t=0;t<e.children.length;t++)e.children[t].parent_uid=e.uid}),v.tree_rows=[];var g=function(e,t,n,i,a){var r="",o="",s=n.aggr;s=s?"-"+s.toLowerCase():"";var l=0;if(n.expanded||(n.expanded=!1),n.children&&0<n.children.length||!0===n.expandable){var c=!1;for("view"!==n.type&&"section"!==n.type&&(c=!0),l=0;l<n.children.length;l++)if(!n.children[l].hide){c=!0;break}r=c?n.expanded?h.iconCollapse:h.iconExpand:"fa fa-lg fa-fw"}else r="fa fa-lg fa-fw";o=n.loading?"fa fa-spinner fa-spin":v.options&&v.options.types&&v.options.types[n.type.toLowerCase()+s]?v.options.types[n.type.toLowerCase()+s]:h.iconDefault;var d=t.join(".");if("figure"===n.type||"table"===n.type||"equation"===n.type)if(a[n.type]++,0==v.options.numberingDepth)d=a[n.type];else if(t.length>=v.options.numberingDepth)d=t.slice(0,v.options.numberingDepth).join(".")+v.options.numberingSeparator+a[n.type];else{for(var m=t.slice();m.length<v.options.numberingDepth;)m.push(0);d=m.join(".")+v.options.numberingSeparator+a[n.type]}else"view"!==n.type&&"section"!==n.type&&(d="");if(n.data&&n.data.id&&v.options.sectionNumbering&&(n.data._veNumber=d),n.hide&&(i=!1),v.tree_rows.push({level:e,section:d,branch:n,label:n.label,expand_icon:r,visible:i,type_icon:o,children:n.children}),n.children){v.options.sort&&n.children.sort(v.options.sort);var p=v.options.startChapter;for(null!=p&&1==e||(p=1),l=0;l<n.children.length;l++){var u=i&&n.expanded;if("figure"===n.children[l].type||"table"===n.children[l].type||"equation"===n.children[l].type)g(e+1,t,n.children[l],u,a);else{if(v.options.sectionNumbering){var f=t.slice();f.push(p),f.length<=v.options.numberingDepth&&(a.table=0,a.figure=0,a.equaton=0),g(e+1,f,n.children[l],u,a)}else g(e+1,[],n.children[l],u,a);p++}}}};v.options.sort&&v.treeData.sort(v.options.sort);for(var e=0;e<v.treeData.length;e++)g(1,[],v.treeData[e],!0,{figure:0,table:0,equation:0})};if(v.expandCallback=function(e,t){!e.branch.expanded&&v.options.expandCallback&&v.options.expandCallback(e.branch.data.id,e.branch,!1),e.branch.expanded=!e.branch.expanded,t&&(t.stopPropagation(),d())},v.on_treeData_change=d,v.$watch("treeData",d,!1),v.$watch("initialSelection",c),v.tree_rows=[],v.treeFilter=g("uiTreeFilter"),h.initialSelection&&i(function(e){e.data.id===h.initialSelection&&u(function(){l(e)})}),i(function(e,t){e.level=t,e.expanded=e.level<=n}),v.user_clicks_branch=function(e){e!==s&&l(e)},v.user_dblclicks_branch=function(e){e.onDblclick?u(function(){e.onDblclick(e)}):v.options.onDblclick&&u(function(){v.options.onDblclick(e)})},angular.isObject(v.treeControl)){var m=v.treeControl;m.expand_all=function(){i(function(e,t){v.expandCallback({branch:e}),e.expanded=!0}),d()},m.collapse_all=function(e){i(function(e,t){e.expanded=!1},e),d()},m.get_first_branch=function(){if(0<v.treeData.length)return v.treeData[0]},m.select_first_branch=function(){var e=m.get_first_branch();l(e)},m.get_selected_branch=function(){return s},m.clear_selected_branch=function(){s=null},m.get_parent_branch=r,m.select_branch=l,m.get_children=function(e){return e.children},m.select_parent_branch=function(e){var t=m.get_parent_branch(e);t&&m.select_branch(t)},m.add_branch=function(e,t,n){e?(n?e.children.unshift(t):e.children.push(t),e.expanded=!0):n?v.treeData.unshift(t):v.treeData.push(t),d()},m.remove_branch=function(e){t(e,!1),d()},m.remove_single_branch=function(e){t(e,!0),d()},m.add_root_branch=function(e){m.add_branch(null,e)},m.expand_branch=function(e){e||(e=m.get_selected_branch()),e&&(v.expandCallback({branch:e}),e.expanded=!0),d()},m.expandPathToSelectedBranch=function(){s&&(o(s),d())},m.collapse_branch=function(e){e||(e=s),e&&(e.expanded=!1),d()},m.get_siblings=function(e){var t=m.get_parent_branch(e);return t?t.children:v.treeData},m.get_next_sibling=function(e){var t=m.get_siblings(e);if(angular.isArray(t)){var n=t.indexOf(e);if(n<t.length-1)return t[n+1]}},m.get_prev_sibling=function(e){var t=m.get_siblings(e);if(angular.isArray(t)){var n=t.indexOf(e);if(0<n)return t[n-1]}},m.select_next_sibling=function(e){var t=m.get_next_silbing(e);t&&m.select_branch(t)},m.select_prev_sibling=function(e){var t=m.get_prev_sibling(e);t&&m.select_branch(t)},m.get_first_child=function(e){if(e||(e=s),e&&e.children&&0<e.children.length)return e.children[0]},m.get_closest_ancestor_next_sibling=function(e){var t=m.get_next_sibling(e);return t||(t=m.get_parent_branch(e),m.get_closest_ancestor_next_sibling(t))},m.get_next_branch=function(e){if(e||(e=s),e){var t=m.get_first_child(e);return t||(t=m.get_closest_ancestor_next_sibling(e))}},m.select_next_branch=function(e){var t=m.get_next_branch(e);t&&m.select_branch(t)},m.last_descendant=function(e){if(e){if(0===e.children.length)return e;var t=e.children[e.children.length-1];return m.last_descendant(t)}},m.get_prev_branch=function(e){var t=m.get_prev_sibling(e);return t?m.last_descendant(t):m.get_parent_branch(e)},m.select_prev_branch=function(e){var t=m.get_prev_branch(e);t&&m.select_branch(t)},m.refresh=function(){d()},m.initialSelect=function(){c()},m.sort_branch=function(e,t){e.children.sort(t)},m.get_branch=function(t){var n=null;return i(function(e){e.data.id===t.id&&(n=e)}),n},m.get_rows=function(){return v.tree_rows},m.user_clicks_branch=function(e){return v.user_clicks_branch(e)}}}else f.warn("treeData is not an array!")}}}function mmsTsDiagram(e,t,c,d,n,m,p,u){var f=!1,i=t.get("mms/templates/mmsTsDiagram.html"),g={},v={},h={},a={},b={IBD:"Internal Block Diagram",BDD:"Block Definition Diagram",STM:"State Machine",ACT:"Activity Diagram",SD:"Sequence Diagram",PKG:"Package Diagram",PAR:"Parametric Diagram",REQ:"Requirement Diagram",UC:"Use Case Diagram"},w={IBD:"IBD Controls",BDD:"BDD Controls",STM:"STM Controls",ACT:"ACT Controls",SD:"Controls",PKG:"PKG Controls",PAR:"PAR Controls",REQ:"REQ Controls",UC:"UC Controls"},y={IBD:"IBD Elements",BDD:"BDD Elements",STM:"STM Elements",ACT:"ACT Elements",SD:"Elements",PKG:"PKG Elements",PAR:"PAR Elements",REQ:"REQ Elements",UC:"UC Elements"},I={IBD:"IBD Relationships",BDD:"BDD Relationships",STM:"STM Relationships",ACT:"ACT Relationships",SD:"Associations",PKG:"PKG Relationships",PAR:"PAR Relationships",REQ:"REQ Relationships",UC:"UC Relationships"};c.onPerspectivesCommandSuccess=function(e){console.log("Perspectives command: "+e.command+" completed successfully"),c.hidePerspectivesProgressIndicator()},c.onPerspectivesCommandFailure=function(e,t,n){console.log("Perspectives command "+e.commmand+" failed. Reason is: "+t),c.hidePerspectivesProgressIndicator(),console.log(n)},c.onPerspectivesProjectLoad=function(e){console.log("All project UI elements should now be on the DOM for "+e)},c.onPerspectivesProjectReady=function(e){console.log("All project RPC calls are complete and you can now access all project resources via the DOM. "+e),a[e]||(c.showPerspectivesProgressIndicator(),c.invokePerspectivesCommand(g[e]),a[e]=!0)},c.onPerspectivesViewLoaded=function(e,t,n,i,a){console.log("The Perspectives view "+i+" is now on the DOM.")},c.onPerspectivesViewUpdated=function(e,t,n,i,a,r){console.log("The Perspectives view"+i+" was udpdated with data "+r)},c.onPerspectivesViewCanvasRendered=function(e,t,n,i,a){console.log("The Perspectives canvas for view"+i+" was rendered")},c.onPerspectivesMouseClickOnObject=function(e){e&&console.log("JavaScript Callback = Mouse clicked on object with ID = "+e.objectID)},c.onPerspectivesMouseDoubleClickOnObject=function(e){e&&console.log("JavaScript Callback = Mouse double clicked on object with ID = "+e.objectID)},c.PerspectivesErrorDialogHandler=function(e,t){console.log(e),console.log(t)};return{restrict:"E",template:i,scope:{mmsProjectId:"@",mmsRefId:"@",mmsTspSpec:"<",mmsPeId:"@"},link:function(e,t,n){c.invokePerspectivesCommand||f||($("body").append('<script type="text/javascript" language="javascript" src="/mms-ts/tsperspectives/tsperspectives.nocache.js"><\/script>\n<script type="text/javascript" language="javascript" src="/mms-ts/tsperspectives/dojo/dojo/dojo.js"><\/script>\n<script type="text/javascript" language="javascript" src="/mms-ts/tsperspectives/TSHovering.js"><\/script>\n<script type="text/javascript" language="javascript" src="/mms-ts/tsperspectives/TSButtonTooltip.js"><\/script>'),f=!0);var i=m.createUniqueId();h[e.mmsPeId]?i=h[e.mmsPeId]:h[e.mmsPeId]=i,v[i]=e.mmsPeId,e.containerId="tabContainer-"+i,e.viewId="view-"+i,e.tableId="table-"+i,e.edgeTableId="edgeTable-"+i,e.inspectorId="inspector-"+i,e.controlsId="controls-"+i,e.initElements=[];var a={viewName:b[e.mmsTspSpec.diagramType],viewType:"tsDrawingView",tableName:y[e.mmsTspSpec.diagramType],edgeTableName:I[e.mmsTspSpec.diagramType],inspectorName:"Details",controlsName:w[e.mmsTspSpec.diagramType]};e.mmsTspSpec&&e.mmsTspSpec.elements&&(e.initElements=e.mmsTspSpec.elements),e.mmsTspSpec&&e.mmsTspSpec.context&&(e.context=e.mmsTspSpec.context);var r,o,s,l=(r=e,{command:"WebProject",onload:"onPerspectivesProjectLoad",onready:"onPerspectivesProjectReady",onfailure:"onPerspectivesCommandFailure",onsuccess:"onPerspectivesCommandSuccess",data:[{command:"LoadProject",data:{project:s=i,filename:"project/MMS.tsp"}},{command:"NewDefaultModel",data:{project:s,module:"SysML",modelID:"model-"+s}},{command:"NewIntegrator",data:{project:s,module:"SysML",modelID:"model-"+s,integratorName:"MMS ADD",integratorID:"int-add-"+s}},{command:"NewIntegrator",data:{project:s,module:"SysML",modelID:"model-"+s,integratorName:"Filter Control Data",integratorID:"int-fcd-"+s,integratorFileLocation:"data/SysMLFilterDefaults.xlsx"}},{command:"NewView",data:{project:s,module:"SysML",modelID:"model-"+s,viewID:"view-"+s,viewName:(o=a).viewName,viewClass:o.viewType,onload:"onPerspectivesViewLoaded",onupdate:"onPerspectivesViewUpdated",oncanvasrendered:"onPerspectivesViewCanvasRendered"}},{command:"NewView",data:{project:s,module:"SysML",modelID:"model-"+s,viewID:"table-"+s,viewName:o.tableName,viewClass:"tsTableView",onload:"onPerspectivesViewLoaded",onupdate:"onPerspectivesViewUpdated",oncanvasrendered:"onPerspectivesViewCanvasRendered"}},{command:"NewView",data:{project:s,module:"SysML",modelID:"model-"+s,viewID:"edgeTable-"+s,viewName:o.edgeTableName,viewClass:"tsTableView",onload:"onPerspectivesViewLoaded",onupdate:"onPerspectivesViewUpdated",oncanvasrendered:"onPerspectivesViewCanvasRendered"}},{command:"NewView",data:{project:s,module:"SysML",modelID:"model-"+s,viewID:""+r.inspectorId,viewName:o.inspectorName,viewClass:"tsInspectorView",onload:"onPerspectivesViewLoaded",onupdate:"onPerspectivesViewUpdated",oncanvasrendered:"onPerspectivesViewCanvasRendered"}},{command:"NewView",data:{project:s,module:"SysML",modelID:"model-"+s,viewID:""+r.controlsId,viewName:o.controlsName,viewClass:"tsTreeView",onload:"onPerspectivesViewLoaded",onupdate:"onPerspectivesViewUpdated",oncanvasrendered:"onPerspectivesViewCanvasRendered"}},{command:"NewTabPanel",data:{project:s,module:"SysML",modelID:"model-"+s,id:"tabContainer-"+s,widgetIDs:[r.viewId,r.tableId,r.edgeTableId,r.inspectorId,r.controlsId]}}]});g[i]=function(e,t,n){var i,a={command:"Group",onsuccess:"onPerspectivesCommandSuccess",data:[{command:"Custom",data:{serverClassName:"gov.nasa.jpl.mbee.ems.action.SetMmsRestBaseUrlCommandImpl",args:["int-add-"+n,u.getMmsServer()+u.getRoot()],modelID:"model-"+n,module:"SysML",project:n,viewID:"view-"+n,viewName:t}},{command:"SetModelAttribute",data:{attributeName:"Ticket",attributeValue:p.getTicket(),modelID:"model-"+n,module:"SysML",project:n,viewID:"view-"+n,viewName:t},onfailure:"onPerspectivesCommandFailure"},{command:"SetModelAttribute",data:{attributeName:"MMSRefId",attributeValue:e.mmsRefId,modelID:"model-"+n,module:"SysML",project:n,viewID:"view-"+n,viewName:t},onfailure:"onPerspectivesCommandFailure"},{command:"SetModelAttribute",data:{attributeName:"MMSProjectId",attributeValue:e.mmsProjectId,modelID:"model-"+n,module:"SysML",project:n,viewID:"view-"+n,viewName:t},onfailure:"onPerspectivesCommandFailure"}]};if(e.context||0<e.initElements.length){var r=[];0<e.initElements.length&&(a.data.push({command:"SetModelAttribute",data:{attributeName:"AddElements",attributeValue:(i=e.initElements,'[{"id": "'+i.join('"}, {"id": "')+'"}]'),modelID:"model-"+n,module:"SysML",project:n,viewID:"view-"+n,viewName:t},onfailure:"onPerspectivesCommandFailure"}),r.push("int-add-"+n)),r.push("int-fcd-"+n),a.data.push({command:"Update",onsuccess:"onPerspectivesCommandSuccess",onfailure:"onPerspectivesCommandFailure",data:{project:n,module:"SysML",integratorIDs:r}}),e.context&&a.data.push({command:"Custom",data:{project:n,module:"SysML",modelID:"model-"+n,serverClassName:"gov.nasa.jpl.mbee.ems.command.NewContextCommand",viewID:"view-"+n,viewName:t,args:[""+e.context]},onfailure:"onPerspectivesCommandFailure"})}return a}(e,a.viewName,i),function e(){c.invokePerspectivesCommand?c.invokePerspectivesCommand(l):d(e,1e3,!1)}()}}}function mmsValueLink(p,e,t){return{restrict:"E",scope:{mmsElementId:"@",mmsProjectId:"@",mmsRefId:"@",mmsCommitId:"@",mmsErrorText:"@",mmsLinkText:"@"},require:["?^^mmsCf","?^^mmsView"],template:'<a ng-href="{{url}}">{{mmsLinkText}}</a>',link:function(n,i,e,t){var a=t[0],r=t[1],o=n.mmsProjectId,s=n.mmsRefId,l=n.mmsCommitId;if(a){var c=a.getElementOrigin();o||(o=c.projectId),s||(s=c.refId),l||(l=c.commitId)}if(r){var d=r.getElementOrigin();o||(o=d.projectId),s||(s=d.refId),l||(l=d.commitId)}if(o){n.projectId=o,n.refId=s||"master",n.commitId=l||"latest";var m={elementId:n.mmsElementId,projectId:n.projectId,refId:n.refId,commitId:n.commitId};p.getElement(m).then(function(e){if("Property"===e.type){var t=e.defaultValue;t&&"LiteralString"===t.type&&(n.url=t.value)}else"Slot"===e.type?angular.isArray(e.value)&&0<e.value.length&&"LiteralString"===e.value[0].type&&(n.url=e.value[0].value):n.mmsErrorText?i.html('<span class="mms-error">'+n.mmsErrorText+"</span>"):n.mmsErrorText?i.html("<span>"+n.mmsErrorText+"</span>"):i.html('<span class="mms-error">Element does not provide link value.</span>')},function(e){i.html('<span class="mms-error">Element was not found.</span>')})}}}}function mmsView(o,s,l,e,c){return{restrict:"E",template:e.get("mms/templates/mmsView.html"),scope:{mmsElementId:"@",mmsProjectId:"@",mmsRefId:"@",mmsCommitId:"@",mmsLink:"<",mmsViewApi:"<"},controller:["$scope",function(n){n.presentationElemCleanUpFncs=[],this.isTranscludedElement=function(e){return"MMS-TRANSCLUDE-COM"===e||"MMS-TRANSCLUDE-DOC"===e||"MMS-TRANSCLUDE-IMG"===e||"MMS-TRANSCLUDE-NAME"===e||"MMS-TRANSCLUDE-VAL"===e},this.isViewElement=function(e){return"MMS-VIEW-IMG"===e||"MMS-VIEW-LIST"===e||"MMS-VIEW-PARA"===e||"MMS-VIEW-TABLE"===e||"MMS-VIEW-TABLE-T"===e||"MMS-VIEW-LIST-T"===e||"MMS-VIEW-EQUATION"===e},this.isPresentationElement=function(e){return"MMS-VIEW-PRESENTATION-ELEM"===e},this.isEditable=function(){return n.showEdits},this.transcludeClicked=function(e){n.mmsViewApi&&n.mmsViewApi.elementClicked&&e&&n.mmsViewApi.elementClicked(e)},this.elementTranscluded=function(e,t){e&&(e._modified>n.modified&&"Comment"!==t&&(n.modified=e._modified,e._modifier&&(n.modifier=e._modifier)),n.mmsViewApi&&n.mmsViewApi.elementTranscluded&&n.mmsViewApi.elementTranscluded(e,t))},this.getElementOrigin=function(){return{projectId:n.mmsProjectId,refId:n.mmsRefId,commitId:n.mmsCommitId}},this.getView=function(){return n.view},n.hoverIn=function(){n.isHover=!0},n.hoverOut=function(){n.isHover=!1}}],link:function(n,i,e){var a={elementId:n.mmsElementId,projectId:n.mmsProjectId,refId:n.mmsRefId,commitId:n.mmsCommitId},r=!1;n.setPeLineVisibility=function(t){window.setTimeout(function(){var e=$(t.currentTarget).closest(".add-pe-button-container");"none"==e.find(".dropdown-menu").css("display")?e.find("hr").css("visibility","hidden"):e.find("hr").css("visibility","visible")})},n.isSection=!1;if(n.$watch("mmsElementId",function(e,t){!e||e===t&&r||(r=!0,i.addClass("isLoading"),l.getElement(a,1).then(function(e){"InstanceSpecification"===e.type&&(n.isSection=!0);var t=[];if(e._contents&&e._contents.operand&&(t=e._contents.operand),e.specification&&e.specification.operand&&(t=e.specification.operand),0<o.checkForDuplicateInstances(t).length&&c.warning("There are duplicates in this view, dupilcates ignored!"),e._veNumber&&(n.level=e._veNumber.split(".").length),n.mmsCommitId&&"latest"!==n.mmsCommitId)return n.view=e,n.modified=e._modified,void(n.modifier=e._modifier);s.getViewElements(a,1).finally(function(){n.view=e,n.modified=e._modified,n.modifier=e._modifier,i.removeClass("isLoading")})},function(e){c.error("Getting View Error: "+e.message+": "+n.mmsElementId)}).finally(function(){n.view&&i.removeClass("isLoading")}))}),n.showElements=!1,n.showComments=!1,n.showEdits=!1,n.addEltAction=function(e,t){n.showEdits&&(n.addPeIndex=e,o.addPresentationElement(n,t,n.view))},n.toggleShowElements=function(){n.showElements=!n.showElements,i.toggleClass("outline")},n.toggleShowComments=function(){n.showComments=!n.showComments,i.toggleClass("reviewing")},n.toggleShowEdits=function(){n.showEdits=!n.showEdits,i.toggleClass("editing");for(var e=0;e<n.presentationElemCleanUpFncs.length;e++)n.presentationElemCleanUpFncs[e]()},angular.isObject(n.mmsViewApi)){var t=n.mmsViewApi;t.toggleShowElements=n.toggleShowElements,t.toggleShowEdits=n.toggleShowEdits,t.toggleShowComments=n.toggleShowComments,t.setShowElements=function(e){(n.showElements=e)?i.addClass("outline"):i.removeClass("outline")},t.setShowComments=function(e){(n.showComments=e)?i.addClass("reviewing"):i.removeClass("reviewing")},t.changeView=function(e){n.changeView(e)},t.init&&t.init(t)}}}}function mmsViewEquation(){return{restrict:"E",template:'<mms-cf mms-cf-type="doc" mms-element-id="{{para.source}}"></mms-cf>',scope:{para:"<mmsPara"}}}function mmsViewFigure(){return{restrict:"E",template:'<mms-cf mms-cf-type="doc" mms-element-id="{{para.source}}"></mms-cf>',scope:{para:"<mmsPara"}}}function mmsViewImg(){return{restrict:"E",template:'<figure><mms-cf mms-cf-type="img" mms-element-id="{{image.id}}"></mms-cf><figcaption><span ng-if="!image.excludeFromList">Figure {{mmsPe._veNumber}}. </span>{{image.title || mmsPe.name}}</figcaption></figure>',scope:{image:"<mmsImage",mmsPe:"<"},link:function(e,t,n){}}}function mmsViewLink(g,v,h,e,b,w){return{restrict:"E",scope:{mmsElementId:"@",mmsProjectId:"@",mmsRefId:"@",mmsCommitId:"@",mmsDocId:"@",mmsPeId:"@",linkText:"@?",linkClass:"@?",linkIconClass:"@?",linkTarget:"@?",mmsExternalLink:"<?",suppressNumbering:"<"},require:["?^^mmsCf","?^^mmsView"],template:'<span ng-if="!loading"><a target="{{target}}" ng-class="linkClass" ng-href="{{href}}"><i ng-class="linkIconClass" aria-hidden="true"></i><span ng-if="linkText">{{linkText}}</span><span ng-if="!linkText && change">{{type}}{{element._veNumber}}{{suffix}}</span><span ng-if="!linkText && !change">{{name || "Unnamed View"}}</span></a><a class="external-link no-print" target="_blank" ng-href="{{href}}" ng-if="mmsExternalLink"><i class="fa fa-external-link ve-secondary-text pull-right" aria-hidden="true" title="Open document in new tab"></i></a></span>',link:function(d,m,e,t){var p=t[0],u=t[1],f=!1;d.loading=!0,d.target=d.linkTarget?d.linkTarget:"_self",d.$watch("mmsElementId",function(e,t){if(e&&(e!==t||!f)){f=!0;var n=d.mmsProjectId,i=d.mmsRefId,a=d.mmsCommitId,r=d.mmsDocId;if(p){var o=p.getElementOrigin();n||(n=o.projectId),i||(i=o.refId),a||(a=o.commitId)}if(u){var s=u.getElementOrigin();n||(n=s.projectId),i||(i=s.refId),a||(a=s.commitId)}if(n){d.projectId=n,d.refId=i||"master",d.commitId=a||"latest";var l=d.mmsElementId;l?l=l.replace(/[^\w\-]/gi,""):d.mmsPeId&&!d.mmsDocId&&(l=w.getState().currentDoc);var c={elementId:l,projectId:n,refId:i,commitId:a,includeRecentVersionElement:!0};g.getElement(c,1).then(function(e){if(d.element=e,d.name=e.name,d.type="Section ",d.suffix="",d.hash="#"+e.id,d.mmsPeId&&""!==d.mmsPeId){var t={elementId:d.mmsPeId,projectId:n,refId:i,commitId:a};g.getElement(t).then(function(e){d.hash="#"+e.id,d.element=e,d.name=e.name,b.isTable(e)?d.type="Table ":b.isFigure(e)?d.type="Fig. ":b.isEquation(e)&&(d.type="Eq. (",d.suffix=")"),w.getState().fullDoc?d.href=v.PROJECT_URL_PREFIX+d.projectId+"/"+d.refId+"/documents/"+d.docid+"/full"+d.hash:d.href=v.PROJECT_URL_PREFIX+d.projectId+"/"+d.refId+"/documents/"+d.docid+"/views/"+d.vid+d.hash})}v.isDocument(e)?(r=e.id,d.docid=r,d.vid=e.id):v.isView(e)||"InstanceSpecification"===e.type?(r&&""!==r||(r=e.id),d.docid=r,d.vid=e.id):m.html('<span class="mms-error">view link doesn\'t refer to a view</span>'),d.loading=!1,w.getState().fullDoc?d.href=v.PROJECT_URL_PREFIX+d.projectId+"/"+d.refId+"/documents/"+d.docid+"/full"+d.hash:d.href=v.PROJECT_URL_PREFIX+d.projectId+"/"+d.refId+"/documents/"+d.docid+"/views/"+d.vid,d.change=w.getState().inDoc&&w.getState().currentDoc==d.docid&&!d.suppressNumbering},function(e){m.html('<span mms-annotation mms-req-ob="::reqOb" mms-recent-element="::recentElement" mms-type="::type"></span>'),h(m.contents())(Object.assign(d.$new(),{reqOb:c,recentElement:e.data.recentVersionOfElement,type:b.AnnotationType.mmsViewLink})),d.loading=!1})}}})}}}function mmsViewList(a,r,o){return{restrict:"E",scope:{list:"<mmsList"},link:function(e,t,n){var i=r.makeHtmlList(e.list);t[0].innerHTML=i,$(t[0]).find("img").each(function(e){o.fixImgSrc($(this))}),a(t.contents())(e)}}}function mmsViewListT(){return{restrict:"E",template:'<mms-cf mms-cf-type="doc" mms-element-id="{{para.source}}"></mms-cf>',scope:{para:"<mmsPara"}}}function mmsViewPara(a,r,o){return{restrict:"E",scope:{para:"<mmsPara"},link:function(e,t,n){var i=r.makeHtmlPara(e.para);t[0].innerHTML=i,$(t[0]).find("img").each(function(e){o.fixImgSrc($(this))}),a(t.contents())(e)}}}function mmsViewPlot(r,e){return{restrict:"E",require:"?^mmsView",scope:{plot:"<mmsPlot"},link:function(e,t,n,i,a){if("Plot"===e.plot.type){if(void 0!==e.plot.config&&0!==e.plot.config.trim().length)try{e.plot.config=JSON.parse(e.plot.config.replace(/'/g,'"')),void 0!==e.plot.config.ptype&&(e.plot.ptype=e.plot.config.ptype)}catch(e){console.log("error ignored")}t[0].innerHTML="<figure><mms-"+e.plot.ptype+'-plot plot="plot"></mms-'+e.plot.ptype+"-plot><figcaption>{{plot.title}}</figcaption></figure>",r(t.contents())(e)}}}}function mmsViewPresentationElem(c,d,e,m,p,u,f){return{restrict:"E",template:e.get("mms/templates/mmsViewPresentationElem.html"),require:"?^^mmsView",scope:{mmsInstanceVal:"<",mmsParentSection:"<"},controller:["$scope",function(e){e.presentationElemLoading=!0,this.getInstanceSpec=function(){return e.instanceSpec},this.getInstanceVal=function(){return e.mmsInstanceVal},this.getPresentationElement=function(){return e.presentationElem},this.getParentSection=function(){return e.mmsParentSection}}],link:function(n,i,e,a){if(n.mmsInstanceVal){if(!n.mmsInstanceVal.instanceId)return void i.html('<span class="mms-error">Reference is null</span>');var t=null,r=null,o=null;if(a){var s=a.getElementOrigin();t=s.projectId,r=s.refId,o=s.commitId}i.addClass("isLoading");var l={elementId:n.mmsInstanceVal.instanceId,projectId:t,refId:r,commitId:o,includeRecentVersionElement:!0};d.getElement(l,1).then(function(t){n.presentationElem=c.getPresentationElementSpec(t),n.instanceSpec=t,n.presentationElemLoading=!1,p.hash()===t.id&&m(function(){u()},1e3,!1),a&&a.elementTranscluded(t),i.click(function(e){a&&a.transcludeClicked(t),e.stopPropagation()})},function(e){500===e.status?i.html('<span class="mms-error">View element reference error: '+n.mmsInstanceVal.instanceId+" invalid specification</span>"):(i.html('<span mms-annotation mms-req-ob="::reqOb" mms-recent-element="::recentElement" mms-type="::type"></span>'),f(i.contents())(Object.assign(n.$new(),{reqOb:l,recentElement:e.data.recentVersionOfElement,type:c.AnnotationType.mmsPresentationElement})))}).finally(function(){i.removeClass("isLoading")})}}}}function mmsViewReorder(c,s,e,d,m,p){return{restrict:"E",template:e.get("mms/templates/mmsViewReorder.html"),scope:{mmsElementId:"@",mmsProjectId:"@",mmsRefId:"@",mmsCommitId:"@",mmsViewReorderApi:"<"},controller:["$scope","ViewService",function(e,i){this.getEditing=function(){return e.editing},e.treeOptions={accept:function(e,t,n){return!(e.element.isOpaque||!t.$element.hasClass("root")&&!i.isSection(t.element.presentationElement))}}}],link:function(l,e,t){var r=!1,o=null;if(l.$watch("mmsElementId",function(n,e){if(n&&(n!=e||!r)){r=!0,o=n;var i=l.mmsCommitId;i=i||"latest";var a={elementId:l.mmsElementId,projectId:l.mmsProjectId,refId:l.mmsRefId,commitId:i};c.getElement(a).then(function(e){if(n===o){l.view=e,l.editable=l.view._editable&&"latest"===i;var t=e._contents||e.specification;t?s.getElementReferenceTree(a,t).then(function(e){n===o&&(l.elementReferenceTree=e,l.originalElementReferenceTree=p.cloneDeep(e,function(e,t,n){if("instanceId"===t||"instanceSpecification"===t||"presentationElement"===t||"instanceVal"===t)return e}))},function(e){n===o&&(l.elementReferenceTree=[],l.originalElementReferenceTree=[])}):(l.elementReferenceTree=[],l.originalElementReferenceTree=[])}},function(e){n===o&&(d.error("View Error: "+e.message),l.elementReferenceTree=[],l.originalElementReferenceTree=[])})}}),l.editing=!1,l.elementReferenceTree=[],l.originalElementReferenceTree=[],l.toggleEditing=function(){return!!l.editable&&(l.editing=!l.editing,!0)},l.save=function(){var r=[],o=function(e){for(var t={id:e.instanceId,_projectId:e.instanceSpecification._projectId,_refId:e.instanceSpecification._refId,type:e.instanceSpecification.type,specification:{type:"Expression"}},n=t.specification.operand=[],i=e.instanceSpecification.specification.operand,a=0;a<e.sectionElements.length;a++)n.push(e.sectionElements[a].instanceVal),0<e.sectionElements[a].sectionElements.length&&o(e.sectionElements[a]);angular.equals(n,i)||r.push(t)},e=m.defer();if(!l.editable||!l.editing)return e.reject({type:"error",message:"View isn't editable and can't be saved."}),e.promise;if(0===l.elementReferenceTree.length)return e.reject({type:"error",message:"View contents were not initialized properly or is empty."}),e.promise;var t={id:l.view.id,_projectId:l.view._projectId,_refId:l.view._refId,type:l.view.type};l.view._contents&&(t._contents=JSON.parse(JSON.stringify(l.view._contents))),l.view.specification&&(t.specification=JSON.parse(JSON.stringify(l.view.specification)));var n=t._contents||t.specification,i=l.view._contents||l.view.specification;if(n){n.operand=[];for(var a=0;a<l.elementReferenceTree.length;a++)n.operand.push(l.elementReferenceTree[a].instanceVal)}t.view2view&&delete t.view2view,n&&!angular.equals(n.operand,i.operand)&&r.push(t);for(var s=0;s<l.elementReferenceTree.length;s++)0<l.elementReferenceTree[s].sectionElements.length&&o(l.elementReferenceTree[s]);return c.updateElements(r,!1)},l.revert=function(){l.elementReferenceTree=p.cloneDeep(l.originalElementReferenceTree,function(e,t,n){if("instanceId"===t||"instanceSpecification"===t||"presentationElement"===t||"instanceVal"===t)return e})},l.refresh=function(){var e=l.view._contents||l.view.specification,t={elementId:l.mmsElementId,projectId:l.mmsProjectId,refId:l.mmsRefId,commitId:l.mmsCommitId};e?s.getElementReferenceTree(t,e).then(function(e){l.elementReferenceTree=e,l.originalElementReferenceTree=p.cloneDeep(e,function(e,t,n){if("instanceId"===t||"instanceSpecification"===t||"presentationElement"===t||"instanceVal"===t)return e})},function(e){l.elementReferenceTree=[],l.originalElementReferenceTree=[]}):(l.elementReferenceTree=[],l.originalElementReferenceTree=[])},angular.isObject(l.mmsViewReorderApi)){var n=l.mmsViewReorderApi;n.toggleEditing=l.toggleEditing,n.save=l.save,n.refresh=l.refresh,n.setEditing=function(e){if(!l.editable&&e)return!1;l.editing=e},n.revertEdits=l.revert}}}}function mmsViewSection(p,e,t,u,n,f,g){var v=e.get("mms/templates/mmsViewSection.html");return{restrict:"E",scope:{section:"<mmsSection"},require:["?^mmsView","?^mmsViewPresentationElem"],controller:["$scope","$rootScope",function(e,t){e.sectionInstanceVals=[],e.bbApi={},e.buttons=[],e.buttonsInit=!1,e.bbApi.init=function(){e.buttonsInit||(e.buttonsInit=!0,e.bbApi.addButton(n.getButtonBarButton("presentation-element-preview",e)),e.bbApi.addButton(n.getButtonBarButton("presentation-element-save",e)),e.bbApi.addButton(n.getButtonBarButton("presentation-element-saveC",e)),e.bbApi.addButton(n.getButtonBarButton("presentation-element-cancel",e)),e.bbApi.addButton(n.getButtonBarButton("presentation-element-delete",e)),e.bbApi.setPermission("presentation-element-delete",e.isDirectChildOfPresentationElement))}}],link:function(i,e,t,n){i.element=i.section;var a=n[0],r=n[1];i.setPeLineVisibility=function(t){window.setTimeout(function(){var e=$(t.currentTarget).closest(".add-pe-button-container");"none"==e.find(".dropdown-menu").css("display")?e.find("hr").css("visibility","hidden"):e.find("hr").css("visibility","visible")})},e.click(function(e){i.startEdit&&i.startEdit(),a&&r&&a.transcludeClicked(i.section),e.stopPropagation()});var o=function(){i.isEditing=!1,i.inPreviewMode=!1},s=function(){};i.section.specification&&i.section.specification.operand&&0<f.checkForDuplicateInstances(i.section.specification.operand).length&&g.warning("There are duplicates in this section, dupilcates ignored!");i.section._veNumber&&(i.level=i.section._veNumber.split(".").length),e.append(v),p(e.contents())(i);var l=i.mmsProjectId,c=i.mmsRefId,d=i.mmsCommitId;if(a){var m=a.getElementOrigin();l||(l=m.projectId),c||(c=m.refId),d||(d=m.commitId)}i.projectId=l,i.refId=c||"master",i.commitId=d||"latest",a&&r&&(i.isEditing=!1,i.inPreviewMode=!1,i.elementSaving=!1,i.cleanUp=!1,i.instanceSpec=r.getInstanceSpec(),i.instanceVal=r.getInstanceVal(),i.presentationElem=r.getPresentationElement(),i.view=a.getView(),i.isDirectChildOfPresentationElement=f.isDirectChildOfPresentationElementFunc(e,a),i.instanceSpec.classifierIds[0]===u.TYPE_TO_CLASSIFIER_ID.Section&&(i.isDirectChildOfPresentationElement=!1),"latest"===i.commitId&&i.$on("element.updated",function(e,t,n){t.id!==i.element.id||t._projectId!==i.element._projectId||t._refId!==i.element._refId||n||o()}),i.save=function(){f.saveAction(i,e,!1)},i.saveC=function(){f.saveAction(i,e,!0)},i.cancel=function(){f.cancelAction(i,o,e)},i.delete=function(){f.deleteAction(i,i.bbApi,r.getParentSection())},i.startEdit=function(){f.startEdit(i,a,e,null,i.section)},i.preview=function(){f.previewAction(i,s,o,"name")});i.addEltAction=function(e,t,n){a&&a.isEditable()&&(n.stopPropagation(),i.addPeIndex=e,f.addPresentationElement(i,t,i.section))}}}}function mmsViewTable(v,h,b,w,y,I){return{restrict:"E",scope:{table:"<mmsTable",mmsPe:"<"},controller:["$scope",function(s){var l=this;function c(a){return function(e,t){var n=m(e,a),i=m(t,a);return null===n&&null===i?0:null===n&&null!==i?s.isAscending?1:-1:null!==n&&null===i?s.isAscending?-1:1:null!==n&&null!==i?(n=n.toLowerCase())<(i=i.toLowerCase())?-1:i<n?1:0:void 0}}function d(e,n){return e.every(function(e){return null!==(t=m(e,n))&&!isNaN(Number(t));var t})}function m(e,t){var n=$(e).children("td").eq(t),i=n.children("div").contents();if(0===i.length)return"";if(i.prop("tagName")){var a=i.prop("tagName").toLowerCase(),r=i.attr("mms-cf-type");return"img"===a||"table"===a||"mms-cf"===a&&("img"===r||"table"===r)?null:n.text().trim()}return n.text().trim()}l.addFullTableFilter=function(e){l._fullTableFilterWatcherUnregisterFn=l._addWatcherToFullTableFilterInput(function(){l._fullTableFilter(e)})},l._addWatcherToFullTableFilterInput=function(n){return s.$watch("searchTerm",function(e,t){e!==t&&n()})},l._displaySomeRows=function(e,t){for(var n=s.searchTerm,i=new RegExp(n,"i"),a=0,r=e.length;a<r;a++){var o=$(e[a]).text();i.test(o)?($(e[a]).show(),t()):$(e[a]).hide()}},l._fullTableFilter=function(e){l._resetColumnWiseFilterInputs(),""===s.searchTerm?(s.numFiltered=e.length,e.show()):(s.numFiltered=0,l._displaySomeRows(e,function(){s.numFiltered++}))},l.addColumnsWiseFilter=function(e,a){l._columnsInputWatchers=l._addWatchersForAllHeaderColumnsInput(e),l._filterTermForColumns={},s.filterByColumn=function(e,t,n,i){l._resetFullTableFilterInput(a),l._storeColumnWiseFilterTerm(l._filterTermForColumns,i,t,n,e),s.numFiltered=0,l._displayRowsMatchingAllColumnsFilterTerms(a,l._filterTermForColumns,function(){s.numFiltered++})}},l._addWatchersForAllHeaderColumnsInput=function(n){var i={};return s.table.header?(s.table.header.forEach(function(e){e.forEach(function(e){var t=n.filterTermColumnPrefixBinding+e.startCol+e.endCol;l._addWatcherToColumnInput(i,t,e)})}),i):void 0},l._addWatcherToColumnInput=function(e,n,i){e[n]={deRegistration:s.$watch(n,function(e,t){e!==t&&s.filterByColumn(e,i.startCol,i.endCol,n)}),cell:i}},l._displayRowsMatchingAllColumnsFilterTerms=function(e,i,t){e.toArray().forEach(function(n){var e=Object.keys(i).every(function(e){var t=new RegExp(i[e].filterTerm,"i");return i[e].columns.some(function(e){return t.test(l._getCellValueForFiltering(n,e))})});e?($(n).show(),t()):$(n).hide()})},l._storeColumnWiseFilterTerm=function(e,t,n,i,a){e[t]?l._updateExistingColumnWiseFilterTerm(e,t,a):l._addNewColumnWiseFilterTerm(e,t,n,i,a)},l._addNewColumnWiseFilterTerm=function(e,t,n,i,a){e[t]={filterTerm:a,columns:n===i?[n]:[n,i]}},l._updateExistingColumnWiseFilterTerm=function(e,t,n){e[t].filterTerm=n},l._getCellValueForFiltering=function(e,t){return $(e).children("td").eq(t).text().trim()},l._resetColumnWiseFilterInputs=function(){var e=Object.keys(l._filterTermForColumns);0<e.length&&(e.forEach(function(e){""!==l._filterTermForColumns[e].filterTerm&&l._columnsInputWatchers[e].deRegistration(),s[e]="",l._addWatcherToColumnInput(l._columnsInputWatchers,e,l._columnsInputWatchers[e].cell)}),l._filterTermForColumns={})},l._resetFullTableFilterInput=function(e){""!==s.searchTerm&&(l._fullTableFilterWatcherUnregisterFn(),s.searchTerm="",l._fullTableFilterWatcherUnregisterFn=l._addWatcherToFullTableFilterInput(function(){l._fullTableFilter(e)}))},l.addSorting=function(e,t){l._addDefaultSortOrder(e),l._addSortingBinding(e,t),l._addSortResetBinding(e,t)},l._addDefaultSortOrder=function(e){e.each(function(e,t){$(t).attr(l._rowSortOrderAttrName,e)})},l._addSortingBinding=function(i,r){var o=y.tableConfig;s[o.showBindingForSortIcon]=-1,s[o.sortByColumnFn]=function(e){s[o.showBindingForSortIcon]=e;var a,t=i.toArray(),n=d(t,e)?t.sort((a=e,function(e,t){var n=Number(m(e,a)),i=Number(m(t,a));return n-i})):t.sort(c(e));s.isAscending=!s.isAscending,s.isAscending||(n=n.reverse()),l._displaySortedRows(n,r),s.showSortReset=!0}},l._addSortResetBinding=function(t,n){s.resetSort=function(){var e=t.toArray().sort(l._comparatorForSortReset());l._displaySortedRows(e,n),s.showSortReset=!1,s[y.tableConfig.showBindingForSortIcon]=-1}},l._comparator=c,l._getCellValueForSorting=m,l._displaySortedRows=function(e,t){$(e).detach().appendTo(t)},l._comparatorForSortReset=function(){return function(e,t){var n=Number($(e).attr(l._rowSortOrderAttrName)),i=Number($(t).attr(l._rowSortOrderAttrName));return n<i?-1:i<n?1:0}},l._rowSortOrderAttrName="data-original-row-num",l.__areAllCellValidNumber=d}],link:function(a,c,e,t){if(a.table.showIfEmpty||0!==a.table.body.length){var n=y.tableConfig;a.searchTerm="",a.showFilter=!1,a.showSortReset=!1,a.isAscending=!1,a.getSortIconClass=function(e){return a[n.showBindingForSortIcon]!==e?["fa","fa-sort","sort-default"]:a.isAscending?["fa","fa-caret-down","sort-activated"]:["fa","fa-caret-up","sort-activated"]};var i=y.makeHtmlTable(a.table,!0,!0,a.mmsPe);i='<div class="tableSearch ve-table-filter"><button class="btn btn-sm export-csv-button btn-default" ng-click="makeCsv()">Export CSV</button> <button class="btn btn-sm filter-table-button btn-default" ng-click="showFilter = !showFilter">Filter table</button> <label class="btn btn-sm btn-default table-button"><input type="checkbox" class="fixed-header-checkbox" ng-model="fixedHeaders" ng-change="makeFixedHeader()" /> Freeze Headers</label> <label class="btn btn-sm btn-default table-button"><input type="checkbox" class="fixed-header-checkbox" ng-model="fixedColumns" ng-change="makeFixedColumn()" /> Freeze Columns</label> <label class="btn btn-sm table-button column-input-label" ng-show="fixedColumns">Columns to Freeze <input type="text" ng-show="fixedColumns" size="3" class="column-input" ng-model="numFixedColumns" /></label> <button class="btn btn-sm btn-default table-button" ng-show="fixedColumns" ng-click="updateFixedColumns()">Update</button> <button class="btn btn-sm reset-sort-button btn-default reset-sort-fade" ng-show="showSortReset" ng-click="resetSort()">Reset Sort</button><span class = "ve-show-filter" ng-show="showFilter"><form style="display: inline" class="ve-filter-table-form"><input type="text" size="75" placeholder="Filter table" ng-model-options="{debounce: '+n.filterDebounceRate+'}" ng-model="searchTerm"></form><span class = "ve-filter-status">Showing <strong>{{numFiltered}}</strong> of <strong>{{numTotal}}</strong> Rows: </span></span></div><div class="table-wrapper">'+i+"</div>",a.makeCsv=function(){var e=c.find(".table-wrapper").children("table").table2CSV({delivery:"value"}),t=new Blob(["\ufeff"+e],{type:"text/csv;charset=utf-8;"});if(window.navigator.msSaveOrOpenBlob)navigator.msSaveBlob(t,"TableData.csv");else{var n=angular.element('<div data-tap-disabled="true"><a></a></div>'),i=angular.element(n.children()[0]);i.attr("href",window.URL.createObjectURL(t)),i.attr("download","TableData.csv"),i.attr("target","_blank"),b.find("body").append(n),h(function(){i[0].click(),i.remove()},null)}};var r=null;a.fixedHeaders=!1;var o=null;a.fixedColumns=!1,a.numFixedColumns=2;var s=function(){o&&o.css("transform","translateX("+this.scrollLeft+"px)"),r&&r.css("transform","translateY("+this.scrollTop+"px)"),r&&o&&c.find("caption").css("transform","translate("+this.scrollLeft+"px, "+this.scrollTop+"px)")};a.makeFixedHeader=function(){if(!a.fixedHeaders)return c.find(".table-wrapper").removeClass("table-fix-head").css("height",""),r.css("transform","").css("will-change",""),r=null,void w.localStorage.setItem("ve-table-header-"+a.mmsPe.id,"false");c.find(".table-wrapper").addClass("table-fix-head").css("height",w.innerHeight-108),(r=c.find("thead, caption")).css("will-change","transform"),c.find(".table-fix-head").on("scroll",s),w.localStorage.setItem("ve-table-header-"+a.mmsPe.id,"true")},a.makeFixedColumn=function(){if(!a.fixedColumns)return c.find(".table-wrapper").removeClass("table-fix-column").css("width",""),o.css("transform","").css("will-change","").removeClass("table-fixed-cell"),o=null,void w.localStorage.setItem("ve-table-column-"+a.mmsPe.id,"false");c.find(".table-wrapper").addClass("table-fix-column").css("width",w.innerWidth-400),(o=(o=(o=l("thead","th",a.numFixedColumns)).add(l("tbody","td",a.numFixedColumns))).add(c.find(".table-fix-column caption"))).css("will-change","transform"),o.addClass("table-fixed-cell"),c.find(".table-fix-column").on("scroll",s),w.localStorage.setItem("ve-table-column-"+a.mmsPe.id,a.numFixedColumns)},a.updateFixedColumns=function(){a.fixedColumns=!1,a.makeFixedColumn(),a.fixedColumns=!0,a.makeFixedColumn()};var l=function(e,t,r){var o={},s=0,l=$();return c.find(".table-fix-column table").children(e).children("tr").each(function(){var a=0;$(this).children(t).each(function(){for(;o[s]&&o[s][a];)a++;if(!(r<=a)){l=l.add($(this));var e=$(this).attr("rowspan");if(e&&1<(e=parseInt(e)))for(var t=1;t<e;t++)o[s+t]||(o[s+t]={}),o[s+t][a]=!0;var n=$(this).attr("colspan");if(n){for(n=parseInt(n);1<n;)if(a++,n--,1<e)for(var i=1;i<e;i++)o[s+i][a]=!0;a++}else a++}}),s++}),l};c[0].innerHTML=i,$(c[0]).find("img").each(function(e){I.fixImgSrc($(this))});var d=0,m=c.find("thead");v(m)(a);var p=c.children("div")[0];v(p)(a),v(c.find("caption"))(a);var u=c.find(".table-wrapper").children("table").children("tbody"),f=u.children("tr"),g=f.length;a.numFiltered=g,a.numTotal=g,function i(){h(function(){var e=d;if(!(g<e)){var t=f.slice(e,e+300);if(v(t)(a),(d=e+300)<g)i();else{"true"==w.localStorage.getItem("ve-table-header-"+a.mmsPe.id)&&(a.fixedHeaders=!0,a.makeFixedHeader());var n=w.localStorage.getItem("ve-table-column-"+a.mmsPe.id);"false"!=n&&null!=n&&"null"!=n&&(a.fixedColumns=!0,a.numFixedColumns=n,a.makeFixedColumn())}}},100,!1)}(),t.addFullTableFilter(f),t.addColumnsWiseFilter(n,f),t.addSorting(f,u)}}}}function mmsViewTableT(){return{restrict:"E",template:'<mms-cf mms-cf-type="doc" mms-element-id="{{para.source}}"></mms-cf>',scope:{para:"<mmsPara"}}}angular.module("mms",[]).config(["$sceProvider",function(e){e.enabled(!1)}]).constant("_",window._).constant("HtmlRenderedDiff",window.HtmlRenderedDiff).constant("moment",window.moment).constant("flatpickr",window.flatpickr),angular.module("mms").factory("ApplicationService",["$q","$http","URLService",ApplicationService]),angular.module("mms").factory("ArtifactService",["$q","$http","URLService","UtilsService","CacheService","HttpService","ApplicationService",ArtifactService]),angular.module("mms").factory("AuthService",["$q","$http","CacheService","URLService","HttpService","ElementService","ViewService","ProjectService","$window","$analytics",AuthService]),angular.module("mms").factory("CacheService",["_",CacheService]),angular.module("mms").factory("ElementService",["$q","$http","URLService","UtilsService","CacheService","HttpService","ApplicationService","_",ElementService]),angular.module("mms").factory("FullDocumentService",["$timeout","$interval","$http","_","growl",FullDocumentService]),angular.module("mms").factory("HttpService",["$http",HttpService]),angular.module("mms").factory("JobService",["$q","$http","$location","URLService","CacheService","AuthService","_",JobService]),angular.module("mms").factory("MentionService",["$rootScope","$compile","$timeout","moment","CacheService","ViewService","UtilsService",MentionService]),angular.module("mms").factory("ProjectService",["$q","$http","ApplicationService","CacheService","ElementService","URLService","_",ProjectService]),angular.module("mms").factory("ShortenUrlService",["$http","$q","URLService","UtilsService",ShortenUrlService]),angular.module("mms").factory("StompService",["$rootScope","ApplicationService","ElementService","URLService","$http","UtilsService","CacheService","_",StompService]),angular.module("mms").factory("TableService",["$q","$http","URLService","UtilsService","CacheService","_","ElementService",TableService]),angular.module("mms").provider("URLService",function(){var t="/alfresco/service",n="";this.setBaseUrl=function(e){t=e},this.setMmsUrl=function(e){n=e},this.$get=[function(){return urlService(t,n)}]}),angular.module("mms").factory("UtilsService",["$q","$http","CacheService","URLService","ApplicationService","_",UtilsService]),angular.module("mms").factory("UxService",["$rootScope",UxService]),angular.module("mms").factory("ViewService",["$q","$http","$rootScope","URLService","ElementService","UtilsService","CacheService","_",ViewService]),angular.module("mms").factory("VizService",["$q","$http","URLService","CacheService","UtilsService","AuthService",VizService]),angular.module("mms").filter("underlineMatch",["$filter",partialMatch]),angular.module("mms.directives.tpls",["mms/templates/mergeConfirm.html","mms/templates/mmsAddPeButton.html","mms/templates/mmsAnnotation.html","mms/templates/mmsButtonBar.html","mms/templates/mmsCfModal.html","mms/templates/mmsCommentModal.html","mms/templates/mmsDiffAttr.html","mms/templates/mmsGroupDocs.html","mms/templates/mmsHistory.html","mms/templates/mmsHtmlDiff.html","mms/templates/mmsJobs.html","mms/templates/mmsMention.html","mms/templates/mmsRefList.html","mms/templates/mmsSearch.html","mms/templates/mmsSearchResults.html","mms/templates/mmsSpec.html","mms/templates/mmsToolbar.html","mms/templates/mmsTranscludeDoc.html","mms/templates/mmsTranscludeName.html","mms/templates/mmsTranscludeVal.html","mms/templates/mmsTranscludeValEdit.html","mms/templates/mmsTranscludeValFrame.html","mms/templates/mmsTree.html","mms/templates/mmsTsDiagram.html","mms/templates/mmsView.html","mms/templates/mmsViewPresentationElem.html","mms/templates/mmsViewReorder.html","mms/templates/mmsViewSection.html","mms/templates/revertConfirm.html","mms/templates/saveConflict.html"]),angular.module("mms/templates/mergeConfirm.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mergeConfirm.html",'<div class="modal-header">\n    <h4>Pull in changed presentation elements <span class="text-warning">(beta)</span></h4>\n</div>\n\n<div class="modal-body revert-dialogue">\n    <p><b>{{docName}}:</b> Pull in changed Presentation Elements from <span class="{{srcRefOb.type}}-icon"><b>{{srcRefOb.name}}</b></span> to <span class="{{currentRefOb.type}}-icon"><b>{{currentRefOb.name}}</b></p>\n\n    <p style="padding-bottom:20px;"> This will commit contents of source Presentation Elements (PEs)<a><i class="fa fa-question-circle" uib-tooltip="Text, image, equation, and section elements" tooltip-placement="bottom"></i></a> to target PEs if source PEs have changed, and add new PEs from source to target if they do not exist on target.\n        \x3c!-- <a> More...</a> --\x3e\n    </p>\n\n    <div class="element-preview-box">\n        <p><i class="fa fa-exclamation-triangle"></i><b>Notice:</b> Your document may not\n            look complete unless your model merge was completed as well.\n        </p>\n        <p><i class="fa fa-exclamation-triangle"></i><b>Before applying to your production\n            branch</b> please <a>create a test branch</a> from your target branch, apply changes, and preview.</p>\n    </div>\n    <label>Optional change log message</label>\n    <div class="commit-message-box">\n        <textarea ng-model="commitMessage" style="width:100%" rows="3" placeholder="Describe your changes"></textarea>\n    </div>\n</div>\n\n<div class="modal-footer">\n    <button class="btn btn-warning" ng-click="ok()">Pull</button>\n    <button class="btn btn-default" ng-click="cancel()">Cancel</button>\n</div>\n')}]),angular.module("mms/templates/mmsAddPeButton.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mmsAddPeButton.html",'<div class="mms-add-pe-button" ng-mouseover="setPeLineVisibility($event);" ng-mouseleave="setPeLineVisibility($event);">\n  <span class="center btn-group dropdown" uib-dropdown>\n    <a type="button" class="dropdown-toggle btn btn-sm" ng-click="$event.stopPropagation(); setPeLineVisibility($event);" uib-dropdown-toggle aria-expanded="true" title="Add cross referenceable text, tables, images, equations, sections, and comments">\n        <i class="fa fa-plus"></i>\n    </a>\n    <ul class="dropdown-menu" uib-dropdown-menu role="add PE menu">\n      <li ng-click="addEltAction($index, \'Paragraph\', $event)">\n        <a type="button" class="add-element-button center view-add-paragraph pe-type-Paragraph" title="Add text">\n          <span class="icon-title">Text</span>\n        </a>\n      </li>\n      <li ng-click="addEltAction($index, \'Table\', $event)">\n        <a type="button" class="add-element-button center view-add-table pe-type-Table" title="Add table">\n          <span class="icon-title">Table</span>\n        </a>\n      </li>\n      <li ng-click="addEltAction($index, \'Image\', $event)">\n        <a type="button" class="add-element-button center view-add-image pe-type-Image" title="Add image">\n          <span class="icon-title">Image</span>\n        </a>\n      </li>\n      <li ng-click="addEltAction($index, \'Equation\', $event)">\n        <a type="button" class="add-element-button center view-add-equation pe-type-Equation" title="Add equation">\n          <span class="icon-title">Equation</span>\n        </a>\n      </li>\n      <li ng-click="addEltAction($index, \'Section\', $event)">\n        <a type="button" class="add-element-button center view-add-section pe-type-Section" title="Add section">\n          <span class="icon-title">Section</span>\n        </a>\n      </li>\n      <li ng-click="addEltAction($index, \'Comment\', $event)">\n        <a type="button" class="add-element-button center view-add-comment pe-type-Comment" title="Add comment">\n          <span class="icon-title">Comment</span>\n        </a>\n      </li>\n    </ul>\n  </span>\n</div>\n<hr/>')}]),angular.module("mms/templates/mmsAnnotation.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mmsAnnotation.html",'<span class="mms-error" uib-popover-template="\'annotationTemplate.html\'" popover-popup-close-delay="500" ng-bind-html="displayContent.inlineContent" popover-placement="top-left" popover-title="{{displayContent.toolTipTitle}}"></span>\n<script type="text/ng-template" id="annotationTemplate.html">\n    <p>\n        {{displayContent.toolTipContent}}\n    </p>\n    <p id="tooltipElementId" style="position: absolute; left: -1000px; top: -1000px; ">\n        {{displayContent.id}}\n    </p>\n    <button ng-click="copyToClipboard($event)" class="btn btn-sm btn-default"><i class="fa fa-copy"></i>Copy Element ID</button>\n<\/script>\n')}]),angular.module("mms/templates/mmsButtonBar.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mmsButtonBar.html",'<span ng-repeat="button in buttons | filter: {permission: true}">\n\n  \x3c!-- Normal button --\x3e\n  <a type="button" ng-if="!button.dropdown_buttons" class="btn btn-tools btn-sm {{button.id}}"\n      ng-click="button.action($event)" uib-tooltip="{{button.tooltip}}" tooltip-append-to-body="false"\n      tooltip-trigger="mouseenter" tooltip-popup-delay="100" tooltip-placement="{{button.placement}}">\n      <i class="fa {{button.icon}}"></i>{{button.text}}</a>\n\n  \x3c!-- Button with dropdown buttons --\x3e\n  <span ng-if="button.dropdown_buttons" class="btn-group" uib-dropdown>\n    <button type="button" class="btn btn-tools btn-sm dropdown-toggle {{button.id}}" uib-dropdown-toggle uib-tooltip="{{button.tooltip}}"\n        tooltip-append-to-body="false" tooltip-trigger="mouseenter" tooltip-popup-delay="100"\n        tooltip-placement="{{button.placement}}">\n        <i class="fa {{button.icon}}"></i>{{button.button_content}}<span class="caret"></span></button>\n    <ul class="dropdown-menu" role="menu">\n      <li>\n          <a ng-repeat="dropdown_button in button.dropdown_buttons | filter: {permission: true}" type="button"\n              class="center {{dropdown_button.id}} {{ button.id === \'view-mode-dropdown\' && dropdown_button.selected ? \'checked-list-item\' : \'\'}}" ng-click="dropdown_button.action($event); mmsBbApi.select(button, dropdown_button)"><i\n              class="fa {{dropdown_button.icon}}"> </i>&nbsp;{{dropdown_button.tooltip}}</a>\n      </li>\n    </ul>\n  </span>\n\n</span>\n')}]),angular.module("mms/templates/mmsCfModal.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mmsCfModal.html",'<div class="modal-header">\n    <h4>{{title}}</h4>\n</div>\n<div class="modal-body">\n    <div class="ve-light-tabs modal-top-tabs" ng-show="showProposeLink">\n        <ul class="nav nav-tabs">\n            <li class="uib-tab nav-item tab-item" ng-class="{\'active\': !searchExisting}">\n                <a class="nav-link" ng-click="searchExisting = false"><i class="fa fa-plus"></i>Create New</a>\n            </li>\n            <li class="uib-tab nav-item tab-item" ng-class="{\'active\': searchExisting}">\n                <a class="nav-link" ng-click="searchExisting = true"><i class="fa fa-search"></i>Search for existing</a>\n            </li>\n        </ul>\n    </div>\n\n    \x3c!-- Seach for exisiting panel --\x3e\n    <div ng-show="searchExisting">\n        <div class="transclude-modal-instructions">\n            {{description}}\n        </div>\n        <div class="form-group" ng-show="!showProposeLink"><br>\n            <label>Link Text:</label>\n            <div class="radio radio-with-label">\n                <label><input type="radio" ng-model="linkType" ng-value="1">&nbsp;Document auto-numbering\n                <a uib-tooltip="For links within current document, otherwise defaults to name" tooltip-trigger="mouseenter" tooltip-popup-delay="100"><i class="fa fa-info-circle"></i></a></label><br>\n                <label><input type="radio" ng-model="linkType" ng-value="2">&nbsp;Name</label><br>\n                <label><input type="radio" ng-model="linkType" ng-value="3">&nbsp;Custom&nbsp;\n                    <input type="text" ng-model="linkText" placeholder="custom title"/></label>\n            </div>\n        </div>\n        <label ng-show="showEditableOp" for="nonEditableCheckbox">\n            <input id="nonEditableCheckbox" type="checkbox" ng-model="nonEditableCheckbox">&nbsp;Restrict editing\n        </label>\n\n        <mms-search mms-options="searchOptions" mms-project-id="{{mmsProjectId}}" mms-ref-id="{{mmsRefId}}"></mms-search>\n    </div>\n\n    \x3c!-- Create New Panel --\x3e\n    <div ng-show="!searchExisting">\n        <form>\n            <div class="form-group">\n                <label>Name </label><span class="star-mandatory">*</span>\n                <input class="form-control" type="text" ng-model="newE.name" placeholder="Name your new element" autofocus/>\n            </div>\n            <div class="form-group">\n                <label class="label-documentation">Documentation</label>\n                <textarea mms-ckeditor ng-model="newE.documentation" mms-project-id="{{mmsProjectId}}" mms-ref-id="{{mmsRefId}}" class="textarea-transclude-modal"></textarea>\n            </div>\n            <label>Property to cross-reference</label><span class="star-mandatory">*</span>\n            <div class="radio radio-with-label">\n                <label><input type="radio" name="optradio" value="true" ng-click="toggleRadio(\'name\')">Name</label><br>\n                <label><input type="radio" name="optradio" value="true" ng-click="toggleRadio(\'documentation\')">Documentation</label>\n            </div>\n        </form>\n\n        <p class="help-block pull-left"><i>Fields marked with <span class="star-mandatory">*</span> are required</i></p>\n    </div>\n</div>\n<div class="modal-footer">\n    <button class="btn btn-primary" ng-show="!searchExisting" type="button" ng-click="makeNewAndChoose()">Create & Cross Reference<i class="{{proposeClass}}"></i></button>\n    <button class="btn btn-default" ng-click="cancel()">Cancel</button>\n</div>')}]),angular.module("mms/templates/mmsCommentModal.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mmsCommentModal.html",'<div class="modal-header">\n    <h4>Insert a comment</h4>\n</div>\n\n<div class="modal-body comment-modal">\n    <div class="comment-modal-input">\n        <div class="form-group">\n            <label>Title</label>\n            <input class="form-control" ng-model="comment.name" type="text"\n                   placeholder="Type a title for your comment here" autofocus>\n        </div>\n        <div class="form-group">\n            <label>Comment</label>\n            <textarea class="form-control" rows="3" ng-model="comment.documentation" \n                placeholder="Type your comment here" ng-keyup="$event.keyCode == 13 ? ok(comment) : null"></textarea>\n        </div>\n    </div>\n</div>\n\n<div class="modal-footer">\n    <button class="btn btn-primary" ng-click="ok(comment)">Create <i ng-show="oking" class="fa fa-spin fa-spinner"></i>\n    </button>\n    <button class="btn btn-default" ng-click="cancel()">Cancel</button>\n</div>')}]),angular.module("mms/templates/mmsDiffAttr.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mmsDiffAttr.html",'<span ng-show="diffLoading">\n    <i class="fa fa-spin fa-spinner"></i>\n</span>\n<span ng-hide="diffLoading">\n    <span class="text-info" ng-if="message"><i class="fa fa-info-circle"></i>{{message}}</span>\n    <mms-html-diff ng-if="baseElementHtml != undefined && comparedElementHtml != undefined" mms-base-html="baseElementHtml" mms-compared-html="comparedElementHtml" mms-diff-finish="diffFinish"></mms-html-diff>\n</span>')}]),angular.module("mms/templates/mmsGroupDocs.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mmsGroupDocs.html",'<table class="table table-condensed">\n    <tr><th>Document(s)</th>\x3c!--<th>Last Modified</th><th>Last Modified By</th><th>Created</th>--\x3e</tr>\n    <tr ng-repeat="doc in docs | orderBy: \'name\'">\n        <td><mms-view-link mms-document-id="{{doc.id}}" mms-element-id="{{doc.id}}" mms-project-id="{{projectId}}" mms-ref-id="{{refId}}"></mms-view-link></td>\n    </tr>\n</table>')}]),angular.module("mms/templates/mmsHistory.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mmsHistory.html",'<h4 class="right-pane-title">Element History\n    <span ng-show="gettingHistory"><i class="fa fa-spin fa-spinner"></i></span>\n</h4>\n\n<div style="margin-bottom:6px;">\n    <input type="checkbox" style="margin-right:4px;" ng-model="ModelData.ShowDiffPrototype" ng-disabled="disableCompare">Compare versions\n</div>\n\n<div style="position:relative;">\n    <div ng-if="ModelData.ShowDiffPrototype" class="inline-diff-buttons fade-in-out">\n        <span class="inline-btn-label">Before:</span>\n        <div class="btn-group ve-light-dropdown" uib-dropdown keyboard-nav is-open="baseCommit.isopen" auto-close="outsideClick" style="flex:2" ng-hide="disableRevert">\n            <button class="dropdown-toggle" type="button" uib-dropdown-toggle>\n                {{baseCommit.commitSelected._created | date:\'M/d/yy h:mm a\'}} by <b>{{baseCommit.commitSelected._creator}}</b><span ng-if="baseCommit.commitSelected.id === baseCommit.baseHistory[0].id"> (Latest)</span>\n                <i class="fa fa-caret-down" aria-hidden="true"></i>\n            </button>\n            <ul class="dropdown-menu menu-with-input" uib-dropdown-menu role="menu">\n                <li class="dropdown-input">\n                    <input class="ve-plain-input" ng-model="compareHistoryFilter" type="text" placeholder="Filter history on {{baseCommit.refSelected.type}}: {{baseCommit.refSelected.name}}">\n                </li>\n                <li ng-click="baseCommitClicked(version)" ng-repeat="version in baseCommit.baseHistory | filter:compareHistoryFilter"\n                    ng-class="{\'checked-list-item\': version === baseCommit.commitSelected,\'secondary-checked-list-item\': version === compareCommit.commitSelected}"\n                    ng-disabled="$index === 0" tooltip-placement="left" uib-tooltip="Selected after version"\n                    tooltip-append-to-body="version === compareCommit.commitSelected" tooltip-enable="version === compareCommit.commitSelected">\n                    <a>{{version._created | date:\'M/d/yy h:mm a\'}} by <b>{{ version._creator }}</b><span ng-if="$index == 0"> (Latest)</span></a>\n                </li>\n            </ul>\n        </div>\n\n        <span class="inline-btn-label" style="flex:2;text-align:right;" ng-show="disableRevert">Element does not exist</span>\n\n        <span class="inline-btn-label"> on</span>\n\n        <div class="btn-group ve-light-dropdown" uib-dropdown keyboard-nav is-open="baseCommit.refisopen" auto-close="outsideClick" style="flex:1">\n            <button class="dropdown-toggle" type="button" uib-dropdown-toggle>\n                {{baseCommit.refSelected.type}}: <b>{{baseCommit.refSelected.name}}</b>\n                <i class="fa fa-caret-down" aria-hidden="true"></i>\n            </button>\n            <ul class="dropdown-menu menu-with-input pull-right" uib-dropdown-menu role="menu">\n                <li class="dropdown-input">\n                    <input class="ve-plain-input" type="text" placeholder="Filter branches/tags" ng-model="refFilter">\n                </li>\n                <li ng-click="getElementHistoryByRef(ref)" ng-repeat="ref in refList | filter:refFilter"\n                    ng-class="{\'checked-list-item\': ref.id === baseCommit.refSelected.id}">\n                    <a>{{ ref.type }}: <b>{{ref.name}}</b></a>\n                </li>\n            </ul>\n        </div>\n    </div>\n\n    <div class="diff-dotted-connection fade-in-out" ng-show="ModelData.ShowDiffPrototype"></div>\n    <div class="inline-diff-buttons">\n        <span class="inline-btn-label fade-in-out" ng-show="ModelData.ShowDiffPrototype">After:</span>\n        <div class="btn-group ve-light-dropdown" ng-class="{\'flex-grow-shrink\':ModelData.ShowDiffPrototype}" uib-dropdown keyboard-nav is-open="compareCommit.isopen" auto-close="outsideClick" style="flex:2">\n            <button class="dropdown-toggle" type="button" uib-dropdown-toggle>\n                <span>{{compareCommit.commitSelected._created | date:\'M/d/yy h:mm a\'}} by <b>{{compareCommit.commitSelected._creator}}</b></span>\n                <span ng-if="compareCommit.commitSelected.id === compareCommit.compareHistory[0].id"> (Latest)</span>\n                <i class="fa fa-caret-down" aria-hidden="true"></i>\n            </button>\n            <ul class="dropdown-menu menu-with-input" uib-dropdown-menu role="menu">\n                <li class="dropdown-input">\n                    <input class="ve-plain-input" type="text" placeholder="Filter history on {{compareCommit.ref.type}}: {{compareCommit.ref.name}}" ng-model="historyFilter">\n                </li>\n                <li ng-click="commitClicked(version)" ng-repeat="version in compareCommit.compareHistory | filter:historyFilter"\n                    ng-class="{\'checked-list-item\': version === compareCommit.commitSelected,\'secondary-checked-list-item\': version === baseCommit.commitSelected && ModelData.ShowDiffPrototype}"\n                    tooltip-placement="left" uib-tooltip="Selected before version"\n                    tooltip-append-to-body="version === baseCommit.commitSelected" tooltip-enable="ModelData.ShowDiffPrototype && version === baseCommit.commitSelected">\n                    <a>{{version._created | date:\'M/d/yy h:mm a\'}} by <b>{{ version._creator }}</b><span ng-if="$index == 0"> (Latest)</span></a>\n                </li>\n            </ul>\n        </div>\n        <span class="inline-btn-label" ng-show="ModelData.ShowDiffPrototype">on</span>\n        <span class="inline-btn-label fade-in-out" ng-show="ModelData.ShowDiffPrototype" style="flex:1">{{compareCommit.ref.type}}: <b>{{compareCommit.ref.name}}</b></span>\n    </div>\n</div>\n\n<hr class="spec-title-divider">\n\n<div ng-if="ModelData.ShowDiffPrototype">\n    <div class="ve-notify-banner fade-in-out" ng-show="disableRevert">\n        <span>Element does not exist on <strong>{{baseCommit.refSelected.type}}: {{baseCommit.refSelected.name}}</strong></span>\n    </div>\n    <div ng-hide="disableRevert">\n        <h1 class="prop element-title">\n            <mms-diff-attr mms-attr="name"\n                           mms-base-project-id="{{mmsProjectId}}"\n                           mms-base-ref-id="{{baseCommit.refSelected.id}}"\n                           mms-base-commit-id="{{baseCommit.commitSelected.id}}"\n                           mms-base-element-id="{{mmsElementId}}"\n                           mms-compare-ref-id="{{mmsRefId}}"\n                           mms-compare-commit-id="{{compareCommit.commitSelected.id}}">\n            </mms-diff-attr>\n        </h1>\n\n        <h2 class="prop-title spec-view-doc-heading">Documentation</h2>\n        <mms-diff-attr mms-attr="doc"\n                       mms-base-project-id="{{mmsProjectId}}"\n                       mms-base-ref-id="{{baseCommit.refSelected.id}}"\n                       mms-base-commit-id="{{baseCommit.commitSelected.id}}"\n                       mms-base-element-id="{{mmsElementId}}"\n                       mms-compare-ref-id="{{mmsRefId}}"\n                       mms-compare-commit-id="{{compareCommit.commitSelected.id}}">\n        </mms-diff-attr>\n\n        <div ng-if="element.type === \'Property\' || element.type === \'Port\' || element.type === \'Slot\'">\n            <h2 class="prop-title">Property Value</h2>\n            <span class="prop">\n                <mms-diff-attr mms-attr="val"\n                               mms-base-project-id="{{mmsProjectId}}"\n                               mms-base-ref-id="{{baseCommit.refSelected.id}}"\n                               mms-base-commit-id="{{baseCommit.commitSelected.id}}"\n                               mms-base-element-id="{{mmsElementId}}"\n                               mms-compare-ref-id="{{mmsRefId}}"\n                               mms-compare-commit-id="{{compareCommit.commitSelected.id}}">\n                </mms-diff-attr>\n            </span>\n        </div>\n        <h2 class="prop-title">Commit</h2>\n        <span class="prop">{{baseCommit.commitSelected.id}}<br>\n        <img src="assets/images/arrow-change.svg" class="change-connection"><br>\n        {{compareCommit.commitSelected.id}}</span>\n    </div>\n</div>\n\n\x3c!-- Spec window --\x3e\n<div ng-hide="ModelData.ShowDiffPrototype">\n    <mms-spec mms-element-id="{{mmsElementId}}" mms-project-id="{{mmsProjectId}}" mms-ref-id="{{mmsRefId}}" mms-commit-id="{{historyVer}}" no-edit="true"></mms-spec>\n</div>\n\n<div ng-show="ModelData.ShowDiffPrototype && compareCommit.ref.type === \'Tag\'" class="revert-section fade-in-out">\n    <div>\n        <span class="ve-secondary-text">Cannot make changes on a <b>Tag</b>.</span>\n    </div>\n</div>\n<div ng-show="ModelData.ShowDiffPrototype && !disableRevert && compareCommit.ref.type !== \'Tag\'" class="revert-section fade-in-out">\n    <div>\n        <span>To revert <b>documentation</b>, <b>name</b>, and <b>value</b> to before content ({{baseCommit.commitSelected._created | date:\'M/d/yy h:mm a\'}} by <b>{{baseCommit.commitSelected._creator}}</b>):</span>\n        <button class="btn btn-warning btn-sm pull-right" ng-click="revert()">Revert</button>\n    </div>\n</div>\n')}]),angular.module("mms/templates/mmsHtmlDiff.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mmsHtmlDiff.html",'<div id="{{htmlDiffId}}" class="htmlDiff" ng-bind-html="diffResult"></div>\n')}]),angular.module("mms/templates/mmsJobs.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mmsJobs.html",'<h4 class="right-pane-title">Jobs</h4>\n<span ng-if="loadingJobs"><i class="fa fa-spin fa-spinner"></i></span>\n<hr class="spec-title-divider">\n\n<div id="ve-jobs-table">\n    <h3>View Editor</h3>\n    <div ng-if="!refList.length" class="text-center well empty-state">\n    <h4>No Current VE Jobs</h4>\n    </div>\n    <table class="table table-condensed" ng-if="refList.length">\n        <thead>\n            <tr>\n                <td>Name</td>\n                <td>Status</td>\n                <td>Created</td>\n            </tr>\n        </thead>\n        <tbody>\n            <tr ng-repeat="ref in refList">\n                <td>{{ref.type}}: {{ref.name}}</td>\n                <td>\n                    <div ng-switch="ref.status">\n                        <span ng-switch-when="creating">\n                            <i class="fa fa-ellipsis-h in-progress-marker" aria-hidden="true"></i>{{ref.status}} \n                        </span>\n                        <span ng-switch-when="fail">\n                            <i class="fa fa-circle failed-marker" aria-hidden="true"></i>{{ref.status}} \n                        </span>\n                        <span ng-switch-when="created">\n                            <i class="fa fa-circle completed-marker" aria-hidden="true"></i>{{ref.status}}\n                        </span>\n                    </div>\n                </td>\n                <td>{{ref._created | date:\'M/d/yy h:mm a\'}}</td>\n            </tr>\n        </tbody>\n    </table><br>\n\n\n    <h3>PMA (Platform for Modeling and Analysis)</h3>\n    <table class="table table-condensed" ng-if="!loadingJobs && jobs.length">\n        <thead>\n            <tr>\n                <td>Name</td>\n                \x3c!--<td>Created</td>--\x3e\n                <td>Status</td>\n                <td>Actions</td>\n            </tr>\n        </thead>\n        <tbody>\n            <tr ng-repeat="job in jobs">\n                <td>\n                    <div ng-hide="editorEnabled">\n                        <b>{{job.name}}</b>\n                        \x3c!--<a class="ng-binding" ng-click="enableEditor()">--\x3e\n                            \x3c!--<i class="fa fa-pencil" aria-hidden="true"></i>--\x3e\n                        \x3c!--</a>--\x3e\n                    </div>\n                    \x3c!--<div ng-show="editorEnabled">\n                        <input ng-model="jobInput.jobName" ng-show="editorEnabled">\n                        <a ng-click="save()">Save</a>\n                        or\n                        <a ng-click="disableEditor()">Cancel</a>\n                    </div>--\x3e\n                </td>\n                \x3c!--<td>\n                    <select class = "form-control">\n                        {{job.create}}\n                    </select>\n                </td>--\x3e\n                <td>\n                    <div ng-if="loading">\n                        <span><i class="fa fa-spinner fa-spin"></i>&nbsp;Loading...</span>\n                    </div>\n                    <div ng-show="job.latestStatus || (jobInstances[job.id] && jobInstances[job.id].length)">\n                        <b>Build {{jobInstances[job.id][0].buildNumber}}</b>\n                        <div class="build-details" ng-switch="jobInstances[job.id][0].jobStatus">\n                            <span ng-switch-when="pending|loading|running|started" ng-switch-when-separator="|">\n                                Started {{jobInstances[job.id][0].started | date:\'M/d/yy h:mm a\'}}<br>\n                                <i class="fa fa-ellipsis-h in-progress-marker" aria-hidden="true"></i>in progress\n                            </span>\n                            <span ng-switch-when="failed">\n                                Completed {{jobInstances[job.id][0].completed | date:\'M/d/yy h:mm a\'}}<br>\n                                <i class="fa fa-circle failed-marker" aria-hidden="true"></i>failed\n                            </span>\n                            <span ng-switch-when="completed">\n                                Completed {{jobInstances[job.id][0].completed | date:\'M/d/yy h:mm a\'}}<br>\n                                <i class="fa fa-circle completed-marker" aria-hidden="true"></i>success\n                            </span>\n                            <span class="animate-switch" ng-switch-default>{{jobInstances[job.id][0].jobStatus}}</span>\n                            <a ng-attr-href="{{jobInstances[job.id][0].logUrl}}" target="_blank" rel="noopener noreferrer" ng-show="jobInstances[job.id][0].logUrl">log</a>\n                        </div>\n                    </div>\n                    <div ng-if="(!jobInstances[job.id] || !jobInstances[job.id].length) && !loading">\n                        <span>No runs</span>\n                    </div>\n                </td>\n                <td>\n                    <div ng-if="jobInstances[job.id][0].type === \'docmerge\'">\n                        <a ng-click="changePane(\'gotoTagsBranches\')">Go to branches/tags pane</a>\n                    </div>\n                    <div ng-switch="jobInstances[job.id][0].jobStatus" ng-if="jobInstances[job.id][0].type != \'docmerge\'">\n                        <span ng-switch-when="pending|loading|running|started" ng-switch-when-separator="|">\n                        <button class="btn btn-primary btn-sm disabled">\n                            Run Now <i ng-show="!runCleared" class="fa fa-spin fa-spinner"></i>\n                        </button>\n                        </span>\n                        <span ng-switch-default>\n                            <button class="btn btn-primary btn-sm" ng-class="{\'disabled\': !docEditable || !runCleared || loading}" ng-click="!runCleared || createJobandRun(job.id)">\n                                Run Now <i ng-show="!runCleared" class="fa fa-spin fa-spinner"></i>\n                            </button>\n                        </span>\n                    </div>\n                </td>\n            </tr>\n        </tbody>\n    </table>\n    <div ng-if="!docgenExists && !loadingJobs" class="text-center well empty-state">\n        <h4 ng-if="!jobs.length && !loadingJobs">No Current PMA Jobs</h4>\n        <p><i>What\'s PMA?</i> PMA regenerates views for the current document. \n        <a target="_blank" href="https://wiki.jpl.nasa.gov/display/opencae/View+Editor+User+Guide%3A+5+Jobs">More</a></p>\n        <p ng-if="mmsRefType == \'Tag\'">PMA is not available on tags.</p>\n        <p ng-if="!isDoc">Please select a document.</p>\n        <button class="btn btn-primary" ng-if="mmsRefType != \'Tag\' && isDoc" ng-click="!createJobCleared || createJobandRun()" ng-class="{\'disabled\': !docEditable || !runCleared || !createJobCleared}">\n            Run DocGen <i ng-hide="createJobCleared" class="fa fa-spin fa-spinner"></i>\n        </button>\n    </div>\n</div>\n\n')}]),angular.module("mms/templates/mmsMention.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mmsMention.html",'<script type="text/ng-template" id="customTemplate.html">\n    <a class="itemContainer" ng-switch="match.model.type">\n        <span ng-switch-when="name" class="nameContainer">\n            <div class="leftItem">\n                <i class="icon" ng-class="match.model.iconClass"></i>\n                <span> name </span>\n                <span id="{{match.model.id + match.model.type}}" class="matchName mentionMatch" ng-bind-html="match.model.name | underlineMatch:query"></span>\n                <br>\n            </div>\n            <div class="rightItem">\n                <span class="elementType">{{match.model.elementType}}</span>\n                <span>last mod {{match.model.editTime}} by\n                    <span class="editor">{{match.model.editor}}</span>\n                </span>\n            </div>\n        </span>\n        <span ng-switch-when="doc" class="contentContainer">\n            <span> documentation </span>\n            <span id="{{match.model.id + match.model.type}}" class="content mentionMatch">{{match.model.documentation}}</span>\n        </span>\n        <div ng-switch-when="val" class="contentContainer" ng-if="match.model.type === \'val\'">\n            <span> value </span>\n            <span id="{{match.model.id + match.model.type}}" class="content mentionMatch">{{match.model.value}}</span>\n        </div>\n    </a>\n<\/script>\n\n<div class="mmsMention" id={{mmsMentionId}}>\n    <input style="display:none;" mms-mention-intercept mms-mention-intercept-value="mmsMentionValue"\n           uib-typeahead="mentionItem as mentionItem.name for mentionItem in fastCfListing | filter:{name: $viewValue} | limitTo:10"\n           typeahead-template-url="customTemplate.html" typeahead-on-select=\'selectMentionItem($item, $model)\'\n           ng-model="selected" class="autocomplete-modal-typeahead form-control"\n           placeholder="Type an element name to Cf" autofocus/>\n</div>\n')}]),angular.module("mms/templates/mmsRefList.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mmsRefList.html",'<input class="form-control" ng-model="refFilter" type="text" placeholder="Filter branches/tags">\n\n<table class="tags-table table table-condensed">\n    <thead>\n        <tr>\n            <td><h3 class="Tag-icon">Tag</h3></td>\n            <td><h3>Created</h3></td>\n            <td ng-if="isDoc && docEditable && showMerge"></td>\n        </tr>\n    </thead>\n    <tbody ng-show="filteredTags.length">\n        <tr ng-repeat="tag in filteredTags = (mmsTags | orderBy:\'-_created\' | filter: {name : refFilter})">\n            <td>\n                <a ui-sref="{refId: tag.id}"><b>{{tag.name}}</b></a>\n                <div>{{tag.description}}</div>\n            </td>\n            <td class="ve-secondary-text">{{tag._created | date:\'M/d/yy h:mm a\'}}</td>\n            <td ng-if="isDoc && docEditable && showMerge">\n                <div class="btn-group" uib-dropdown is-open="status.isopen">\n                    <button type="button" class="btn btn-default" uib-dropdown-toggle ng-disabled="disabled" title="Tag actions">\n                        <i class="fa fa-ellipsis-v"></i>\n                    </button>\n                    <ul class="dropdown-menu pull-right" uib-dropdown-menu role="menu" aria-labelledby="single-button">\n                        <li role="menuitem" style="padding:10px;">\n                            <button class="btn btn-default btn-sm" ng-class="{\'disabled\': !docEditable || !runCleared}" ng-click="docMergeAction(tag)">\n                                Pull In<i ng-show="!runCleared" class="fa fa-spin fa-spinner"></i>\n                            </button> to this document on current branch\n                        </li>\n                    </ul>\n                </div>\n            </td>\n        </tr>\n    </tbody>\n\n    <tbody ng-show="mmsTags.length && !filteredTags.length"><tr><td colspan="3" class="ve-secondary-text">No tags found</td></tr></tbody>\n\n    <tbody ng-hide="mmsTags.length"><tr><td colspan="3" class="ve-secondary-text">No tags in current project.</td></tr></tbody>\n\n    <thead>\n        <tr>\n            <td><h3 class="Branch-icon">Branch</h3></td>\n            <td><h3>Created</h3></td>\n            <td ng-if="isDoc && docEditable && showMerge"></td>\n        </tr>\n    </thead>\n    <tbody ng-show="filteredBranches.length">\n        <tr ng-repeat="branch in filteredBranches = (mmsBranches | orderBy:\'-_created\' | filter: {name : refFilter})">\n            <td>\n                <a ui-sref="{refId: branch.id}"><b>{{branch.name}}</b></a>\n                <div>{{branch.description}}</div>\n            </td>\n            <td class="ve-secondary-text">{{branch._created | date:\'M/d/yy h:mm a\'}}</td>\n            <td ng-if="isDoc && docEditable && showMerge">\n                <div class="btn-group" uib-dropdown is-open="status.isopen">\n                    <button type="button" class="btn btn-default" uib-dropdown-toggle ng-disabled="disabled" title="Branch actions">\n                        <i class="fa fa-ellipsis-v"></i>\n                    </button>\n                    <ul class="dropdown-menu pull-right" uib-dropdown-menu role="menu" aria-labelledby="single-button">\n                        <li role="menuitem" style="padding:10px;">\n                            <button class="btn btn-default btn-sm" ng-class="{\'disabled\': !docEditable || !runCleared}" ng-click="docMergeAction(branch)">\n                                Pull In<i ng-show="!runCleared" class="fa fa-spin fa-spinner"></i>\n                            </button> to this document on current branch\n                        </li>\n                    </ul>\n                </div>\n            </td>\n        </tr>\n    </tbody>\n    <tbody><tr ng-hide="filteredBranches.length"><td colspan="3" class="ve-secondary-text">No branches found</td></tr></tbody>\n</table>')}]),angular.module("mms/templates/mmsSearch.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mmsSearch.html",'<div class="mms-search">\n    <div class="search-header" ng-class="{searchresults : searchResults}">\n        <div class="mms-search-input" ng-hide="advanceSearch || advancedSearchResults">\n            <form class="form-inline basic-search-form" ng-submit="newSearch(mainSearch)">\n                \x3c!-- search type menu --\x3e\n                <div class="form-group fixed-content-m">\n                    <label class="sr-only" for="searchTypeSelect">Search type menu</label>\n                    <div class="btn-group ve-light-dropdown" uib-dropdown keyboard-nav is-open="mainSearchType.isopen">\n                        <button id="searchTypeSelect" class="dropdown-toggle" type="button" uib-dropdown-toggle>\n                            {{mainSearch.searchType.label}}&nbsp;<i class="fa fa-caret-down" aria-hidden="true"></i>\n                        </button>\n                        <ul class="dropdown-menu" uib-dropdown-menu role="menu" aria-labelledby="searchTypeSelect">\n                            <li ng-click="mainSearch.searchType = type;" ng-repeat="type in fieldTypeList"\n                                ng-class="{\'checked-list-item\': type.id === mainSearch.searchType.id}">\n                                <a>{{ type.label }}</a>\n                            </li>\n                        </ul>\n                    </div>\n                </div>\n                \x3c!-- search keyword input --\x3e\n                <div class="form-group" ng-show="mainSearch.searchType.id != \'metatype\'">\n                    <label class="sr-only" for="searchInput">Search keyword</label>\n                    <input class="search-input" type="text" id="searchInput" ng-model="mainSearch.searchText" autofocus/>\n                </div>\n                <div class="form-group" ng-if="mainSearch.searchType.id === \'metatype\'">\n                    <label class="sr-only" for="searchMetatypeSelect">Search metatype menu</label>\n                    <div id="searchMetatypeSelect" ng-dropdown-multiselect="" options="metatypeList" selected-model="mainSearch.selectedSearchMetatypes" extra-settings="metatypeSettings"></div>\n                </div>\n                <button class="btn btn-primary" type="button" ng-click="newSearch(mainSearch)">\n                    <span class="btn-text">Search</span> <i ng-if="searchLoading" class="fa fa-spin fa-spinner"></i>\n                </button>\n            </form>\n            <div>\n                <input type="checkbox" ng-model="docsviews.selected"> Search for Views and Documents\n                <a class="pull-right" ng-click="advanceSearch = !advanceSearch">Advanced Search</a>\n            </div>\n        </div>\n\n        <div class="mms-search-input" ng-show="advanceSearch">\n            <div class="misc-form-field search-nav-back">\n                <a ng-click="advanceSearch = !advanceSearch"><i class="fa fa-arrow-left"></i>Basic Search</a>\n            </div>\n            \x3c!-- submit change --\x3e\n            <form class="form-inline advanced-query" ng-submit="newSearch(mainSearch)">\n                \x3c!-- advanced search query input disabled --\x3e\n                <h3 class="fixed-content-m">Advanced Search</h3>\n                <div class="form-group">\n                    <label class="sr-only" for="searchQuery">Advanced search query (disabled)</label>\n                    <input class="search-input disabled-input" type="text" id="searchQuery" ng-model="stringQuery" disabled />\n                </div>\n                <button class="btn btn-primary" type="button" ng-click="newSearch(mainSearch)">\n                    <span class="btn-text">Search</span> <i ng-if="searchLoading" class="fa fa-spin fa-spinner"></i>\n                </button>\n            </form>\n\n            <div class="form-inline" style="justify-content: flex-end">\n                <div class="form-group fixed-content-s">\n                </div>\n                \x3c!-- search type menu --\x3e\n                <div class="form-group fixed-content-m">\n                    <label class="sr-only" for="searchTypeSelectAdvance">Search type menu</label>\n                    <div class="btn-group ve-light-dropdown" uib-dropdown keyboard-nav is-open="mainSearchType.isopen2">\n                        <button id="searchTypeSelectAdvance" class="dropdown-toggle" type="button" uib-dropdown-toggle>\n                            {{mainSearch.searchType.label}}&nbsp;<i class="fa fa-caret-down" aria-hidden="true"></i>\n                        </button>\n                        <ul class="dropdown-menu" uib-dropdown-menu role="menu" aria-labelledby="searchTypeSelectAdvance">\n                            <li ng-click="mainSearch.searchType = type; stringQueryUpdate()" ng-repeat="type in fieldTypeList"\n                                ng-class="{\'checked-list-item\': type.id === mainSearch.searchType.id}">\n                                <a>{{ type.label }}</a>\n                            </li>\n                        </ul>\n                    </div>\n                </div>\n                \x3c!-- search keyword input --\x3e\n                <div class="form-group" ng-show="mainSearch.searchType.id != \'metatype\'">\n                    <label class="sr-only" for="searchText">Advanced search query</label>\n                    <input class="search-input" type="text" id="searchText" ng-model="mainSearch.searchText" ng-change="stringQueryUpdate()" autofocus/>\n                </div>\n                \x3c!-- metatype multiselect --\x3e\n                <div class="form-group" ng-if="mainSearch.searchType.id === \'metatype\'">\n                    <label class="sr-only" for="searchMetatypeSelectAdvance">Search metatype menu</label>\n                    <div id="searchMetatypeSelectAdvance" ng-dropdown-multiselect="" options="metatypeList" selected-model="mainSearch.selectedSearchMetatypes" extra-settings="metatypeSettings" events="multiselectEvent"></div>\n                </div>\n            </div>\n\n            \x3c!-- Advanced search rows --\x3e\n            <div ng-repeat="row in advanceSearchRows">\n                <div class="form-inline">\n                    \x3c!-- operator --\x3e\n                    <div class="form-group fixed-content-s">\n                        <label class="sr-only" for="operator-{{$index}}">Search row operator</label>\n                        <div class="btn-group ve-light-dropdown" uib-dropdown keyboard-nav is-open="row.operatorisopen">\n                            <button id="operator-{{$index}}" class="dropdown-toggle" type="button" uib-dropdown-toggle>\n                                {{row.operator}}&nbsp;<i class="fa fa-caret-down" aria-hidden="true"></i>\n                            </button>\n                            <ul class="dropdown-menu" uib-dropdown-menu role="menu" aria-labelledby="operator-{{$index}}">\n                                <li ng-click="row.operator = value; stringQueryUpdate()" ng-repeat="(key, value) in operatorList"\n                                    ng-class="{\'checked-list-item\': value === row.operator}">\n                                    <a>{{ value }}</a>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                    \x3c!-- row search type menu --\x3e\n                    <div class="form-group fixed-content-m">\n                        <label class="sr-only" for="searchTypeSelect-{{$index}}">Search type menu</label>\n                        <div class="btn-group ve-light-dropdown" uib-dropdown keyboard-nav is-open="row.isopen">\n                            <button id="searchTypeSelect-{{$index}}" class="dropdown-toggle" type="button" uib-dropdown-toggle>\n                                {{row.searchType.label}}&nbsp;<i class="fa fa-caret-down" aria-hidden="true"></i>\n                            </button>\n                            <ul class="dropdown-menu" uib-dropdown-menu role="menu" aria-labelledby="searchTypeSelect-{{$index}}">\n                                <li ng-click="row.searchType = type; stringQueryUpdate()" ng-repeat="type in fieldTypeList"\n                                    ng-class="{\'checked-list-item\': type.id === row.searchType.id}">\n                                    <a>{{ type.label }}</a>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                    \x3c!-- row search keyword input --\x3e\n                    <div class="form-group" ng-show="row.searchType.id != \'metatype\'">\n                        <label class="sr-only" for="searchText-{{$index}}">Advanced search query</label>\n                        <input class="search-input" type="text" id="searchText-{{$index}}" ng-model="row.searchText" ng-change="stringQueryUpdate()" autofocus/>\n                    </div>\n                    \x3c!-- row metatype multiselect --\x3e\n                    <div class="form-group" ng-if="row.searchType.id === \'metatype\'">\n                        <label class="sr-only" for="searchMetatypeSelect-{{$index}}">Search metatype menu</label>\n                        <div id="searchMetatypeSelect-{{$index}}" ng-dropdown-multiselect="" options="metatypeList" selected-model="row.selectedSearchMetatypes" extra-settings="metatypeSettings" events="multiselectEvent"></div>\n                    </div>\n                    \x3c!-- remove row button --\x3e\n                    <a type="button" ng-click="removeRowAdvanceSearch(row)" class="btn btn-secondary">\n                        <i class="fa fa-times"></i>\n                    </a>\n                </div>\n            </div>\n            \x3c!-- add row button --\x3e\n            <a type="button" ng-click="addAdvanceSearchRow()" class="btn btn-secondary">\n                <i class="fa fa-plus"></i>&nbsp;Add Row\n            </a>\n            <div class="advanced-views-docs">\n                <input type="checkbox" ng-model="docsviews.selected"> Search for Views and Documents\n            </div>\n        </div>\n        <span class="close-button-container">\n            <span class="close-button" ng-if="mmsOptions.closeable" ng-click="closeSearch()">\n                <i tooltip-placement="left" uib-tooltip="Close Search"  class="fa fa-times"></i>\n            </span>\n        </span>\n\n        \x3c!-- <div ng-show="advancedSearchResults" class="mms-search-input"> --\x3e\n            \x3c!-- advanced search query input disabled --\x3e\n            \x3c!-- <div class="form-group">\n                <div class="misc-form-field search-nav-back">\n                    <a ng-click="advancedSearchResults = !advancedSearchResults"><i class="fa fa-arrow-left"></i>Basic Search</a>\n                </div>\n                <form class="form-inline" ng-submit="newSearch(mainSearch)"> --\x3e\n                    \x3c!-- advanced search query input disabled --\x3e\n                    \x3c!-- <h3 class="fixed-content-m">Advanced Search</h3>\n                    <label class="sr-only" for="searchText">Advanced search query (disabled)</label>\n                    <span ng-click="modifyAdvanceSearch()" class="search-input disabled-input-container">\n                        <input class="search-input disabled-input form-group" type="text" id="searchText" ng-model="stringQuery" disabled />\n                    </span>\n                    <a ng-click="modifyAdvanceSearch()">Modify</a>\n                </form>\n            </div>\n        </div> --\x3e\n    </div>\n    <div class="slide-animate" ng-include="\'mms/templates/mmsSearchResults.html\'"></div>\n    <div class="container-fluid search-nav">\n        <a ng-show="currentPage > 0" ng-click="prevPage()">&lt; Prev</a>\n        <a ng-show="searchResults.length > 0 && currentPage < maxPages" class="pull-right" ng-click="nextPage()">Next ></a>\n    </div>\n\n    <div class="container-no-results container-fluid" ng-show="searchResults.length === 0 && !searchLoading">\n        <h3>No Results Found.</h3>\n    </div>\n</div>\n')}]),angular.module("mms/templates/mmsSearchResults.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mmsSearchResults.html",'<div id="ve-search-results" class="misc-form-field results-count" ng-hide="searchLoading || !paginationCache.length">\n    <div class="ve-search-filter" ng-hide="!showFilterOptions">\n        <span class="label-for-filter ve-secondary-text">FILTER: </span>\n        <div class="btn-group btn-group-sm" role="group"  aria-label="mms-search-results-filter">\n            <button type="button" ng-repeat="item in filterOptions" ng-click="filterSearchResults(item.type)"\n            title="Filter {{item.display}}" class="btn ve-btn-group-default {{item.icon}}"\n            ng-class="{\'active\': getActiveFilterClass(item.type)}">{{item.display}}</button>\n        </div>\n    </div>\n\n    <div class="ve-secondary-text">Showing <b>{{searchResults.length}}</b> \x3c!--of {{searchResults.length}} --\x3esearch results. (Page {{currentPage + 1}})</div>\n</div>\n\n\n<div class="search-results" ng-show="searchResults.length > 0">\n    <div class="elem-wrapper" ng-repeat="elem in filteredElms = (searchResults)">\n        <div class="elem-name-wrapper">\n            <span class="{{ getTypeClass(elem) }}"></span>\n            <a class="elem-name" ng-click="userResultClick(elem, \'name\')">{{elem.name}}</a>\n            <a class="elem-name" ng-show="elem.type == \'Slot\'" ng-click="userResultClick(elem, \'name\')">\n                <mms-transclude-name mms-element-id="{{elem.definingFeatureId}}" mms-project-id="{{elem._projectId}}" mms-ref-id="{{elem._refId}}" no-click="true"></mms-transclude-name>\n            </a>\n        </div>\n        <div class="elem-qualified-name-wrapper">\n            <div ng-click="expandQualifiedName($event, elem._qualifiedName);" class="elem-qualified-name">\n                {{qualifiedNameFormatter(elem._qualifiedName)}}\n            </div>\n        </div>\n        <div ng-if="elem.type === \'Diagram\' && elem._artifactIds">\n            <mms-transclude-img ng-click="userResultClick(elem, \'img\')" mms-element-id="{{elem.id}}" mms-project-id="{{elem._projectId}}" mms-ref-id="{{elem._refId}}"></mms-transclude-img>\n        </div>\n        <div class="elem-documentation-wrapper">\n            <label>Documentation</label>\n            <div class="elem-documentation">\n                <a ng-show="elem.documentation" ng-bind-html="elem.documentation | limitTo:270" ng-click="userResultClick(elem, \'doc\')"></a><span class="ellipses">{{elem.documentation.length > 270 ? \' ...\' : \'\'}}</span>\n                <span><a ng-show="!elem.documentation" ng-click="userResultClick(elem, \'doc\')">\n                  {{emptyDocTxt}}\n                  </a></span>\n            </div>\n        </div>\n        <div ng-if="(elem.type === \'Property\' || elem.type === \'Port\') && elem.defaultValue">\n            <label>Value</label>\n            <div class="elem-properties">\n                <a ng-click="userResultClick(elem, \'val\')">\n                    {{elem.defaultValue.value + \'\' | limitTo:250 || elem.defaultValue.body[0] | limitTo:250 || \'Default Value\'}}<span class="ellipses">{{(elem.defaultValue.body[0] && elem.defaultValue.body.length > 1 || val.value.length > 250) ? \' ...\' : \'\' }}</span>\n                </a>\n            </div>\n        </div>\n        <div ng-if="elem.type === \'Slot\' && elem.value">\n            <label>Value</label>\n            <div class="elem-properties">\n                <a ng-click="userResultClick(elem, \'val\')">\n                    <span ng-repeat="val in elem.value">\n                        {{val.value + \'\' | limitTo:250 || val.body[0] | limitTo:250 || \'Default Value\'}}<span class="ellipses">{{(val.body[0] && val.body.length > 1 || val.value.length > 250) ? \' ...\' : \'\' }}</span>{{$last ? \'\' : \', \'}}\n                    </span>\n                </a>\n            </div>\n        </div>\n        <div ng-if="elem.type === \'Constraint\'">\n            <label>Specification</label>\n            <div class="elem-specification">\n                <a ng-click="userResultClick(elem, \'val\')">\n                    {{elem.specification.value + \'\' || \'Constraint Specification\'}}\n                </a>\n            </div>\n            <a ng-click="userResultClick(elem, \'val\')">\n                <div ng-repeat="str in elem.specification.body">\n                    <div class="elem-specification">{{str}}</div>\n                </div>\n            </a>\n        </div>\n        <div ng-if="elem._properties[0]" class="elem-properties-wrapper ve-search">\n            <label>Properties</label>\n            <table>\n                <tr ng-repeat="property in elem._properties | limitTo : limitForProps">\n                    <td>\n                        {{property.name}}<span ng-if="property.type === \'Slot\'"><mms-transclude-name mms-element-id="{{property.definingFeatureId}}" mms-project-id="{{elem._projectId}}" mms-ref-id="{{elem._refId}}" no-click="true"></mms-transclude-name></span>: \n                    </td>\n                    <td>\n                        <a ng-click="userResultClick(property, \'val\')">{{property.defaultValue.value | limitTo:300}}\n                            <span ng-if="property.type === \'Slot\'" ng-repeat="val in property.value | limitTo:4">\n                                <span ng-bind-html="val.value | limitTo:300"></span>\n                                <span ng-bind-html="val.body[0] | limitTo:300"></span>\n                                <span ng-if="!val.value && !val.body[0]">Default Value</span>\n                            </span>\n                            \x3c!-- set variable for limit --\x3e\n                            <span ng-if="property.value.length > 4 || property.defaultValue.value.length > 300">...</span>\n                        </a>\n                    </td>\n                </tr>\n                <tr class="visibility-toggle" ng-show="elem._properties.length > 6">\n                    <td></td>\n                    <td>\n                        <a ng-click="showSearchResultProps = !showSearchResultProps; showSearchResultProps ? switchText=\'Less\' : switchText=\'More\'; showSearchResultProps ? limitForProps=50 : limitForProps=6" ng-class="{active: showSearchResultProps}">{{switchText}}</a>\n                    </td>\n                </tr>\n            </table>\n        </div>\n        <div ng-if="elem.allRelatedDocuments.length > 0" class="elem-related-docs-wrapper">\n            <label>Related Documents</label>\n            \x3c!-- show no more than three related views here--\x3e\n            <div ng-repeat="doc in elem.someRelatedDocuments" class="elem-documentation">\n                <mms-view-link suppress-numbering="true" mms-project-id="{{elem._projectId}}" mms-ref-id="{{elem._refId}}" mms-doc-id="{{doc.relatedDocument.id}}" mms-element-id="{{doc.relatedDocument.id}}" ng-click="userRelatedClick($event, doc.relatedDocument, doc.relatedDocument, elem)"></mms-view-link>\n                > <mms-view-link suppress-numbering="true" mms-project-id="{{elem._projectId}}" mms-ref-id="{{elem._refId}}" mms-doc-id="{{doc.relatedDocument.id}}" mms-element-id="{{doc.relatedView.id}}" ng-click="userRelatedClick($event, doc.relatedDocument, doc.relatedView, elem)"></mms-view-link><br/>\n            </div>\n\n            \x3c!-- show the remaining related views when users click on "More" --\x3e\n            <div ng-if="elem.remainingRelatedDocuments">\n                <div ng-repeat="doc in elem.remainingRelatedDocuments" class="elem-documentation">\n                    <mms-view-link suppress-numbering="true" mms-project-id="{{elem._projectId}}" mms-ref-id="{{elem._refId}}" mms-doc-id="{{doc.relatedDocument.id}}" mms-element-id="{{doc.relatedDocument.id}}" ng-click="userRelatedClick($event, doc.relatedDocument, doc.relatedDocument, elem)"></mms-view-link>\n                    > <mms-view-link suppress-numbering="true" mms-project-id="{{elem._projectId}}" mms-ref-id="{{elem._refId}}" mms-doc-id="{{doc.relatedDocument.id}}" mms-element-id="{{doc.relatedView.id}}" ng-click="userRelatedClick($event, doc.relatedDocument, doc.relatedView, elem)"></mms-view-link><br/>\n                </div>\n            </div>\n\n            <div class="show-more-container" ng-if="!elem.remainingRelatedDocuments && elem.allRelatedDocuments.length > elem.someRelatedDocuments.length">\n                <a class="show-more-btn" ng-click="showMoreRelatedViews(elem);"> {{(elem.allRelatedDocuments.length - elem.someRelatedDocuments.length) + \' More\'}}\n                </a>\n            </div>\n\n        </div>\n        <div ng-if="elem.type != \'InstanceSpecification\'">\n            <label>Metatypes</label>\n            <div class="elem-type-wrapper">\n                <span class="elem-type">{{elem.type}}</span>\n                <span ng-if="elem._appliedStereotypeIds.length">\n                    <span ng-repeat="type in elem._appliedStereotypeIds">\n                        <mms-transclude-name class="elem-type" mms-element-id="{{type}}" mms-project-id="{{elem._projectId}}" mms-ref-id="{{elem._refId}}" no-click="true"></mms-transclude-name>\n                    </span>\n                </span>\n            </div>\n        </div>\n        <div class="elem-updated-wrapper">\n            <div>Last modified {{elem._modified | date:\'M/d/yy h:mm a\'}} by <b>{{elem._modifier}}</b></div>\n        </div>\n    </div>\n</div>\n')}]),angular.module("mms/templates/mmsSpec.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mmsSpec.html",'\x3c!-- HTML for edit mode --\x3e\n<div ng-if="!noEdit && editing" class="editing">\n\n    <h1 class="prop" ng-if="edit.name !== undefined"><input class="form-control ve-plain-input" type="text" ng-model="edit.name"></h1>\n    <span class="elem-updated-wrapper">Last modified {{element._modified | date:\'M/d/yy h:mm a\'}} by <b>{{element._modifier}}</b></span>\n\n    <div ng-if="edit.type === \'Property\' || edit.type === \'Port\' || edit.type === \'Slot\'">\n        <h2 class="prop-title spec-view-value-heading">Property Value</h2>\n        <div ng-if="!isEnumeration">\n            <div ng-if="editValues.length == 0">\n                <select ng-model="addValueType" ng-options="key for (key, value) in addValueTypes"></select>\n                <button class="btn btn-sm btn-default" ng-click="addValue(addValueType)">Add</button>\n            </div>\n            <div ng-repeat="value in editValues" ng-switch on="value.type" ng-form="valForm">\n                <div ng-switch-when="LiteralInteger" ng-class="{\'has-error\': valForm.$error.pattern}">\n                    <div class="form-inline">\n                    <input class="form-control ve-plain-input" type="number" ng-model="value.value" ng-pattern="/^-?\\d+$/" ng-blur="cleanupVal(value)">&nbsp;\n                    <a ng-if="!$first" ng-click="removeVal($index)"><i class="fa fa-close"></i></a>\n                    </div>\n                    <label class="control-label mms-error-icon" ng-show="valForm.$error.pattern">Not a valid integer</label>\n                </div>\n                <div ng-switch-when="LiteralUnlimitedNatural" ng-class="{\'has-error\': valForm.$error.pattern}">\n                    <div class="form-inline">\n                    <input class="form-control ve-plain-input" type="number" name="natVal" ng-model="value.value" ng-pattern="/^\\d+$/" ng-blur="cleanupVal(value)">&nbsp;\n                    <a ng-if="!$first" ng-click="removeVal($index)"><i class="fa fa-close"></i></a>\n                    </div>\n                    <label class="control-label mms-error-icon" ng-show="valForm.$error.pattern">Not a valid natural number</label>\n                </div>\n                <div ng-switch-when="LiteralBoolean"><input type="checkbox" ng-model="value.value">&nbsp;{{value.value}}&nbsp;<a ng-if="!$first" ng-click="removeVal($index)"><i class="fa fa-close"></i></a></div>\n                <div ng-switch-when="LiteralReal">\n                    <div class="form-inline">\n                        <input class="form-control ve-plain-input" type="number" ng-model="value.value" step="any"><a ng-if="!$first" ng-click="removeVal($index)">&nbsp;<i class="fa fa-close"></i></a>\n                    </div>\n                </div>\n                <div ng-switch-when="LiteralString">\n                    <textarea ng-if="hasHtml(value.value)" mms-ckeditor ng-model="value.value" mms-project-id="{{element._projectId}}" mms-ref-id="{{element._refId}}" mms-element-id="{{element.id}}" autosave-key="{{element._projectId + element._refId + element.id + \'index:\' + $index}}"></textarea>\n                    <div ng-if="!hasHtml(value.value)"><textarea ng-model="value.value"></textarea><a ng-click="addHtml(value)"><i class="fa fa-html5"></i></a></div>\n                    <a ng-if="!$first" ng-click="removeVal($index)"><i class="fa fa-close"></i></a>\n                </div>\n                <div ng-switch-when="OpaqueExpression">\n                    <textarea ng-model="value.body[0]"></textarea><a ng-if="!$first" ng-click="removeVal($index)"><i class="fa fa-close"></i></a>\n                </div>\n                <div ng-switch-default>Editing not supported for now</div>\n            </div>\n            <div ng-if="editValues.length != 0 && isSlot">\n                <button class="btn btn-sm btn-default" ng-click="addValue(editValues[0].type)">Add</button>\n            </div>\n        </div>\n        <div ng-if="isEnumeration" ng-repeat="val in editValues">\n            <select ng-model="val.instanceId" ng-options="el.id as el.name for el in options">\n            </select><a ng-if="!$first" ng-click="removeVal($index)"><i class="fa fa-close"></i></a>\n        </div>\n        <div ng-if="(isSlot || editValues.length == 0) && isEnumeration">\n            <button class="btn btn-sm btn-default" ng-click="addEnumerationValue()">Add</button>\n        </div>\n    </div>\n\n    <div ng-if="edit.type === \'Constraint\'">\n        <h2 class="prop-title spec-view-value-heading">Constraint Specification</h2>\n        <div ng-switch on="editValues[0].type">\n            <div ng-switch-when="LiteralInteger"><input class="form-control ve-plain-input" type="number" ng-model="editValues[0].value"></div>\n            <div ng-switch-when="LiteralUnlimitedNatural"><input class="form-control ve-plain-input" type="number" ng-model="editValues[0].value"></div>\n            <div ng-switch-when="LiteralBoolean"><input type="checkbox" ng-model="editValues[0].value"></div>\n            <div ng-switch-when="LiteralReal"><input class="form-control ve-plain-input" type="number" ng-model="editValues[0].value" step="any"></div>\n            <div ng-switch-when="LiteralString">\n                <textarea ng-model="editValues[0].value"></textarea>\n            </div>\n            <div ng-switch-when="OpaqueExpression">\n                <textarea ng-model="editValues[0].body[0]"></textarea>\n            </div>\n            <div ng-switch-default>Editing not supported for now</div>\n        </div>\n    </div>\n\n    <h2 class="prop-title spec-view-doc-heading">Documentation</h2>\n    <textarea ng-model="edit.documentation" mms-ckeditor mms-editor-api="editorApi" mms-project-id="{{element._projectId}}" mms-ref-id="{{element._refId}}" autosave-key="{{element._projectId + element._refId + element.id}}"></textarea>\n\n    <h2 class="prop-title spec-view-type-heading">Metatypes</h2>\n    <span class="elem-type-wrapper prop">\n        <span class="elem-type">{{element.type}}</span>\n        <div ng-repeat="type in element._appliedStereotypeIds" class="prop elem-type"><mms-transclude-name mms-element-id="{{type}}" mms-project-id="{{mmsProjectId}}" mms-ref-id="{{mmsRefId}}" no-click="true"></mms-transclude-name></div>\n    </span>\n    <h2 class="prop-title">Location</h2>\n    <span class="prop">{{element._qualifiedName}}</span>\n    <h2 class="prop-title">ID</h2>\n    <span class="prop id">{{element.id}}</span>\n    <h2 class="prop-title">Branch/Tag</h2>\n    <span class="prop">{{element._refId}}</span>\n    <h2 class="prop-title">Project</h2>\n    <span class="prop">{{element._projectId}}</span>\n    <h2 class="prop-title">Formatted Modified Time</h2>\n    <span class="prop">{{element._modified}}</span>\n    <h2 class="prop-title">Commit</h2>\n    <span class="prop">{{element._commitId}}</span>\n</div>\n\x3c!-- HTML for view mode --\x3e\n<div ng-hide="editing" class="reading">\n    <p class="text-center" ng-show="gettingSpec"><i class="fa fa-3x fa-spin fa-spinner"></i></p>\n\n    <div ng-hide="gettingSpec">\n        <div class="text-warning" ng-if="mmsDisplayOldContent">\n            <b> Element not found:</b> displaying last found content\n        </div>\n        <h1 class="prop element-title" ng-class="{\'mms-error\': mmsDisplayOldContent}"><span class="{{ elementTypeClass }}"></span>{{element.name}}</h1>\n        <span class="elem-updated-wrapper">Last modified {{element._modified | date:\'M/d/yy h:mm a\'}} by <b>{{element._modifier}}</b></span>\n\n        <div ng-if="element.type === \'Property\' || element.type === \'Port\' || element.type === \'Slot\'">\n            <h2 class="prop-title spec-view-value-heading">Property Value</h2>\n            <div ng-repeat="value in values" ng-switch on="value.type">\n                <span class="prop" ng-switch-when="LiteralInteger">{{value.value}}</span>\n                <span class="prop" ng-switch-when="LiteralBoolean">{{value.value}}</span>\n                <span class="prop" ng-switch-when="LiteralReal">{{value.value | veRealNum}}</span>\n                <span class="prop" ng-switch-when="LiteralUnlimitedNatural">{{value.value}}</span>\n                <span class="prop" ng-switch-when="LiteralString" ng-bind-html="value.value"></span>\n                <span class="prop" ng-switch-when="ElementValue"><mms-transclude-name mms-watch-id="true" mms-element-id="{{value.elementId}}" mms-project-id="{{mmsProjectId}}" mms-ref-id="{{mmsRefId}}"></mms-transclude-name></span>\n                <span class="prop" ng-switch-when="InstanceValue"><mms-transclude-name mms-watch-id="true" mms-element-id="{{value.instanceId}}" mms-project-id="{{mmsProjectId}}" mms-ref-id="{{mmsRefId}}"></mms-transclude-name></span>\n                <span class="prop" ng-switch-when="OpaqueExpression">{{value.body[0]}}</span>\n                <span class="prop" ng-switch-default>{{value}}</span>\n            </div>\n            <h2 class="prop-title spec-view-value-heading">Property Type</h2>\n            <span class="prop" ng-if="element.type === \'Property\'"><mms-transclude-name mms-watch-id="true" mms-element-id="{{element.typeId}}" mms-project-id="{{mmsProjectId}}" mms-ref-id="{{mmsRefId}}" click-handler="propertyTypeClicked(element.typeId)"></mms-transclude-name></span>\n            <span class="prop" ng-if="element.type === \'Slot\'"><mms-transclude-name mms-watch-id="true" mms-element-id="{{element.definingFeatureId}}" mms-project-id="{{mmsProjectId}}" mms-ref-id="{{mmsRefId}}" click-handler="propertyTypeClicked(element.definingFeatureId)"></mms-transclude-name></span>\n        </div>\n\n        <div ng-if="element.type === \'Generalization\' || element.type === \'Dependency\'">\n            <h2 class="prop-title">Source</h2>\n            <span class="prop"><mms-transclude-name mms-watch-id="true" mms-element-id="{{element._sourceIds[0]}}" mms-project-id="{{mmsProjectId}}" mms-ref-id="{{mmsRefId}}"></mms-transclude-name></span>\n            <h2 class="prop-title">Target</h2>\n            <span class="prop"><mms-transclude-name mms-watch-id="true" mms-element-id="{{element._targetIds[0]}}" mms-project-id="{{mmsProjectId}}" mms-ref-id="{{mmsRefId}}"></mms-transclude-name></span>\n        </div>\n\n        <div ng-if="element.type === \'Connector\'">\n            <h2 class="prop-title">Path 1</h2>\n            <span class="prop" ng-repeat="path in element._propertyPathIds[0]"><mms-transclude-name mms-watch-id="true" mms-element-id="{{path}}" mms-project-id="{{mmsProjectId}}" mms-ref-id="{{mmsRefId}}"></mms-transclude-name></span>\n            <h2 class="prop-title">Path 2</h2>\n            <span class="prop" ng-repeat="path in element._propertyPathIds[1]"><mms-transclude-name mms-watch-id="true" mms-element-id="{{path}}" mms-project-id="{{mmsProjectId}}" mms-ref-id="{{mmsRefId}}"></mms-transclude-name></span>\n        </div>\n\n        <div ng-if="element.type === \'Association\'">\n            <h2 class="prop-title">Role 1</h2>\n            <span class="prop"><mms-transclude-name mms-watch-id="true" mms-element-id="{{element.memberEndIds[0]}}" mms-project-id="{{mmsProjectId}}" mms-ref-id="{{mmsRefId}}"></mms-transclude-name></span>\n            <h2 class="prop-title">Role 2</h2>\n            <span class="prop"><mms-transclude-name mms-watch-id="true" mms-element-id="{{element.memberEndIds[1]}}" mms-project-id="{{mmsProjectId}}" mms-ref-id="{{mmsRefId}}"></mms-transclude-name></span>\n        </div>\n\n        <div ng-if="element.type === \'Constraint\'">\n            <h2 class="prop-title">Constraint Specification</h2>\n            <div ng-switch on="values[0].type">\n                <span class="prop" ng-switch-when="LiteralInteger">{{values[0].value}}</span>\n                <span class="prop" ng-switch-when="LiteralBoolean">{{values[0].value}}</span>\n                <span class="prop" ng-switch-when="LiteralReal">{{values[0].value | veRealNum}}</span>\n                <span class="prop" ng-switch-when="LiteralUnlimitedNatural">{{values[0].value}}</span>\n                <span class="prop" ng-switch-when="LiteralString" ng-bind-html="values[0].value"></span>\n                <span class="prop" ng-switch-when="ElementValue"><mms-transclude-name mms-watch-id="true" mms-element-id="{{value.elementId}}" mms-project-id="{{mmsProjectId}}" mms-ref-id="{{mmsRefId}}"></mms-transclude-name></span>\n                <span class="prop" ng-switch-when="OpaqueExpression">{{values[0].body[0]}}</span>\n                <span class="prop" ng-switch-default>{{values}}</span>\n            </div>\n        </div>\n\n        <div ng-if="element.type === \'Diagram\' && element._artifactIds">\n            <mms-transclude-img mms-element-id="{{element.id}}" mms-ref-id="{{element._refId}}" mms-project-id="{{element._projectId}}" mms-commit-id="{{element._commitId}}"></mms-transclude-img>\n        </div>\n\n        <h2 class="prop-title spec-view-doc-heading">Documentation <a ng-click="showDocHTML = !showDocHTML"><i class="fa fa-code"></i></a></h2>\n        <p ng-show="!showDocHTML" class="doc-text">\n            <mms-cf mms-cf-type="doc" mms-element-id="{{element.id}}" mms-project-id="{{element._projectId}}" mms-ref-id="{{element._refId}}" mms-commit-id="{{element._commitId}}" mms-watch-id="true"></mms-cf>\n        </p>\n        <div ng-show="showDocHTML">{{element.documentation}}</div>\n\n        <div ng-if="relatedDocuments.length > 0">\n            <h2 class="prop-title">Used by Documents/Views</h2>\n            <span class="elem-related-docs-wrapper prop">\n                <div ng-repeat="relatedDocument in relatedDocuments">\n                    <span ng-repeat="relatedView in relatedDocument._parentViews">\n                        <mms-view-link suppress-numbering="true" mms-project-id="{{element._projectId}}" mms-ref-id="{{element._refId}}" mms-doc-id="{{relatedDocument.id}}" mms-element-id="{{relatedDocument.id}}" link-target="_blank" rel="noopener"></mms-view-link>\n                        > <mms-view-link suppress-numbering="true" mms-project-id="{{element._projectId}}" mms-ref-id="{{element._refId}}" mms-doc-id="{{relatedDocument.id}}" mms-element-id="{{relatedView.id}}" link-target="_blank" rel="noopener"></mms-view-link><br/>\n                    </span>\n                </div>\n            </span>\n        </div>\n\n        \x3c!-- <a ng-click="toggleAdvancedProperties = !toggleAdvancedProperties" class="visibility-toggle" ng-class="{active: toggleAdvancedProperties}" ng-init="toggleAdvancedProperties=false">Advanced</a>\n        <div ng-show="toggleAdvancedProperties"> --\x3e\n            <h2 class="prop-title">Metatypes</h2>\n            <span class="elem-type-wrapper prop">\n                <span class="elem-type">{{element.type}}</span>\n                <div ng-repeat="type in element._appliedStereotypeIds" class="elem-type"><mms-transclude-name mms-element-id="{{type}}" mms-project-id="{{mmsProjectId}}" mms-ref-id="{{mmsRefId}}" no-click="true"></mms-transclude-name></div>\n            </span>\n\n            <div ng-if="element.type === \'InstanceSpecification\'">\n                <h2 class="prop-title">Classifiers</h2>\n                <span class="prop" ng-repeat="path in element.classifierIds"><mms-transclude-name mms-watch-id="true" mms-element-id="{{path}}" mms-project-id="{{mmsProjectId}}" mms-ref-id="{{mmsRefId}}"></mms-transclude-name></span>\n            </div>\n\n            <h2 class="prop-title">Location</h2>\n            <span class="prop">{{element._qualifiedName}}</span>\n            <h2 class="prop-title">ID&nbsp;\n                <button ng-click="copyToClipboard($event, \'#spec-element-id\')" class="btn btn-sm btn-default" uib-tooltip="Copy ID">\n                    <i class="fa fa-copy"></i>\n                </button>\n            </h2>\n            <span class="prop id" title="Copy ID">\n                <span id="spec-element-id" ng-click="copyToClipboard($event, \'#spec-element-id\')">{{element.id}}</span>\n            </span>\n            <h2 class="prop-title">Branch/Tag</h2>\n            <span class="prop">{{element._refId}}</span>\n            <h2 class="prop-title">Project</h2>\n            <span class="prop">{{element._projectId}}</span>\n            <h2 class="prop-title">Formatted Modified Time</h2>\n            <span class="prop">{{element._modified}}</span>\n            <h2 class="prop-title">Commit</h2>\n            <span class="prop" title="View raw element data">\n                <a target="_blank" rel="noopener noreferrer" ng-href="{{elementDataLink}}">\n                    {{element._commitId}}&nbsp;<i class="fa fa-external-link" aria-hidden="true"></i>\n                </a>\n            </span>\n        \x3c!-- </div> --\x3e\n    </div>\n</div>\n')}]),angular.module("mms/templates/mmsToolbar.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mmsToolbar.html",'<div class="right-toolbar">\n    <div class="toolbox">\n        <div ng-repeat="button in buttons | filter: {active: true, permission: true} | orderBy:\'priority\'">\n            <a class="tools {{button.id}}"\n               ng-class="{selected: button.selected, dynamic: button.dynamic, pulldown: button.pullDown}"\n               ng-click="clicked(button)" uib-tooltip="{{button.tooltip}}" tooltip-trigger="mouseenter"\n               tooltip-popup-delay="100" tooltip-placement="left" tooltip-append-to-body="true"><i\n                class="fa {{button.icon}}"></i></a>\n        </div>\n    </div>\n</div>\n')}]),angular.module("mms/templates/mmsTranscludeDoc.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mmsTranscludeDoc.html",'<div class="panel panel-default no-print">\n    <div class="panel-heading clearfix">\n        <h3 class="panel-title pull-left">\n            <form class="form-inline">\n            <div class="form-group">\n                <span class="pe-type-{{panelType}}">{{panelType}} :</span>\n                <span ng-if="!isDirectChildOfPresentationElement">{{panelTitle}}</span>\n                <span ng-if="isDirectChildOfPresentationElement"><input type="text" class="form-control" ng-model="edit.name"/></span>\n            </div></form>\n        </h3>\n        <div class="btn-group pull-right">\n            <mms-button-bar class="transclude-panel-toolbar" buttons="buttons" mms-bb-api="bbApi"></mms-button-bar>\n        </div>\n    </div>\n    <div class="panel-body no-padding-panel">\n        <textarea ng-model="edit.documentation" mms-ckeditor mms-editor-type="{{editorType}}" mms-editor-api="editorApi" mms-project-id="{{element._projectId}}" mms-ref-id="{{element._refId}}" autosave-key="{{element._projectId + element._refId + element.id}}"></textarea>\n    </div>\n</div>')}]),angular.module("mms/templates/mmsTranscludeName.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mmsTranscludeName.html",'<form class="input-group" ng-submit="save($event)">\n    <input type="text" class="form-control" ng-model="edit.name" aria-describedby="basic-addon2">\n\t<span class="input-group-addon transclude-name-label">Name</span>\n    <span class="input-group-addon" ng-click="save($event)" title="Save">\n        <i ng-if="!elementSaving" class="fa fa-save"></i>\n        <i ng-if="elementSaving" class="fa fa-spinner fa-spin"></i>\n    </span>\n    <span class="input-group-addon" ng-click="cancel($event)"><i class="fa fa-times" title="Cancel"></i></span>\n</form>\n')}]),angular.module("mms/templates/mmsTranscludeVal.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mmsTranscludeVal.html",'<span ng-repeat="value in ::values" ng-switch on="value.type">\n    <span ng-switch-when="LiteralInteger">{{::value.value}}</span>\n    <span ng-switch-when="LiteralBoolean">{{::value.value}}</span>\n    <span ng-switch-when="LiteralReal">{{::value.value | veRealNum}}</span>\n    <span ng-switch-when="LiteralUnlimitedNatural">{{::value.value}}</span>\n    <span ng-switch-when="ElementValue"><mms-transclude-name no-click="true" mms-element-id="{{::value.elementId}}" mms-project-id="{{projectId}}" mms-ref-id="{{refId}}" mms-commit-id="{{commitId}}"></mms-transclude-name></span>\n    <span ng-switch-when="InstanceValue"><mms-transclude-name no-click="true" mms-element-id="{{::value.instanceId}}" mms-project-id="{{projectId}}" mms-ref-id="{{refId}}" mms-commit-id="{{commitId}}"></mms-transclude-name></span>\n    <span ng-switch-when="OpaqueExpression">{{::value.body[0]}}</span>\n    <span ng-switch-default>{{::value}}</span>\n</span>')}]),angular.module("mms/templates/mmsTranscludeValEdit.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mmsTranscludeValEdit.html",'<div class="panel panel-info">\n    <span ng-repeat="value in editValues" ng-switch on="value.type">\n        <span ng-switch-when="LiteralInteger">{{value.value}}</span>\n        <span ng-switch-when="LiteralBoolean">{{value.value}}</span>\n        <span ng-switch-when="LiteralReal">{{value.value | veRealNum}}</span>\n        <span ng-switch-when="LiteralUnlimitedNatural">{{value.value}}</span>\n        <span ng-switch-when="ElementValue"><mms-transclude-name no-click="true" mms-element-id="{{::value.elementId}}" mms-project-id="{{projectId}}" mms-ref-id="{{refId}}" mms-commit-id="{{commitId}}"></mms-transclude-name></span>\n        <span ng-switch-when="InstanceValue"><mms-transclude-name no-click="true" mms-element-id="{{::value.instanceId}}" mms-project-id="{{projectId}}" mms-ref-id="{{refId}}" mms-commit-id="{{commitId}}"></mms-transclude-name></span>\n        <span ng-switch-when="OpaqueExpression">{{value.body[0]}}</span>\n        <span ng-switch-default>{{value}}</span>\n    </span>\n</div>')}]),angular.module("mms/templates/mmsTranscludeValFrame.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mmsTranscludeValFrame.html",'\x3c!-- Most of this code is borrowed from mmsSepc.html --\x3e\n<div class="panel panel-default no-print">\n    <div class="panel-heading clearfix">\n        <h3 class="panel-title pull-left">Value : {{element.name}}</h3>\n        <div class="btn-group pull-right">\n            <mms-button-bar class="transclude-panel-toolbar" buttons="buttons" mms-bb-api="bbApi"></mms-button-bar>\n        </div>\n    </div>\n    <div class="panel-body">\n        <div ng-if="!isEnumeration">\n            <div ng-if="editValues.length == 0">\n                <select ng-model="addValueType" ng-options="key for (key, value) in addValueTypes"></select>\n                <button class="btn btn-sm btn-default" ng-click="addValue(addValueType)">Add</button>\n            </div>\n            <span class="transclude-val" ng-repeat="value in editValues" ng-switch on="value.type" ng-form="valForm">\n                <div ng-switch-when="LiteralInteger" ng-class="{\'has-error\': valForm.$error.pattern}">\n                    <div class="form-inline">\n                    <input class="form-control ve-plain-input" type="number" name="intVal" ng-model="value.value" ng-pattern="/^-?\\d+$/" ng-blur="cleanupVal(value)">\n                    <a ng-if="!$first" ng-click="removeVal($index)"><i class="fa fa-close"></i></a>\n                    </div>\n                    <label class="control-label mms-error-icon" ng-show="valForm.$error.pattern">Not a valid integer</label>\n                </div>\n                <div ng-switch-when="LiteralUnlimitedNatural" ng-class="{\'has-error\': valForm.$error.pattern}">\n                    <div class="form-inline">\n                    <input class="form-control ve-plain-input" type="number" name="natVal" ng-model="value.value" ng-pattern="/^\\d+$/" ng-blur="cleanupVal(value)">\n                    <a ng-if="!$first" ng-click="removeVal($index)"><i class="fa fa-close"></i></a>\n                    </div>\n                    <label class="control-label mms-error-icon" ng-show="valForm.$error.pattern">Not a valid natural number</label>\n                </div>\n                <div ng-switch-when="LiteralBoolean"><input type="checkbox" ng-model="value.value">&nbsp;{{value.value}}&nbsp;<a ng-if="!$first" ng-click="removeVal($index)"><i class="fa fa-close"></i></a></div>\n                <div ng-switch-when="LiteralReal">\n                    <div class="form-inline">\n                    <input class="form-control ve-plain-input" type="number" ng-model="value.value" step="any">&nbsp;<a ng-if="!$first" ng-click="removeVal($index)"><i class="fa fa-close"></i></a>\n                    </div>\n                </div>\n                <div ng-switch-when="LiteralString">\n                    <textarea ng-if="hasHtml(value.value)" mms-ckeditor mms-project-id="{{element._projectId}}" mms-ref-id="{{element._refId}}" autosave-key="{{element._projectId + element._refId + element.id + \'index:\' + $index}}" ng-model="value.value"></textarea>\n                    <div ng-if="!hasHtml(value.value)"><textarea ng-model="value.value"></textarea><a ng-click="addHtml(value)"><i class="fa fa-html5"></i></a></div>\n                    <a ng-if="!$first" ng-click="removeVal($index)"><i class="fa fa-close"></i></a>\n                </div>\n                <div ng-switch-when="OpaqueExpression">\n                    <textarea ng-model="value.body[0]"></textarea><a ng-if="!$first" ng-click="removeVal($index)"><i class="fa fa-close"></i></a>\n                </div>\n                <div ng-switch-default>Editing not supported for now</div>\n            </span>\n            <div ng-if="editValues.length != 0 && isSlot">\n                <button class="btn btn-sm btn-default" ng-click="addValue(editValues[0].type)">Add</button>\n            </div>\n        </div>\n        \x3c!-- if enum and isslot repeat values in element --\x3e\n        <div ng-if="isEnumeration" ng-repeat="val in editValues">\n            <select ng-model="val.instanceId" ng-options="el.id as el.name for el in options"></select>\n            <a ng-if="!$first" ng-click="removeVal($index)"><i class="fa fa-close"></i></a>\n        </div>\n        <div ng-if="(isSlot || editValues.length == 0) && isEnumeration">\n            <button class="btn btn-sm btn-default" ng-click="addEnumerationValue()">Add</button>\n        </div>\n    </div>\n</div>\n\n\n')}]),angular.module("mms/templates/mmsTree.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mmsTree.html",'<ul class="nav nav-list nav-pills nav-stacked abn-tree">\n    <li ng-repeat="row in tree_rows | filter:{visible:true} track by row.branch.uid" ng-hide="!treeFilter(row, options.search)"\n        ng-class="\'level-\' + {{row.level}}" class="abn-tree-row">\n        <div class="arrow" ng-click="user_clicks_branch(row.branch)" ng-dblclick="user_dblclicks_branch(row.branch)" ng-class="{\'active-text\': row.branch.selected}" id="tree-branch-{{row.branch.data.id}}">\n            <div class="shaft" ng-class="{\'shaft-selected\': row.branch.selected, \'shaft-hidden\': !row.branch.selected}">\n                <a ng-href="{{getHref(row);}}" class="tree-item">\n                    <i ng-class="{\'active-text\': row.branch.selected}" ng-click="expandCallback(row, $event)" class="indented tree-icon {{row.expand_icon}}" ></i>\n                    <i ng-class="{\'active-text\': row.branch.selected}" class="indented tree-icon {{row.type_icon}}" ></i>\n                    <span class="indented tree-label" ng-class="{\'active-text\': row.branch.selected}">{{row.section}} {{row.branch.data.name}}</span>\n                </a>\n            </div>\n        </div>\n    </li>\n</ul>\n')}]),angular.module("mms/templates/mmsTsDiagram.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mmsTsDiagram.html",'<div class="tsTabPanel" id="{{containerId}}" style="width:95%;height:800px;" ></div>\n<div class="tsDrawingView" id="{{viewId}}" ></div>\n<div class="tsTreeView" id="{{controlsId}}" ></div>\n<div class="tsTableView" id="{{tableId}}" ></div>\n<div class="tsTableView" id="{{edgeTableId}}" ></div>\n<div class="tsInspectorView" id="{{inspectorId}}" ></div>\n')}]),angular.module("mms/templates/mmsView.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mmsView.html",'<div id="{{mmsElementId}}" ng-class="{landscape: view._printLandscape}">\n\n    <h1 ng-if="mmsLink" class="view-title">\n      <span class="ve-view-number">{{view._veNumber}}</span> <mms-view-link ng-class="{\'docTitle-underlined\': isHover}" mms-element-id="{{view.id}}" mms-doc-id="{{view.id}}"></mms-view-link>\n      <mms-view-link class="open-document" ng-mouseover="hoverIn()" ng-mouseleave="hoverOut()" mms-element-id="{{view.id}}" mms-doc-id="{{view.id}}" \n        link-text="Open Document" link-class="btn btn-primary no-print" mms-external-link="true" link-icon-class="fa fa-share"></mms-view-link>\n    </h1>\n\n    <h1 ng-if="!mmsLink" class="view-title h{{level}}">\n        <span class="ve-view-number">{{view._veNumber}}</span> <mms-transclude-name mms-element-id="{{view.id}}" mms-project-id="{{view._projectId}}" mms-ref-id="{{view._refId}}"></mms-transclude-name>\n    </h1>\n\n    <div class="ve-secondary-text last-modified no-print">\n      Last Modified: {{modified | date:\'M/d/yy h:mm a\'}} by <b>{{modifier}}</b>\n    </div>\n\n    <i ng-hide="view" class="fa fa-2x fa-spinner fa-spin"></i>\n\n    <div class="add-pe-button-container no-print" ng-init="$index = -1" ng-include="\'mms/templates/mmsAddPeButton.html\'"></div>\n    <div ng-if="view._contents">\n        \x3c!-- Cant use track by instanceVal.instance b/c of possible duplicate entries --\x3e\n        <div ng-repeat="instanceVal in view._contents.operand track by instanceVal.instanceId"> \n            <mms-view-presentation-elem data-mms-instance-val="::instanceVal"></mms-view-presentation-elem>\n            <div class="add-pe-button-container no-print" ng-include="\'mms/templates/mmsAddPeButton.html\'"></div>\n        </div>\n    </div>\n    <div ng-if="view.specification">\n        \x3c!-- Cant use track by instanceVal.instance b/c of possible duplicate entries --\x3e\n        <div ng-repeat="instanceVal in view.specification.operand track by instanceVal.instanceId"> \n            <mms-view-presentation-elem data-mms-instance-val="::instanceVal"></mms-view-presentation-elem>\n            <div class="add-pe-button-container no-print" ng-include="\'mms/templates/mmsAddPeButton.html\'"></div>\n        </div>\n    </div>\n</div>')}]),angular.module("mms/templates/mmsViewPresentationElem.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mmsViewPresentationElem.html",'<div ng-if="presentationElemLoading" class="fa fa-spinner fa-spin"></div>\n<div id="{{instanceSpec.id}}" ng-if="!presentationElemLoading" ng-switch on="presentationElem.type">\n    <mms-view-para class="read-width" data-mms-para="presentationElem" ng-switch-when="Paragraph"></mms-view-para>\n    <mms-view-table data-mms-table="presentationElem" mms-pe="instanceSpec" ng-switch-when="Table"></mms-view-table>\n    <mms-view-table-t class="read-width" data-mms-para="presentationElem" ng-switch-when="TableT"></mms-view-table-t>\n    <mms-view-list class="read-width" data-mms-list="presentationElem" ng-switch-when="List"></mms-view-list>\n    <mms-view-list-t class="read-width" data-mms-para="presentationElem" ng-switch-when="ListT"></mms-view-list-t>\n    <mms-view-img data-mms-image="presentationElem" mms-pe="instanceSpec" ng-switch-when="Image"></mms-view-img>\n    <mms-view-section data-mms-section="presentationElem" ng-switch-when="InstanceSpecification"></mms-view-section>\n    <mms-view-equation class="read-width" data-mms-para="presentationElem" ng-switch-when="Equation"></mms-view-equation>\n    <mms-view-figure class="read-width" data-mms-para="presentationElem" ng-switch-when="Figure"></mms-view-figure>\n    <mms-view-figure class="read-width" data-mms-para="presentationElem" ng-switch-when="ImageT"></mms-view-figure>\n    <mms-transclude-com class="read-width" mms-element-id="{{presentationElem.source}}" mms-project-id="{{instanceSpec._projectId}}" mms-ref-id="{{instanceSpec._refId}}" ng-switch-when="Comment"></mms-transclude-com>\n    <mms-view-plot data-mms-plot="presentationElem" ng-switch-when="Plot"></mms-view-plot>\n    <mms-ts-diagram mms-pe-id="{{instanceSpec.id}}" mms-project-id="{{instanceSpec._projectId}}" mms-ref-id="{{instanceSpec._refId}}" mms-tsp-spec="presentationElem" ng-switch-when="TomSawyerDiagram"></mms-ts-diagram>\n</div>')}]),angular.module("mms/templates/mmsViewReorder.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mmsViewReorder.html",'\x3c!-- Nested node template --\x3e\n<script type="text/ng-template" id="nodes_renderer2.html">\n    <div ui-tree-handle data-nodrag="{{element.isOpaque ? \'true\' : \'false\'}}"\n         ng-class="{ \'grab\' : !element.isOpaque, \'no-grab\': element.isOpaque }"\n         title="{{element.isOpaque ? \'Docgen element is not reorderable\' : \'\'}}">\n        \n         {{element.presentationElement.type === \'InstanceSpecification\' ? \'Section\' : element.presentationElement.type}} : {{element.instanceSpecification.name}}\n    </div>\n    <ol ui-tree-nodes ng-model="element.sectionElements">\n        <li ng-repeat="element in element.sectionElements" ui-tree-node ng-include="\'nodes_renderer2.html\'">\n        </li>\n    </ol>\n<\/script>\n<div class="container-tree-reorder">\n    <h4 class="right-pane-title">Reorder contents</h4>\n    <hr class="spec-title-divider">\n    <div ng-show="!elementReferenceTree || elementReferenceTree.length == 0">View contents loading or unavailable\n    </div>\n    <div ng-show="elementReferenceTree && elementReferenceTree.length > 0"><b>Bold</b> view contents are reorderable</div>\n    <div class="well" ui-tree="treeOptions">\n        <ol ui-tree-nodes class="root" ng-model="elementReferenceTree">\n            <li ng-repeat="element in elementReferenceTree" ui-tree-node ng-include="\'nodes_renderer2.html\'"></li>\n        </ol>\n    </div>\n</div>\n')}]),angular.module("mms/templates/mmsViewSection.html",[]).run(["$templateCache",function(e){e.put("mms/templates/mmsViewSection.html",'<div ng-if="section.specification">\n    <div ng-show="! isEditing">\n        <h1 class="section-title h{{level}}" ng-hide="inPreviewMode">{{section._veNumber}} {{section.name}}</h1>\n        <div ng-show="inPreviewMode"><h1 class="section-title h{{level}}">{{section._veNumber}} {{edit.name}}</h1></div>\n    </div>\n    <div ng-class="{\'panel panel-default\' : isEditing}">\n        <div ng-class="{\'no-display\' : ! isEditing}" class="panel-heading clearfix no-print">\n            <h3 class="panel-title pull-left">\n                <div ng-class="{prop: isEditing}"><input class="form-control" type="text" ng-model="edit.name"/></div>\n            </h3>\n            <div class="btn-group pull-right">\n                <mms-button-bar class="transclude-panel-toolbar" buttons="buttons" mms-bb-api="bbApi"></mms-button-bar>\n            </div>\n        </div>\n        <div ng-class="{\'panel-body\' : isEditing}">\n            <div class="add-pe-button-container no-print" ng-init="$index = -1" ng-include="\'mms/templates/mmsAddPeButton.html\'"></div>\n            <div ng-repeat="instanceVal in section.specification.operand track by instanceVal.instanceId">\n                <mms-view-presentation-elem data-mms-instance-val="::instanceVal" data-mms-parent-section="::section"></mms-view-presentation-elem>\n                <div class="add-pe-button-container no-print" ng-include="\'mms/templates/mmsAddPeButton.html\'"></div>\n            </div>\n        </div>\n    </div>\n</div>\n')}]),angular.module("mms/templates/revertConfirm.html",[]).run(["$templateCache",function(e){e.put("mms/templates/revertConfirm.html",'<div class="modal-header">\n    <h4>Revert element documentation, name, and value</h4>\n</div>\n\n<div class="modal-body revert-dialogue">\n    <p>Revert documentation, name, and value of this element from \n    <b>{{compareCommit.commitSelected._creator}} - {{compareCommit.commitSelected._created | date:\'M/d/yy h:mm a\'}}</b> on {{compareCommit.ref.type}}: <b>{{compareCommit.ref.name}}</b>\n    to \n    <b>{{baseCommit.commitSelected._creator}} - {{baseCommit.commitSelected._created | date:\'M/d/yy h:mm a\'}}</b>\n    on {{baseCommit.refSelected.type}}: <b>{{baseCommit.refSelected.name}}</b>.</p>\n    <p>This will create a new version under your user name on <b>{{compareCommit.ref.name}}.</b></p>\n    <p>Cross reference contents will NOT be reverted.</p>\n\n    <h3>Preview Element</h3>\n    <div class="element-preview-box">\n        <h1 class="prop element-title">\n            <mms-cf mms-cf-type="name" mms-element-id="{{mmsElementId}}" mms-project-id="{{mmsProjectId}}" mms-ref-id="{{baseCommit.refSelected.id}}" mms-commit-id="{{baseCommit.commitSelected.id}}"></mms-cf>\n        </h1>\n        <h2 class="prop-title spec-view-doc-heading">Documentation</h2>\n        <p ng-show="!showDocHTML" class="doc-text">\n            <mms-cf mms-cf-type="doc" mms-element-id="{{mmsElementId}}" mms-project-id="{{mmsProjectId}}" mms-ref-id="{{baseCommit.refSelected.id}}" mms-commit-id="{{baseCommit.commitSelected.id}}"></mms-cf>\n        </p>\n        <div ng-if="element.type === \'Property\' || element.type === \'Port\' || element.type === \'Slot\'">\n        <h2 class="prop-title">Property Value</h2>\n        <span class="prop">\n            <mms-cf mms-cf-type="val" mms-element-id="{{mmsElementId}}" mms-project-id="{{mmsProjectId}}" mms-ref-id="{{baseCommit.refSelected.id}}" mms-commit-id="{{baseCommit.commitSelected.id}}"></mms-cf>\n        </span></div>\n    </div>\n</div>\n\n<div class="modal-footer">\n    <button class="btn btn-warning " ng-click="ok()">Revert</button>\n    <button class="btn btn-default" ng-click="cancel()">Cancel</button>\n</div>\n')}]),angular.module("mms/templates/saveConflict.html",[]).run(["$templateCache",function(e){e.put("mms/templates/saveConflict.html",'<div class="modal-header"><h4>Conflict!</h4></div>\n<div class="modal-body">\n    <p>This element has been updated on the server since the last read\n        and your save is rejected!</p>\n    <hr/>\n    <h6>Latest</h6>\n    <mms-spec mms-type="element" mms-element="latest" no-edit="true"></mms-spec>\n    <hr/>\n    <p> Do you want to discard your edits and update to the latest or force an overwrite?</p>\n</div>\n<div class="modal-footer">\n    <button class="btn btn-warning" ng-click="ok()">Discard Edits</button>\n    <button class="btn btn-warning" ng-click="force()">Force Save</button>\n    \x3c!--<button class="btn btn-sm btn-primary" ng-click="merge()">Try Merge Edits</button>--\x3e\n    <button class="btn btn-default" ng-click="cancel()">Cancel (Do nothing)</button>\n</div>\n')}]),angular.module("mms.directives",["mms","mms.directives.tpls","ui.bootstrap","angular-growl","angularjs-dropdown-multiselect","ui.tree-filter"]).config(["$sceProvider","growlProvider","uiTreeFilterSettingsProvider",function(e,t,n){e.enabled(!1),t.onlyUniqueMessages(!1),t.globalTimeToLive({success:5e3,error:-1,warning:5e3,info:5e3}),t.globalPosition("bottom-right"),n.addresses=["label"],n.descendantCollection="children"}]).filter("veRealNum",function(){return function(e){return Number.isInteger(e)?e+".0":e}}).constant("CKEDITOR",window.CKEDITOR).constant("MathJax",window.MathJax),angular.module("mms.directives").directive("mmsC3Plot",["TableService","$window","_",mmsC3Plot]),angular.module("mms.directives").directive("mmsD3GroupedHorizontalBarPlot",["TableService","$window",mmsD3GroupedHorizontalBarPlot]),angular.module("mms.directives").directive("mmsD3NormalizedStackedBarPlot",["TableService","$window",mmsD3NormalizedStackedBarPlot]),angular.module("mms.directives").directive("mmsD3ParallelAxisPlot",["TableService","$window",mmsD3ParallelAxisPlot]),angular.module("mms.directives").directive("mmsD3RadarPlot",["TableService","$window",mmsD3RadarPlot]),angular.module("mms.directives").directive("mmsAnnotation",["$templateCache","$rootScope","ViewService","UtilsService",mmsAnnotation]),angular.module("mms.directives").directive("mmsButtonBar",["$templateCache",mmsButtonBar]),angular.module("mms.directives").directive("mmsCf",["$compile",mmsCf]),angular.module("mms.directives").directive("mmsCkeditor",["$uibModal","$templateCache","$timeout","growl","CKEDITOR","_","CacheService","ElementService","UtilsService","ViewService","URLService","MentionService","Utils",mmsCkeditor]),angular.module("mms.directives").directive("mmsDiagramBlock",["go","growl","ElementService",mmsDiagramBlock]),angular.module("mms.directives").directive("mmsDiffAttr",["$compile","$rootScope","$interval","$templateCache","$q","ElementService",mmsDiffAttr]),angular.module("mms.directives").directive("mmsGroupDocs",["ElementService","ViewService","growl","$q","$templateCache","_",mmsGroupDocs]),angular.module("mms.directives").directive("mmsHistory",["Utils","ElementService","ProjectService","$templateCache","$q","$animate","$uibModal","_",mmsHistory]),angular.module("mms.directives").directive("mmsHtmlDiff",["$templateCache","$timeout","MathJax","HtmlRenderedDiff",mmsHtmlDiff]),angular.module("mms.directives").directive("mmsJobs",["$templateCache","$http","$location","$window","growl","_","$q","$rootScope","AuthService","ElementService","ProjectService","UtilsService","JobService",mmsJobs]),angular.module("mms.directives").directive("mmsMaturityBar",["$window",mmsMaturityBar]),angular.module("mms.directives").directive("mmsMention",["$templateCache","MentionService","Utils",mmsMention]),angular.module("mms.directives").directive("mmsMentionIntercept",["$templateCache",mmsMentionIntercept]),angular.module("mms.directives").directive("mmsRefList",["$templateCache","$http","growl","_","$q","$uibModal","UtilsService","JobService","ElementService","URLService",mmsRefList]),angular.module("mms.directives").directive("mmsSearch",["$window","$anchorScroll","CacheService","ElementService","ProjectService","UtilsService","ViewService","_","growl","$templateCache","$timeout",mmsSearch]),angular.module("mms.directives").directive("mmsSpec",["Utils","AuthService","ElementService","UtilsService","ViewService","$templateCache","growl","_",mmsSpec]),angular.module("mms.directives").directive("mmsToolbar",["$templateCache","$rootScope",mmsToolbar]),angular.module("mms.directives").directive("mmsTranscludeArt",["ArtifactService","AuthService","URLService",mmsTranscludeArt]),angular.module("mms.directives").directive("mmsTranscludeCom",["Utils","ElementService","UtilsService","ViewService","UxService","$templateCache","$compile","growl","MathJax",mmsTranscludeCom]),angular.module("mms.directives").directive("mmsTranscludeDoc",["Utils","ElementService","UtilsService","ViewService","UxService","AuthService","$compile","$templateCache","growl","_","MathJax",mmsTranscludeDoc]),angular.module("mms.directives").directive("mmsTranscludeImg",["ArtifactService","AuthService","ElementService","URLService","growl",mmsTranscludeImg]),angular.module("mms.directives").directive("mmsTranscludeName",["ElementService","UxService","$compile","growl","$templateCache","Utils","ViewService",mmsTranscludeName]),angular.module("mms.directives").directive("mmsTranscludeVal",["ElementService","UtilsService","UxService","Utils","URLService","AuthService","$http","_","$compile","$templateCache","growl","MathJax","ViewService",mmsTranscludeVal]),angular.module("mms.directives").directive("mmsTree",["ApplicationService","$timeout","$log","$templateCache","$filter","UtilsService",mmsTree]),angular.module("mms.directives").directive("mmsTsDiagram",["ElementService","$templateCache","$window","$timeout","growl","ApplicationService","AuthService","URLService",mmsTsDiagram]),angular.module("mms.directives").directive("mmsValueLink",["ElementService",mmsValueLink]),angular.module("mms.directives").directive("mmsView",["Utils","ViewService","ElementService","$templateCache","growl",mmsView]),angular.module("mms.directives").directive("mmsViewEquation",[mmsViewEquation]),angular.module("mms.directives").directive("mmsViewFigure",[mmsViewFigure]),angular.module("mms.directives").directive("mmsViewImg",[mmsViewImg]),angular.module("mms.directives").directive("mmsViewLink",["ElementService","UtilsService","$compile","growl","ViewService","ApplicationService",mmsViewLink]),angular.module("mms.directives").directive("mmsViewList",["$compile","UtilsService","Utils",mmsViewList]),angular.module("mms.directives").directive("mmsViewListT",[mmsViewListT]),angular.module("mms.directives").directive("mmsViewPara",["$compile","UtilsService","Utils",mmsViewPara]),angular.module("mms.directives").directive("mmsViewPlot",["$compile","$window",mmsViewPlot]),angular.module("mms.directives").directive("mmsViewPresentationElem",["ViewService","ElementService","$templateCache","$timeout","$location","$anchorScroll","$compile",mmsViewPresentationElem]),angular.module("mms.directives").directive("mmsViewReorder",["ElementService","ViewService","$templateCache","growl","$q","_",mmsViewReorder]),angular.module("mms.directives").directive("mmsViewSection",["$compile","$templateCache","$rootScope","ViewService","UxService","Utils","growl",mmsViewSection]),angular.module("mms.directives").directive("mmsViewTable",["$compile","$timeout","$document","$window","UtilsService","Utils",mmsViewTable]),angular.module("mms.directives").directive("mmsViewTableT",[mmsViewTableT]);var directiveModule=angular.module("angularjs-dropdown-multiselect",[]);function Utils(s,l,i,t,c,d,n,a,r,m,o,p,u,f){function g(t,e){"Slot"===e?Object.keys(n.localStorage).forEach(function(e){-1!==e.indexOf(t)&&n.localStorage.removeItem(e)}):n.localStorage.removeItem(t)}var v=function(e,t){e.ok=function(){t.close("ok")},e.cancel=function(){t.close("cancel")},e.force=function(){t.close("force")},e.merge=function(){t.close("merge")}},h=function(e){var t=e.element;"Property"!==t.type&&"Port"!==t.type||(t.defaultValue?e.values=[t.defaultValue]:e.values=[]),"Slot"===t.type&&(e.values=t.value),"Constraint"===t.type&&t.specification&&(e.values=[t.specification]),"Expression"===t.type&&(e.values=t.operand)},b=function(n,i,a,r){var o=s.defer();return i&&i.save&&i.save(),m.updateElement(n).then(function(e){o.resolve(e),h(a),c.$broadcast("element.updated",e,r)},function(e){409===e.status?(a.latest=e.data.elements[0],l.open({template:t.get("mms/templates/saveConflict.html"),controller:["$scope","$uibModalInstance",v],scope:a,size:"lg"}).result.then(function(e){if("ok"===e){var t={elementId:a.latest.id,projectId:a.latest._projectId,refId:a.latest._refId,commitId:"latest"};m.cacheElement(t,a.latest,!0),m.cacheElement(t,a.latest,!1)}else"force"===e?(n._read=a.latest._read,n._modified=a.latest._modified,b(n,i,a,r).then(function(e){o.resolve(e)},function(e){o.reject(e)})):o.reject({type:"cancel"})})):o.reject({type:"error",message:e.message})}),o.promise},w=function(e){e._commitId="latest";var t=p.makeElementKey(e),n=r.get(t);return e.name!==n.name||(e.documentation!==n.documentation||(!("Property"!==e.type&&"Port"!==e.type||angular.equals(e.defaultValue,n.defaultValue))||("Slot"===e.type&&!angular.equals(e.value,n.value)||"Constraint"===e.type&&!angular.equals(e.specification,n.specification))))},y=function(e,t,n){n&&n.destroy&&n.destroy(),t._commitId="latest";var i=p.makeElementKey(t),a=r.get(i);a.name&&(t.name=a.name),t.documentation=a.documentation,"Property"===t.type||"Port"===t.type?(t.defaultValue=JSON.parse(JSON.stringify(a.defaultValue)),t.defaultValue?e.editValues=[t.defaultValue]:e.editValues=[]):"Slot"===t.type?(t.value=JSON.parse(JSON.stringify(a.value)),e.editValues=t.value):"Constraint"===t.type&&t.specification&&(t.specification=JSON.parse(JSON.stringify(a.specification)),e.editValues=[t.specification])},I=function(e){"info"===e.type?f.info(e.message):"warning"===e.type?f.warning(e.message):"error"===e.type&&f.error(e.message)},_=function(e){var i=s.defer();if("Enumeration"===e.type){var t={elementId:e.id,projectId:e._projectId,refId:e._refId,depth:1};m.getOwnedElements(t).then(function(e){for(var t=[],n=0;n<e.length;n++)"EnumerationLiteral"===e[n].type&&t.push(e[n]);t.sort(function(e,t){return e.name.localeCompare(t.name)}),i.resolve({options:t,isEnumeration:!0})},function(e){i.reject(e)})}else i.resolve({options:[],isEnumeration:!1});return i.promise},S=function(t){i(function(){var e=t.get(0);t.isOnScreen()||e.scrollIntoView()},500,!1)},E=function(n,i,e){n.oking=!1,n.newPe={name:""},n.createForm=!0;n.searchOptions={callback:function(e){if(n.oking)f.info("Please wait...");else{n.oking=!0;var t={instanceId:e.id,type:"InstanceValue"};o.addElementToViewOrSection(n.viewOrSectionOb,t,n.addPeIndex).then(function(e){var t=n.presentationElemType;C(t,n.viewOrSectionOb.id),i.close(e)},function(e){f.error(n.presentationElemType+" Add Error: "+e.message)}).finally(function(){n.oking=!1})}},itemsPerPage:200,filterQueryList:[function(){var e={};"Table"===n.presentationElemType?e.classifierIds=[o.TYPE_TO_CLASSIFIER_ID.TableT,o.TYPE_TO_CLASSIFIER_ID.Table]:"List"===n.presentationElemType?e.classifierIds=[o.TYPE_TO_CLASSIFIER_ID.ListT,o.TYPE_TO_CLASSIFIER_ID.List]:"Image"===n.presentationElemType?e.classifierIds=[o.TYPE_TO_CLASSIFIER_ID.ImageT,o.TYPE_TO_CLASSIFIER_ID.Image]:"Paragraph"===n.presentationElemType?e.classifierIds=[o.TYPE_TO_CLASSIFIER_ID.ParagraphT,o.TYPE_TO_CLASSIFIER_ID.Paragraph]:"Section"===n.presentationElemType?e.classifierIds=[o.TYPE_TO_CLASSIFIER_ID.SectionT,o.TYPE_TO_CLASSIFIER_ID.Section]:e.classifierIds=[o.TYPE_TO_CLASSIFIER_ID[n.presentationElemType]];var t={};return t.terms=e,t}],hideFilterOptions:!0},n.ok=function(){n.oking?f.info("Please wait..."):(n.oking=!0,o.createInstanceSpecification(n.viewOrSectionOb,n.presentationElemType,n.newPe.name,n.addPeIndex).then(function(e){var t=n.presentationElemType;C(t,n.viewOrSectionOb.id),i.close(e)},function(e){f.error(n.presentationElemType+" Add Error: "+e.message)}).finally(function(){n.oking=!1}))},n.cancel=function(){i.dismiss()}},C=function(e,t){c.$broadcast("view-reorder.refresh"),c.$broadcast("view.reorder.saved",t),f.success("Adding "+e+" Successful"),"Comment"!==e||c.veCommentsOn||i(function(){$(".show-comments").click()},0,!1)};return{save:b,hasEdits:w,revertEdits:y,startEdit:function(t,e,n,i,a){if(e.isEditable()&&!t.isEditing&&t.element&&t.element._editable&&"latest"===t.commitId){var r=t.element,o={elementId:r.id,projectId:r._projectId,refId:r._refId};m.getElementForEdit(o).then(function(e){t.isEditing=!0,t.inPreviewMode=!1,"Property"===(t.edit=e).type||"Port"===e.type?t.edit.defaultValue&&(t.editValues=[t.edit.defaultValue]):"Slot"===e.type?angular.isArray(e.value)&&(t.editValues=e.value):"Constraint"===e.type&&e.specification&&(t.editValues=[e.specification]),t.editValues||(t.editValues=[]),i&&(t.recompileScope&&t.recompileScope.$destroy(),t.recompileScope=t.$new(),n.empty(),n.append(i),d(n.contents())(t.recompileScope)),t.skipBroadcast?t.skipBroadcast=!1:c.$broadcast("presentationElem.edit",t.edit),a||S(n)},I),m.isCacheOutdated(t.element).then(function(e){e.status&&e.server._modified>e.cache._modified&&f.warning("This element has been updated on the server")})}},saveAction:function(t,e,n){t.elementSaving?f.info("Please Wait..."):(g(t.element._projectId+t.element._refId+t.element.id,t.edit.type),t.bbApi&&(n?t.bbApi.toggleButtonSpinner("presentation-element-saveC"):t.bbApi.toggleButtonSpinner("presentation-element-save")),t.elementSaving=!0,i(function(){b(t.edit,t.editorApi,t,n).then(function(e){t.elementSaving=!1,n||(t.isEditing=!1,c.$broadcast("presentationElem.save",t.edit)),f.success("Save Successful")},function(e){t.elementSaving=!1,I(e)}).finally(function(){t.bbApi&&(n?t.bbApi.toggleButtonSpinner("presentation-element-saveC"):t.bbApi.toggleButtonSpinner("presentation-element-save"))})},1e3,!1))},cancelAction:function(n,e,t){if(n.elementSaving)f.info("Please Wait...");else{var i=function(){n.isEditing=!1,y(n,n.edit),c.$broadcast("presentationElem.cancel",n.edit),e()};n.bbApi&&n.bbApi.toggleButtonSpinner("presentation-element-cancel"),w(n.edit)?l.open({templateUrl:"partials/mms/cancelConfirm.html",scope:n,controller:["$scope","$uibModalInstance",function(e,t){e.ok=function(){g(n.element._projectId+n.element._refId+n.element.id,n.edit.type),t.close("ok")},e.cancel=function(){t.dismiss()}}]}).result.then(function(){i()}).finally(function(){n.bbApi&&n.bbApi.toggleButtonSpinner("presentation-element-cancel")}):(i(),n.bbApi&&n.bbApi.toggleButtonSpinner("presentation-element-cancel"))}},deleteAction:function(n,e,i){n.elementSaving?f.info("Please Wait..."):(e.toggleButtonSpinner("presentation-element-delete"),n.name=n.edit.name,l.open({templateUrl:"partials/mms/confirmRemove.html",scope:n,controller:["$scope","$uibModalInstance",function(e,t){e.ok=function(){g(n.element._projectId+n.element._refId+n.element.id,n.edit.type),t.close("ok")},e.cancel=function(){t.dismiss()}}]}).result.then(function(){var e=i||n.view,t={elementId:e.id,projectId:e._projectId,refId:e._refId,commitId:"latest"};o.removeElementFromViewOrSection(t,n.instanceVal).then(function(e){(o.isSection(n.instanceSpec)||o.isTable(n.instanceSpec)||o.isFigure(n.instanceSpec)||o.isEquation(n.instanceSpec))&&c.$broadcast("viewctrl.delete.element",n.instanceSpec),c.$broadcast("view-reorder.refresh"),c.$broadcast("presentationElem.cancel",n.edit),f.success("Remove Successful")},I)}).finally(function(){n.bbApi.toggleButtonSpinner("presentation-element-delete")}))},previewAction:function(e,t,n){e.elementSaving?f.info("Please Wait..."):(e.edit&&w(e.edit)&&!e.inPreviewMode?(e.skipBroadcast=!0,t(e.inPreviewMode=!0)):e.edit&&e.isEditing&&(c.$broadcast("presentationElem.cancel",e.edit),e.element&&t()),e.isEditing=!1,e.elementSaving=!1,S(n))},isDirectChildOfPresentationElementFunc:function(e,t){for(var n=e[0].parentElement;n&&"MMS-VIEW-PRESENTATION-ELEM"!==n.nodeName&&"MMS-VIEW"!==n.nodeName;){if(t.isTranscludedElement(n.nodeName))return!1;if("MMS-VIEW-TABLE"===n.nodeName||"MMS-VIEW-LIST"===n.nodeName||"MMS-VIEW-SECTION"===n.nodeName)return!1;n=n.parentElement}return!(!n||"MMS-VIEW"===n.nodeName)},hasHtml:function(e){return-1!==e.indexOf("<p>")},isEnumeration:_,getPropertySpec:function(e){var t=s.defer(),n=e.typeId,i=!1,a=!1,r=[];if("Slot"===e.type&&(i=!0,n=e.definingFeatureId),!n)return t.resolve({options:r,isEnumeration:a,isSlot:i}),t.promise;var o={elementId:n,projectId:e._projectId,refId:e._refId};return m.getElement(o).then(function(e){if(i){if(!e.typeId)return void t.resolve({options:r,isEnumeration:a,isSlot:i});o.elementId=e.typeId,m.getElement(o).then(function(e){_(e).then(function(e){e.isEnumeration&&(a=e.isEnumeration,r=e.options),t.resolve({options:r,isEnumeration:a,isSlot:i})},function(e){t.resolve({options:r,isEnumeration:a,isSlot:i})})})}else _(e).then(function(e){e.isEnumeration&&(a=e.isEnumeration,r=e.options),t.resolve({options:r,isEnumeration:a,isSlot:i})},function(e){t.reject(e)})},function(e){t.resolve({options:r,isEnumeration:a,isSlot:i})}),t.promise},addPresentationElement:function(e,t,n){e.viewOrSectionOb=n,e.presentationElemType=t;l.open({templateUrl:"partials/mms/add-pe.html",scope:e,controller:["$scope","$uibModalInstance","$filter",E]}).result.then(function(e){"InstanceSpecification"!==e.type||o.isSection(e)||i(function(){$("#"+e.id).find("mms-transclude-doc,mms-transclude-com").click()},0,!1)})},setupValCf:h,setupValEditFunctions:function(n){n.addValueTypes={string:"LiteralString",boolean:"LiteralBoolean",integer:"LiteralInteger",real:"LiteralReal"},n.addValue=function(e){var t=null;"LiteralBoolean"===e?t=p.createValueSpecElement({type:e,value:!1,id:p.createMmsId(),ownerId:n.element.id}):"LiteralInteger"===e?t=p.createValueSpecElement({type:e,value:0,id:p.createMmsId(),ownerId:n.element.id}):"LiteralString"===e?t=p.createValueSpecElement({type:e,value:"",id:p.createMmsId(),ownerId:n.element.id}):"LiteralReal"===e&&(t=p.createValueSpecElement({type:e,value:0,id:p.createMmsId(),ownerId:n.element.id})),n.editValues.push(t),"Property"!=n.element.type&&"Port"!=n.element.type||(n.edit.defaultValue=t)},n.addValueType="LiteralString",n.addEnumerationValue=function(){var e=p.createValueSpecElement({type:"InstanceValue",instanceId:n.options[0],id:p.createMmsId(),ownerId:n.element.id});n.editValues.push(e),"Property"!=n.element.type&&"Port"!=n.element.type||(n.edit.defaultValue=e)},n.removeVal=function(e){n.editValues.splice(e,1)}},revertAction:function(e,t,n){l.open({templateUrl:"mms/templates/revertConfirm.html",scope:e,size:"lg",windowClass:"revert-spec",controller:["$scope","$uibModalInstance",function(n,i){n.ok=function(){if(n.oking)f.info("Please wait...");else{n.oking=!0;var t={id:n.mmsElementId,_projectId:n.mmsProjectId,_refId:n.mmsRefId},e={elementId:n.mmsElementId,projectId:n.mmsProjectId,refId:n.baseCommit.refSelected.id,commitId:n.baseCommit.commitSelected.id};m.getElement(e,2,!1).then(function(e){e.name&&(t.name=e.name),t.documentation=e.documentation,e.defaultValue&&(t.defaultValue=e.defaultValue),e.value&&(t.value=e.value),m.updateElement(t).then(function(e){c.$broadcast("element.updated",e,!1),i.close(),f.success("Element reverted")},function(e){f.error("Revert not compeleted - Error: "+e.message)}).finally(function(){n.oking=!1})})}},n.cancel=function(){i.dismiss()}}]}).result.then(function(e){})},clearAutosaveContent:g,reopenUnsavedElts:function(e,t){var n={};e.$root.ve_edits&&(n=e.$root.ve_edits);var i=n[e.element.id+"|"+e.element._projectId+"|"+e.element._refId];if(i&&"latest"===e.commitId)if("value"===t){if("Property"===e.element.type||"Port"===e.element.type)e.element.defaultValue.value===i.defaultValue.value&&e.element.defaultValue.instanceId===i.defaultValue.instanceId||e.startEdit();else if("Slot"===e.element.type){var a=i.value,r=e.element.value;if(a.length!==r.length)e.startEdit();else for(var o=0;o<a.length;o++)if(a[o].value!==r[o].value||a[o].instanceId!==r[o].instanceId){e.startEdit();break}}}else e.element[t]!==i[t]&&e.startEdit()},checkForDuplicateInstances:function(e){for(var t,n={},i=[],a=0;a<e.length;a++)if(t=e[a].instanceId){if(n[t]){i.push(e[a]),e.splice(a,1),a--;continue}n[t]=!0}return i},fixImgSrc:function(e){var t=e.attr("src");if(t&&(t.startsWith("../")&&t.replace("../","/alfresco/"),t.startsWith("/alfresco/")&&e.attr("src",a.getMmsServer()+t+"?alf_ticket="+u.getTicket())),!(e.width()<860)){var n=e.parent("p");0<n.length&&(("center"==n.css("text-align")||n.hasClass("image-center"))&&e.addClass("image-center"),e.unwrap())}},focusOnEditorAfterAddingWidgetTag:function(e){var t=e.widgets.focused.element.getParent(),n=e.createRange();n&&(n.moveToClosestEditablePosition(t,!0),n.select())},toggleLeftPane:function(e){e&&!c.ve_tree_pane.closed&&c.ve_tree_pane.toggle(),!e&&c.ve_tree_pane.closed&&c.ve_tree_pane.toggle()}}}function MmsAppUtils(b,i,m,I,p,t,_,r,u,o,f,S,g){var v=function(e,t,n,i,a){var r,o,s=angular.element("#print-div"),l=(r={},s.find("mms-ts-diagram").each(function(e){var t=$(this).find("canvas")[0];if(t){var n=$("<img>");n.attr({src:t.toDataURL(),width:"100%"}),r[e]=n}}),r);s=s.clone(),o=l,s.find("mms-ts-diagram").each(function(e){var t=o[e];$(this).replaceWith(t)});var c=I.host(),d=I.port(),m=I.protocol(),p=I.absUrl(),u=m+"://"+c+(80==d||443==d?"":":"+d),f=p.indexOf("mms.html"),g=S.makeHtmlTOC(_.ve_treeApi.get_rows());S.convertViewLinks(s);var v=S.makeTablesAndFiguresTOC(_.ve_treeApi.get_rows(),s,!1,a),h=v.figures,b=v.tables,w=v.equations;n||(g=h=b=w=""),i||(h=b=w=""),angular.element(s).find("a").attr("href",function(e,t){return t?0===t.indexOf("/")?u+t:0===t.indexOf("../../")?u+t.substring(5):0===t.indexOf("../")?u+"/alfresco"+t.substring(2):0===t.indexOf("mms.html")?p.substring(0,f)+t:t:t}),s.find("mms-transclude-com").remove(),s.find("style").remove(),s.find("div.tableSearch").remove(),s.find(".no-print").remove(),s.find(".ng-hide").remove(),2===t?s.find(".mms-svg").remove():s.find(".mms-png").remove(),s.find("p:empty").remove(),s.find("p").each(function(){var e=$(this);0===e.html().replace(/\s|&nbsp;/g,"").length&&e.remove()}),s.find("[width]").not("img").not(".ve-fixed-width").removeAttr("width"),s.find("[style]").not("hr").each(function(){this.style.removeProperty("font-size"),this.style.removeProperty("width"),this.style.removeProperty("min-width"),this.style.removeProperty("height"),this.style.removeProperty("transform"),this.style.removeProperty("will-change")}),s.find(".math").remove(),s.find("script").remove();var y="";return n&&((y=s.find("mms-view[mms-element-id='"+e.id+"']")).remove(),y.addClass("ve-cover-page"),y=y[0].outerHTML),{cover:y,contents:s[0].outerHTML,toc:g,tof:h,tot:b,toe:w}},w=function(s,e,t,l,c,d,m,n){var p=n;p||(p={});var u=b.defer(),f=d(s,e,t);p[s.id]=s;var g=[],v=[],h=[];if(!s._childViews||0===s._childViews.length||"none"===e)return angular.isObject(f)&&f.loading&&(f.loading=!1),u.resolve(f),u.promise;for(var i=0;i<s._childViews.length;i++)p[s._childViews[i].id]||(g.push(s._childViews[i].id),v.push(s._childViews[i].aggregation),h.push(s._childViews[i].propertyId));return o.getElements({elementIds:g,projectId:l,refId:c},2).then(function(e){for(var t={},n=0;n<e.length;n++)t[e[n].id]=e[n];var i=[],a=[],r=[];for(n=0;n<g.length;n++){var o=t[g[n]];o&&S.isView(o)&&(i.push(w(o,v[n],h[n],l,c,d,m,p)),a.push(d(o,v[n],h[n])),r.push({id:o.id,aggregation:v[n],propertyId:h[n]}))}s._childViews=r,m(f,a),b.all(i).then(function(e){u.resolve(f)},function(e){u.reject(e)})},function(e){u.reject(e)}),u.promise};return{printModal:function(s,n,l,c){var d=b.defer();return i.open({templateUrl:"partials/mms/printConfirm.html",controller:["$scope","$uibModalInstance",function(a,e){a.type=l?"DOCUMENT":"VIEW",a.action=1===c?"print":3===c?"Generate PDF":"Generate word",a.label=3===c?"PDF":2===c?"Word":"",a.mode=c,a.meta={},a.customizeDoc={},a.customizeDoc.useCustomStyle=!1,0<angular.element("#print-div").find(".mms-error").length&&(a.hasError=!0),l&&(a.customizeDoc.useCustomStyle=!1,s._printCss?(a.customizeDoc.useCustomStyle=!0,a.customizeDoc.customCSS=s._printCss):a.customizeDoc.customCSS=S.getPrintCss(!1,!1,{}),a.meta={"top-left":"loading...",top:"loading...","top-right":"loading...","bottom-left":"loading...",bottom:"loading...","bottom-right":"loading..."},f.getDocMetadata({elementId:s.id,projectId:s._projectId,refId:s._refId},2).then(function(e){a.meta.top=e.top?e.top:"",a.meta.bottom=e.bottom?e.bottom:"",a.meta["top-left"]=e.topl?e.topl:"",a.meta["top-right"]=e.topr?e.topr:"",n&&"Tag"===n.type&&(a.meta["top-right"]=a.meta["top-right"]+" "+n.name);var t="Tag"===n.type?n._timestamp:"latest";"latest"===t&&(t=new Date,t=r("date")(t,"M/d/yy h:mm a")),a.meta["top-right"]=a.meta["top-right"]+" "+t,a.meta["bottom-left"]=e.bottoml?e.bottoml:"",a.meta["bottom-right"]=e.bottomr?e.bottomr:"counter(page)"},function(e){a.meta["top-left"]=a.meta.top=a.meta["top-right"]=a.meta["bottom-left"]=a.meta.bottom="",a.meta["bottom-right"]="counter(page)"})),a.unsaved=_.ve_edits&&!g.isEmpty(_.ve_edits),a.docOption=!l&&(3===c||2===c),a.model={genTotf:!1,landscape:!1,htmlTotf:!1},a.saveStyleUpdate=function(){a.elementSaving=!0;var e={id:s.id,_projectId:s._projectId,_refId:s._refId};e._printCss=a.customizeDoc.customCSS,o.updateElement(e).then(function(){a.elementSaving=!1,t.success("Save Successful")},function(){a.elementSaving=!1,t.warning("Save was not complete. Please try again.")})},a.preview=function(){a.previewResult||(a.previewResult=v(s,3,!0,!0,!1),a.previewResult.tof=a.previewResult.tof+a.previewResult.toe);var e=a.previewResult,t=["<html><head><title>"+s.name+'</title><style type="text/css">',a.customizeDoc.customCSS,'</style></head><body style="overflow: auto">',e.cover];""!=e.toc&&t.push(e.toc),""!=e.tot&&a.model.genTotf&&t.push(e.tot),""!=e.tof&&a.model.genTotf&&t.push(e.tof),t.push(e.contents,"</body></html>");var n=t.join(""),i=p.open("about:blank","_blank","width=800,height=600,scrollbars=1,status=1,toolbar=1,menubar=1");i.document.open(),i.document.write(n),i.document.close()},a.print=function(){a.customization=!!a.customizeDoc.useCustomStyle&&a.customizeDoc.customCSS,e.close(["ok",a.model.genTotf,a.model.htmlTotf,a.model.landscape,a.meta,a.customization])},a.fulldoc=function(){e.close(["fulldoc"])},a.cancel=function(){e.dismiss()}}],backdrop:"static",keyboard:!1}).result.then(function(e){if("ok"===e[0]){var t=v(s,c,l,e[1],e[2]),n=e[5],i=n||S.getPrintCss(e[2],e[3],e[4]);if(t.toe=e[2]?"":t.toe,1===c){var a=p.open("about:blank","_blank","width=800,height=600,scrollbars=1,status=1,toolbar=1,menubar=1");a.document.open(),a.document.write("<html><head><title>"+s.name+'</title><style type="text/css">'+i+'</style></head><body style="overflow: auto">'+t.cover+t.toc+t.tot+t.tof+t.toe+t.contents+"</body></html>"),a.document.close(),m(function(){a.print()},1e3,!1)}else{t.tof=e[1]?t.tof+t.toe:"",t.tot=e[1]?t.tot:"";var r=["<html><head><title>"+s.name+'</title><style type="text/css">',i,"</style></head><body>",t.cover];""!=t.toc&&r.push(t.toc),""!=t.tot&&r.push(t.tot),""!=t.tof&&r.push(t.tof),r.push(t.contents,"</body></html>");var o=r.join("");S.exportHtmlAs(c,{htmlString:o,name:s.name,projectId:s._projectId,refId:s._refId,css:i}).then(function(e){d.resolve(e)},function(e){d.reject(e)})}}else _.ve_fullDocMode=!0,_.ve_bbApi.setToggleState("tree-full-document",!0),u.go("project.ref.document.full",{search:void 0})}),d.promise},tableToCsv:function(e){var t=i.open({templateUrl:"partials/mms/tableExport.html",controller:["$scope","$uibModalInstance","type",function(e,t,n){e.type=n,e.export=function(){t.close("export")},e.cancel=function(){t.dismiss()}}],resolve:{type:function(){return e?"DOCUMENT":"VIEW"}},backdrop:"static",keyboard:!1});t.result.then(function(e){if("export"===e){var n=[];angular.element("#print-div").find("table").each(function(e){var t={};this.caption?t.caption=this.caption.innerHTML:t.caption="no caption",t.val=angular.element(this).table2CSV({delivery:"value"}),n.push(t)});var t="",i=0;angular.element(n).each(function(){t+="<h2>"+this.caption+'</h2><div><button class="btn btn-sm btn-primary" onclick="doClick(\'textArea'+i+'\')">Save CSV</button></div><textArea cols=100 rows=15 wrap="off" id="textArea'+i+'">',t+=this.val+"</textArea>",i++}),a=t+="<script src=\"https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js\"><\/script><script>function doClick(id) { var csvString = document.getElementById(id).value;var blob = new Blob([\"\\uFEFF\" + csvString], {     type: \"text/csv;charset=utf-8;\" }); if (window.navigator.msSaveOrOpenBlob) {     navigator.msSaveBlob(blob,'TableData.csv'); } else {     var downloadContainer = $('<div data-tap-disabled=\"true\"><a></a></div>');     var downloadLink = $(downloadContainer.children()[0]);     downloadLink.attr('href', window.URL.createObjectURL(blob));     downloadLink.attr('download', 'TableData.csv');     downloadLink.attr('target', '_blank');      $(window.document).find('body').append(downloadContainer);     /* $timeout(function () { */         downloadLink[0].click();         downloadLink.remove();     /* }, null); */ } } <\/script>",(r=window.open("","csv","height=600,width=800,scrollbars=1")).document.write("<html><head><title>Tables to CSV</title>"),r.document.write("</head><body >"),r.document.write(a),r.document.write("</body></html>"),r.document.close()}var a,r})},handleChildViews:w,refreshNumbering:function(e,t){S.makeTablesAndFiguresTOC(e,t,!0,!1)}}}function mmsCurrentTag(a){return{restrict:"E",scope:{},template:"{{ tag }}",link:function(e,t,n){var i=a.mms_tag;i&&"latest"!==i.name?e.tag=i.name:e.tag="Latest"}}}function runXlr(m,t,p,u,e){return{template:'<button class="btn btn-primary" ng-click="runXLR()">{{xlrTaskName}}</button>',scope:{templateId:"@",xlrTaskName:"@",xlrReleaseName:"@"},controller:["$scope",function(e){e.xlrTaskName=e.xlrTaskName?e.xlrTaskName:"Sync FN to JPL Network",e.runXLR=function(){!0,t.open({template:'<div class="modal-header"><h4>Please login to {{xlrTaskName}}.</h4></div><div class="modal-body"><form name="loginForm" ng-submit="login(credentials)"><input type="text" class="form-control" ng-model="credentials.username" placeholder="Username" style="margin-bottom: 1.5em;" autofocus><input type="password" class="form-control" ng-model="credentials.password" placeholder="Password" style="margin-bottom: 1.5em;"><button class="btn btn-block btn-primary" type="submit">LOG IN <span ng-if="spin" ><i class="fa fa-spin fa-spinner"></i></span></button></form></div>',scope:e,backdrop:"static",controller:["$scope","$uibModalInstance",function(c,d){c.credentials={username:"",password:""},c.spin=!1,c.login=function(e){c.spin=!0;var t,n,i,a=(t=e.username,n=e.password,i=t+":"+n,"Basic "+p.btoa(i)),r=e.username+"@jpl.nasa.gov",o={releaseTitle:c.xlrReleaseName?c.xlrReleaseName:"CAE Portal Sync",releaseVariables:{contentEditor:e.username,editorEmail:r},autoStart:!0},s="/xlrapi/v1/templates/Applications/"+c.templateId+"/create",l={method:"POST",url:s,headers:{Authorization:a,"Content-Type":"application/json","cache-control":"no-cache"},data:o,withCredentials:!0,async:!0,crossDomain:!0,processData:!1};m(l).then(function(){u.success(c.xlrTaskName+" is running. You will receive a completion email")},function(e){u.error(c.xlrTaskName+" has failed.")}).finally(function(){c.spin=!1,!1,d.dismiss()})}}],size:"md"}).result.finally(function(){!1})}}],link:function(e,t,n,i){}}}function veFooter(e){return{restrict:"E",template:e.get("partials/mms/veFooter.html"),transclude:!0}}function veMenu(m,p,e,u,f,g){return{restrict:"E",template:e.get("partials/mms/veMenu.html"),scope:{org:"<mmsOrg",project:"<mmsProject",projects:"<mmsProjects",group:"<mmsGroup",groups:"<mmsGroups",branch:"<mmsBranch",ref:"<mmsRef",refs:"<mmsRefs",branches:"<mmsBranches",tag:"<mmsTag",tags:"<mmsTags",document:"<mmsDocument",view:"<mmsView"},link:function(c,n,e){c.getHrefForProject=function(e){var t=e._refId||"master";return g.PROJECT_URL_PREFIX+e.id+"/"+t},c.getHrefForBranch=d,c.getHrefForTag=function(e){return d(e)},c.htmlTooltip=u.trustAsHtml("Branch temporarily unavailable during duplication."),c.currentProject=c.project.name,c.ref&&(c.currentRef=c.ref,"Branch"===c.ref.type?c.currentBranch=c.branch.name:"Tag"===c.ref.type&&(c.currentTag=c.tag.name)),c.updateProject=function(e){e&&p.go("project.ref",{projectId:e.id,refId:"master",search:void 0},{reload:!0})},c.updateBranch=function(e){"creating"!=e.status&&p.go(p.current.name,{projectId:c.project.id,refId:e.id,search:void 0},{reload:!0})},c.updateTag=function(e){"creating"!=e.status&&p.go(p.current.name,{projectId:c.project.id,refId:e.id,search:void 0},{reload:!0})},c.refsView=function(){p.go("project",{projectId:c.project.id},{reload:!0})},c.isRefsView=function(){return!(!p.includes("project")||p.includes("project.ref"))},c.$on("stomp.branchCreated",function(e,t,n){var i=["refs",c.project.id];if(m.exists(i)&&c.project.id===n){for(var a=m.get(i),r=[],o=0;o<a.length;o++)"Tag"===a[o].type&&r.push(a[o]);c.tags=r;for(var s=[],l=0;l<a.length;l++)"Branch"===a[l].type&&s.push(a[l]);c.branches=s}});var t,i,a=[],r=c.groups,o={};if(void 0!==c.group){for(var s=0;s<r.length;s++)o[r[s].id]={id:r[s].id,name:r[s].name,parentId:r[s]._parentId};t=c.group}if(void 0!==c.document&&(t=c.document),t){if("Package"===t.type?(a.push({name:t.name,id:t.id,type:"group",alfLink:t._link,link:"project.ref.preview({documentId: 'site_' + breadcrumb.id + '_cover', search: undefined})"}),t._parentId&&(i=t._parentId)):(a.push({name:t.name,id:t.id,type:"doc",link:"project.ref.document({documentId: breadcrumb.id, search: undefined})"}),t._groupId&&(i=t._groupId)),i)for(;void 0!==o[i];){var l=o[i].id;a.push({name:o[l].name,id:l,type:"group",link:"project.ref.preview({documentId: 'site_' + breadcrumb.id + '_cover', search: undefined})"}),i=o[l].parentId}c.breadcrumbs=a.reverse(),f(function(){var e=n.children().children(),t=.85*(n.parent().width()-e[0].scrollWidth-e[2].scrollWidth)/c.breadcrumbs.length;c.truncateStyle={"max-width":t,"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis",display:"inline-block"}})}function d(e){var t=g.PROJECT_URL_PREFIX+c.project.id+"/"+e.id;return c.document&&(t+="/documents/"+c.document.id),c.view&&(t+="/views/"+c.view.id),t}}}}function veNav(e,t,a,i,r,o,s,l,c,d){return{restrict:"E",template:e.get("partials/mms/veNav.html"),scope:{title:"<mmsTitle",org:"<mmsOrg",project:"<mmsProject",projects:"<mmsProjects",ref:"<mmsRef",branch:"<mmsBranch",branches:"<mmsBranches",tag:"<mmsTag",tags:"<mmsTags",search:"<mmsSearch"},link:function(t,e,n){d.getOrgs().then(function(e){t.orgs=e}),t.isNavCollapsed=!0,t.updateOrg=function(){s.open({templateUrl:"partials/mms/selectModal.html",windowClass:"ve-dropdown-short-modal",scope:t,controller:["$scope","$uibModalInstance",function(t,e){t.selectedOrg=t.org.name,t.selectedProject=t.project.name;var n=t.org.id,i=t.project.id;t.selectOrg=function(e){e&&(n=e.id,t.selectedOrg=e.name,t.selectedProject="",d.getProjects(n).then(function(e){0<(t.projects=e).length&&t.selectProject(e[0])}))},t.selectProject=function(e){e&&(i=e.id,t.selectedProject=e.name)},t.spin=!1,t.continue=function(){n&&i&&(t.$parent.project.orgId===n&&t.$parent.project.id===i?t.cancel():(t.spin=!0,a.go("project.ref",{orgId:n,projectId:i,refId:"master",search:void 0}).then(function(e){},function(e){t.spin=!1})))},t.cancel=function(){e.dismiss()}}]})},t.toggleHelp=function(){i.toggleCheatSheet()},t.toggleAbout=function(){t.veV="3.6.1",t.mmsV="Loading...",l.getMmsVersion().then(function(e){t.mmsV=e},function(e){t.mmsV="Could not retrieve due to failure: "+e.message}),s.open({templateUrl:"partials/mms/about.html",scope:t,controller:["$scope","$uibModalInstance",function(e,t){e.cancel=function(){t.dismiss()}}]})},t.logout=function(){c.logout().then(function(){a.go("login")},function(){r.error("You were not logged out")})},t.searchClass="",t.search=function(e){a.includes("project.ref.document.order")?r.warning("Please finish reorder action first."):a.params.search!==e&&(t.searchClass="fa fa-spin fa-spinner",a.go(a.current.name,{search:e}))},t.stagingView=function(){var e=o.host(),t="https://uatlinkhere";"localhost"!==e&&"uat"!==e.split(".")[0].substr(-3)&&(t="https://"+e.split(".")[0]+"-uat.jpl.nasa.gov"),window.open(t,"_blank")},c.checkLogin().then(function(e){t.username=e})}}}directiveModule.directive("ngDropdownMultiselect",["$filter","$document","$compile","$parse","_",function(n,a,e,t,l){return{restrict:"AE",scope:{selectedModel:"=",options:"=",extraSettings:"=",events:"=",searchFilter:"=?",translationTexts:"=",groupBy:"@"},template:function(e,t){var n=!!t.checkboxes,i='<div class="multiselect-parent btn-group dropdown-multiselect ve-light-dropdown" ng-value="getButtonText()">';i+='<button type="button" class="dropdown-toggle" ng-class="settings.buttonClasses" ng-click="toggleDropdown()">{{getButtonText()}}&nbsp;<i class="fa fa-caret-down" aria-hidden="true"></i></button>',i+="<ul class=\"dropdown-menu dropdown-menu-form menu-with-input\" ng-style=\"{display: open ? 'block' : 'none', height : settings.scrollable ? settings.scrollableHeight : 'auto' }\" style=\"overflow-y: scroll\" >",i+='<li ng-hide="!settings.showCheckAll || settings.selectionLimit > 0"><a data-ng-click="selectAll()"><span class="fa fa-check"></span>  {{texts.checkAll}}</a>',i+='<li ng-show="settings.showUncheckAll"><a data-ng-click="deselectAll();"><span class="remove-list-item"></span>   {{texts.uncheckAll}}</a></li>',i+='<li class="dropdown-input" ng-show="settings.enableSearch"><input type="text" class="ve-plain-input" ng-model="searchFilter" placeholder="{{texts.searchPlaceholder}}" /></li>',!!t.groupBy?(i+='<li ng-repeat-start="option in orderedItems | filter: searchFilter" ng-show="getPropertyForObject(option, settings.groupBy) !== getPropertyForObject(orderedItems[$index - 1], settings.groupBy)" role="presentation" class="dropdown-header">{{ getGroupTitle(getPropertyForObject(option, settings.groupBy)) }}</li>',i+='<li ng-repeat-end role="presentation">'):i+='<li role="presentation" ng-repeat="option in options | filter: searchFilter">',i+='<a role="menuitem" tabindex="-1" ng-click="setSelectedItem(getPropertyForObject(option,settings.idProp))">',i+=n?'<div class="checkbox"><label><input class="checkboxInput" type="checkbox" ng-click="checkboxClick($event, getPropertyForObject(option,settings.idProp))" ng-checked="isChecked(getPropertyForObject(option,settings.idProp))" /> {{getPropertyForObject(option, settings.displayProp)}}</label></div></a>':"<span data-ng-class=\"{'checked-list-item': isChecked(getPropertyForObject(option,settings.idProp))}\"></span> {{getPropertyForObject(option, settings.displayProp)}}</a>",i+="</li>",i+='<li class="divider" ng-show="settings.selectionLimit > 1"></li>',i+='<li role="presentation" ng-show="settings.selectionLimit > 1"><a role="menuitem">{{selectedModel.length}} {{texts.selectionOf}} {{settings.selectionLimit}} {{texts.selectionCount}}</a></li>',i+="</ul>",i+="</div>",e.html(i)},link:function(r,e,t){var i=e.children()[0];function o(e){var t={};return""===r.settings.externalIdProp?t[r.settings.idProp]=e:t[r.settings.externalIdProp]=e,t}function s(e){for(var t in e)delete e[t]}r.toggleDropdown=function(){r.open=!r.open},r.checkboxClick=function(e,t){r.setSelectedItem(t),e.stopImmediatePropagation()},r.externalEvents={onItemSelect:angular.noop,onItemDeselect:angular.noop,onSelectAll:angular.noop,onDeselectAll:angular.noop,onInitDone:angular.noop,onMaxSelectionReached:angular.noop},r.settings={dynamicTitle:!0,scrollable:!1,scrollableHeight:"300px",closeOnBlur:!0,displayProp:"label",idProp:"id",externalIdProp:"id",enableSearch:!1,selectionLimit:0,showCheckAll:!0,showUncheckAll:!0,closeOnSelect:!1,buttonClasses:"btn btn-default",closeOnDeselect:!1,groupBy:t.groupBy||void 0,groupByTextProvider:null,smartButtonMaxItems:0,smartButtonTextConverter:angular.noop},r.texts={checkAll:"Check All",uncheckAll:"Uncheck All",selectionCount:"checked",selectionOf:"/",searchPlaceholder:"Search...",buttonDefaultText:"Select",dynamicButtonTextSuffix:"checked"},r.searchFilter=r.searchFilter||"",angular.isDefined(r.settings.groupBy)&&r.$watch("options",function(e){angular.isDefined(e)&&(r.orderedItems=n("orderBy")(e,r.settings.groupBy))}),angular.extend(r.settings,r.extraSettings||[]),angular.extend(r.externalEvents,r.events||[]),angular.extend(r.texts,r.translationTexts),r.singleSelection=1===r.settings.selectionLimit,r.singleSelection&&angular.isArray(r.selectedModel)&&0===r.selectedModel.length&&s(r.selectedModel),r.settings.closeOnBlur&&a.on("click",function(e){for(var t=e.target.parentElement,n=!1;angular.isDefined(t)&&null!==t&&!n;)l.contains(t.className.split(" "),"multiselect-parent")&&!n&&t===i&&(n=!0),t=t.parentElement;n||r.$apply(function(){r.open=!1})}),r.getGroupTitle=function(e){return null!==r.settings.groupByTextProvider?r.settings.groupByTextProvider(e):e},r.getButtonText=function(){if(r.settings.dynamicTitle&&(0<r.selectedModel.length||angular.isObject(r.selectedModel)&&0<l.keys(r.selectedModel).length)){if(0<r.settings.smartButtonMaxItems){var i=[];return angular.forEach(r.options,function(e){if(r.isChecked(r.getPropertyForObject(e,r.settings.idProp))){var t=r.getPropertyForObject(e,r.settings.displayProp),n=r.settings.smartButtonTextConverter(t,e);i.push(n||t)}}),r.selectedModel.length>r.settings.smartButtonMaxItems&&(i=i.slice(0,r.settings.smartButtonMaxItems)).push("..."),i.join(", ")}var e;return 0===(e=r.singleSelection?null!==r.selectedModel&&angular.isDefined(r.selectedModel[r.settings.idProp])?1:0:angular.isDefined(r.selectedModel)?r.selectedModel.length:0)?r.texts.buttonDefaultText:e+" "+r.texts.dynamicButtonTextSuffix}return r.texts.buttonDefaultText},r.getPropertyForObject=function(e,t){return angular.isDefined(e)&&e.hasOwnProperty(t)?e[t]:""},r.selectAll=function(){r.deselectAll(!1),r.externalEvents.onSelectAll(),angular.forEach(r.options,function(e){r.setSelectedItem(e[r.settings.idProp],!0)})},r.deselectAll=function(e){(e=e||!0)&&r.externalEvents.onDeselectAll(),r.singleSelection?s(r.selectedModel):r.selectedModel.splice(0,r.selectedModel.length)},r.setSelectedItem=function(e,t){var n=o(e),i=null;if(i=""===r.settings.externalIdProp?l.find(r.options,n):n,r.singleSelection)return s(r.selectedModel),angular.extend(r.selectedModel,i),r.externalEvents.onItemSelect(i),void(r.settings.closeOnSelect&&(r.open=!1));t=t||!1;var a=-1!==l.findIndex(r.selectedModel,n);!t&&a?(r.selectedModel.splice(l.findIndex(r.selectedModel,n),1),r.externalEvents.onItemDeselect(n)):!a&&(0===r.settings.selectionLimit||r.selectedModel.length<r.settings.selectionLimit)&&(r.selectedModel.push(i),r.externalEvents.onItemSelect(i)),r.settings.closeOnSelect&&(r.open=!1)},r.isChecked=function(e){return r.singleSelection?null!==r.selectedModel&&angular.isDefined(r.selectedModel[r.settings.idProp])&&r.selectedModel[r.settings.idProp]===o(e)[r.settings.idProp]:-1!==l.findIndex(r.selectedModel,o(e))},r.externalEvents.onInitDone()}}}]),angular.module("mms.directives").factory("Utils",["$q","$uibModal","$timeout","$templateCache","$rootScope","$compile","$window","URLService","CacheService","ElementService","ViewService","UtilsService","AuthService","growl",Utils]),angular.module("app.tpls",["partials/mms/about.html","partials/mms/add-pe.html","partials/mms/cancelConfirm.html","partials/mms/cancelModal.html","partials/mms/confirmDelete.html","partials/mms/confirmRemove.html","partials/mms/docCover.html","partials/mms/full-doc.html","partials/mms/login.html","partials/mms/manage-refs.html","partials/mms/new-branch.html","partials/mms/new-doc-or-group.html","partials/mms/new-tag.html","partials/mms/new-view.html","partials/mms/pane-center.html","partials/mms/pane-left.html","partials/mms/pane-right.html","partials/mms/printConfirm.html","partials/mms/redirect.html","partials/mms/reorder-groups.html","partials/mms/reorder-views.html","partials/mms/select.html","partials/mms/selectModal.html","partials/mms/tableExport.html","partials/mms/veFooter.html","partials/mms/veMenu.html","partials/mms/veNav.html"]),angular.module("partials/mms/about.html",[]).run(["$templateCache",function(e){e.put("partials/mms/about.html",'<div class="modal-header">\n    <h4>About</h4>\n</div>\n\n<div class="modal-body">\n    <p>MMS Version : <b>{{mmsV}}</b></p>\n    <p>View Editor Version : <b>{{veV}}</b></p>\n</div>\n\n<div class="modal-footer">\n    <button class="btn btn-default" ng-click="cancel()">Close</button>\n</div>\n')}]),angular.module("partials/mms/add-pe.html",[]).run(["$templateCache",function(e){e.put("partials/mms/add-pe.html",'\x3c!-- TODO: This is almost the same as new-view.html.  Should be combined if possible --\x3e\n\n<div class="modal-header">\n    <h4 class="pe-type-{{presentationElemType}}">Add {{presentationElemType | lowercase}}</h4>\n</div>\n\n<div class="modal-body">\n    <div class="ve-light-tabs modal-top-tabs">\n        <ul class="nav nav-tabs" ng-show="presentationElemType != \'Comment\'">\n            <li class="uib-tab nav-item tab-item" ng-class="{\'active\': createForm}">\n                <a class="nav-link" ng-click="createForm = true"><i class="fa fa-plus"></i>Create New</a>\n            </li>\n            <li class="uib-tab nav-item tab-item" ng-class="{\'active\': !createForm}">\n                <a class="nav-link" ng-click="createForm = false"><i class="fa fa-search"></i>Search for existing</a>\n            </li>\n        </ul>\n    </div>\n\n    <div ng-show="createForm">\n        <div class="form-group">\n            <label>Name (optional):</label>\n            <input class="form-control" ng-model="newPe.name" ng-keyup="$event.keyCode == 13 ? ok() : null" type="text" placeholder="Type a name for your {{presentationElemType}} here"\n                autofocus>\n        </div>\n    </div>\n\n    <div ng-show="!createForm">\n        <p>Begin by searching for the {{presentationElemType | lowercase}}, then click its name or documentation to add the {{presentationElemType | lowercase}}.</p>\n        <mms-search mms-options="searchOptions" mms-project-id="{{viewOrSectionOb._projectId}}" mms-ref-id="{{viewOrSectionOb._refId}}"></mms-search>\n    </div>\n</div>\n\n<div class="modal-footer">\n    <button class="btn btn-primary" ng-show="createForm" ng-click="ok()">Create\n        <i ng-show="oking" class="fa fa-spin fa-spinner"></i>\n    </button>\n    <button class="btn btn-default" ng-click="cancel()">Cancel</button>\n</div>')}]),angular.module("partials/mms/cancelConfirm.html",[]).run(["$templateCache",function(e){e.put("partials/mms/cancelConfirm.html",'<div class="modal-header">\n    <h4>Discard Modifications</h4>\n</div>\n\n<div class="modal-body">\n    <p>\n      There are unsaved modifications to this element, which may include html beautification.<br/>\n      Are you sure you want to discard them? \n    </p>\n</div>\n\n<div class="modal-footer">\n    <button class="btn btn-warning " ng-click="ok()">Discard</button>\n    <button class="btn btn-default" ng-click="cancel()">Cancel</button>\n</div>\n')}]),angular.module("partials/mms/cancelModal.html",[]).run(["$templateCache",function(e){e.put("partials/mms/cancelModal.html",'<div class="assistModal">\n    <div class="modal-body">\n        <h3>Are you sure you want to exit this page?</h3>\n        <br>\n        <div>\n            Your changes will not be saved if you leave this page, but you may come back to this page later using the\n            same link.\n        </div>\n        <br>\n        <span style="text-align: right; width: 100%; display: inline-block;">\n            <button class="btn btn-warning" ng-click="exit()">Leave page</button>\n            <button class="btn btn-default" ng-click="close()">Stay on page</button>\n        </span>\n    </div>\n</div>')}]),angular.module("partials/mms/confirmDelete.html",[]).run(["$templateCache",function(e){e.put("partials/mms/confirmDelete.html",'<div class="modal-header">\n    <h4>Confirm Delete</h4>\n</div>\n\n<div class="modal-body">\n    <p>Are you sure you want to delete {{type}} <b>&ldquo;{{name}}&rdquo;</b>?</p>\n</div>\n\n<div class="modal-footer">\n    <button class="btn btn-warning" ng-click="ok()">Delete <i ng-show="oking" class="fa fa-spin fa-spinner"></i></button>\n    <button class="btn btn-default" ng-click="cancel()">Cancel</button>\n</div>')}]),angular.module("partials/mms/confirmRemove.html",[]).run(["$templateCache",function(e){e.put("partials/mms/confirmRemove.html",'<div class="modal-header">\n    <h4>Confirm Remove</h4>\n</div>\n\n<div class="modal-body">\n    <p>Are you sure you want to remove {{type}} <b>&ldquo;{{name}}&rdquo;</b>?</p>\n    <p ng-if="type != \'Document\' && type != \'group\'">This will remove <b>&ldquo;{{name}}&rdquo;</b> from the hierarchy, but you can still access it in search.</p>\n    <p ng-if="type === \'Document\' || type === \'group\'">This will remove <b>&ldquo;{{name}}&rdquo;</b> from the project navigation, but you can still access it in search.</p>\n</div>\n\n<div class="modal-footer">\n    <button class="btn btn-warning" ng-click="ok()">Remove <i ng-show="oking" class="fa fa-spin fa-spinner"></i></button>\n    <button class="btn btn-default" ng-click="cancel()">Cancel</button>\n</div>')}]),angular.module("partials/mms/docCover.html",[]).run(["$templateCache",function(e){e.put("partials/mms/docCover.html",'<div>\n    <div style="page-break-after:always">\n        <div style="text-align:center; font-size:32px">{{meta.project}}</div>\n        <div style="text-align:center; font-size:30px">{{meta.title}}</div>\n        <div style="text-align:center; font-size:12px"> {{meta.version}} {{tag.name}}</div>\n        <br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>\n\n        <div> Paper copies of this document may not be current and should not be relied on for official purposes.</div>\n        <div> {{meta.titlelegal}}</div>\n        <div> {{time | date:\'M/d/yy h:mm a\'}}</div>\n        <div> {{meta.dnumber}}</div>\n        <br/><br/>\n        <div ng-if="meta.instlogo"><img ng-src="{{meta.instlogo}}"></div>\n        <div> {{meta.inst1}}</div>\n        <div> {{meta.inst2}}</div>\n    </div>\n\n\n    <div style="page-break-after:always">\n        <div style="font-size:32px" ng-if="meta.project">{{meta.project}}</div>\n        <div style="font-size:30px">{{meta.title}}</div>\n        <div style="font-size:12px"><span ng-if="meta.version">{{meta.version}}</span> {{tag.name}}</div>\n        \n        <div ng-if="meta.authors.length > 0">\n            <br/><br/>\n            <div>PREPARED BY:</div>\n            <div ng-repeat="author in meta.authors">\n                <br/><br/>\n                <div><span>_____________________________________</span> <span class="pull-right">________________</span></div>\n                <div><span>{{author.firstname}} {{author.lastname}}</span><span class="pull-right">Date</span></div>\n                <div>{{author.title}}, {{author.orgname}} ({{author.orgnum}})</div>\n            </div>\n        </div>\n\n        <div ng-if="meta.approvers.length > 0"> \n            <br/><br/>\n            <div>APPROVED BY:</div>\n            <div ng-repeat="author in meta.approvers">\n                <br/><br/>\n                <div><span>_____________________________________</span> <span class="pull-right">________________</span></div>\n                <div><span>{{author.firstname}} {{author.lastname}}</span><span class="pull-right">Date</span></div>\n                <div>{{author.title}}, {{author.orgname}} ({{author.orgnum}})</div>\n            </div>\n        </div>\n\n        <div ng-if="meta.concurrences.length > 0">\n            <br/><br/>\n            <div>CONCURRED BY:</div>\n            <div ng-repeat="author in meta.concurrences">\n                <br/><br/>\n                <div><span>_____________________________________</span> <span class="pull-right">________________</span></div>\n                <div><span>{{author.firstname}} {{author.lastname}}</span><span class="pull-right">Date</span></div>\n                <div>{{author.title}}, {{author.orgname}} ({{author.orgnum}})</div>\n            </div>\n        </div>\n\n        <br/><br/>\n        <div ng-if="meta.instlogo"> <img ng-src="{{meta.instlogo}}"></div>\n        <div> {{meta.inst1}}</div>\n        <div> {{meta.inst2}}</div>\n    </div>\n\n    <div style="page-break-after:always">\n        <div ng-if="meta.revisions.length > 0"> \n            <div style="text-align:center"><b>Change Log</b></div>\n            <table>\n                <thead>\n                    <tr><td>Version</td><td>Date</td><td>Sections Changed</td><td>Author</td></tr>\n                </thead>\n                <tbody>\n                    <tr ng-repeat="rev in meta.revisions"><td>{{rev.revnum}}</td><td>{{rev.date}}</td><td>{{rev.remark}}</td><td>{{rev.firstname}} {{rev.lastname}}</td></tr>\n                </tbody>\n            </table>\n        </div>\n\n        <div ng-if="meta.emails.length > 0">\n            <br/>\n            <div style="text-align:center"><b>Distribution List</b></div>\n            <div ng-repeat="email in meta.emails">{{email}}</div>\n        </div>\n\n        <br/><br/><br/><br/><br/><br/><br/><br/>\n        <div ng-if="meta.instlogo"> <img ng-src="{{meta.instlogo}}"></div>\n        <div> {{meta.inst1}}</div>\n        <div> {{meta.inst2}}</div>\n    </div>\n</div>')}]),angular.module("partials/mms/full-doc.html",[]).run(["$templateCache",function(e){e.put("partials/mms/full-doc.html",'<div ng-if="search === null">\n    <div fa-pane pane-anchor="north" pane-size="36px" pane-no-toggle="true" pane-no-scroll="true">\n        <div class="pane-center-toolbar">\n            <div class="doclib-link">\n                <a type="button" class="btn btn-tools btn-sm" target="_blank" rel="noopener noreferrer" ng-href="{{docLibLink}}" uib-tooltip="Manage files" tooltip-placement="bottom" tooltip-popup-delay="100">\n                    <img src="assets/alfresco-icon-sm.png">DocLib\n                </a>\n                <button type="button" class="btn btn-tools btn-sm share-url" ng-if="!ve_fn" ng-click="handleShareURL()" uib-tooltip="Share Page" tooltip-placement="bottom" tooltip-popup-delay="100"\n                        popover-trigger="outsideClick" uib-popover-template="dynamicPopover.templateUrl" popover-title="{{dynamicPopover.title}}" popover-placement="bottom-left">\n                    <i class="fa fa-share-alt"></i></button>\n            </div>\n            <div class="pane-center-btn-group">\n                <mms-button-bar buttons="buttons" mms-bb-api="bbApi" class="bordered-button-bar"></mms-button-bar>\n            </div>\n        </div>\n    </div>\n    <div fa-pane pane-anchor="center" pane-scroll-api="scrollApi">\n        <i class="pane-center-spinner fa fa-5x fa-spinner fa-spin" ng-show="ve_viewContentLoading"></i>\n        <div class="ve-notify-banner" ng-show="refOb.type === \'Tag\'">\n            <span><strong>Tags are read only:</strong> Switch to a branch to edit</span>\n        </div>\n        <div class="container-fluid ve-secondary-text"> Document Last Modified: {{ latestElement | date:\'M/d/yy h:mm a\' }}</div>\n        <div class="pane-center container-fluid" id="print-div">\n            <div ng-repeat="view in views track by view.id" ng-class="{chapter: view.topLevel, \'first-chapter\': view.first}">\n                <mms-view mms-element-id="{{view.id}}" mms-commit-id="latest" mms-project-id="{{projectOb.id}}" mms-ref-id="{{refOb.id}}" mms-number="{{view.number}}" mms-view-api="view.api"></mms-view>\n            </div>\n        </div>\n    </div>\n</div>\n\n<div ng-if="search !== null">\n    <i class="pane-center-spinner fa fa-5x fa-spinner fa-spin" ng-show="ve_viewContentLoading"></i>\n    <mms-search mms-options="searchOptions" mms-project-id={{projectOb.id}} mms-ref-id="{{refOb.id}}"></mms-search>\n</div>\n\n<script type="text/ng-template" id="shareUrlTemplate.html">\n    <p id="ve-short-url">\n        {{(shortUrl)}}\n    </p>\n    <button ng-click="copyToClipboard($event)" class="btn btn-sm btn-default"><i class="fa fa-copy"></i>Copy</button>\n<\/script>\n')}]),angular.module("partials/mms/login.html",[]).run(["$templateCache",function(e){e.put("partials/mms/login.html",'<div id="ve-login" class="row">\n    <div class="account-wall">\n        <div>\n            <h2>{{ pageTitle }}</h2>\n        </div>\n        <div>\n            <form name="loginForm" ng-submit="login(credentials)">\n                <span class="label-text">Username:</span>\n                <input type="text" class="form-control login-input" ng-model="credentials.username" autofocus>\n                <span class="label-text">Password:</span>\n                <input type="password" class="form-control login-input" ng-model="credentials.password">\n                <button class="btn btn-block btn-primary" type="submit">Log In\n                    <span ng-if="spin" ><i class="fa fa-spin fa-spinner"></i></span>\n                </button>\n            </form>\n        </div>\n    </div>\n</div>\n')}]),angular.module("partials/mms/manage-refs.html",[]).run(["$templateCache",function(e){e.put("partials/mms/manage-refs.html",'<div class="container-fluid ve-no-panes">\n    <div class="row">\n        <div class="col-md-10 col-md-offset-1">\n            <a class="back-to-docs" ui-sref="project.ref({refId: fromParams.id, search: undefined})"\n               ui-sref-opts="{reload:true}">Back to Project Documents ({{fromParams.name}})</a>\n            <h1 class="panel-title">Manage Project branches/tags</h1>\n            <div class="panel panel-default">\n                <div class="panel-body no-padding-panel">\n                    <div ng-show="refManageView" class="col-md-4 ve-light-list-panels">\n                        <ul class="ve-light-list">\n                            <li class="ve-light-input">\n                                <input placeholder="Filter branches/tags" class="ve-plain-input" ng-model="refFilter">\n                            </li>\n                            <li class="ref-title">\n                                <h2><i class="fa fa-code-fork" aria-hidden="true"></i>Branches</h2>\n                            </li>\n                            <li class="ref-item" ng-repeat="branch in branches | orderBy:\'name\' | filter:{name:refFilter}" ng-click="refClickHandler(branch)"\n                                ng-class="{\'selected\': branch.id === refSelected.id}">\n                                <a>{{ branch.name }}</a>\n                            </li>\n                            <li class="ref-title">\n                                <h2><i class="fa fa-tag" aria-hidden="true"></i>Tags</h2>\n                            </li>\n                            <li class="ref-item" ng-repeat="tag in tags | orderBy:\'name\' | filter:{name:refFilter}" ng-click="refClickHandler(tag)"\n                                ng-class="{\'selected\': tag.id === refSelected.id}">\n                                <a>{{ tag.name }}</a>\n                            </li>\n                            <li ng-if="!tags.length" class="ve-secondary-text">No Tags</li>\n                        </ul>\n                    </div>\n                    <div class="col-md-8 ve-light-panels-detail" ng-show="refSelected">\n                        <div class="panels-detail-title clearfix">\n                            <h3 class="{{refSelected.type}}-icon">{{refSelected.name}}</h3>\n                            <div class="ref-button-options" style="float:right">\n                            <button class="btn btn-default" ng-disabled="refSelected.status === \'creating\'" type="button" ng-click="deleteRef()" ng-if="refSelected.id != \'master\'"><i class="fa fa-trash"></i> Delete</button>\n                            <button class="btn btn-primary" ng-disabled="refSelected.status === \'creating\'" type="button" ng-click="addTag()"><i class="fa fa-plus"></i> Tag</button>\n                            <button class="btn btn-primary" ng-disabled="refSelected.status === \'creating\'" type="button" ng-click="addBranch()"><i class="fa fa-plus"></i> Branch</button>\n                            </div>\n                            \x3c!-- <mms-button-bar buttons="buttons" mms-bb-api="bbApi"></mms-button-bar> --\x3e\n                        </div>\n                        <dl class="dl-horizontal ve-light-panels-detail-content">\n                            <dt></dt>\n                            <dd ng-hide="refSelected.status === \'creating\'" class="link-section">\n                                <a ui-sref="project.ref({refId: refSelected.id, search: undefined})" ui-sref-opts="{reload:true}">Project Documents</a>\n                            </dd>\n                            <dd ng-show="refSelected.status === \'creating\'" class="link-section">\n                                <span uib-tooltip-html="htmlTooltip" tooltip-placement="top" tooltip-trigger="mouseenter"\n                                    tooltip-append-to-body="refSelected.status == \'creating\'" tooltip-enable="refSelected.status == \'creating\'"\n                                    ng-class="{\'branch-disabled\': refSelected.status == \'creating\'}">Project Documents</span>\n                            </dd>\n                            <dt>Id</dt>\n                            <dd>{{refSelected.id}}</dd>\n                            <dt>Type</dt>\n                            <dd>{{refSelected.type}}</dd>\n                            <dt>Description</dt>\n                            <dd>{{refSelected.description}}</dd>\n                            <span ng-if="refSelected.id != \'master\'">\n                            <dt>Time Created</dt>\n                            <dd>{{refSelected._created}}</dd>\n                            <dt>Creator</dt>\n                            <dd>{{refSelected._creator}}</dd>\n                            \x3c!-- <dt>Last Modified</dt>\n                            <dd>{{refSelected._modified}}</dd> --\x3e\n                            <dt>Modifier</dt>\n                            <dd>{{refSelected._modifier}}</dd>\n                            <dt>Parent Ref</dt>\n                            <dd>{{refSelected.parentRefId}}</dd>\n                            </span>\n                        </dl>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>')}]),angular.module("partials/mms/new-branch.html",[]).run(["$templateCache",function(e){e.put("partials/mms/new-branch.html",'<div class="modal-header">\n    <h4 class="branch-icon">Create new branch from {{from}}</h4>\n</div>\n\n<div class="modal-body ve-new-ref">\n    <p class="modal-description">A <b>branch</b> is a copy of your project for you to work on specific tasks or sandbox ideas, without interfering with other copies.\n        <a ui-sref="project.ref.document.view({documentId: \'_18_0_2_8630260_1446850132083_177552_51111\', viewId: \'MMS_1453977130045_239e2aee-1243-4480-a6f8-61ff7bed700f\', projectId: \'PROJECT-ID_10_15_15_1_41_52_PM_5b84f7be_1506a83819c__6bce_cae_tw_jpl_nasa_gov_128_149_19_85\', refId: \'master\', search: undefined})">more</a></p>\n    <div class="form-group">\n        <label>Name</label>\n        <input class="form-control" ng-model="branch.name" type="text"\n            placeholder="Type a name for your branch here" autofocus>\n    </div>\n    <div class="form-group">\n        <label>Description</label>\n        <textarea class="form-control" ng-model="branch.description"></textarea>\n    </div>\n    <div class="form-group">\n        <label>Permission</label>\n        <br />\n        <input ng-model="branch.permission" value="read" type="radio"> Read\n        <br />\n        <input ng-model="branch.permission" value="write" type="radio"> Write\n    </div>\n    <div class="form-group">\n        <label>Point in History</label>\n        <form>\n            <div class="radio radio-with-label">\n                <label for="most-recent">\n                    <input id="most-recent" type="radio" name="most recent" ng-model="branch.lastCommit" ng-value="true">Most Recent\n                </label><br>\n                <label for="specify-point">\n                    <input id="specify-point" type="radio" name="specify point" ng-model="branch.lastCommit" ng-value="false">Specify a timestamp\n                </label>\n                <div class="indent ve-secondary-text timestamp-format">\n                    <i>(YYYY-MM-DDTHH:MM:SS)</i>\n                </div>\n            </div>\n            <div class="indent">\n                <input class="datetimepicker" id="branch">\n            </div>\n        </form>\n    </div>\n</div>\n\n<div class="modal-footer">\n    <button class="btn btn-primary" ng-click="ok()">Create <i ng-show="oking" class="fa fa-spin fa-spinner"></i></button>\n    <button class="btn btn-default" ng-click="cancel()">Cancel</button>\n</div>')}]),angular.module("partials/mms/new-doc-or-group.html",[]).run(["$templateCache",function(e){e.put("partials/mms/new-doc-or-group.html",'<div class="modal-header">\n    <h4 class="item-type-{{itemType}}">Create new {{itemType | lowercase}}</h4>\n</div>\n\n<div class="modal-body comment-modal">\n\n    <div class="comment-modal-input">\n        <div class="form-group">\n            <label>Name:</label>\n            <input ng-if="itemType === \'Document\'" class="form-control" ng-model="newDoc.name" type="text"\n                ng-keyup="$event.keyCode == 13 ? ok() : null" placeholder="Type a name for your document here" autofocus>\n            <input ng-if="itemType === \'Group\'"class="form-control" ng-model="newGroup.name" type="text"\n                ng-keyup="$event.keyCode == 13 ? ok() : null" placeholder="Type a name for your group here" autofocus>\n        </div>\n    </div>\n\n</div>\n\n<div class="modal-footer">\n    <button class="btn btn-primary" ng-click="ok()">Create <i ng-show="oking" class="fa fa-spin fa-spinner"></i>\n    </button>\n    <button class="btn btn-default" ng-click="cancel()">Cancel</button>\n</div>')}]),angular.module("partials/mms/new-tag.html",[]).run(["$templateCache",function(e){e.put("partials/mms/new-tag.html",'<div class="modal-header">\n    <h4 class="tag-icon">Create new tag</h4>\n    <span class="ve-notify-banner">Tags are read only</span>\n</div>\n\n<div class="modal-body ve-new-ref">\n    <p class="modal-description">A <b>tag</b> is a read-only version of your project at a specific moment in time, typically a release or review.\n        <a ui-sref="project.ref.document.view({documentId: \'_18_0_2_8630260_1446850132083_177552_51111\', viewId: \'MMS_1453977130045_239e2aee-1243-4480-a6f8-61ff7bed700f\', projectId: \'PROJECT-ID_10_15_15_1_41_52_PM_5b84f7be_1506a83819c__6bce_cae_tw_jpl_nasa_gov_128_149_19_85\', refId: \'master\', search: undefined})">more</a></p>\n    <div class="form-group">\n        <label>Name</label>\n        <input class="form-control" ng-model="tag.name" type="text"\n            placeholder="Type a name for your tag here" autofocus>\n    </div>\n    <div class="form-group">\n        <label>Description</label>\n        <textarea class="form-control" ng-model="tag.description"></textarea>\n    </div>\n    <div class="form-group">\n        <label>Point in History</label>\n        <form>\n            <div class="radio radio-with-label">\n                <label for="most-recent">\n                    <input id="most-recent" type="radio" name="most recent" ng-model="tag.lastCommit" ng-value="true">\n                    Most Recent\n                </label><br>\n                <label for="specify-point">\n                    <input id="specify-point" type="radio" name="specify point" ng-model="tag.lastCommit" ng-value="false">\n                    Specify a timestamp\n                </label>\n                <div class="indent ve-secondary-text timestamp-format">\n                    <i>(YYYY-MM-DDTHH:MM:SS)</i>\n                </div>\n            </div>\n            <div class="indent">\n                <input class="datetimepicker" id="tag">\n            </div>\n        </form>\n    </div>\n</div>\n\n<div class="modal-footer">\n    <button class="btn btn-primary" ng-click="ok()">Create <i ng-show="oking" class="fa fa-spin fa-spinner"></i></button>\n    <button class="btn btn-default" ng-click="cancel()">Cancel</button>\n</div>')}]),angular.module("partials/mms/new-view.html",[]).run(["$templateCache",function(e){e.put("partials/mms/new-view.html",'<div class="modal-header">\n    <h4 class="item-type-View"></i>Add view</h4>\n</div>\n\n<div class="modal-body">\n    <div class="ve-light-tabs modal-top-tabs">\n        <ul class="nav nav-tabs">\n            <li class="uib-tab nav-item tab-item" ng-class="{\'active\': createForm}">\n                <a class="nav-link" ng-click="createForm = true"><i class="fa fa-plus"></i>Create New</a>\n            </li>\n            <li class="uib-tab nav-item tab-item" ng-class="{\'active\': !createForm}">\n                <a class="nav-link" ng-click="createForm = false"><i class="fa fa-search"></i>Search for existing</a>\n            </li>\n        </ul>\n    </div>\n\n    <div ng-show="createForm">\n        <div class="form-group">\n            <label>Name (optional):</label>\n            <input class="form-control" ng-model="newView.name" ng-keyup="$event.keyCode == 13 ? ok() : null" type="text" placeholder="Type a name for your view here" autofocus>\n        </div>\n    </div>\n\n    <div ng-show="!createForm">\n        <p>Begin by searching for the view, then click its name or documentation to add the view.</p>\n        <div class="radio">\n            <label><input type="radio" ng-model="newViewAggr.type" value="shared">Add view and its children</label><br>\n            <label><input type="radio" ng-model="newViewAggr.type" value="none">Add view only</label>\n        </div>\n        <mms-search mms-options="searchOptions" mms-project-id="{{projectOb.id}}" mms-ref-id="{{refOb.id}}"></mms-search>\n    </div>\n</div>\n\n<div class="modal-footer">\n    <button class="btn btn-primary" ng-show="createForm" ng-click="ok()">Create\n        <i ng-show="oking" class="fa fa-spin fa-spinner"></i>\n    </button>\n    <button class="btn btn-default" ng-click="cancel()">Cancel</button>\n</div>')}]),angular.module("partials/mms/pane-center.html",[]).run(["$templateCache",function(e){e.put("partials/mms/pane-center.html",'<div ng-if="view !== null && search === null">\n    <div fa-pane pane-anchor="north" pane-size="36px" pane-no-toggle="true" pane-no-scroll="true">\n        <div class="pane-center-toolbar">\n            <div class="doclib-link">\n                <a type="button" class="btn btn-tools btn-sm" target="_blank" rel="noopener noreferrer" ng-href="{{docLibLink}}" uib-tooltip="Manage files" tooltip-placement="bottom" tooltip-popup-delay="100">\n                    <img src="assets/alfresco-icon-sm.png">DocLib\n                </a>\n                <button type="button" class="btn btn-tools btn-sm share-url" ng-if="!ve_fn" ng-click="handleShareURL()" uib-tooltip="Share Page" tooltip-placement="bottom" tooltip-popup-delay="100"\n                popover-trigger="outsideClick" uib-popover-template="dynamicPopover.templateUrl" popover-title="{{dynamicPopover.title}}" popover-placement="bottom-left">\n                <i class="fa fa-share-alt"></i></button>\n            </div>\n            <div class="pane-center-btn-group">\n                <mms-button-bar buttons="buttons" mms-bb-api="bbApi" class="bordered-button-bar"></mms-button-bar>\n            </div>\n        </div>\n    </div>\n    <div fa-pane pane-anchor="center">\n        <i class="pane-center-spinner fa fa-5x fa-spinner fa-spin" ng-show="ve_viewContentLoading"></i>\n        <div ng-hide="ve_viewContentLoading" class="container-fluid">\n            <div class="pane-center-inner">\n                <div class="ve-notify-banner" ng-show="refOb.type === \'Tag\'">\n                    <span><strong>Tags are read only:</strong> Switch to a branch to edit</span>\n                </div>\n                <div class="ve-secondary-text">{{comments.count}} Comment<span ng-if="comments.count !== 1">s</span>\n                    <span ng-if="comments.count > 0">\n                        , Last Commented {{comments.lastCommented | date:\'M/d/yy h:mm a\'}} by <b>{{comments.lastCommentedBy}}</b></span>\n                </div>\n                <div id="print-div" ng-if="viewOb">\n                    <mms-view mms-element-id="{{viewOb.id}}" mms-commit-id="latest"\n                              mms-project-id="{{projectOb.id}}" mms-ref-id="{{refOb.id}}"\n                              mms-view-api="viewApi" mms-link="vidLink"></mms-view>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<div ng-if="search !== null">\n    <i class="pane-center-spinner fa fa-5x fa-spinner fa-spin" ng-show="ve_viewContentLoading"></i>\n    <mms-search mms-options="searchOptions" mms-project-id="{{projectOb.id}}" mms-ref-id="{{refOb.id}}"></mms-search>\n</div>\n\n<script type="text/ng-template" id="shareUrlTemplate.html">\n    <p id="ve-short-url">{{(shortUrl)}}</p>\n    <button ng-click="copyToClipboard($event)" class="btn btn-sm btn-default"><i class="fa fa-copy"></i>Copy</button>\n<\/script>\n')}]),angular.module("partials/mms/pane-left.html",[]).run(["$templateCache",function(e){e.put("partials/mms/pane-left.html",'<div fa-pane pane-anchor="north" pane-size="78px" pane-no-toggle="true" pane-no-scroll="true">\n    <div class="pane-left">\n        <div class="pane-left-toolbar" role="toolbar">\n            <mms-button-bar buttons="buttons" mms-bb-api="bbApi"></mms-button-bar>\n        </div>\n        <div class="tree-options">\n            <mms-button-bar buttons="treeButtons" mms-bb-api="tbApi"></mms-button-bar>\n            <input class="ve-plain-input" ng-model-optoins="{debounce: 1000}"\n                ng-model="treeOptions.search" type="text" placeholder="{{filterInputPlaceholder}}"\n                ng-change="searchInputChangeHandler();" style="flex:2">\n        </div>\n    </div>\n</div>\n<div fa-pane pane-anchor="center" pane-no-toggle="true">\n    <div class="pane-left" style="display:table;">\n        <mms-tree ng-show="\'showTree\'==(activeMenu)" tree-data="treeData"\n                tree-control="treeApi" initial-selection="{{ve_treeInitial}}" options="treeOptions"></mms-tree>\n\n        <div data-ng-repeat="view in ::treeViewModes" ng-show="view.id==(activeMenu)">\n            <h4 style="margin: 3px 0px 3px 10px;">List of {{view.title}}</h4>\n            <ul class="nav nav-list nav-pills nav-stacked abn-tree">\n                <li ng-repeat="row in view.branchList | filter:treeOptions.search track by $index"\n                    class="abn-tree-row">\n                    <div class="arrow" ng-click="user_clicks_branch(row)"\n                        ng-class="{\'active-text\': row.branch.selected}" id="tree-branch-{{view.id}}-{{row.data.id}}">\n                        <a class="tree-item" style="padding-left: 20px; position:relative;">\n                            <i ng-class="{\'active-text\': row.branch.selected}"\n                            class="indented tree-icon fa {{view.icon}}"></i>\n                            \x3c!-- TODO active branch --\x3e\n                            <span class="indented tree-label" ng-class="{\'active-text\': row.branch.selected}">{{row.data._veNumber}} {{row.data.name}}</span>\n                        </a>\n                    </div>\n                </li>\n            </ul>\n        </div>\n\n    </div>\n</div>\n')}]),angular.module("partials/mms/pane-right.html",[]).run(["$templateCache",function(e){e.put("partials/mms/pane-right.html",'<div class="pane-right">\n    <div ng-if="documentOb">\n        <div class="container-fluid" ng-show="show.element">\n            <h4 ng-if="specApi.getEditing()" class="right-pane-title">Edit Element</h4>\n            <h4 ng-if="!specApi.getEditing()" class="right-pane-title">Preview Element</h4>\n            <form class="form-horizontal">\n                <div class="form-group">\n                    <label class="col-sm-3 control-label">Edits ({{veEditsLength()}}):</label>\n                    <div class="col-sm-9">\n                        <select class="form-control"\n                            ng-options="eid as edit.type + \': \' + edit.name for (eid, edit) in ve_edits"\n                            ng-model="tracker.etrackerSelected" ng-change="etrackerChange()">\n                        </select>\n                    </div>\n                </div>\n            </form>\n            <hr class="spec-title-divider">\n            <mms-spec mms-element-id="{{specInfo.id}}" mms-commit-id="{{specInfo.commitId}}"\n                mms-ref-id="{{specInfo.refId}}" mms-project-id="{{specInfo.projectId}}"\n                mms-display-old-content="specInfo.mmsDisplayOldContent" mms-spec-api="specApi"></mms-spec>\n        </div>\n    </div>\n\n    <div ng-if="documentOb">\n        <div class="container-fluid" ng-if="show.history">\n            <mms-history mms-element-id="{{specInfo.id}}" mms-ref-id="{{specInfo.refId}}"\n                mms-project-id="{{specInfo.projectId}}"></mms-history>\n        </div>\n    </div>\n\n    <div class="container-fluid container-tags" id="ve-branches-tags" ng-show="show.tags">\n        <h4 class="right-pane-title">Project Branches/Tags</h4>\n        <hr class="spec-title-divider">\n        <mms-ref-list mms-doc-id="{{documentOb.id}}" mms-project-id="{{projectOb.id}}"\n        mms-ref-id="{{refOb.id}}" mms-ref-type="{{refOb.type}}" mms-branches="branchObs" mms-tags="tagObs"></mms-ref-list>\n    </div>\n\n    <div class="container-fluid" ng-show="show.reorder">\n        <mms-view-reorder mms-element-id="{{viewOb.id}}" mms-project-id="{{viewOb._projectId}}"\n            mms-commit-id="{{viewCommitId}}" mms-order="true" mms-ref-id="{{viewOb._refId}}"\n            mms-view-reorder-api="viewContentsOrderApi"></mms-view-reorder>\n    </div>\n\n    <div class="container-fluid" ng-if="show.jobs">\n        <mms-jobs mms-doc-id="{{documentOb.id}}" mms-project-id="{{projectOb.id}}"\n            mms-ref-id="{{refOb.id}}"></mms-jobs>\n    </div>\n</div>\n')}]),angular.module("partials/mms/printConfirm.html",[]).run(["$templateCache",function(e){e.put("partials/mms/printConfirm.html",'<div class="modal-header">\n    <h4>{{action}} {{type | lowercase}}</h4>\n</div>\n\n<div class="modal-body">\n    <p ng-if="hasError" class="mms-error-icon">\n        WARNING: There are cross reference errors in this document that will be reflected in the export.\n    </p>\n    <p ng-if="unsaved" class="mms-error-icon">\n        WARNING: Unsaved changes may not be reflected (alt + a to save all)\n    </p>\n    <p ng-if="mode === 1">\n      This will bring up a popup where you can {{action}} the contents of this {{type === \'DOCUMENT\' ? \'document\' : \'view\'}} , please disable any popup blockers if you don\'t\n      see the popup. \n      <br/><br/>If you don\'t see certain content appearing in the popup, please wait until the full document appears in this pane before clicking {{action}}.\n    </p>\n    <p ng-if="mode !== 1">\n     <span ng-if="type === \'VIEW\'">\n      Click on {{action | uppercase}} to generate a {{label}} of this view (it will not include table of contents or cover pages). You will receive an email with subject line "HTML to {{label}} generation completed" with a link to the generated {{label | uppercase}}. If you want the full document instead, please click on GO TO FULL DOCUMENT.\n     </span>\n     <span ng-if="type === \'DOCUMENT\'">\n      Please wait until the full document appears in this pane before continuing. You will receive an email with subject line "HTML to {{label}} generation completed" with a link to the generated {{label}}.\n     </span>\n    </p>\n    <p ng-if="type == \'DOCUMENT\' && mode === 3">\n      Choose either basic or advanced styling options.\n    </p>    \n    <br/>\n    <div ng-if="type == \'DOCUMENT\' && mode !== 1">\n    </div>\n    <div ng-if="type == \'DOCUMENT\' && mode !== 1"><input type="checkbox" ng-model="model.genTotf"> Include List of Tables, Figures and Equations</div>\n    \x3c!-- <div ng-if="model.genTotf" class="indent"><input type="checkbox" ng-model="model.htmlTotf"> Use HTML for List (will not include equations and may differ from web numbering)</div> --\x3e\n    <br>\n\n    <div ng-if="type == \'DOCUMENT\' && mode === 3">\n        <br>\n        <form class="ve-light-tabs">\n            <input type="radio" name="Options" ng-click="customizeDoc.useCustomStyle = false" data-ng-model="customizeDoc.useCustomStyle" data-ng-value="false">\n            <label for="Basic">Basic Options</label>&nbsp;&nbsp;&nbsp;\n            <input type="radio" name="Options" ng-click="customizeDoc.useCustomStyle = true" data-ng-model="customizeDoc.useCustomStyle" data-ng-value="true">\n            <label for="Advanced">Advanced Options (CSS)</label>\n        </form>\n\n        <div class="well" ng-show="!customizeDoc.useCustomStyle">\n        <form role="form">\n\n            <div ng-if="mode !== 1">\n                <label>Orientation</label><br>\n                <form>\n                    <input type="radio" name="export-orientation" ng-model="model.landscape" ng-value="false">\n                    <label for="portrait" class="ve-font-weight-normal">&nbsp;<i class="fa fa-file ve-secondary-text"></i> Portrait</label><br>\n                    <input type="radio" name="export-orientation" ng-model="model.landscape" ng-value="true">\n                    <label for="landscape" class="ve-font-weight-normal">&nbsp;<i class="fa fa-file fa-rotate-270 ve-secondary-text"></i> Landscape\n                </form>\n            </div>\n            <br>\n\n            <div class="form-group">\n                <label>Header</label>\n                <div class="row narrow-gutter-row">\n                    <div class="col-md-3">\n                        <input class="ve-plain-input" type="text" ng-model="meta[\'top-left\']" placeholder="Left" aria-labelledby="left header">\n                    </div>\n                    <div class="col-md-6">\n                        <input class="ve-plain-input" type="text" ng-model="meta.top" placeholder="Center" aria-labelledby="center header">\n                    </div>\n                    <div class="col-md-3">\n                        <input class="ve-plain-input" type="text" ng-model="meta[\'top-right\']" placeholder="Right" aria-labelledby="right header">\n                    </div>\n                </div>\n            </div>\n            <div class="form-group">\n                <label for="footer">Footer</label>\n                <div class="row narrow-gutter-row">\n                    <div class="col-md-3">\n                        <input class="ve-plain-input" type="text" ng-model="meta[\'bottom-left\']" placeholder="Left" aria-labelledby="left footer">\n                    </div>\n                    <div class="col-md-6">\n                        <input class="ve-plain-input" type="text" ng-model="meta.bottom" placeholder="Center" aria-labelledby="center footer">\n                    </div>\n                    <div class="col-md-3">\n                        <input class="ve-plain-input" type="text" ng-model="meta[\'bottom-right\']"  placeholder="Right" aria-labelledby="right footer">\n                    </div>\n                </div>\n            </div>\n            <p class="help-block"><i>Use \'counter(page)\' for page number</i></p>\n\n        </form>\n        </div>\n\n        <div class="well" ng-show="customizeDoc.useCustomStyle">\n            <form ng-submit="saveStyleUpdate()" role="form">\n\n                <div class="form-group">\n                    <textarea class="form-control" rows="6" style="width:100%" ng-model="customizeDoc.customCSS"></textarea>\n                </div>\n                <p class="help-block">\n                    <a target="_blank" href="https://wiki.jpl.nasa.gov/display/opencae/View+Editor+User+Guide%3A+8+PDF+Customization">Example CSS customizations</a>\n                </p>\n                <button class="btn btn-default" type="submit"><i class="fa fa-save"></i>Save CSS for document<span ng-if="elementSaving"><i class="fa fa-spinner fa-spin"></i></span></button>\n                <button class="btn btn-default" type="button" ng-click="preview()">Preview</button>\n            </form>\n        </div>\n    </div>\n\n</div>\n\n<div class="modal-footer">\n    <button ng-if="type == \'VIEW\' && docOption" class="btn btn-primary" ng-click="fulldoc()">Go to full document</button>\n    <button class="btn btn-primary" ng-click="print()">{{action | uppercase}}</button>\n    <button class="btn btn-default" ng-click="cancel()">Cancel</button>\n</div>\n')}]),angular.module("partials/mms/redirect.html",[]).run(["$templateCache",function(e){e.put("partials/mms/redirect.html",'<div id="ve-origin-select" class="row">\n    <div class="account-wall-lg" ng-if="redirect_from_old_site">\n            <div ng-if="!redirect_element && !redirect_noResults && !redirect_relatedDocs.length">\n                <h2>This link is not valid</h2>\n                <h4><i class="fa fa-spinner fa-spin" aria-hidden="true"></i> We are searching for your content</h4>\n            </div>\n            \x3c!-- Content moved and results found --\x3e\n            <div ng-if="!redirect_noResults && redirect_element.link">\n                <h2>This content has moved</h2>\n                <h4>You will be redirected to the new location at \n                    <a style="text-decoration:underline;" ng-if="redirect_element.link" ui-sref="{{ redirect_element.link }}">\n                    \x3c!-- <i ng-class="{\'fa fa-folder\': redirect_element.type === \'group\', \'fa fa-file\': $last && redirect_element.type === \'doc\'}"></i> --\x3e\n                    {{ redirect_element.name }}</a> in 10 seconds.\n                </h4>\n                \x3c!-- <button class="btn btn-primary"><i class="fa fa-bookmark" aria-hidden="true" style="padding-right:10px;"></i>Bookmark New Link</button> --\x3e\n                <button style="margin-top:60px;" class="btn btn-primary" ng-click="resetSelectPage()">View Editor Home</button>\n            </div>\n            \x3c!-- no content found --\x3e\n            <div ng-if="redirect_noResults">\n                <h2>This link is not valid</h2>\n                <h4>Related content not found for this link. If you believe your content was not moved or deleted, please navigate to it in View Editor and rebookmark.</h4>\n                <button style="margin-top:60px;" class="btn btn-primary" ng-click="resetSelectPage()">View Editor Home</button>\n            </div>\n            \x3c!-- views found in docs - allow user to select --\x3e\n            <div ng-if="redirect_relatedDocs.length">\n                <h2>This link is not valid</h2>\n                <h4>Here are documents related to the content you are looking for:</h4>\n                <div ng-repeat="relatedDocument in redirect_relatedDocs" class="elem-documentation">\n                    <a style="text-decoration:underline;" ng-repeat="relatedView in relatedDocument._parentViews" ui-sref="project.ref.document.view({documentId: relatedDocument.id, viewId: relatedView.id, projectId: relatedDocument._projectId, refId: relatedDocument._refId, search: undefined})" ng-click="userRelatedClick($event, relatedDocument, relatedView, elem)">\n                        <i class="fa fa-file" aria-hidden="true"></i>\n                        <mms-view-link mms-project-id="{{elem._projectId}}" mms-ref-id="{{elem._refId}}" mms-doc-id="{{relatedDocument.id}}" mms-element-id="{{relatedDocument.id}}"></mms-view-link> > <mms-view-link mms-project-id="{{elem._projectId}}" mms-ref-id="{{elem._refId}}" mms-doc-id="{{relatedDocument.id}}" mms-element-id="{{relatedView.id}}"></mms-view-link><br/>\n                    </a>\n                </div>\n                <button style="margin-top:60px;" class="btn btn-primary" ng-click="resetSelectPage()">View Editor Home</button>\n                \x3c!-- <h4 style="margin-top:60px;"><a style="text-decoration:underline;" ng-click="resetSelectPage()">View Editor home</a></h4> --\x3e\n            </div>\n    </div>\n</div>')}]),angular.module("partials/mms/reorder-groups.html",[]).run(["$templateCache",function(e){e.put("partials/mms/reorder-groups.html",'\x3c!-- Nested node template --\x3e\n<div class="group-reorder-container">\n    <script type="text/ng-template" id="nodes_renderer_group.html">\n        <div ng-class="targetId === node.id ? \'highlighted\' : \'\'" ui-tree-handle>\n            <i ng-class="node.type === \'view\' ? \'fa fa-file\' : node.type === \'group\' ? \'fa fa-folder\' : \'fa fa-home\'"></i> {{node.name}}\n        </div>\n        <ol ui-tree-nodes="" ng-model="node.children">\n            <li ng-repeat="node in node.children" ui-tree-node ng-include="\'nodes_renderer_group.html\'">\n            </li>\n        </ol>\n    <\/script>\n\n    <div class="container-tree-reorder container-fluid">\n        <button class="btn-tree-reorder-save btn btn-primary" ng-click="saveReorder()">Save <i ng-If="isSaving" class=\'fa fa-spin fa-spinner\'></i></button>\n        <button class="btn-tree-reorder-save btn btn-default" ng-click="cancelReorder()">Cancel</button>\n        <br>\n        <p>Move group/document to/from a group. Only Grouping is preserved. Ordering is not.</p>\n        <div class="well" ui-tree="treeOptions">\n            <ol ui-tree-nodes="" class="root" ng-model="tree">\n                <li ng-repeat="node in tree" ui-tree-node ng-include="\'nodes_renderer_group.html\'"></li>\n            </ol>\n        </div>\n    </div>\n</div>\n')}]),angular.module("partials/mms/reorder-views.html",[]).run(["$templateCache",function(e){e.put("partials/mms/reorder-views.html",'\x3c!-- Nested node template --\x3e\n<script type="text/ng-template" id="nodes_renderer.html">\n    <div ui-tree-handle>\n        {{node.old}} &rarr; {{node.new}} {{node.name}} ({{node.aggr}})\n    </div>\n    <ol ui-tree-nodes="" ng-model="node.children">\n        <li ng-repeat="node in node.children" ui-tree-node ng-include="\'nodes_renderer.html\'">\n        </li>\n    </ol>\n<\/script>\n\n<div class="container-tree-reorder container-fluid">\n    <button class="btn-tree-reorder-save btn btn-primary" ng-click="save()">Save <i class="{{saveClass}}"></i></button>\n    <button class="btn-tree-reorder-save btn btn-default" ng-click="cancel()">Cancel</button>\n    <br>\n    \x3c!--<p>Note: you cannot reorder views under a view that\'s labeled (none) - these views may have children but are not shown and is not part of this document</p>--\x3e\n    <p>To reorder text, tables, images, equations, and sections, use the <i class="fa fa-arrows-v"></i> in the right pane.</p>\n    <div class="well" ui-tree="treeOptions">\n        <ol ui-tree-nodes="" class="root" ng-model="tree">\n            <li ng-repeat="node in tree" ui-tree-node ng-include="\'nodes_renderer.html\'"></li>\n        </ol>\n    </div>\n</div>')}]),angular.module("partials/mms/select.html",[]).run(["$templateCache",function(e){e.put("partials/mms/select.html",'<div id="ve-origin-select" class="row">\n    <div class="account-wall-lg" ng-if="redirect_from_old_site">\n        <h2>This is not a valid link</h2>\n        <div class="flex">\n            <div class="two-thirds-flex">\n                <h4>Please navigate to your document by selecting the corresponding organization and project to continue.</h4>\n            </div>\n            <div class="one-third-flex">\n                <form name="loginForm" ng-submit="continue()">\n                    <div class="btn-group ve-dark-dropdown-wide" uib-dropdown>\n                        <span class="label-dropdown">Org:</span>\n                        <button type="button" class="dropdown-toggle" uib-dropdown-toggle>\n                            <span>{{ selectedOrg }}<i class="fa fa-caret-down" aria-hidden="true"></i></span>\n                        </button>\n                        <ul class="dropdown-menu list-with-selected-item" uib-dropdown-menu role="menu">\n                            <li ng-model="selectedOrg" ng-repeat="org in orgs | orderBy: \'name\'" ng-click="selectOrg(org)"\n                            ng-class="{\'checked-list-item\': org.name === selectedOrg}">{{ org.name }}</li>\n                        </ul>\n                    </div>\n                    <div class="btn-group ve-dark-dropdown-wide" uib-dropdown>\n                        <span class="label-dropdown">Project:</span>\n                        <button type="button" class="dropdown-toggle" uib-dropdown-toggle ng-disabled="!selectedOrg || !projects.length">\n                            <span ng-hide="projects.length || !selectedOrg">No Projects for selected Org</span>\n                            <span ng-show="projects.length">{{ selectedProject }}<i class="fa fa-caret-down" aria-hidden="true"></i></span>\n                        </button>\n                        <ul class="dropdown-menu list-with-selected-item" uib-dropdown-menu role="menu">\n                            <li ng-model="selectedProject" ng-repeat="project in projects | orderBy: \'name\'"\n                                ng-class="{\'checked-list-item\': project.name === selectedProject}"\n                                ng-click="selectProject(project)">{{ project.name }}\n                            </li>\n                        </ul>\n                    </div>\n                    <button class="btn btn-block btn-primary" type="submit"  ng-disabled="!selectedProject || !selectedOrg">Continue\n                        <span ng-if="spin"><i class="fa fa-spin fa-spinner"></i></span>\n                    </button>\n                </form>\n            </div>\n        </div>\n    </div>\n    <div class="account-wall" ng-if="!redirect_from_old_site">\n        <div ng-class="{\'fade-in\': fromLogin}">\n            <a class="select-logout-button" ng-click="logout()"><i class="fa fa-arrow-left back-to-account" aria-hidden="true"></i></a>\n            <h2>{{ pageTitle }}</h2>\n        </div>\n        <div ng-class="{\'animated-fade-in-slide\': fromLogin}">\n            <form name="loginForm" ng-submit="continue()">\n                <div class="btn-group ve-dark-dropdown-wide" uib-dropdown>\n                    <span class="label-dropdown">Org:</span>\n                    <button type="button" class="dropdown-toggle" uib-dropdown-toggle>\n                        <span>{{ selectedOrg }}<i class="fa fa-caret-down" aria-hidden="true"></i></span>\n                    </button>\n                    <ul class="dropdown-menu list-with-selected-item" uib-dropdown-menu role="menu">\n                        <li ng-model="selectedOrg" ng-repeat="org in orgs | orderBy: \'name\'" ng-click="selectOrg(org)"\n                        ng-class="{\'checked-list-item\': org.name === selectedOrg}">{{ org.name }}</li>\n                    </ul>\n                </div>\n                <div class="btn-group ve-dark-dropdown-wide" uib-dropdown>\n                    <span class="label-dropdown">Project:</span>\n                    <button type="button" class="dropdown-toggle" uib-dropdown-toggle ng-disabled="!selectedOrg || !projects.length">\n                        <span ng-hide="projects.length || !selectedOrg">No Projects for selected Org</span>\n                        <span ng-show="projects.length">{{ selectedProject }}<i class="fa fa-caret-down" aria-hidden="true"></i></span>\n                    </button>\n                    <ul class="dropdown-menu list-with-selected-item" uib-dropdown-menu role="menu">\n                        <li ng-model="selectedProject" ng-repeat="project in projects | orderBy: \'name\'"\n                            ng-class="{\'checked-list-item\': project.name === selectedProject}"\n                            ng-click="selectProject(project)">{{ project.name }}\n                        </li>\n                    </ul>\n                </div>\n                <button class="btn btn-block btn-primary" type="submit" ng-disabled="!selectedProject || !selectedOrg">Continue\n                    <span ng-if="spin"><i class="fa fa-spin fa-spinner"></i></span>\n                </button>\n            </form>\n        </div>\n    </div>\n</div>')}]),angular.module("partials/mms/selectModal.html",[]).run(["$templateCache",function(e){e.put("partials/mms/selectModal.html",'<div id="modal-window" class="ve-dark-modal">\n    <div class="modal-header">\n        <h4 class="modal-title">Switch Org</h4>\n    </div>\n    <div class="modal-body" id="modal-body">\n        <div class="btn-group ve-dark-dropdown-wide" uib-dropdown>\n            <span class="label-dropdown">Org:</span>\n            <button id="project-btn-keyboard-nav" type="button" class="dropdown-toggle" uib-dropdown-toggle>\n                <span>{{ selectedOrg }}<i class="fa fa-caret-down" aria-hidden="true"></i></span>\n            </button>\n            <ul class="dropdown-menu list-with-selected-item" uib-dropdown-menu role="menu"\n                aria-labelledby="project-btn-keyboard-nav">\n                <li ng-repeat="org in orgs | orderBy: \'name\'" ng-click="selectOrg(org)"\n                    ng-class="{\'checked-list-item\': org.name === selectedOrg}">{{ org.name }}\n                </li>\n            </ul>\n        </div>\n        <div class="btn-group ve-dark-dropdown-wide" uib-dropdown keyboard-nav>\n            <span class="label-dropdown">Project:</span>\n            <button id="module-btn-keyboard-nav" type="button" class="dropdown-toggle" uib-dropdown-toggle\n                    ng-disabled="!selectedOrg || !projects.length">\n                <span ng-hide="projects.length">No Projects for selected Org</span>\n                <span ng-show="projects.length">{{ selectedProject }}<i class="fa fa-caret-down" aria-hidden="true"></i></span>\n            </button>\n            <ul class="dropdown-menu list-with-selected-item" uib-dropdown-menu role="menu"\n                aria-labelledby="module-btn-keyboard-nav">\n                <li ng-repeat="project in projects | orderBy: \'name\'" ng-click="selectProject(project)"\n                    ng-class="{\'checked-list-item\': project.name === selectedProject}">{{ project.name }}\n                </li>\n            </ul>\n        </div>\n    </div>\n    <div class="modal-footer ng-scope">\n        <button class="btn btn-primary" type="button" ng-click="continue()" ng-disabled="!selectedProject || !selectedOrg">\n            Continue<span ng-if="spin"><i class="fa fa-spin fa-spinner"></i></span>\n        </button>\n        <button class="btn btn-default" type="button" ng-click="cancel()">Cancel</button>\n    </div>\n</div>')}]),angular.module("partials/mms/tableExport.html",[]).run(["$templateCache",function(e){e.put("partials/mms/tableExport.html",'<div class="modal-header">\n    <h4>Export table(s) to CSV in {{type | lowercase}}</h4>\n</div>\n\n<div class="modal-body">\n    <p ng-if="type == \'DOCUMENT\'">\n      This will bring up a popup where you can copy/paste the table contents of this document as CSV, please disable any popup blockers if you don\'t \n      see the popup. \n      <br/><br/>If you don\'t see certain content appearing in the popup, please wait until the full document appears in this pane before clicking export.\n    </p>\n    <p ng-if="type == \'VIEW\'">\n        This will bring up a popup where you can copy/paste the table contents of this view as CSV, please disable any popup blockers if you don\'t \n      see the popup. \n      <br/><br/>\n      If you don\'t see certain content appearing in the popup, please wait until the full document appears in this pane before clicking export.\n      \x3c!--<br/><br/>If you would like all the tables in the entire document instead, please click on \'GO TO FULL DOCUMENT\' and click export again when it finishes loading. --\x3e\n    </p>\n</div>\n\n<div class="modal-footer">\n    <button class="btn btn-primary" ng-click="export()">Export to CSV</button>\n    \x3c!--<button ng-if="type == \'VIEW\'" class="btn btn-sm btn-primary" ng-click="fulldoc()">GO TO FULL DOCUMENT</button>--\x3e\n    <button class="btn btn-default" ng-click="cancel()">Cancel</button>\n</div>\n')}]),angular.module("partials/mms/veFooter.html",[]).run(["$templateCache",function(e){e.put("partials/mms/veFooter.html",'<div class="footer" ng-transclude></div>')}]),angular.module("partials/mms/veMenu.html",[]).run(["$templateCache",function(e){e.put("partials/mms/veMenu.html",'<nav class="project-level-header navbar navbar-inverse navbar-fixed-top block" role="navigation">\n    <div class="btn-group ve-dark-dropdown-nav pull-left" uib-dropdown keyboard-nav>\n        <button type="button" class="dropdown-toggle" ng-click="updateProjectChecked()" uib-dropdown-toggle>\n            <span class="label-dropdown">Project:&nbsp;</span><span class="selected-dropdown">{{ currentProject }}</span>\n            <span><i class="fa fa-caret-down" aria-hidden="true"></i></span>\n        </button>\n        <ul class="dropdown-menu list-with-selected-item" uib-dropdown-menu role="menu">\n            <li ng-repeat="project in projects | orderBy: \'name\'" ng-click="updateProject(project)"\n                ng-class="{\'checked-list-item\': project.name === currentProject}">\n                <a ng-href="{{getHrefForProject(project);}}"> {{ project.name }} </a>\n            </li>\n        </ul>\n    </div>\n    <div class="breadcrumbs">\n        <ul>\n            <li ng-style="truncateStyle">\n                <a class="back-to-proj" ui-sref="project.ref({refId: branch.id? branch.id : \'master\', search: undefined})" ui-sref-opts="{reload:true}"\n                    uib-tooltip="{{ currentProject }}" tooltip-trigger="mouseenter" tooltip-popup-delay="100" tooltip-placement="bottom">\n                    <i class="fa fa-home" aria-hidden="true"></i>\n                </a>\n            </li>\n            <li ng-style="truncateStyle" ng-show="!isRefsView()" ng-repeat="breadcrumb in breadcrumbs track by $index">\n                <span> &#8250;</span>\n                <a ui-sref="{{ breadcrumb.link }}" uib-tooltip="{{ breadcrumb.name }}" tooltip-trigger="mouseenter" tooltip-popup-delay="100" tooltip-placement="bottom">\n                    <i ng-class="{\'fa fa-file\': $last && breadcrumb.type === \'doc\'}" aria-hidden="true"></i>{{ breadcrumb.name }}\n                </a>\n            </li>\n        </ul>\n    </div>\n\n    <div ng-show="!isRefsView()" class="nav navbar-nav navbar-right" style="padding-right: 15px">\n        <div class="btn-group ve-dark-dropdown-nav" uib-dropdown keyboard-nav auto-close="outsideClick">\n            <button id="task-selection-button" type="button" class="dropdown-toggle" uib-dropdown-toggle>\n                <span class="label-dropdown">{{ currentRef.type }}:</span>\n                <span class="selected-dropdown">{{ currentRef.name }}</span>\n                <i class="fa fa-caret-down" aria-hidden="true"></i>\n            </button>\n            <ul class="dropdown-menu pull-right list-with-selected-item list-with-button list-with-tabs" uib-dropdown-menu role="menu"\n                aria-labelledby="task-selection-button">\n                <li class="button-item">\n                    <button class="btn btn-large btn-block btn-primary" ng-click="refsView()">Manage Branches/Tags\n                    </button>\n                </li>\n                <li class="button-item">\n                    <form class="ve-dark-minor-search">\n                        <input placeholder="Filter branches/tags" ng-model="refFilter">\n                    </form>\n                </li>\n                <uib-tabset active="active" type="tabs" justified="false">\n                    <uib-tab index="0" classes="tab-item" heading="Branches">\n                        <li ng-repeat="branch in branches | orderBy:\'name\' | filter:{name:refFilter} " ng-click="updateBranch(branch)"\n                            ng-class="{\'checked-list-item\': branch.name === currentBranch, \'branch-disabled\': branch.status == \'creating\'}"\n                            is-open="false" tooltip-placement="left" uib-tooltip-html="htmlTooltip"\n                            tooltip-append-to-body="branch.status == \'creating\'" tooltip-enable="branch.status == \'creating\'">\n                            <a ng-href="{{getHrefForBranch(branch);}}" ng-style="{display: \'block\'}"> {{ branch.name }} </a>\n                        </li>\n                    </uib-tab>\n                    <uib-tab index="1" classes="tab-item" heading="Tags">\n                        <li ng-if="tags.length" ng-repeat="tag in tags | orderBy:\'name\' | filter:{name:refFilter}" ng-click="updateTag(tag)"\n                            ng-class="{\'checked-list-item\': tag.name === currentTag, \'branch-disabled\': tag.status == \'creating\'}"\n                            is-open="false" tooltip-placement="left" uib-tooltip-html="htmlTooltip"\n                            tooltip-append-to-body="tag.status == \'creating\'" tooltip-enable="tag.status == \'creating\'">\n                            <a ng-href="{{getHrefForTag(tag);}}" ng-style="{display: \'block\'}"> {{ tag.name }} </a>\n                        </li>\n                        <li ng-if="!tags.length" class="ve-secondary">No Tags</li>\n                    </uib-tab>\n                </uib-tabset>\n            </ul>\n        </div>\n    </div>\n</nav>\n')}]),angular.module("partials/mms/veNav.html",[]).run(["$templateCache",function(e){e.put("partials/mms/veNav.html",'<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">\n    <div class="block">\n        <div class="navbar-header">\n            <button type="button" class="navbar-toggle main-nav-toggle" ng-click="isNavCollapsed = !isNavCollapsed">\n                <span class="sr-only">Toggle navigation</span>\n                <i class="fa fa-bars" aria-hidden="true"></i>\n            </button>\n            <span>\n            <a class="navbar-brand" ui-sref="login.select">\n                <img src="assets/logo.svg" alt="View Editor Logo">\n            </a>\n            <a ng-if="!org.homeLink" class="org-title" ui-sref="project.ref({projectId: project.id, refId: ref.id})">{{ org.name }}</a>\n            <a ng-if="org.homeLink" class="org-title" ng-href="{{org.homeLink}}">{{ org.name }}</a>\n            <a class="switch-org" ng-click="updateOrg()">Switch Org</a>\n            </span>\n        </div>\n        <div class="collapse navbar-collapse" uib-collapse="isNavCollapsed" id="global-navigation">\n            <form id="global-search" ng-submit="search(searchText)" class="navbar-form navbar-left" role="search">\n                <div class="form-group">\n                    <input placeholder="Search selected project" ng-model="searchText"/>\n                    <button ng-click="search(searchText)">\n                        <i class="fa fa-search" aria-hidden="true"></i>\n                    </button>\n                </div>\n            </form>\n            <ul class="nav navbar-nav global-menu">\n                \x3c!--<li><span><a ng-click="stagingView()">UAT</a></span></li>--\x3e\n                <li class="dropdown">\n                    <span class="dropdown ve-dark-dropdown-nav fixed-content-dropdown" uib-dropdown on-toggle="toggled(open)">\n                        <a href id="help-dropdown" class="dropdown-toggle" uib-dropdown-toggle>\n                        Help <i class="fa fa-caret-down" aria-hidden="true"></i>\n                        </a>\n                        <ul class="dropdown-menu pull-right" uib-dropdown-menu aria-labelledby="help-dropdown">\n                            <li>\n                                <a href="" ng-click="toggleHelp()">Keyboard Shortcuts</a>\n                            </li>\n                            <li class="divider"></li>\n                            <li>\n                                <a href="https://wiki.jpl.nasa.gov/display/opencae/View+Editor+User+Guide" target="_blank">View Editor User Guide</a>\n                            </li>\n                            <li>\n                                <a href="https://jira.jpl.nasa.gov/servicedesk/customer/portal/5" target="_blank">Report Issue</a>\n                            </li>\n                            <li class="divider"></li>\n                            <li class="list-section-bottom">\n                                <a ng-click="toggleAbout()" href="">About View Editor</a>\n                            </li>\n                         </ul>\n                    </span>\n                </li>\n                <li class="dropdown">\n                    <span class="dropdown ve-dark-dropdown-nav fixed-content-dropdown user-profile" uib-dropdown on-toggle="toggled(open)">\n                        <a href id="login-dropdown" class="dropdown-toggle" uib-dropdown-toggle>\n                            {{ username | limitTo:1 | uppercase }}\n                        </a>\n                        <ul class="dropdown-menu pull-right" uib-dropdown-menu aria-labelledby="login-dropdown" style="white-space: nowrap" role="login-menu">\n                            <li ng-if="username" class="ve-secondary">\n                                <span>Logged in as <b>{{ username }}</b></span>\n                            </li>\n                            <li class="divider"></li>\n                            <li>\n                                <a ng-click="logout()">Log Out</a>\n                            </li>\n                         </ul>\n                    </span>\n                </li>\n            </ul>\n        </div>\n    </div>\n</nav>\n')}]),angular.module("mmsApp",["mms","mms.directives","app.tpls","fa.directive.borderLayout","ui.bootstrap","ui.router","ui.tree","angular-growl","cfp.hotkeys","angulartics","angulartics.piwik","ngStorage","ngAnimate","ngPromiseExtras","ngCookies"]).config(["$stateProvider","$urlRouterProvider","$httpProvider","$provide","URLServiceProvider","$locationProvider",function(e,t,n,i,a,r){i.decorator("uibTypeaheadPopupDirective",["$delegate",function(i){var a=i[0].link;return i[0].compile=function(e,t){return function(t,n,e){a.apply(i[0],arguments),t.selectActive=function(e){n.children().removeClass("active"),t.active=e}}},delete i[0].link,i}]),r.hashPrefix(""),t.rule(function(e,t){var n=e.get("$state"),i=t.url();if(0<i.indexOf("full%23")&&(i=i.replace("full%23","full#")),"/"!==i[0]&&(i="/"+i),"/"==i[i.length-1]&&(i=i.substring(0,i.length-1)),""===n.current.name||"login.redirect"===n.current.name){var a=t.hash(),r=i.indexOf("/full#");-1!==r&&a&&!a.endsWith("_pei")&&(i=i.substr(0,r)+"/views/"+a)}i!==t.url()&&t.url(i)});var o=window.location.protocol+"//"+window.location.host;a.setMmsUrl(o),n.defaults.withCredentials=!0,t.otherwise(function(e,t){var n=e.get("$rootScope"),i=e.get("$state");e.get("AuthService").checkLogin()?t.url().includes("workspace")?(n.redirect_from_old_site=!0,n.crush_url=t.path(),i.go("login.redirect")):(n.redirect_from_old_site=!1,i.go("login.select")):i.go("login")}),e.state("login",{url:"/login",resolve:{},views:{"login@":{templateUrl:"partials/mms/login.html",controller:["$scope","$rootScope","$state","AuthService","growl",function(n,i,a,r,o){n.credentials={username:"",password:""},i.ve_title="Login",n.pageTitle="View Editor",n.spin=!1,n.login=function(e){n.spin=!0;var t={username:e.username,password:e.password};r.getAuthorized(t).then(function(e){if(i.ve_redirect){var t=i.ve_redirect.toState,n=i.ve_redirect.toParams;a.go(t,n)}else a.go("login.select",{fromLogin:!0})},function(e){n.spin=!1,o.error(e.message)})}}]}}}).state("login.redirect",{url:"/redirect",resolve:{ticket:["$window","URLService","AuthService","$q","$cookies","ApplicationService",function(t,n,e,i,a,r){var o=i.defer();return e.checkLogin().then(function(e){r.setUserName(e),n.setTicket(t.localStorage.getItem("ticket")),o.resolve(t.localStorage.getItem("ticket")),a.put("com.tomsawyer.web.license.user",e,{path:"/"})},function(e){o.reject(e)}),o.promise}]},views:{"login@":{templateUrl:"partials/mms/redirect.html",controller:"RedirectCtrl"}}}).state("login.select",{url:"/select?fromLogin",resolve:{ticket:["$window","URLService","AuthService","$q","ApplicationService",function(t,n,e,i,a){var r=i.defer();return e.checkLogin().then(function(e){a.setUserName(e),n.setTicket(t.localStorage.getItem("ticket")),r.resolve(t.localStorage.getItem("ticket"))},function(e){r.reject(e)}),r.promise}],orgObs:["$stateParams","ProjectService","ticket",function(e,t,n){return t.getOrgs()}]},views:{"login@":{templateUrl:"partials/mms/select.html",controller:["$scope","$rootScope","$state","$stateParams","orgObs","ProjectService","AuthService","growl","$localStorage",function(t,e,n,i,a,r,o,s,l){var c,d;e.ve_title="Projects",t.pageTitle="View Editor",t.fromLogin=i.fromLogin,l.$default({org:a[0]}),t.spin=!1,t.orgs=a,t.selectOrg=function(e){e&&(l.org=e,c=e.id,l.org.orgName=e.name,t.selectedOrg=l.org.name,t.selectedProject="",r.getProjects(c).then(function(e){0<(t.projects=e).length&&(l.project&&1===m(e,l.project)?(t.selectedProject=l.project.name,d=l.project.id):t.selectProject(e[0]))}))},t.selectProject=function(e){e&&(l.project=e,t.selectedProject=l.project.name,d=l.project.id)},l.org&&t.selectOrg(l.org);var m=function(e,t){for(var n=0;n<e.length;n++)if(e[n].id===t.id)return 1;return 0};t.continue=function(){c&&d&&(t.spin=!0,e.redirect_from_old_site=!1,n.go("project.ref",{orgId:c,projectId:d,refId:"master"}).then(function(e){},function(e){t.spin=!1}))},t.logout=function(){o.logout().then(function(){n.go("login")},function(){s.error("You were not logged out")})}}]}}}).state("project",{url:"/projects/:projectId",resolve:{ticket:["$window","URLService","AuthService","$q","ApplicationService","$cookies",function(t,n,e,i,a,r){var o=i.defer();return e.checkLogin().then(function(e){a.setUserName(e),n.setTicket(t.localStorage.getItem("ticket")),o.resolve(t.localStorage.getItem("ticket")),r.put("com.tomsawyer.web.license.user",e,{path:"/"})},function(e){o.reject(e)}),o.promise}],projectOb:["$stateParams","ProjectService","ticket",function(e,t,n){return t.getProject(e.projectId)}],projectObs:["$stateParams","ProjectService","ticket","projectOb",function(e,t,n,i){return t.getProjects(i.orgId)}],orgOb:["ProjectService","projectOb","ticket",function(e,t,n){return e.getOrg(t.orgId)}],refObs:["$stateParams","ProjectService","ticket",function(e,t,n){return t.getRefs(e.projectId)}],tagObs:["refObs",function(e){for(var t=[],n=0;n<e.length;n++)"Tag"===e[n].type&&t.push(e[n]);return t}],branchObs:["refObs",function(e){for(var t=[],n=0;n<e.length;n++)"Branch"===e[n].type&&t.push(e[n]);return t}],refOb:function(){return null},tagOb:function(){return null},branchOb:function(){return null},documentOb:function(){return null},viewOb:function(){return null},search:function(){return null}},views:{"nav@":{template:'<ve-nav mms-title="ve_title" mms-org="org" mms-project="project" mms-projects="projects" mms-ref="ref" mms-branch="branch" mms-branches="branches" mms-tag="tag" mms-tags="tags" mms-search="search"></ve-nav>',controller:["$scope","$rootScope","orgOb","projectOb","projectObs","refOb","branchOb","branchObs","tagOb","tagObs","search",function(e,t,n,i,a,r,o,s,l,c,d){t.ve_title=n.name,e.org=n,e.project=i,e.projects=a,e.ref=r,e.branch=o,e.branches=s,e.tag=l,e.tags=c,e.search=d}]},"menu@":{template:'<ve-menu mms-org="org" mms-project="project" mms-projects="projects" mms-ref="ref" mms-refs="refs" mms-branch="branch" mms-branches="branches" mms-tag="tag" mms-tags="tags"></ve-menu>',controller:["$scope","$rootScope","orgOb","projectOb","projectObs","refOb","refObs","branchOb","branchObs","tagOb","tagObs",function(e,t,n,i,a,r,o,s,l,c,d){t.ve_title=i.name,e.org=n,e.project=i,e.projects=a,e.ref=r,e.refs=o,e.branch=s,e.branches=l,e.tag=c,e.tags=d}]},"manageRefs@":{templateUrl:"partials/mms/manage-refs.html",controller:"RefsCtrl"}}}).state("project.ref",{url:"/:refId?search",resolve:{projectOb:["$stateParams","ProjectService","ticket",function(e,t,n){return t.getProjectMounts(e.projectId,e.refId)}],refOb:["$stateParams","ProjectService","ticket",function(e,t,n){return t.getRef(e.refId,e.projectId)}],tagOb:["refOb",function(e){return"Tag"===e.type?e:[]}],branchOb:["refOb",function(e){return"Branch"===e.type?e:[]}],groupObs:["$stateParams","ProjectService","ticket",function(e,t,n){return t.getGroups(e.projectId,e.refId)}],groupOb:function(){return null},documentOb:["$stateParams","$q","ElementService","ViewService","refOb","projectOb","ticket",function(n,e,i,a,r,o,t){var s=e.defer(),l=n.projectId+"_cover";return i.getElement({projectId:n.projectId,refId:n.refId,extended:!0,elementId:l},2).then(function(e){s.resolve(e)},function(e){if(404===e.status)"Tag"===r.type?s.resolve(null):a.createView({_projectId:n.projectId,_refId:n.refId,id:"holding_bin_"+n.projectId},{viewName:o.name+" Cover Page",viewId:l},2).then(function(e){s.resolve(e)},function(e){s.resolve(null)});else if(410===e.status){var t=o.name+" Cover Page ";try{t=e.data.deleted[0].name+" "}catch(e){}i.updateElements([{_projectId:n.projectId,_refId:n.refId,id:l,name:t},{_projectId:n.projectId,_refId:n.refId,id:l+"_asi",name:" "}]).then(function(e){var t=!1;0<e.length&&e.forEach(function(e){e.id==l&&(s.resolve(e),t=!0)}),t||s.resolve(null)},function(e){s.resolve(null)})}else s.resolve(null)}),s.promise}],viewOb:["documentOb",function(e){return e}],search:["$stateParams","ElementService","ticket",function(e,t,n){return void 0===e.search?null:e.search}],docMeta:[function(){return{}}]},views:{"nav@":{template:'<ve-nav mms-title="ve_title" mms-org="org" mms-project="project" mms-projects="projects" mms-ref="ref" mms-branch="branch" mms-branches="branches" mms-tag="tag" mms-tags="tags" mms-search="search"></ve-nav>',controller:["$scope","$rootScope","orgOb","projectOb","projectObs","refOb","branchOb","branchObs","tagOb","tagObs","search",function(e,t,n,i,a,r,o,s,l,c,d){t.ve_title=n.name,e.org=n,e.project=i,e.projects=a,e.ref=r,e.branch=o,e.branches=s,e.tag=l,e.tags=c,e.search=d}]},"menu@":{template:'<ve-menu mms-org="org" mms-ref="ref" mms-refs="refs" mms-groups="groups" mms-project="project" mms-projects="projects" mms-branch="branch" mms-branches="branches" mms-tag="tag" mms-tags="tags"></ve-menu>',controller:["$scope","$rootScope","orgOb","groupObs","projectOb","projectObs","refOb","refObs","branchOb","branchObs","tagOb","tagObs",function(e,t,n,i,a,r,o,s,l,c,d,m){t.ve_title=a.name,e.org=n,e.groups=i,e.project=a,e.projects=r,e.ref=o,e.refs=s,e.branch=l,e.branches=c,e.tag=d,e.tags=m}]},"pane-left@":{templateUrl:"partials/mms/pane-left.html",controller:"TreeCtrl"},"pane-center@":{templateUrl:"partials/mms/pane-center.html",controller:"ViewCtrl"},"pane-right@":{templateUrl:"partials/mms/pane-right.html",controller:"ToolCtrl"},"toolbar-right@":{template:'<mms-toolbar buttons="buttons" on-click="onClick(button)" mms-tb-api="tbApi"></mms-toolbar>',controller:"ToolbarCtrl"}}}).state("project.ref.groupReorder",{url:"/group-reorder",resolve:{documentObs:["ViewService","$stateParams","ticket",function(e,t,n){return e.getProjectDocuments({projectId:t.projectId,refId:t.refId})}]},views:{"pane-center@":{templateUrl:"partials/mms/reorder-groups.html",controller:"ReorderGroupCtrl"}}}).state("project.ref.manage",{url:"/manage"}).state("project.ref.preview",{url:"/document/:documentId",resolve:{documentOb:["$stateParams","$q","ElementService","ViewService","refOb","ticket",function(n,e,i,a,r,t){var o=e.defer(),s=n.documentId,l=s.indexOf("_cover");if(0<l){var c=s.substring(5,l);i.getElement({projectId:n.projectId,refId:n.refId,extended:!0,elementId:s},2).then(function(e){o.resolve(e)},function(e){if(404===e.status)if("Tag"===r.type)o.resolve(null);else{var t='<mms-group-docs mms-group-id="'+c+'">[cf:group docs]</mms-group-docs>';i.getElement({projectId:n.projectId,refId:n.refId,elementId:c}).then(function(e){a.createView({_projectId:n.projectId,_refId:n.refId,id:c},{viewName:e.name+" Cover Page",viewId:s},t).then(function(e){o.resolve(e)},function(e){o.resolve(null)})},function(e){o.resolve(null)})}else o.reject(e)})}else i.getElement({projectId:n.projectId,refId:n.refId,extended:!0,elementId:n.documentId},2).then(function(e){o.resolve(e)},function(e){o.reject(e)});return o.promise}],viewOb:["documentOb",function(e){return e}],groupOb:["groupObs","documentOb","ProjectService","ticket",function(e,t,n,i){var a=null;if(t)for(var r=0;r<e.length;r++)if(e[r].id==t._groupId){a=e[r];break}return a}]},views:{"menu@":{template:'<ve-menu mms-org="org" mms-ref="ref" mms-refs="refs" mms-group="group" mms-groups="groups" mms-project="project" mms-projects="projects" mms-branch="branch" mms-branches="branches" mms-tag="tag" mms-tags="tags"></ve-menu>',controller:["$scope","$rootScope","orgOb","groupOb","groupObs","projectOb","projectObs","refOb","refObs","branchOb","branchObs","tagOb","tagObs","documentOb",function(e,t,n,i,a,r,o,s,l,c,d,m,p,u){t.ve_title=u.name,e.org=n,e.ref=s,e.group=i,e.groups=a,e.project=r,e.projects=o,e.ref=s,e.refs=l,e.branch=c,e.branches=d,e.tag=m,e.tags=p}]},"pane-center@":{templateUrl:"partials/mms/pane-center.html",controller:"ViewCtrl"},"pane-right@":{templateUrl:"partials/mms/pane-right.html",controller:"ToolCtrl"}}}).state("project.ref.document",{url:"/documents/:documentId",resolve:{documentOb:["$stateParams","ElementService","ticket",function(e,t,n){return t.getElement({projectId:e.projectId,refId:e.refId,extended:!0,elementId:e.documentId},2)}],viewOb:["documentOb",function(e){return e}],groupOb:["groupObs","documentOb",function(e,t){var n=null;if(t)for(var i=0;i<e.length;i++)if(e[i].id==t._groupId){n=e[i];break}return n}],docMeta:["ViewService","documentOb",function(e,t){return e.getDocMetadata({projectId:t._projectId,refId:t._refId,elementId:t.id})}]},views:{"menu@":{template:'<ve-menu mms-org="org" mms-ref="ref" mms-refs="refs" mms-group="group" mms-groups="groups" mms-project="project" mms-projects="projects" mms-branch="branch" mms-branches="branches" mms-tag="tag" mms-tags="tags" mms-document="document"></ve-menu>',controller:["$scope","$rootScope","orgOb","groupOb","groupObs","projectOb","projectObs","refOb","refObs","branchOb","branchObs","tagOb","tagObs","documentOb",function(e,t,n,i,a,r,o,s,l,c,d,m,p,u){t.ve_title=u.name,e.org=n,e.group=i,e.groups=a,e.project=r,e.projects=o,e.ref=s,e.refs=l,e.branch=c,e.branches=d,e.tag=m,e.tags=p,e.document=u}]},"pane-left@":{templateUrl:"partials/mms/pane-left.html",controller:"TreeCtrl"},"pane-center@":{templateUrl:"partials/mms/pane-center.html",controller:"ViewCtrl"},"pane-right@":{templateUrl:"partials/mms/pane-right.html",controller:"ToolCtrl"},"toolbar-right@":{template:'<mms-toolbar buttons="buttons" on-click="onClick(button)" mms-tb-api="tbApi"></mms-toolbar>',controller:"ToolbarCtrl"}}}).state("project.ref.document.view",{url:"/views/:viewId",resolve:{viewOb:["$stateParams","ElementService","ticket",function(e,t,n){return t.getElement({projectId:e.projectId,refId:e.refId,elementId:e.viewId},2)}],groupOb:["groupObs","documentOb",function(e,t){var n=null;if(t)for(var i=0;i<e.length;i++)if(e[i].id==t._groupId){n=e[i];break}return n}]},views:{"menu@":{template:'<ve-menu mms-org="org" mms-group="group" mms-groups="groups" mms-project="project" mms-projects="projects" mms-ref="ref" mms-refs="refs" mms-branch="branch" mms-branches="branches" mms-tag="tag" mms-tags="tags" mms-document="document" mms-view="view"></ve-menu>',controller:["$scope","$rootScope","orgOb","groupOb","groupObs","projectOb","projectObs","refOb","refObs","branchOb","branchObs","tagOb","tagObs","documentOb","viewOb",function(e,t,n,i,a,r,o,s,l,c,d,m,p,u,f){t.ve_title=u.name,e.org=n,e.group=i,e.groups=a,e.project=r,e.projects=o,e.ref=s,e.refs=l,e.branch=c,e.branches=d,e.tag=m,e.tags=p,e.document=u,e.view=f}]},"pane-center@":{templateUrl:"partials/mms/pane-center.html",controller:"ViewCtrl"}}}).state("project.ref.document.order",{url:"/order",views:{"pane-center@":{templateUrl:"partials/mms/reorder-views.html",controller:"ReorderCtrl"}}}).state("project.ref.document.full",{url:"/full",views:{"pane-center@":{templateUrl:"partials/mms/full-doc.html",controller:"FullDocCtrl"}}}),n.interceptors.push(["$q","$location","$rootScope","$injector",function(t,e,n,i){return{responseError:function(e){return 401===e.status&&n.$broadcast("mms.unauthorized",e),t.reject(e)},response:function(e){return 202===e.status&&n.$broadcast("mms.working",e),e.status=501,e}}}]),n.useApplyAsync(!0)}]),angular.module("mmsApp").factory("MmsAppUtils",["$q","$uibModal","$timeout","$location","$window","growl","$rootScope","$filter","$state","ElementService","ViewService","UtilsService","_",MmsAppUtils]),angular.module("mmsApp").controller("FullDocCtrl",["$scope","$rootScope","$state","$anchorScroll","$location","$timeout","$http","FullDocumentService","ShortenUrlService","hotkeys","growl","_","MmsAppUtils","Utils","UxService","URLService","UtilsService","search","orgOb","projectOb","refOb","groupOb","documentOb",function(n,i,a,r,o,e,t,s,l,c,d,m,p,u,f,g,v,h,b,w,y,I,_){i.ve_fullDocMode=!0,i.veCommentsOn||(i.veCommentsOn=!1),i.veElementsOn||(i.veElementsOn=!1),i.ve_editmode||(i.ve_editmode=!1),n.search=h,u.toggleLeftPane(h),n.buttons=[],n.refOb=y,n.projectOb=w,n.latestElement="",n.docLibLink="",n.bbApi={init:function(){_&&_._editable&&"Branch"===y.type&&(n.bbApi.addButton(f.getButtonBarButton("show-edits")),n.bbApi.setToggleState("show-edits",i.ve_editmode),c.bindTo(n).add({combo:"alt+d",description:"toggle edit mode",callback:function(){n.$broadcast("show-edits")}})),n.bbApi.addButton(f.getButtonBarButton("show-elements")),n.bbApi.addButton(f.getButtonBarButton("show-comments")),n.bbApi.addButton(f.getButtonBarButton("refresh-numbering")),n.bbApi.addButton(f.getButtonBarButton("print"));var e=f.getButtonBarButton("export");e.dropdown_buttons.push(f.getButtonBarButton("convert-pdf")),n.bbApi.addButton(e),n.bbApi.setToggleState("show-comments",i.veCommentsOn),n.bbApi.setToggleState("show-elements",i.veElementsOn),c.bindTo(n).add({combo:"alt+c",description:"toggle show comments",callback:function(){n.$broadcast("show-comments")}}).add({combo:"alt+e",description:"toggle show elements",callback:function(){n.$broadcast("show-elements")}})}},n.searchOptions={emptyDocTxt:"This field is empty.",searchInput:h,getProperties:!0,closeable:!0,callback:function(e){i.$broadcast("elementSelected",e,"latest"),i.ve_togglePane&&i.ve_togglePane.closed&&i.ve_togglePane.toggle()},relatedCallback:function(e,t,n){a.go("project.ref.document.view",{projectId:e._projectId,documentId:e.id,viewId:t.id,refId:e._refId,search:void 0})}},n.views=[],n.scrollApi={notifyOnScroll:function(){return S.handleDocumentScrolling()},isScrollVisible:function(){},throttleRate:500,threshold:3e3,frequency:100};var S,E=[],C={},j=1,k={};function x(e,t){e&&"Comment"!==t&&e._modified>n.latestElement&&(n.latestElement=e._modified)}function T(e){i.$broadcast("elementSelected",e,"latest")}function P(e,t){return{id:e,api:{init:function(e){i.veCommentsOn&&e.toggleShowComments(),i.veElementsOn&&e.toggleShowElements(),i.ve_editmode&&e.toggleShowEdits()},elementTranscluded:x,elementClicked:T},number:t,topLevel:!!t&&-1===t.toString().indexOf("."),first:1==t}}function O(e,t){if(E.push(P(e,t)),C[e])for(var n=1,i=0;i<C[e].length;i++)O(C[e][i],t+"."+n),n+=1}function $(e,t){var n=C[e.id];if(n||(n=[]),C[e.id]=n,!e._childViews||0===e._childViews.length||"none"===t)return n;for(var i=0;i<e._childViews.length;i++)k[e._childViews[i].id]||(k[e._childViews[i].id]=!0,n.push(e._childViews[i].id));return n}function A(e,t){return e}C[_.id]=[],function(){var e=d.info("Loading data from server!",{ttl:-1});E.push({id:_.id,api:{init:function(e){i.veCommentsOn&&e.toggleShowComments(),i.veElementsOn&&e.toggleShowElements(),i.ve_editmode&&e.toggleShowEdits()},elementTranscluded:x,elementClicked:T}}),_._childViews||(_._childViews=[]);return p.handleChildViews(_,"composite",void 0,w.id,y.id,$,A).then(function(e){for(var t=0;t<e.length;t++)O(e[t],j),j+=1}).finally(e.destroy)}().then(function(){e(function(){(S=new s(E)).addInitialViews(n.scrollApi.isScrollVisible),n.views=S.viewsBuffer})}),null!==I?n.docLibLink=I._link:null!==_&&void 0!==_._groupId&&null!==_._groupId?n.docLibLink="/share/page/repository#filter=path|/Sites/"+b.id+"/documentLibrary/"+w.id+"/"+_._groupId:n.docLibLink="/share/page/repository#filter=path|/Sites/"+b.id+"/documentLibrary/"+w.id,n.$on("mms-tree-click",function(e,t){S.handleClickOnBranch(t,function(){o.hash(t.data.id),r()})}),n.$on("mms-full-doc-view-deleted",function(e,t){S.handleViewDelete(t)}),n.$on("mms-new-view-added",function(e,t,n,i){S.handleViewAdd(P(t,n),i)}),n.$on("show-comments",function(){for(var e=0;e<n.views.length;e++)n.views[e].api.toggleShowComments();n.bbApi.toggleButtonState("show-comments"),i.veCommentsOn=!i.veCommentsOn}),n.$on("show-elements",function(){for(var e=0;e<n.views.length;e++)n.views[e].api.toggleShowElements();n.bbApi.toggleButtonState("show-elements"),i.veElementsOn=!i.veElementsOn}),n.$on("show-edits",function(){var e=0;if(i.veElementsOn&&i.ve_editmode||!i.veElementsOn&&!i.ve_editmode){for(e=0;e<n.views.length;e++)n.views[e].api.toggleShowElements();n.bbApi.toggleButtonState("show-elements"),i.veElementsOn=!i.veElementsOn}for(n.bbApi.toggleButtonState("show-edits"),i.ve_editmode=!i.ve_editmode,e=0;e<n.views.length;e++)n.views[e].api.toggleShowEdits()}),n.$on("convert-pdf",function(){S.loadRemainingViews(function(){p.printModal(_,y,!0,3).then(function(e){d.info("Exporting as PDF file. Please wait for a completion email.",{ttl:-1})},function(e){d.error("Exporting as PDF file Failed: "+e.message)})})}),n.$on("print",function(){S.loadRemainingViews(function(){p.printModal(_,y,!0,1)})}),n.$on("word",function(){S.loadRemainingViews(function(){p.printModal(_,y,!0,2).then(function(e){d.info("Exporting as Word file. Please wait for a completion email.",{ttl:-1})},function(e){d.error("Exporting as Word file Failed: "+e.message)})})}),n.$on("tabletocsv",function(){S.loadRemainingViews(function(){p.tableToCsv(!0)})}),n.$on("refresh-numbering",function(){S.loadRemainingViews(function(){p.refreshNumbering(i.ve_treeApi.get_rows(),angular.element("#print-div"))})}),n.dynamicPopover=l.dynamicPopover,n.copyToClipboard=l.copyToClipboard,n.handleShareURL=l.getShortUrl.bind(null,o.absUrl(),n)}]),angular.module("mmsApp").controller("MainCtrl",["$scope","$timeout","$location","$rootScope","$state","_","$window","$uibModal","growl","$http","URLService","hotkeys","growlMessages","StompService","UtilsService","HttpService","AuthService","ElementService","CacheService","ApplicationService","$interval",function(n,o,e,s,l,a,t,i,c,r,d,m,p,u,f,g,v,h,b,w,y){s.ve_viewContentLoading=!1,s.ve_treeInitial="",s.ve_title="",s.ve_footer="";var I=s.ve_fn=!1;-1!==e.host().indexOf("fn")&&(s.ve_footer='JPL/Caltech PROPRIETARY  Not for Public Release or Redistribution. No export controlled documents allowed on this server. <a target="_blank" href="https://wiki.jpl.nasa.gov/x/GaByE">More</a>',s.ve_fn=!0),t.addEventListener("beforeunload",function(e){if(s.ve_edits&&!a.isEmpty(s.ve_edits)){var t="You may have unsaved changes, are you sure you want to leave?";return e.returnValue=t}}),m.bindTo(n).add({combo:"alt+m",description:"close all messages",callback:function(){p.destroyAllMessages()}}).add({combo:"@",description:"fast cf in editor",callback:function(){}}),n.$on("$stateChangeError",function(e,t,n,i,a,r){if(s.ve_stateChanging=!1,s.ve_viewContentLoading=!1,!r||401===r.status||404===r.status&&r.config&&r.config.url&&-1!==r.config.url.indexOf("/login/ticket"))return e.preventDefault(),s.ve_redirect={toState:t,toParams:n},void l.go("login",{notify:!1});c.error("Error: "+r.message)}),s.$on("$stateChangeStart",function(e,t,n,i,a){s.ve_viewContentLoading=!0,g.transformQueue(),s.ve_stateChanging=!0}),s.$on("mms.unauthorized",function(e,t){"login"===l.$current.name||s.ve_stateChanging||I||v.checkLogin().then(function(){},function(){"login"===l.$current.name||I||(I=!0,i.open({template:'<div class="modal-header"><h4>You have been logged out, please login again.</h4></div><div class="modal-body"><form name="loginForm" ng-submit="login(credentials)"><input type="text" class="form-control" ng-model="credentials.username" placeholder="Username" style="margin-bottom: 1.5em;" autofocus><input type="password" class="form-control" ng-model="credentials.password" placeholder="Password" style="margin-bottom: 1.5em;"><button class="btn btn-block btn-primary" type="submit">LOG IN <span ng-if="spin" ><i class="fa fa-spin fa-spinner"></i></span></button></form></div>',scope:n,backdrop:"static",controller:["$scope","$uibModalInstance",function(n,i){n.credentials={username:"",password:""},n.spin=!1,n.login=function(e){n.spin=!0;var t={username:e.username,password:e.password};v.getAuthorized(t).then(function(e){c.success("Logged in"),i.dismiss();var t=s.ve_edits;a.map(t,function(e,t){var n=f.makeElementKey(e,!0);b.put(n,e)}),l.go(l.current,{},{reload:!0})},function(e){n.spin=!1,n.credentials.password="",c.error(e.message)})}}],size:"md"}).result.finally(function(){I=!1}))})}),y(function(){s.$broadcast("mms.unauthorized")},6e5,0,!1),s.$on("$stateChangeSuccess",function(e,t,n,i,a){if(s.ve_stateChanging=!1,s.hidePanes=!1,s.showManageRefs=!1,s.showLogin=!1,"login"===l.current.name||"login.select"===l.current.name||"login.redirect"===l.current.name?(s.hidePanes=!0,s.showLogin=!0):l.includes("project")&&!l.includes("project.ref")&&(s.hidePanes=!0,s.showManageRefs=!0,s.$broadcast("fromParamChange",a)),"project.ref"===l.current.name)s.ve_treeInitial=n.refId;else if("project.ref.preview"===l.current.name){var r=n.documentId.indexOf("_cover");s.ve_treeInitial=0<r?n.documentId.substring(5,r):n.documentId}else l.includes("project.ref.document")&&"project.ref.document.order"!==l.current.name&&(void 0!==n.viewId?s.ve_treeInitial=n.viewId:s.ve_treeInitial=n.documentId);l.includes("project.ref.document")?(w.getState().inDoc=!0,w.getState().currentDoc=n.documentId,l.includes("project.ref.document.full")?w.getState().fullDoc=!0:w.getState().fullDoc=!1):(w.getState().inDoc=!1,w.getState().fullDoc=!1),s.ve_viewContentLoading=!1,!l.includes("project.ref")||"login"!==i.name&&"login.select"!==i.name&&"project"!==i.name&&"login.redirect"!==i.name||o(function(){s.ve_tree_pane.toggle(),s.ve_tree_pane.toggle()},1,!1)});var _=!1;s.$on("mms.working",function(e,t){s.ve_viewContentLoading=!1,_||(n.mmsWorkingTime=t.data,_=!0,i.open({template:'<div class="modal-header">Please come back later</div><div class="modal-body">The document you\'re requesting has been requested already at {{mmsWorkingTime.startTime | date:\'M/d/yy h:mm a\'}} and is currently being cached, please try again later.</div>',scope:n,backdrop:!0,controller:["$scope","$uibModalInstance",function(e,t){}],size:"md"}).result.finally(function(){_=!1}))}),s.$on("element.updated",function(e,t){var n=f.makeElementKey(t,!0),i=t.id+"|"+t._projectId+"|"+t._refId;s.ve_edits&&!s.ve_edits[i]&&b.exists(n)&&h.cacheElement({projectId:t._projectId,refId:t._refId,elementId:t.id,commitId:"latest"},JSON.parse(JSON.stringify(t)),!0)})}]),angular.module("mmsApp").controller("RedirectCtrl",["$scope","$rootScope","$state","$location","$timeout","ProjectService","ElementService","growl",function(c,e,d,t,m,n,p,i){e.ve_title="View Editor",c.redirect_noResults=!1,c.redirect_element=null,c.spin=!1,c.resetSelectPage=function(){d.go("login.select")};var u=function(e){d.go("login.select")},f=[],g={};n.getProjects().then(function(e){f=e.map(function(e){return e.id}),g={projectId:f[0],refId:"master"},function(e){var n=e.split("/"),t=[],i=u,a=function(){c.redirect_noResults=!0};5===n.length?e.includes("sites")&&(t.push(n[4]+"_cover"),i=function(e){0<e.length?(c.redirect_element={name:e[0].name,type:"group",link:"project.ref.preview({projectId:'"+e[0]._projectId+"',refId:'master',documentId:'"+e[0].id+"'})"},m(function(){d.go("project.ref.preview",{projectId:e[0]._projectId,refId:"master",documentId:e[0].id})},1e4)):a()}):7===n.length?e.includes("documents")?(t.push(n[6]),i=function(e){0<e.length?(c.redirect_element={name:e[0].name,type:"doc",link:"project.ref.document({projectId:'"+e[0]._projectId+"',refId:'master',documentId:'"+e[0].id+"'})"},m(function(){d.go("project.ref.document",{projectId:e[0]._projectId,refId:"master",documentId:e[0].id})},1e4)):a()}):e.includes("document")&&(t.push(n[6]),i=function(e){0<e.length?(c.redirect_element={name:e[0].name,type:"doc",link:"project.ref.preview({projectId:'"+e[0]._projectId+"',refId:'master',documentId:'"+e[0].id+"'})"},m(function(){d.go("project.ref.preview",{projectId:e[0]._projectId,refId:"master",documentId:e[0].id})},1e4)):a()}):9===n.length?e.includes("views")&&(i=n[6]==n[8]?(t.push(n[6]),function(e){0<e.length?(c.redirect_element={name:e[0].name,type:"doc",link:"project.ref.document.view({projectId:'"+e[0]._projectId+"',refId:'master',documentId:'"+e[0].id+"',viewId:'"+e[0].id+"'})"},m(function(){d.go("project.ref.document.view",{projectId:e[0]._projectId,refId:"master",documentId:e[0].id,viewId:e[0].id})},1e4)):a()}):(t.push(n[6]),t.push(n[8]),function(e){var t;1<e.length?(e[0].id===n[6]&&e[1].id===n[8]?(c.redirect_element={name:e[0].name,type:"doc",link:"project.ref.document.view({projectId:'"+e[0]._projectId+"',refId:'master',documentId:'"+e[0].id+"',viewId:'"+e[1].id+"'})"},t=function(){d.go("project.ref.document.view",{projectId:e[0]._projectId,refId:"master",documentId:e[0].id,viewId:e[1].id})}):e[0].id===n[8]&&e[1].id===n[6]&&(c.redirect_element={name:e[0].name,type:"doc",link:"project.ref.document.view({projectId:'"+e[0]._projectId+"',refId:'master',documentId:'"+e[1].id+"',viewId:'"+e[0].id+"'})"},t=function(){d.go("project.ref.document.view",{projectId:e[0]._projectId,refId:"master",documentId:e[1].id,viewId:e[0].id})}),m(t,1e4)):0<e.length?e[0].id===n[8]?(c.elem=e[0],c.redirect_relatedDocs=e[0]._relatedDocuments):e[0].id===n[6]&&(c.redirect_element={name:e[0].name,type:"doc",link:"project.ref.document({projectId:'"+e[0]._projectId+"',refId:'master',documentId:'"+e[0].id+"'})"},m(t=function(){d.go("project.ref.document",{projectId:e[0]._projectId,refId:"master",documentId:e[0].id})},1e4)):a()})):8===n.length&&e.includes("full")&&(t.push(n[6]),i=function(e){0<e.length?(c.redirect_element={name:e[0].name,type:"doc",link:"project.ref.document.full({projectId:'"+e[0]._projectId+"',refId:'master',documentId:'"+e[0].id+"'})"},m(function(){d.go("project.ref.document.full",{projectId:e[0]._projectId,refId:"master",documentId:e[0].id})},1e4)):a()});var r,o,s,l=(r=t,o=f,(s={query:{bool:{filter:[]}}}).query.bool.filter.push({terms:{id:r}}),s.query.bool.filter.push({terms:{_projectId:o}}),s.query.bool.filter.push({term:{_inRefIds:"master"}}),s);p.search(g,l).then(i,u)}(c.crush_url)})}]),angular.module("mmsApp").controller("RefsCtrl",["$sce","$q","$filter","$location","$uibModal","$scope","$rootScope","$state","$timeout","$window","growl","_","flatpickr","ElementService","ProjectService","MmsAppUtils","ApplicationService","orgOb","projectOb","refOb","refObs","tagObs","branchObs",function(e,t,n,i,a,r,o,s,l,c,d,m,p,u,f,g,v,h,b,w,y,I,_){o.mms_refOb=w,r.refManageView=!0,r.refData=[],r.bbApi={},r.buttons=[],r.branches=_,r.tags=I,r.activeTab=0,r.refSelected=null,r.search=null,r.view=null,r.fromParams={};var S=function(){var e=m.findIndex(y,{name:"master"});-1<e&&(r.fromParams=y[e],r.refSelected=y[e])};m.isEmpty(w)?S():(r.fromParams=w,r.refSelected=w),r.htmlTooltip=e.trustAsHtml("Branch temporarily unavailable during duplication."),r.addBranch=function(e){E("Branch")},r.addTag=function(e){E("Tag")},r.deleteRef=function(e){j()},r.$on("fromParamChange",function(e,t){var n=m.findIndex(y,{name:t.refId});-1<n&&(r.fromParams=y[n])}),r.$on("stomp.branchCreated",function(e,t,n){d.success(t.name+" "+t.type+" Created")}),r.refClickHandler=function(e){f.getRef(e.id,b.id).then(function(e){r.refSelected=e},function(e){d.error("Ref click handler error: "+e)})};var E=function(e){r.itemType=e;var t=r.refSelected,n="";if("Branch"===e){if(!t)return void d.warning("Add Branch Error: Select a branch or tag first");"Tag"===t.type?r.from="Tag "+t.name:r.from="Branch "+t.name,r.createParentRefId=t.id,n="partials/mms/new-branch.html"}else{if("Tag"!==e)return void d.error("Add Item of Type "+e+" is not supported");if(!t)return void d.warning("Add Tag Error: Select a branch or tag first");r.createParentRefId=t.id,n="partials/mms/new-tag.html"}a.open({templateUrl:n,scope:r,controller:["$scope","$uibModalInstance","$filter",C]}).result.then(function(e){for(var t=[],n=0;n<y.length;n++)"Tag"===y[n].type&&t.push(y[n]);r.tags=t;for(var i=[],a=0;a<y.length;a++)"Branch"===y[a].type&&i.push(y[a]);r.branches=i,"Branch"===e.type?(r.refSelected=e,r.activeTab=0):(r.refSelected=e,r.activeTab=1)})},C=function(a,t,r){a.createForm=!0,a.oking=!1;var n="",e=new Date;"Branch"===a.itemType?(a.branch={},a.branch.name="",a.branch.description="",a.branch.permission="read",a.branch.lastCommit=!0,a.branch.timestamp=e,n="Branch",a.updateTimeOpt=function(){a.branch.lastCommit=!1}):"Tag"===a.itemType&&(a.tag={},a.tag.name="",a.tag.description="",a.tag.lastCommit=!0,a.tag.timestamp=e,n="Tag",a.updateTimeOpt=function(){a.tag.lastCommit=!1}),l(function(){p(".datetimepicker",{enableTime:!0,enableSeconds:!0,defaultDate:e,dateFormat:"Y-m-dTH:i:S",time_24hr:!0,maxDate:new Date,onClose:function(e){a.$apply(function(){a.updateTimeOpt(),$(".datetimepicker#branch").length?a.branch.timestamp=e[0]:$(".datetimepicker#tag").length&&(a.tag.timestamp=e[0])})}})});var o=function(e){e.then(function(e){d.success(n+" is being created."),t.close(e)},function(e){d.error("Create "+n+" : "+e.message)}).finally(function(){a.oking=!1})};a.ok=function(){var t,e;if(a.oking)d.info("Please wait...");else if(a.oking=!0,"Branch"===a.itemType&&""!==a.branch.name){var n={name:a.branch.name,type:"Branch",description:a.branch.description};n.parentRefId=a.createParentRefId,n.permission=a.branch.permission,n.id=v.createUniqueId(),a.branch.lastCommit?(t=f.createRef(n,b.id),o(t)):(e=r("date")(a.branch.timestamp,"yyyy-MM-ddTHH:mm:ss.sssZ"),f.getRefHistory(n.parentRefId,b.id,e).then(function(e){n.parentCommitId=e[0].id,t=f.createRef(n,b.id),o(t)}))}else{if("Tag"!==a.itemType||""===a.tag.name)return d.error("Add Item of Type "+a.itemType+" is not supported"),void(a.oking=!1);var i={name:a.tag.name,type:"Tag",description:a.tag.description};i.parentRefId=a.createParentRefId,i.id=v.createUniqueId(),a.tag.lastCommit?(t=f.createRef(i,b.id),o(t)):(e=r("date")(a.tag.timestamp,"yyyy-MM-ddTHH:mm:ss.sssZ"),f.getRefHistory(i.parentRefId,b.id,e).then(function(e){i.parentCommitId=e[0].id,t=f.createRef(i,b.id),o(t)}))}},a.cancel=function(){t.dismiss()}},j=function(){var e=r.refSelected;e?(r.deleteBranch=e,a.open({templateUrl:"partials/mms/confirmDelete.html",scope:r,controller:["$scope","$uibModalInstance",k]}).result.then(function(e){var t;"Branch"===r.refSelected.type?(t=r.branches.indexOf(r.refSelected),r.branches.splice(t,1),S()):"Tag"===r.refSelected.type&&(t=r.tags.indexOf(r.refSelected),r.tags.splice(t,1)),r.refSelected=null})):d.warning("Select item to delete.")},k=function(t,n){t.oking=!1;var e=t.deleteBranch;"Tag"===e.type?t.type="Tag":"Branch"===e.type&&(t.type="Branch"),t.name=e.name,t.ok=function(){t.oking?d.info("Please wait..."):(t.oking=!0,f.deleteRef(e.id,b.id).then(function(e){d.success(t.type+" Deleted"),n.close("ok")},function(e){d.error(t.type+" Delete Error: "+e.message)}).finally(function(){t.oking=!1}))},t.cancel=function(){n.dismiss()}}}]),angular.module("mmsApp").controller("ReorderCtrl",["$scope","$rootScope","documentOb","ElementService","ViewService","MmsAppUtils","$state","growl","$q","_",function(a,i,e,t,n,r,o,s,l,c){a.doc=e;var d={},m={};d[e.id]={name:e.name,id:e.id,aggr:"composite",children:[]};var p=function(e,t,n){e[n]=t;for(var i=1,a=0;a<e.children.length;a++)p(e.children[a],t+"."+i,n),i++};a.treeOptions={dropped:function(){for(var e=0;e<a.tree.length;e++){var t=a.tree[e];t.new="";for(var n=1,i=0;i<t.children.length;i++)p(t.children[i],n+"","new"),n++}},accept:function(e,t,n){return!t.$element.hasClass("root")&&"none"!=t.node.aggr}};var u={};r.handleChildViews(e,"composite",void 0,e._projectId,e._refId,function(e,t,n){var i=d[e.id];return i||(i={name:e.name,id:e.id,aggr:t,propertyId:n,children:[]},d[e.id]=i),m[e.id]=e,i},function(e,t){for(var n=[],i=0;i<t.length;i++){var a=t[i];if(u[a.id])return;u[a.id]=a,n.push(a)}e.children.push.apply(e.children,n)}).then(function(e){var t=1;e.children.forEach(function(e){p(e,t+"","old"),p(e,t+"","new"),t++}),a.tree=[e]}),a.saveClass="";var f=!1;function g(e){var t=i.ve_treeApi.get_selected_branch();if(t){var n=t.data.id;"section"!==t.type&&"view"!==t.type&&(n=t.viewId),o.go("project.ref.document.view",{viewId:n},{reload:e})}else o.go("project.ref.document",{},{reload:!0})}a.save=function(){if(f)s.info("please wait");else if(1<a.tree.length||a.tree[0].id!==e.id)s.error("Views cannot be re-ordered outside the context of the current document.");else{f=!0,a.saveClass="fa fa-spin fa-spinner";var r=[];if(angular.forEach(d,function(e,t){if("none"!=e.aggr){for(var n=[],i=0;i<e.children.length;i++)n.push({id:e.children[i].id,aggregation:e.children[i].aggr,propertyId:e.children[i].propertyId});var a=m[t];((!a._childViews||0===a._childViews.length)&&0<n.length||a._childViews&&!angular.equals(a._childViews,n))&&r.push({id:t,_childViews:n,_projectId:a._projectId,_refId:a._refId,type:a.type})}}),0===r.length)return s.info("No changes to save!"),f=!1,void(a.saveClass="");t.updateElements(r,!0).then(function(){s.success("Reorder Successful"),g(!0)},function(e){var t=e.failedRequests[0],n=t.message;409===t.status?s.error("There's a conflict in the views you're trying to change!"):s.error(n)}).finally(function(){a.saveClass="",f=!1})}},a.cancel=function(){g(!1)}}]),angular.module("mmsApp").controller("ReorderGroupCtrl",["$scope","$rootScope","$stateParams","$state","growl","_","ElementService","CacheService","projectOb","refOb","groupObs","documentObs",function(a,i,e,r,o,s,l,c,d,m,t,n){a.isSaving=!1,a.targetId="",a.treeOptions={dropped:function(e){h(u),a.targetId=""},accept:function(e,t,n){var i=t.node&&("group"===t.node.type||"root"===t.node.type);return i&&t.$nodeScope&&t.$nodeScope.$modelValue&&t.$nodeScope.$modelValue.id&&(a.targetId=t.$nodeScope.$modelValue.id),i},dragStart:function(e){a.targetId=e.dest.nodesScope.$nodeScope.$modelValue.id}},a.saveReorder=function(){if(a.isSaving)o.info("please wait");else{a.isSaving=!0;var t=[];n=t,a.tree[0].children.forEach(function(e){("group"===e.type&&e.data._parentId||"view"===e.type&&e.data._groupId)&&n.push({node:e,newOwnerId:"holding_bin_"+d.id}),function t(n,i){n.children.forEach(function(e){("group"===e.type&&e.data._parentId!==n.data.id||"view"===e.type&&e.data._groupId!==n.data.id)&&i.push({node:e,newOwnerId:n.data.id}),t(e,i)})}(e,n)});var e=t.map(function(e){return{id:e.node.data.id,ownerId:e.newOwnerId,_projectId:d.id,_refId:m.id}});l.updateElements(e,!1).then(function(){var e,a,r;e=t,a=c.get(["documents",d.id,m.id]),r=c.get(["groups",d.id,m.id]),e.forEach(function(t){var e=-1!==t.newOwnerId.indexOf(d.id)?void 0:t.newOwnerId;if("group"===t.node.type){var n=s.find(r,function(e){return e.id===t.node.data.id});n&&(n._parentId=e)}else if("view"===t.node.type){var i=s.find(a,function(e){return e.id===t.node.data.id});i&&(i._groupId=e)}}),b(!0)}).catch(function(){o.error("Failed to save the grouping!")}).finally(function(){a.isSaving=!1})}var n},a.cancelReorder=function(){b(!1)};var p,u=(p=t.map(function(e){return g(e.name,"group",[],e)}),n.filter(function(e){return e._groupId}).forEach(function(t){var e=s.find(p,function(e){return e.data.id===t._groupId});e&&e.children.push(g(t.name,"view",[],t))}),p.forEach(function(t){var e=s.find(p,function(e){return e.data.id===t.data._parentId});return e&&(t.isChild=!0,e.children.push(t)),t}),p=p.filter(function(e){return!e.isChild}),n.filter(function(e){return!e._groupId}).forEach(function(e){p.push(g(e.name,"view",[],e))}),p);h(u);var f=g("Top Level","root",u,{id:"root"});function g(e,t,n,i){return{name:e,type:t,children:n,data:i,id:i.id}}function v(e,t){return e.type===t.type?e.name.localeCompare(t.name):"group"===e.type?-1:1}function h(e){e.sort(v),e.forEach(function(e){h(e.children)})}function b(e){var t=i.ve_treeApi.get_selected_branch();if(t){var n="group"===t.type?"site_"+t.data.id+"_cover":t.data.id;r.go("project.ref.preview",{documentId:n},{reload:e})}else r.go("project.ref",{},{reload:e})}a.tree=[f]}]),angular.module("mmsApp").controller("ToolCtrl",["$scope","$rootScope","$state","$uibModal","$q","$timeout","hotkeys","ElementService","JobService","ProjectService","growl","projectOb","refOb","tagObs","branchObs","documentOb","viewOb","Utils",function(o,s,e,t,n,i,a,r,l,c,d,m,p,u,f,g,v,h){o.specInfo={refId:p.id,commitId:"latest",projectId:m.id,id:null},o.projectOb=m,o.editable=g&&g._editable&&"Branch"===p.type,o.viewOb=v,o.documentOb=g,o.refOb=p,o.tagObs=u,o.branchObs=f,v?(o.specInfo.id=v.id,o.viewId=v.id):g&&(o.specInfo.id=g.id,o.viewId=g.id),o.specApi={},o.viewContentsOrderApi={},s.ve_togglePane=o.$pane,o.show={element:!0,history:!1,tags:!1,reorder:!1,jobs:!1},o.tracker={},s.ve_edits||(s.ve_edits={}),o.veEditsLength=function(){return Object.keys(s.ve_edits).length},o.etrackerChange=function(){o.specApi.keepMode();var e=o.tracker.etrackerSelected;if(e){var t=e.split("|");o.specInfo.id=t[0],o.specInfo.projectId=t[1],o.specInfo.refId=t[2],o.specInfo.commitId="latest",s.ve_tbApi.setPermission("element-editor",!0)}};var b=function(n){angular.forEach(o.show,function(e,t){o.show[t]=t===n})},w=function(){0<o.veEditsLength()?(s.ve_tbApi.setPermission("element-editor-saveall",!0),s.ve_tbApi.setIcon("element-editor","fa-edit-asterisk")):(s.ve_tbApi.setPermission("element-editor-saveall",!1),s.ve_tbApi.setIcon("element-editor","fa-edit"))};o.$on("jobs",function(){b("jobs")}),o.$on("element-history",function(){b("history")}),o.$on("tags",function(){b("tags")}),o.$on("gotoTagsBranches",function(){s.ve_tbApi.select("tags"),b("tags")});var y=function(e,t){if(!h.hasEdits(e)||t){var n=e.id+"|"+e._projectId+"|"+e._refId;delete s.ve_edits[n],w()}};o.$on("presentationElem.edit",function(e,t){var n=t.id+"|"+t._projectId+"|"+t._refId;s.ve_edits[n]=t,w()}),o.$on("presentationElem.save",function(e,t){y(t,!0)}),o.$on("presentationElem.cancel",function(e,t){y(t)});var I=function(e,t,n,i){o.specInfo.id=t.id,o.specInfo.projectId=t._projectId,o.specInfo.refId=t._refId,o.specInfo.commitId=n||t._commitId,o.specInfo.mmsDisplayOldContent=i,o.show.element&&s.ve_tbApi.select("element-viewer"),o.specApi.setEditing&&o.specApi.setEditing(!1);var a=t._editable&&"Branch"===o.refOb.type&&"latest"===n;s.ve_tbApi.setPermission("element-editor",a),s.$digest()};o.$on("elementSelected",I),o.$on("element-viewer",function(){o.specApi.setEditing(!1),w(),b("element")}),o.$on("element-editor",function(){o.specApi.setEditing(!0),b("element");var e=o.specApi.getEdits();if(e){var t=e.id+"|"+e._projectId+"|"+e._refId;o.tracker.etrackerSelected=t,s.ve_edits[t]=e,w()}r.isCacheOutdated(e).then(function(e){e.status&&e.server._modified>e.cache._modified&&d.error("This element has been updated on the server. Please refresh the page to get the latest version.")})}),o.$on("viewSelected",function(e,t,n){I(0,t,n);var i=(o.viewOb=t)._editable&&"Branch"===o.refOb.type&&"latest"===n;o.viewCommitId=n||t._commitId,s.ve_tbApi.setPermission("view-reorder",i)}),o.$on("view-reorder.refresh",function(){o.viewContentsOrderApi.refresh()}),o.$on("view-reorder",function(){o.viewContentsOrderApi.setEditing(!0),b("reorder")});var _=!1;o.$on("element-editor-save",function(){S(!1)}),o.$on("element-editor-saveC",function(){S(!0)});var S=function(r){if(_)d.info("Please Wait...");else{var e=o.specApi.getEdits();h.clearAutosaveContent(e._projectId+e._refId+e.id,e.type),_=!0,r?s.ve_tbApi.toggleButtonSpinner("element-editor-saveC"):s.ve_tbApi.toggleButtonSpinner("element-editor-save"),i(function(){o.specApi.save().then(function(e){if(_=!1,d.success("Save Successful"),!r){var t=o.specApi.getEdits(),n=t.id+"|"+t._projectId+"|"+t._refId;if(delete s.ve_edits[n],0<Object.keys(s.ve_edits).length){var i=Object.keys(s.ve_edits)[0],a=i.split("|");o.tracker.etrackerSelected=i,o.specApi.keepMode(),o.specInfo.id=a[0],o.specInfo.projectId=a[1],o.specInfo.refId=a[2],o.specInfo.commitId="latest"}else o.specApi.setEditing(!1),s.ve_tbApi.select("element-viewer"),w()}},function(e){_=!1,"info"===e.type?d.info(e.message):"warning"===e.type?d.warning(e.message):"error"===e.type&&d.error(e.message)}).finally(function(){r?s.ve_tbApi.toggleButtonSpinner("element-editor-saveC"):s.ve_tbApi.toggleButtonSpinner("element-editor-save")})},1e3,!1),s.ve_tbApi.select("element-editor")}};a.bindTo(o).add({combo:"alt+a",description:"save all",callback:function(){o.$broadcast("element-editor-saveall")}});var E=!1;o.$on("element-editor-saveall",function(){if(E)d.info("Please wait...");else{var e=s.ve_edits;0!==Object.keys(e).length?(Object.values(e).forEach(function(e){h.clearAutosaveContent(e._projectId+e._refId+e.id,e.type)}),o.specApi&&o.specApi.editorSave&&o.specApi.editorSave(),E=!0,s.ve_tbApi.toggleButtonSpinner("element-editor-saveall"),r.updateElements(Object.values(s.ve_edits)).then(function(e){e.forEach(function(e){delete s.ve_edits[e.id+"|"+e._projectId+"|"+e._refId],s.$broadcast("element.updated",e,!1),s.ve_tbApi.select("element-viewer"),o.specApi.setEditing(!1)}),d.success("Save All Successful")},function(e){var t=Object.values(s.ve_edits)[0];o.tracker.etrackerSelected=t.id+"|"+t._projectId+"|"+t._refId,o.specApi.keepMode(),o.specInfo.id=t.id,o.specInfo.projectId=t._projectId,o.specInfo.refId=t._refId,o.specInfo.commitId="latest",d.error("Some elements failed to save, resolve individually in edit pane")}).finally(function(){s.ve_tbApi.toggleButtonSpinner("element-editor-saveall"),E=!1,w(),0===Object.keys(s.ve_edits).length&&s.ve_tbApi.setIcon("element-editor","fa-edit")})):d.info("Nothing to save")}}),o.$on("element-editor-cancel",function(){var e=function(){var e=o.specApi.getEdits();if(delete s.ve_edits[e.id+"|"+e._projectId+"|"+e._refId],o.specApi.revertEdits(),0<Object.keys(s.ve_edits).length){var t=Object.keys(s.ve_edits)[0],n=t.split("|");o.tracker.etrackerSelected=t,o.specApi.keepMode(),o.specInfo.id=n[0],o.specInfo.projectId=n[1],o.specInfo.refId=n[2],o.specInfo.commitId="latest"}else o.specApi.setEditing(!1),s.ve_tbApi.select("element-viewer"),s.ve_tbApi.setIcon("element-editor","fa-edit"),w()};o.specApi.hasEdits()?t.open({templateUrl:"partials/mms/cancelConfirm.html",scope:o,controller:["$scope","$uibModalInstance",function(t,n){t.ok=function(){var e=t.specApi.getEdits();h.clearAutosaveContent(e._projectId+e._refId+e.id,e.type),n.close("ok")},t.cancel=function(){n.dismiss()}}]}).result.then(function(){e()}):e()});var C=!1;o.$on("view-reorder-save",function(){C?d.info("Please Wait..."):(C=!0,s.ve_tbApi.toggleButtonSpinner("view-reorder-save"),o.viewContentsOrderApi.save().then(function(e){C=!1,o.viewContentsOrderApi.refresh(),d.success("Save Succesful"),s.ve_tbApi.toggleButtonSpinner("view-reorder-save"),s.$broadcast("view.reorder.saved",o.viewOb.id)},function(e){o.viewContentsOrderApi.refresh(),C=!1;var t=e.failedRequests[0];d.error(t.message),s.ve_tbApi.toggleButtonSpinner("view-reorder-save")}),s.ve_tbApi.select("view-reorder"))}),o.$on("view-reorder-cancel",function(){o.specApi.setEditing(!1),o.viewContentsOrderApi.refresh(),s.ve_tbApi.select("element-viewer"),b("element")})}]),angular.module("mmsApp").controller("ToolbarCtrl",["$scope","$rootScope","$state","UxService","refOb","documentOb",function(e,t,n,i,a,r){var o={};e.tbApi=o,e.buttons=[],(t.ve_tbApi=o).init=function(){o.addButton(i.getToolbarButton("element-viewer")),o.addButton(i.getToolbarButton("element-editor")),t.ve_edits&&0<Object.keys(t.ve_edits).length&&(o.setIcon("element-editor","fa-edit-asterisk"),o.setPermission("element-editor-saveall",!0));var e=!1;o.addButton(i.getToolbarButton("element-history")),o.addButton(i.getToolbarButton("tags")),o.addButton(i.getToolbarButton("jobs")),n.includes("project.ref")&&!n.includes("project.ref.document")?(e=r._editable&&"Branch"===a.type,o.setPermission("element-editor",e),n.includes("project.ref.preview")&&(o.addButton(i.getToolbarButton("view-reorder")),o.setPermission("view-reorder",e))):n.includes("project.ref.document")&&(e=r._editable&&"Branch"===a.type,o.addButton(i.getToolbarButton("view-reorder")),o.setPermission("element-editor",e),o.setPermission("view-reorder",e))}}]),angular.module("mmsApp").controller("TreeCtrl",["$anchorScroll","$q","$filter","$location","$uibModal","$scope","$rootScope","$state","$timeout","growl","UxService","ElementService","UtilsService","ViewService","ProjectService","MmsAppUtils","documentOb","viewOb","orgOb","projectOb","refOb","refObs","groupObs","docMeta",function(i,a,e,r,s,m,p,c,d,u,t,f,o,g,n,v,l,h,b,w,y,I,_,S){m.filterInputPlaceholder="Filter groups/docs",c.includes("project.ref.document")&&(m.filterInputPlaceholder="Filter table of contents"),p.mms_refOb=y,p.ve_bbApi=m.bbApi={},m.tbApi={},p.ve_treeApi=m.treeApi={},p.ve_tree_pane=m.$pane,p.veTreeShowPe||(p.veTreeShowPe=!1),m.buttons=[],m.treeButtons=[],m.projectOb=w,m.refOb=y,p.ve_fullDocMode=!1,c.includes("project.ref.document.full")&&(p.ve_fullDocMode=!0);var E=l&&l._editable&&y&&"Branch"===y.type&&o.isView(l);m.tbApi.init=function(){if(c.includes("project.ref.document")){var e=t.getButtonBarButton("view-mode-dropdown");m.tbApi.addButton(e),m.tbApi.select(e,p.veTreeShowPe?t.getButtonBarButton("tree-show-pe"):t.getButtonBarButton("tree-show-views"))}},m.bbApi.init=function(){m.bbApi.addButton(t.getButtonBarButton("tree-expand")),m.bbApi.addButton(t.getButtonBarButton("tree-collapse")),c.includes("project.ref")&&!c.includes("project.ref.document")?(m.bbApi.addButton(t.getButtonBarButton("tree-reorder-group")),m.bbApi.setPermission("tree-reorder-group",w&&w._editable),m.bbApi.addButton(t.getButtonBarButton("tree-add-document-or-group")),m.bbApi.addButton(t.getButtonBarButton("tree-delete-document")),m.bbApi.setPermission("tree-add-document-or-group",l._editable&&"Tag"!==y.type),m.bbApi.setPermission("tree-delete-document",l._editable&&"Tag"!==y.type)):c.includes("project.ref.document")&&(m.bbApi.addButton(t.getButtonBarButton("tree-reorder-view")),m.bbApi.addButton(t.getButtonBarButton("tree-full-document")),m.bbApi.addButton(t.getButtonBarButton("tree-add-view")),m.bbApi.addButton(t.getButtonBarButton("tree-delete-view")),m.bbApi.setPermission("tree-add-view",E),m.bbApi.setPermission("tree-reorder-view",E),m.bbApi.setPermission("tree-delete-view",E),p.ve_fullDocMode&&m.bbApi.setToggleState("tree-full-document",!0))},m.$on("tree-expand",function(){m.treeApi.expand_all()}),m.$on("tree-collapse",function(){m.treeApi.collapse_all()}),m.$on("tree-add-document",function(){V("Document")}),m.$on("tree-delete-document",function(){m.deleteItem()}),m.$on("tree-add-view",function(){V("View")}),m.$on("tree-delete",function(){m.deleteItem()}),m.$on("tree-delete-view",function(){m.deleteItem(function(e){p.$broadcast("mms-full-doc-view-deleted",e)})}),m.$on("tree-reorder-view",function(){p.ve_fullDocMode=!1,m.bbApi.setToggleState("tree-full-document",!1),c.go("project.ref.document.order",{search:void 0})}),m.$on("tree-reorder-group",function(){c.go("project.ref.groupReorder")}),m.$on("tree-add-group",function(){V("Group")}),m.$on("tree-show-pe",function(){C("showTree"),p.veTreeShowPe=!0,B(x[l.id]),m.treeApi.refresh()}),m.$on("tree-show-views",function(){C("showTree"),p.veTreeShowPe=!1,B(x[l.id]),m.treeApi.refresh()}),m.tableList=[],m.figureList=[],m.equationList=[],m.treeViewModes=[{id:"table",title:"Tables",icon:"fa-table",branchList:m.tableList},{id:"figure",title:"Figures",icon:"fa-image",branchList:m.figureList},{id:"equation",title:"Equations",icon:"fa-superscript",branchList:m.equationList}];var C=function(e){m.activeMenu=e};function j(e,t,n){e.type===t&&n.push(e);for(var i=0;i<e.children.length;i++)j(e.children[i],t,n)}function k(e){"table"!=e&&"all"!=e||(m.tableList.length=0,j(x[l.id],"table",m.tableList)),"figure"!=e&&"image"!=e&&"all"!=e||(m.figureList.length=0,j(x[l.id],"figure",m.figureList)),"equation"!=e&&"all"!=e||(m.equationList.length=0,j(x[l.id],"equation",m.equationList))}C("showTree"),m.$on("tree-show-tables",function(){C("table")}),m.$on("tree-show-figures",function(){C("figure")}),m.$on("tree-show-equations",function(){C("equation")}),m.$on("tree-full-document",function(){m.fullDocMode()});var x={},T={},P=function(e,t){var n=x[e.id];return n||(n={label:e.name,type:"view",data:e,children:[],loading:!0,aggr:t},x[e.id]=n),n},O=function(e,t){for(var n,i=[],a=0;a<t.length;a++)n=t[a],T[n.data.id]?u.error("Warning: View "+n.data.name+" have multiple parents! Duplicates not shown."):(T[n.data.id]=n,i.push(n));e.children.push.apply(e.children,i),e.loading=!1,m.treeApi.refresh&&m.treeApi.refresh()},A=function(e){var t=e.data.id;T[t]&&delete T[t],x[t]&&delete x[t];for(var n=0;n<e.children.length;n++)A(e.children[n])};function R(e,o,s,l){var t=null;e._contents?t=e._contents:g.isSection(e)&&e.specification&&(t=e.specification),t&&t.operand&&function(i){var e=[],t=0;for(t=0;t<i.length;t++)e.push(i[t].instanceId);f.getElements({elementIds:e,projectId:w.id,refId:y.id},0).then(function(e){for(var t=[],n=0;n<i.length;n++)t.push(f.getElement({projectId:w.id,refId:y.id,elementId:i[n].instanceId},0));a.all(t).then(function(e){for(var t=e.length-1;0<=t;t--){var n=e[t],i=!p.veTreeShowPe;if(g.isSection(n)){var a={label:n.name,type:"section",viewId:o.data.id,data:n,children:[]};x[n.id]=a,s.children.unshift(a),R(n,o,a,l)}else if(g.getTreeType(n)){var r={label:n.name,type:g.getTreeType(n),viewId:o.data.id,data:n,hide:i,children:[]};s.children.unshift(r)}}m.treeApi.refresh(),l&&m.treeApi.initialSelect(),k("all")},function(e){})},function(e){})}(t.operand)}c.includes("project.ref")&&!c.includes("project.ref.document")?(m.treeData=o.buildTreeHierarchy(_,"id","group","_parentId",function(a,r){r.loading=!0,g.getProjectDocuments({projectId:w.id,refId:y.id},2).then(function(e){var t,n,i=[];for(n=0;n<e.length;n++)(t=e[n])._groupId===a.id&&i.push(t);for(n=0;n<i.length;n++)t=i[n],r.children.unshift({label:t.name,type:"Branch"===y.type?"view":"snapshot",data:t,group:a,children:[]});r.loading=!1,m.treeApi.initialSelect&&m.treeApi.initialSelect()})}),g.getProjectDocuments({projectId:w.id,refId:y.id},2).then(function(e){for(var t=0;t<e.length;t++)e[t]._groupId&&e[t]._groupId!=w.id||m.treeData.push({label:e[t].name,type:"view",data:e[t],children:[]});m.treeApi.initialSelect&&m.treeApi.initialSelect()})):(l._childViews||(l._childViews=[]),v.handleChildViews(l,"composite",void 0,w.id,y.id,P,O).then(function(e){var t=[];for(var n in x){var i=x[n].data;if(i._contents&&i._contents.operand)for(var a=0;a<i._contents.operand.length;a++)t.push(i._contents.operand[a].instanceId)}f.getElements({elementIds:t,projectId:w.id,refId:y.id},0).finally(function(){for(var e in x)R(x[e].data,x[e],x[e],!0);m.treeApi.refresh()})},function(e){console.log(e)}),m.treeData=[x[l.id]]);m.treeOptions={types:t.getTreeTypes(),sectionNumbering:!!c.includes("project.ref.document"),numberingDepth:0,numberingSeparator:".",expandLevel:c.includes("project.ref.document")?3:c.includes("project.ref")?0:1,search:"",onSelect:function(e){if(c.includes("project.ref")&&!c.includes("project.ref.document"))"group"===e.type?c.go("project.ref.preview",{documentId:"site_"+e.data.id+"_cover",search:void 0}):"view"!==e.type&&"snapshot"!==e.type||c.go("project.ref.preview",{documentId:e.data.id,search:void 0});else if(c.includes("project.ref.document")){var t="view"!==e.type?e.viewId:e.data.id,n=e.data.id;p.ve_fullDocMode?p.$broadcast("mms-tree-click",e):"view"===e.type||"section"===e.type?c.go("project.ref.document.view",{viewId:e.data.id,search:void 0}):(c.go("project.ref.document.view",{viewId:t,search:void 0}),d(function(){r.hash(n),i()},1e3,!1))}},onDblclick:function(e){c.includes("project.ref")&&!c.includes("project.ref.document")?"group"===e.type?p.ve_treeApi.expand_branch(e):"view"!==e.type&&"snapshot"!==e.type||c.go("project.ref.document",{documentId:e.data.id,search:void 0}):c.includes("project.ref.document")&&p.ve_treeApi.expand_branch(e)},sort:c.includes("project.ref.document")?null:function(e,t){return e.priority=100,"tag"===e.type?e.priority=0:"group"===e.type?e.priority=1:"view"===e.type&&(e.priority=2),t.priority=100,"tag"===t.type?t.priority=0:"group"===t.type?t.priority=1:"view"===t.type&&(t.priority=2),e.priority<t.priority?-1:e.priority>t.priority?1:(e.label||(e.label=""),t.label||(t.label=""),e.label.toLowerCase()<t.label.toLowerCase()?-1:e.label.toLowerCase()>t.label.toLowerCase()?1:0)}},l&&S&&(m.treeOptions.numberingDepth=S.numberingDepth,m.treeOptions.numberingSeparator=S.numberingSeparator,m.treeOptions.startChapter=l._startChapter),m.fullDocMode=function(){if(p.ve_fullDocMode){p.ve_fullDocMode=!1,m.bbApi.setToggleState("tree-full-document",!1);var e,t=m.treeApi.get_selected_branch();if(t)e="view"!==t.type?"section"===t.type&&"InstanceSpecification"===t.data.type?t.data.id:t.viewId:t.data.id,c.go("project.ref.document.view",{viewId:e,search:void 0})}else p.ve_fullDocMode=!0,m.bbApi.setToggleState("tree-full-document",!0),c.go("project.ref.document.full",{search:void 0})};var V=function(r){m.itemType=r,m.newViewAggr={type:"shared"};var o=m.treeApi.get_selected_branch(),e="",l="";if("Document"===r){if(o){if("group"!==o.type)return void u.warning("Select a group to add document under");m.parentBranchData=o.data}else m.parentBranchData={id:"holding_bin_"+w.id};e="partials/mms/new-doc-or-group.html",l="view"}else if("Group"===r)o&&"group"===o.type?m.parentBranchData=o.data:(m.parentBranchData={id:"holding_bin_"+w.id},o=null),e="partials/mms/new-doc-or-group.html",l="group";else{if("View"!==r)return void u.error("Add Item of Type "+r+" is not supported");if(!o)return void u.warning("Add View Error: Select parent view first");if("section"===o.type)return void u.warning("Add View Error: Cannot add a child view to a section");if("none"===o.aggr)return void u.warning("Add View Error: Cannot add a child view to a non-owned and non-shared view.");m.parentBranchData=o.data,e="partials/mms/new-view.html",l="view"}s.open({templateUrl:e,scope:m,controller:["$scope","$uibModalInstance","$filter",D]}).result.then(function(e){p.ve_editmode||d(function(){$(".show-edits").click()},0,!1);var t={label:e.name,type:l,data:e,children:[]},n="Group"===r;m.treeApi.add_branch(o,t,n);var s=function(e,t,n){var i=n;if(e.children)for(var a=1,r=0;r<e.children.length;r++){var o=e.children[r];p.$broadcast("mms-new-view-added",o.data.id,t+"."+a,i),i=s(o,t+"."+a,o.data.id),a+=1}return i};if("View"===r){x[e.id]=t,(T[e.id]=t).aggr=m.newViewAggr.type;for(var i=o.children[o.children.length-1].section,a=m.treeApi.get_prev_branch(t);"view"!==a.type;)a=m.treeApi.get_prev_branch(a);v.handleChildViews(e,m.newViewAggr.type,void 0,w.id,y.id,P,O).then(function(e){p.ve_fullDocMode&&s(e,i,t.data.id),function e(t){n=t.data,i=x[n.id],R(n,i,i);var n,i;for(var a=0;a<t.children.length;a++)"view"===t.children[a].type&&e(t.children[a])}(e)}),p.ve_fullDocMode?a?p.$broadcast("mms-new-view-added",e.id,i,a.data.id):p.$broadcast("mms-new-view-added",e.id,i,o.data.id):c.go("project.ref.document.view",{viewId:e.id,search:void 0})}})},D=function(i,a){i.createForm=!0,i.oking=!1,i.projectOb=w,i.refOb=y;var t="";if("Document"===i.itemType)i.newDoc={name:""},t="Document";else if("View"===i.itemType)i.newView={name:""},t="View";else{if("Group"!==i.itemType)return void u.error("Add Item of Type "+i.itemType+" is not supported");i.newGroup={name:""},t="Group"}i.searchOptions={callback:function(t){var n=t.id;T[n]?u.error("Error: View "+t.name+" is already in this document."):i.oking?u.info("Please wait..."):(i.oking=!0,g.addViewToParentView({parentViewId:i.parentBranchData.id,viewId:n,projectId:i.parentBranchData._projectId,refId:i.parentBranchData._refId,aggr:i.newViewAggr.type}).then(function(e){f.getElement({elementId:n,projectId:t._projectId,refId:t._refId},2,!1).then(function(e){a.close(e)},function(){a.close(t)}).finally(function(){u.success("View Added")})},function(e){u.error("View Add Error: "+e.message)}).finally(function(){i.oking=!1}))},itemsPerPage:200,filterQueryList:[function(){var e={};return e.terms={_appliedStereotypeIds:[o.VIEW_SID,o.DOCUMENT_SID].concat(o.OTHER_VIEW_SID)},e}],hideFilterOptions:!0},i.ok=function(){if(i.oking)u.info("Please wait...");else{var e;if(i.oking=!0,"Document"===i.itemType)e=g.createDocument({_projectId:w.id,_refId:y.id,id:i.parentBranchData.id},{viewName:i.newDoc.name,isDoc:!0});else if("View"===i.itemType)i.newViewAggr.type="composite",e=g.createView(i.parentBranchData,{viewName:i.newView.name});else{if("Group"!==i.itemType)return u.error("Add Item of Type "+i.itemType+" is not supported"),void(i.oking=!1);e=g.createGroup(i.newGroup.name,{_projectId:w.id,_refId:y.id,id:i.parentBranchData.id},b.id)}e.then(function(e){u.success(t+" Created"),"Tag"===i.itemType&&u.info("Please wait for a completion email prior to viewing of the tag."),a.close(e)},function(e){u.error("Create "+t+" Error: "+e.message)}).finally(function(){i.oking=!1})}},i.cancel=function(){a.dismiss()}};m.deleteItem=function(t){var n=m.treeApi.get_selected_branch();if(n){var e=g.getElementType(n.data);if(c.includes("project.ref.document")){if("Document"==e)return void u.warning("Cannot remove a document from this view. To remove this item, go to project home.");if("view"!==n.type||!o.isView(n.data))return void u.warning("Cannot remove non-view item. To remove this item, open it in the center pane.")}if(!c.includes("project.ref")||c.includes("project.ref.document")||"view"===n.type||o.isDocument(n.data)||!("group"!==n.type||0<n.children.length))m.deleteBranch=n,s.open({templateUrl:"partials/mms/confirmRemove.html",scope:m,controller:["$scope","$uibModalInstance",L]}).result.then(function(e){m.treeApi.remove_branch(n),c.includes("project.ref.document")&&"view"===n.type&&A(n),p.ve_fullDocMode?t(n):(m.treeApi.clear_selected_branch(),c.go("^",{search:void 0}))});else u.warning("Cannot remove group with contents. Empty contents and try again.")}else u.warning("Select item to remove.")};var L=function(n,i){var a=n.deleteBranch;n.oking=!1,n.type=a.type,o.isDocument(a.data)&&(n.type="Document"),n.name=a.data.name,n.ok=function(){if(n.oking)u.info("Please wait...");else{n.oking=!0;var e=null;if("view"===a.type){var t=n.treeApi.get_parent_branch(a);e=c.includes("project.ref.document")?g.removeViewFromParentView({projectId:t.data._projectId,refId:t.data._refId,parentViewId:t.data.id,viewId:a.data.id}):g.downgradeDocument(a.data)}else"group"===a.type&&(e=g.removeGroup(a.data));e?e.then(function(e){u.success(n.type+" Removed"),i.close("ok")},function(e){u.error(n.type+" Removal Error: "+e.message)}).finally(function(){n.oking=!1}):(n.oking=!1,i.dismiss())}},n.cancel=function(){i.dismiss()}};function B(e){"figure"!==e.type&&"table"!==e.type&&"equation"!==e.type||(e.hide=!p.veTreeShowPe);for(var t=0;t<e.children.length;t++)B(e.children[t])}m.$on("viewctrl.add.element",function(e,t,n,i){if("paragraph"!==n&&"list"!==n&&"comment"!==n){var a=m.treeApi.get_branch(i),r=null;r="section"===a.type?a.viewId:a.data.id;var o=x[r],s={label:t.name,type:"image"===n?"figure":n,viewId:r,data:t,hide:!p.veTreeShowPe&&"section"!==n,children:[]},l=0,c=-1,d=!1;for(l=0;l<a.children.length;l++)if("view"===a.children[l].type){c=l-1,d=!0;break}-1!==c||d||(c=a.children.length-1),a.children.splice(c+1,0,s),"section"===n&&R(t,o,s),m.treeApi.refresh(),k(n)}}),m.$on("viewctrl.delete.element",function(e,t){var n=m.treeApi.get_branch(t);n&&m.treeApi.remove_single_branch(n),k(n.type)}),m.$on("view.reorder.saved",function(e,t){for(var n=x[t],i=n,a=[],r=0;r<n.children.length;r++){var o=n.children[r];"view"===o.type&&a.push(o)}n.children=a,"section"===n.type&&((i=x[n.view])||(i=n)),R(n.data,i,n)}),m.user_clicks_branch=function(e){p.ve_treeApi.user_clicks_branch(e)},m.searchInputChangeHandler=function(){""===m.treeOptions.search?(m.treeApi.collapse_all(),m.treeApi.expandPathToSelectedBranch()):m.treeApi.expand_all()}}]),angular.module("mmsApp").controller("ViewCtrl",["$scope","$rootScope","$state","$timeout","$window","$location","$http","$element","growl","hotkeys","MmsAppUtils","UxService","URLService","UtilsService","ShortenUrlService","Utils","search","orgOb","projectOb","refOb","groupOb","documentOb","viewOb",function(n,t,i,e,a,r,o,s,l,c,d,m,p,u,f,g,v,h,b,w,y,I,_){function S(){return 0<s.find(".isLoading").length&&(l.warning("Still loading!"),!0)}n.vidLink=!1,i.includes("project.ref.preview")&&_&&_.id.indexOf("_cover")<0&&(n.vidLink=!0),t.veCommentsOn||(t.veCommentsOn=!1),t.veElementsOn||(t.veElementsOn=!1),t.ve_editmode||(t.ve_editmode=!1),n.search=v,g.toggleLeftPane(v),n.viewOb=_,n.projectOb=b,n.refOb=w,n.buttons=[],n.viewApi={init:function(){t.veCommentsOn&&n.viewApi.toggleShowComments(),t.veElementsOn&&n.viewApi.toggleShowElements(),t.ve_editmode&&n.viewApi.toggleShowEdits()},elementTranscluded:function(e,t){"Comment"!==t||n.comments.map.hasOwnProperty(e.id)||(n.comments.map[e.id]=e,n.comments.count++,e._modified>n.comments.lastCommented&&(n.comments.lastCommented=e._modified,n.comments.lastCommentedBy=e._modifier))},elementClicked:function(e){t.$broadcast("elementSelected",e,"latest")}},n.comments={count:0,lastCommented:"",lastCommentedBy:"",map:{}},n.docLibLink="",null!==y?n.docLibLink=y._link:null!==I&&void 0!==I._groupId&&null!==I._groupId?n.docLibLink="/share/page/repository#filter=path|/Sites/"+h.id+"/documentLibrary/"+b.id+"/"+I._groupId:n.docLibLink="/share/page/repository#filter=path|/Sites/"+h.id+"/documentLibrary/"+b.id,n.bbApi={init:function(){if(_&&_._editable&&"Branch"===w.type&&(n.bbApi.addButton(m.getButtonBarButton("show-edits")),n.bbApi.setToggleState("show-edits",t.ve_editmode),c.bindTo(n).add({combo:"alt+d",description:"toggle edit mode",callback:function(){n.$broadcast("show-edits")}})),n.bbApi.addButton(m.getButtonBarButton("show-elements")),n.bbApi.setToggleState("show-elements",t.veElementsOn),n.bbApi.addButton(m.getButtonBarButton("show-comments")),n.bbApi.setToggleState("show-comments",t.veCommentsOn),c.bindTo(n).add({combo:"alt+c",description:"toggle show comments",callback:function(){n.$broadcast("show-comments")}}).add({combo:"alt+e",description:"toggle show elements",callback:function(){n.$broadcast("show-elements")}}),i.includes("project.ref.preview")||i.includes("project.ref.document"))if(n.bbApi.addButton(m.getButtonBarButton("refresh-numbering")),n.bbApi.addButton(m.getButtonBarButton("print")),i.includes("project.ref.document")){var e=m.getButtonBarButton("export");e.dropdown_buttons.push(m.getButtonBarButton("convert-pdf")),n.bbApi.addButton(e),n.bbApi.addButton(m.getButtonBarButton("center-previous")),n.bbApi.addButton(m.getButtonBarButton("center-next")),c.bindTo(n).add({combo:"alt+.",description:"next",callback:function(){n.$broadcast("center-next")}}).add({combo:"alt+,",description:"previous",callback:function(){n.$broadcast("center-previous")}})}else n.bbApi.addButton(m.getButtonBarButton("export"))}},n.$on("show-comments",function(){n.viewApi.toggleShowComments(),n.bbApi.toggleButtonState("show-comments"),t.veCommentsOn=!t.veCommentsOn}),n.$on("show-elements",function(){n.viewApi.toggleShowElements(),n.bbApi.toggleButtonState("show-elements"),t.veElementsOn=!t.veElementsOn}),n.$on("show-edits",function(){(t.veElementsOn&&t.ve_editmode||!t.veElementsOn&&!t.ve_editmode)&&(n.viewApi.toggleShowElements(),n.bbApi.toggleButtonState("show-elements"),t.veElementsOn=!t.veElementsOn),n.viewApi.toggleShowEdits(),n.bbApi.toggleButtonState("show-edits"),t.ve_editmode=!t.ve_editmode}),n.$on("center-previous",function(){var e=t.ve_treeApi.get_prev_branch(t.ve_treeApi.get_selected_branch());if(e){for(;"view"!==e.type&&"section"!==e.type;)if(!(e=t.ve_treeApi.get_prev_branch(e)))return;n.bbApi.toggleButtonSpinner("center-previous"),t.ve_treeApi.select_branch(e),n.bbApi.toggleButtonSpinner("center-previous")}}),n.$on("center-next",function(){var e=t.ve_treeApi.get_next_branch(t.ve_treeApi.get_selected_branch());if(e){for(;"view"!==e.type&&"section"!==e.type;)if(!(e=t.ve_treeApi.get_next_branch(e)))return;n.bbApi.toggleButtonSpinner("center-next"),t.ve_treeApi.select_branch(e),n.bbApi.toggleButtonSpinner("center-next")}}),n.dynamicPopover=f.dynamicPopover,n.copyToClipboard=f.copyToClipboard,n.handleShareURL=f.getShortUrl.bind(null,r.absUrl(),n),_&&i.includes("project.ref")&&e(function(){t.$broadcast("viewSelected",_,"latest")},1e3),n.searchOptions={emptyDocTxt:"This field is empty.",searchInput:v,getProperties:!0,closeable:!0,callback:function(e){t.$broadcast("elementSelected",e,"latest"),t.ve_togglePane&&t.ve_togglePane.closed&&t.ve_togglePane.toggle()},relatedCallback:function(e,t,n){i.go("project.ref.document.view",{projectId:e._projectId,documentId:e.id,viewId:t.id,refId:e._refId,search:void 0})}},n.$on("convert-pdf",function(){S()||d.printModal(_,w,!1,3).then(function(e){l.info("Exporting as PDF file. Please wait for a completion email.",{ttl:-1})},function(e){l.error("Exporting as PDF file Failed: "+e.message)})}),n.$on("print",function(){S()||d.printModal(_,w,!1,1)}),n.$on("word",function(){S()||d.printModal(_,w,!1,2).then(function(e){l.info("Exporting as Word file. Please wait for a completion email.",{ttl:-1})},function(e){l.error("Exporting as Word file Failed: "+e.message)})}),n.$on("tabletocsv",function(){S()||d.tableToCsv(!1)}),n.$on("refresh-numbering",function(){if(!S()){var e=angular.element("#print-div");d.refreshNumbering(t.ve_treeApi.get_rows(),e)}})}]),angular.module("mmsApp").directive("mmsCurrentTag",["$rootScope",mmsCurrentTag]),angular.module("mmsApp").directive("runXlr",["$http","$uibModal","$window","growl","ApplicationService",runXlr]),angular.module("mmsApp").directive("veFooter",["$templateCache",veFooter]),angular.module("mmsApp").directive("veMenu",["CacheService","$state","$templateCache","$sce","$timeout","UtilsService",veMenu]),angular.module("mmsApp").directive("veNav",["$templateCache","$rootScope","$state","hotkeys","growl","$location","$uibModal","ApplicationService","AuthService","ProjectService",veNav])}("undefined"==typeof mms?mms={}:mms);
//# sourceMappingURL=ve-mms.min.js.map